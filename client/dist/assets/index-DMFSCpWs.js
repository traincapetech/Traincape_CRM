(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(s){if(s.ep)return;s.ep=!0;const l=r(s);fetch(s.href,l)}})();function bp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Kh={exports:{}},lc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rv;function gE(){if(rv)return lc;rv=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,s,l){var u=null;if(l!==void 0&&(u=""+l),s.key!==void 0&&(u=""+s.key),"key"in s){l={};for(var h in s)h!=="key"&&(l[h]=s[h])}else l=s;return s=l.ref,{$$typeof:e,type:n,key:u,ref:s!==void 0?s:null,props:l}}return lc.Fragment=t,lc.jsx=r,lc.jsxs=r,lc}var nv;function yE(){return nv||(nv=1,Kh.exports=gE()),Kh.exports}var o=yE(),Qh={exports:{}},St={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function vE(){if(av)return St;av=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function y(R){return R===null||typeof R!="object"?null:(R=g&&R[g]||R["@@iterator"],typeof R=="function"?R:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,N={};function w(R,ne,P){this.props=R,this.context=ne,this.refs=N,this.updater=P||v}w.prototype.isReactComponent={},w.prototype.setState=function(R,ne){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,ne,"setState")},w.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function E(){}E.prototype=w.prototype;function C(R,ne,P){this.props=R,this.context=ne,this.refs=N,this.updater=P||v}var T=C.prototype=new E;T.constructor=C,S(T,w.prototype),T.isPureReactComponent=!0;var O=Array.isArray,j={H:null,A:null,T:null,S:null,V:null},q=Object.prototype.hasOwnProperty;function D(R,ne,P,H,z,_){return P=_.ref,{$$typeof:e,type:R,key:ne,ref:P!==void 0?P:null,props:_}}function U(R,ne){return D(R.type,ne,void 0,void 0,void 0,R.props)}function K(R){return typeof R=="object"&&R!==null&&R.$$typeof===e}function ie(R){var ne={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(P){return ne[P]})}var te=/\/+/g;function G(R,ne){return typeof R=="object"&&R!==null&&R.key!=null?ie(""+R.key):ne.toString(36)}function de(){}function J(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(de,de):(R.status="pending",R.then(function(ne){R.status==="pending"&&(R.status="fulfilled",R.value=ne)},function(ne){R.status==="pending"&&(R.status="rejected",R.reason=ne)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function W(R,ne,P,H,z){var _=typeof R;(_==="undefined"||_==="boolean")&&(R=null);var ce=!1;if(R===null)ce=!0;else switch(_){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(R.$$typeof){case e:case t:ce=!0;break;case p:return ce=R._init,W(ce(R._payload),ne,P,H,z)}}if(ce)return z=z(R),ce=H===""?"."+G(R,0):H,O(z)?(P="",ce!=null&&(P=ce.replace(te,"$&/")+"/"),W(z,ne,P,"",function(je){return je})):z!=null&&(K(z)&&(z=U(z,P+(z.key==null||R&&R.key===z.key?"":(""+z.key).replace(te,"$&/")+"/")+ce)),ne.push(z)),1;ce=0;var re=H===""?".":H+":";if(O(R))for(var me=0;me<R.length;me++)H=R[me],_=re+G(H,me),ce+=W(H,ne,P,_,z);else if(me=y(R),typeof me=="function")for(R=me.call(R),me=0;!(H=R.next()).done;)H=H.value,_=re+G(H,me++),ce+=W(H,ne,P,_,z);else if(_==="object"){if(typeof R.then=="function")return W(J(R),ne,P,H,z);throw ne=String(R),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return ce}function F(R,ne,P){if(R==null)return R;var H=[],z=0;return W(R,H,"","",function(_){return ne.call(P,_,z++)}),H}function Z(R){if(R._status===-1){var ne=R._result;ne=ne(),ne.then(function(P){(R._status===0||R._status===-1)&&(R._status=1,R._result=P)},function(P){(R._status===0||R._status===-1)&&(R._status=2,R._result=P)}),R._status===-1&&(R._status=0,R._result=ne)}if(R._status===1)return R._result.default;throw R._result}var oe=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent(ne))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)};function le(){}return St.Children={map:F,forEach:function(R,ne,P){F(R,function(){ne.apply(this,arguments)},P)},count:function(R){var ne=0;return F(R,function(){ne++}),ne},toArray:function(R){return F(R,function(ne){return ne})||[]},only:function(R){if(!K(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},St.Component=w,St.Fragment=r,St.Profiler=s,St.PureComponent=C,St.StrictMode=n,St.Suspense=m,St.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,St.__COMPILER_RUNTIME={__proto__:null,c:function(R){return j.H.useMemoCache(R)}},St.cache=function(R){return function(){return R.apply(null,arguments)}},St.cloneElement=function(R,ne,P){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var H=S({},R.props),z=R.key,_=void 0;if(ne!=null)for(ce in ne.ref!==void 0&&(_=void 0),ne.key!==void 0&&(z=""+ne.key),ne)!q.call(ne,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&ne.ref===void 0||(H[ce]=ne[ce]);var ce=arguments.length-2;if(ce===1)H.children=P;else if(1<ce){for(var re=Array(ce),me=0;me<ce;me++)re[me]=arguments[me+2];H.children=re}return D(R.type,z,void 0,void 0,_,H)},St.createContext=function(R){return R={$$typeof:u,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:l,_context:R},R},St.createElement=function(R,ne,P){var H,z={},_=null;if(ne!=null)for(H in ne.key!==void 0&&(_=""+ne.key),ne)q.call(ne,H)&&H!=="key"&&H!=="__self"&&H!=="__source"&&(z[H]=ne[H]);var ce=arguments.length-2;if(ce===1)z.children=P;else if(1<ce){for(var re=Array(ce),me=0;me<ce;me++)re[me]=arguments[me+2];z.children=re}if(R&&R.defaultProps)for(H in ce=R.defaultProps,ce)z[H]===void 0&&(z[H]=ce[H]);return D(R,_,void 0,void 0,null,z)},St.createRef=function(){return{current:null}},St.forwardRef=function(R){return{$$typeof:h,render:R}},St.isValidElement=K,St.lazy=function(R){return{$$typeof:p,_payload:{_status:-1,_result:R},_init:Z}},St.memo=function(R,ne){return{$$typeof:f,type:R,compare:ne===void 0?null:ne}},St.startTransition=function(R){var ne=j.T,P={};j.T=P;try{var H=R(),z=j.S;z!==null&&z(P,H),typeof H=="object"&&H!==null&&typeof H.then=="function"&&H.then(le,oe)}catch(_){oe(_)}finally{j.T=ne}},St.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},St.use=function(R){return j.H.use(R)},St.useActionState=function(R,ne,P){return j.H.useActionState(R,ne,P)},St.useCallback=function(R,ne){return j.H.useCallback(R,ne)},St.useContext=function(R){return j.H.useContext(R)},St.useDebugValue=function(){},St.useDeferredValue=function(R,ne){return j.H.useDeferredValue(R,ne)},St.useEffect=function(R,ne,P){var H=j.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return H.useEffect(R,ne)},St.useId=function(){return j.H.useId()},St.useImperativeHandle=function(R,ne,P){return j.H.useImperativeHandle(R,ne,P)},St.useInsertionEffect=function(R,ne){return j.H.useInsertionEffect(R,ne)},St.useLayoutEffect=function(R,ne){return j.H.useLayoutEffect(R,ne)},St.useMemo=function(R,ne){return j.H.useMemo(R,ne)},St.useOptimistic=function(R,ne){return j.H.useOptimistic(R,ne)},St.useReducer=function(R,ne,P){return j.H.useReducer(R,ne,P)},St.useRef=function(R){return j.H.useRef(R)},St.useState=function(R){return j.H.useState(R)},St.useSyncExternalStore=function(R,ne,P){return j.H.useSyncExternalStore(R,ne,P)},St.useTransition=function(){return j.H.useTransition()},St.version="19.1.0",St}var sv;function _f(){return sv||(sv=1,Qh.exports=vE()),Qh.exports}var k=_f();const at=bp(k);var Zh={exports:{}},cc={},Jh={exports:{}},em={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iv;function bE(){return iv||(iv=1,function(e){function t(F,Z){var oe=F.length;F.push(Z);e:for(;0<oe;){var le=oe-1>>>1,R=F[le];if(0<s(R,Z))F[le]=Z,F[oe]=R,oe=le;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var Z=F[0],oe=F.pop();if(oe!==Z){F[0]=oe;e:for(var le=0,R=F.length,ne=R>>>1;le<ne;){var P=2*(le+1)-1,H=F[P],z=P+1,_=F[z];if(0>s(H,oe))z<R&&0>s(_,H)?(F[le]=_,F[z]=oe,le=z):(F[le]=H,F[P]=oe,le=P);else if(z<R&&0>s(_,oe))F[le]=_,F[z]=oe,le=z;else break e}}return Z}function s(F,Z){var oe=F.sortIndex-Z.sortIndex;return oe!==0?oe:F.id-Z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var u=Date,h=u.now();e.unstable_now=function(){return u.now()-h}}var m=[],f=[],p=1,g=null,y=3,v=!1,S=!1,N=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function O(F){for(var Z=r(f);Z!==null;){if(Z.callback===null)n(f);else if(Z.startTime<=F)n(f),Z.sortIndex=Z.expirationTime,t(m,Z);else break;Z=r(f)}}function j(F){if(N=!1,O(F),!S)if(r(m)!==null)S=!0,q||(q=!0,G());else{var Z=r(f);Z!==null&&W(j,Z.startTime-F)}}var q=!1,D=-1,U=5,K=-1;function ie(){return w?!0:!(e.unstable_now()-K<U)}function te(){if(w=!1,q){var F=e.unstable_now();K=F;var Z=!0;try{e:{S=!1,N&&(N=!1,C(D),D=-1),v=!0;var oe=y;try{t:{for(O(F),g=r(m);g!==null&&!(g.expirationTime>F&&ie());){var le=g.callback;if(typeof le=="function"){g.callback=null,y=g.priorityLevel;var R=le(g.expirationTime<=F);if(F=e.unstable_now(),typeof R=="function"){g.callback=R,O(F),Z=!0;break t}g===r(m)&&n(m),O(F)}else n(m);g=r(m)}if(g!==null)Z=!0;else{var ne=r(f);ne!==null&&W(j,ne.startTime-F),Z=!1}}break e}finally{g=null,y=oe,v=!1}Z=void 0}}finally{Z?G():q=!1}}}var G;if(typeof T=="function")G=function(){T(te)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,J=de.port2;de.port1.onmessage=te,G=function(){J.postMessage(null)}}else G=function(){E(te,0)};function W(F,Z){D=E(function(){F(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(F){switch(y){case 1:case 2:case 3:var Z=3;break;default:Z=y}var oe=y;y=Z;try{return F()}finally{y=oe}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(F,Z){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var oe=y;y=F;try{return Z()}finally{y=oe}},e.unstable_scheduleCallback=function(F,Z,oe){var le=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?le+oe:le):oe=le,F){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=oe+R,F={id:p++,callback:Z,priorityLevel:F,startTime:oe,expirationTime:R,sortIndex:-1},oe>le?(F.sortIndex=oe,t(f,F),r(m)===null&&F===r(f)&&(N?(C(D),D=-1):N=!0,W(j,oe-le))):(F.sortIndex=R,t(m,F),S||v||(S=!0,q||(q=!0,G()))),F},e.unstable_shouldYield=ie,e.unstable_wrapCallback=function(F){var Z=y;return function(){var oe=y;y=Z;try{return F.apply(this,arguments)}finally{y=oe}}}}(em)),em}var ov;function wE(){return ov||(ov=1,Jh.exports=bE()),Jh.exports}var tm={exports:{}},mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv;function SE(){if(lv)return mn;lv=1;var e=_f();function t(m){var f="https://react.dev/errors/"+m;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+m+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(m,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:g==null?null:""+g,children:m,containerInfo:f,implementation:p}}var u=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,f){if(m==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,mn.createPortal=function(m,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(m,f,null,p)},mn.flushSync=function(m){var f=u.T,p=n.p;try{if(u.T=null,n.p=2,m)return m()}finally{u.T=f,n.p=p,n.d.f()}},mn.preconnect=function(m,f){typeof m=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(m,f))},mn.prefetchDNS=function(m){typeof m=="string"&&n.d.D(m)},mn.preinit=function(m,f){if(typeof m=="string"&&f&&typeof f.as=="string"){var p=f.as,g=h(p,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?n.d.S(m,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:y,fetchPriority:v}):p==="script"&&n.d.X(m,{crossOrigin:g,integrity:y,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},mn.preinitModule=function(m,f){if(typeof m=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=h(f.as,f.crossOrigin);n.d.M(m,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(m)},mn.preload=function(m,f){if(typeof m=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=h(p,f.crossOrigin);n.d.L(m,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},mn.preloadModule=function(m,f){if(typeof m=="string")if(f){var p=h(f.as,f.crossOrigin);n.d.m(m,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(m)},mn.requestFormReset=function(m){n.d.r(m)},mn.unstable_batchedUpdates=function(m,f){return m(f)},mn.useFormState=function(m,f,p){return u.H.useFormState(m,f,p)},mn.useFormStatus=function(){return u.H.useHostTransitionStatus()},mn.version="19.1.0",mn}var cv;function NE(){if(cv)return tm.exports;cv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),tm.exports=SE(),tm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uv;function TE(){if(uv)return cc;uv=1;var e=wE(),t=_f(),r=NE();function n(a){var i="https://react.dev/errors/"+a;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var i=a,c=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,(i.flags&4098)!==0&&(c=i.return),a=i.return;while(a)}return i.tag===3?c:null}function u(a){if(a.tag===13){var i=a.memoizedState;if(i===null&&(a=a.alternate,a!==null&&(i=a.memoizedState)),i!==null)return i.dehydrated}return null}function h(a){if(l(a)!==a)throw Error(n(188))}function m(a){var i=a.alternate;if(!i){if(i=l(a),i===null)throw Error(n(188));return i!==a?null:a}for(var c=a,d=i;;){var x=c.return;if(x===null)break;var b=x.alternate;if(b===null){if(d=x.return,d!==null){c=d;continue}break}if(x.child===b.child){for(b=x.child;b;){if(b===c)return h(x),a;if(b===d)return h(x),i;b=b.sibling}throw Error(n(188))}if(c.return!==d.return)c=x,d=b;else{for(var A=!1,B=x.child;B;){if(B===c){A=!0,c=x,d=b;break}if(B===d){A=!0,d=x,c=b;break}B=B.sibling}if(!A){for(B=b.child;B;){if(B===c){A=!0,c=b,d=x;break}if(B===d){A=!0,d=b,c=x;break}B=B.sibling}if(!A)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?a:i}function f(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a;for(a=a.child;a!==null;){if(i=f(a),i!==null)return i;a=a.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),T=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),j=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),K=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function G(a){return a===null||typeof a!="object"?null:(a=te&&a[te]||a["@@iterator"],typeof a=="function"?a:null)}var de=Symbol.for("react.client.reference");function J(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===de?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case w:return"Profiler";case N:return"StrictMode";case j:return"Suspense";case q:return"SuspenseList";case K:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case v:return"Portal";case T:return(a.displayName||"Context")+".Provider";case C:return(a._context.displayName||"Context")+".Consumer";case O:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case D:return i=a.displayName||null,i!==null?i:J(a.type)||"Memo";case U:i=a._payload,a=a._init;try{return J(a(i))}catch{}}return null}var W=Array.isArray,F=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Z=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},le=[],R=-1;function ne(a){return{current:a}}function P(a){0>R||(a.current=le[R],le[R]=null,R--)}function H(a,i){R++,le[R]=a.current,a.current=i}var z=ne(null),_=ne(null),ce=ne(null),re=ne(null);function me(a,i){switch(H(ce,i),H(_,a),H(z,null),i.nodeType){case 9:case 11:a=(a=i.documentElement)&&(a=a.namespaceURI)?Dy(a):0;break;default:if(a=i.tagName,i=i.namespaceURI)i=Dy(i),a=ky(i,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}P(z),H(z,a)}function je(){P(z),P(_),P(ce)}function Re(a){a.memoizedState!==null&&H(re,a);var i=z.current,c=ky(i,a.type);i!==c&&(H(_,a),H(z,c))}function We(a){_.current===a&&(P(z),P(_)),re.current===a&&(P(re),nc._currentValue=oe)}var Ge=Object.prototype.hasOwnProperty,Ve=e.unstable_scheduleCallback,He=e.unstable_cancelCallback,ge=e.unstable_shouldYield,Ce=e.unstable_requestPaint,_e=e.unstable_now,nt=e.unstable_getCurrentPriorityLevel,Ke=e.unstable_ImmediatePriority,rt=e.unstable_UserBlockingPriority,ot=e.unstable_NormalPriority,At=e.unstable_LowPriority,Ze=e.unstable_IdlePriority,et=e.log,xt=e.unstable_setDisableYieldValue,Qe=null,Xe=null;function gt(a){if(typeof et=="function"&&xt(a),Xe&&typeof Xe.setStrictMode=="function")try{Xe.setStrictMode(Qe,a)}catch{}}var Ft=Math.clz32?Math.clz32:Qr,tr=Math.log,Ut=Math.LN2;function Qr(a){return a>>>=0,a===0?32:31-(tr(a)/Ut|0)|0}var Zr=256,It=4194304;function Lr(a){var i=a&42;if(i!==0)return i;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function dn(a,i,c){var d=a.pendingLanes;if(d===0)return 0;var x=0,b=a.suspendedLanes,A=a.pingedLanes;a=a.warmLanes;var B=d&134217727;return B!==0?(d=B&~b,d!==0?x=Lr(d):(A&=B,A!==0?x=Lr(A):c||(c=B&~a,c!==0&&(x=Lr(c))))):(B=d&~b,B!==0?x=Lr(B):A!==0?x=Lr(A):c||(c=d&~a,c!==0&&(x=Lr(c)))),x===0?0:i!==0&&i!==x&&(i&b)===0&&(b=x&-x,c=i&-i,b>=c||b===32&&(c&4194048)!==0)?i:x}function Er(a,i){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&i)===0}function Un(a,i){switch(a){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function I(){var a=Zr;return Zr<<=1,(Zr&4194048)===0&&(Zr=256),a}function Se(){var a=It;return It<<=1,(It&62914560)===0&&(It=4194304),a}function Ue(a){for(var i=[],c=0;31>c;c++)i.push(a);return i}function Ie(a,i){a.pendingLanes|=i,i!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function st(a,i,c,d,x,b){var A=a.pendingLanes;a.pendingLanes=c,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=c,a.entangledLanes&=c,a.errorRecoveryDisabledLanes&=c,a.shellSuspendCounter=0;var B=a.entanglements,ae=a.expirationTimes,be=a.hiddenUpdates;for(c=A&~c;0<c;){var Me=31-Ft(c),Le=1<<Me;B[Me]=0,ae[Me]=-1;var Ne=be[Me];if(Ne!==null)for(be[Me]=null,Me=0;Me<Ne.length;Me++){var Ee=Ne[Me];Ee!==null&&(Ee.lane&=-536870913)}c&=~Le}d!==0&&lt(a,d,0),b!==0&&x===0&&a.tag!==0&&(a.suspendedLanes|=b&~(A&~i))}function lt(a,i,c){a.pendingLanes|=i,a.suspendedLanes&=~i;var d=31-Ft(i);a.entangledLanes|=i,a.entanglements[d]=a.entanglements[d]|1073741824|c&4194090}function yt(a,i){var c=a.entangledLanes|=i;for(a=a.entanglements;c;){var d=31-Ft(c),x=1<<d;x&i|a[d]&i&&(a[d]|=i),c&=~x}}function Ye(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Yr(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Jr(){var a=Z.p;return a!==0?a:(a=window.event,a===void 0?32:Ky(a.type))}function Pr(a,i){var c=Z.p;try{return Z.p=a,i()}finally{Z.p=c}}var fn=Math.random().toString(36).slice(2),ar="__reactFiber$"+fn,Lt="__reactProps$"+fn,Br="__reactContainer$"+fn,Ra="__reactEvents$"+fn,Es="__reactListeners$"+fn,M="__reactHandles$"+fn,X="__reactResources$"+fn,V="__reactMarker$"+fn;function Y(a){delete a[ar],delete a[Lt],delete a[Ra],delete a[Es],delete a[M]}function Q(a){var i=a[ar];if(i)return i;for(var c=a.parentNode;c;){if(i=c[Br]||c[ar]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(a=Fy(a);a!==null;){if(c=a[ar])return c;a=Fy(a)}return i}a=c,c=a.parentNode}return null}function ee(a){if(a=a[ar]||a[Br]){var i=a.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return a}return null}function ve(a){var i=a.tag;if(i===5||i===26||i===27||i===6)return a.stateNode;throw Error(n(33))}function De(a){var i=a[X];return i||(i=a[X]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function pe(a){a[V]=!0}var we=new Set,Te={};function L(a,i){se(a,i),se(a+"Capture",i)}function se(a,i){for(Te[a]=i,a=0;a<i.length;a++)we.add(i[a])}var xe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),fe={},ke={};function Be(a){return Ge.call(ke,a)?!0:Ge.call(fe,a)?!1:xe.test(a)?ke[a]=!0:(fe[a]=!0,!1)}function Je(a,i,c){if(Be(i))if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":a.removeAttribute(i);return;case"boolean":var d=i.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){a.removeAttribute(i);return}}a.setAttribute(i,""+c)}}function ct(a,i,c){if(c===null)a.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(i);return}a.setAttribute(i,""+c)}}function ut(a,i,c,d){if(d===null)a.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(c);return}a.setAttributeNS(i,c,""+d)}}var _t,wt;function ir(a){if(_t===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);_t=i&&i[1]||"",wt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+_t+a+wt}var Vt=!1;function rr(a,i){if(!a||Vt)return"";Vt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(i){var Le=function(){throw Error()};if(Object.defineProperty(Le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Le,[])}catch(Ee){var Ne=Ee}Reflect.construct(a,[],Le)}else{try{Le.call()}catch(Ee){Ne=Ee}a.call(Le.prototype)}}else{try{throw Error()}catch(Ee){Ne=Ee}(Le=a())&&typeof Le.catch=="function"&&Le.catch(function(){})}}catch(Ee){if(Ee&&Ne&&typeof Ee.stack=="string")return[Ee.stack,Ne.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=d.DetermineComponentFrameRoot(),A=b[0],B=b[1];if(A&&B){var ae=A.split(`
`),be=B.split(`
`);for(x=d=0;d<ae.length&&!ae[d].includes("DetermineComponentFrameRoot");)d++;for(;x<be.length&&!be[x].includes("DetermineComponentFrameRoot");)x++;if(d===ae.length||x===be.length)for(d=ae.length-1,x=be.length-1;1<=d&&0<=x&&ae[d]!==be[x];)x--;for(;1<=d&&0<=x;d--,x--)if(ae[d]!==be[x]){if(d!==1||x!==1)do if(d--,x--,0>x||ae[d]!==be[x]){var Me=`
`+ae[d].replace(" at new "," at ");return a.displayName&&Me.includes("<anonymous>")&&(Me=Me.replace("<anonymous>",a.displayName)),Me}while(1<=d&&0<=x);break}}}finally{Vt=!1,Error.prepareStackTrace=c}return(c=a?a.displayName||a.name:"")?ir(c):""}function zt(a){switch(a.tag){case 26:case 27:case 5:return ir(a.type);case 16:return ir("Lazy");case 13:return ir("Suspense");case 19:return ir("SuspenseList");case 0:case 15:return rr(a.type,!1);case 11:return rr(a.type.render,!1);case 1:return rr(a.type,!0);case 31:return ir("Activity");default:return""}}function _n(a){try{var i="";do i+=zt(a),a=a.return;while(a);return i}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Ur(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function pa(a){var i=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function gu(a){var i=pa(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,i),d=""+a[i];if(!a.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var x=c.get,b=c.set;return Object.defineProperty(a,i,{configurable:!0,get:function(){return x.call(this)},set:function(A){d=""+A,b.call(this,A)}}),Object.defineProperty(a,i,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(A){d=""+A},stopTracking:function(){a._valueTracker=null,delete a[i]}}}}function mi(a){a._valueTracker||(a._valueTracker=gu(a))}function yu(a){if(!a)return!1;var i=a._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return a&&(d=pa(a)?a.checked?"true":"false":a.value),a=d,a!==c?(i.setValue(a),!0):!1}function ro(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Ht=/[\n"\\]/g;function vt(a){return a.replace(Ht,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function pi(a,i,c,d,x,b,A,B){a.name="",A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"?a.type=A:a.removeAttribute("type"),i!=null?A==="number"?(i===0&&a.value===""||a.value!=i)&&(a.value=""+Ur(i)):a.value!==""+Ur(i)&&(a.value=""+Ur(i)):A!=="submit"&&A!=="reset"||a.removeAttribute("value"),i!=null?_s(a,A,Ur(i)):c!=null?_s(a,A,Ur(c)):d!=null&&a.removeAttribute("value"),x==null&&b!=null&&(a.defaultChecked=!!b),x!=null&&(a.checked=x&&typeof x!="function"&&typeof x!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?a.name=""+Ur(B):a.removeAttribute("name")}function Ma(a,i,c,d,x,b,A,B){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.type=b),i!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||i!=null))return;c=c!=null?""+Ur(c):"",i=i!=null?""+Ur(i):c,B||i===a.value||(a.value=i),a.defaultValue=i}d=d??x,d=typeof d!="function"&&typeof d!="symbol"&&!!d,a.checked=B?a.checked:!!d,a.defaultChecked=!!d,A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(a.name=A)}function _s(a,i,c){i==="number"&&ro(a.ownerDocument)===a||a.defaultValue===""+c||(a.defaultValue=""+c)}function Dr(a,i,c,d){if(a=a.options,i){i={};for(var x=0;x<c.length;x++)i["$"+c[x]]=!0;for(c=0;c<a.length;c++)x=i.hasOwnProperty("$"+a[c].value),a[c].selected!==x&&(a[c].selected=x),x&&d&&(a[c].defaultSelected=!0)}else{for(c=""+Ur(c),i=null,x=0;x<a.length;x++){if(a[x].value===c){a[x].selected=!0,d&&(a[x].defaultSelected=!0);return}i!==null||a[x].disabled||(i=a[x])}i!==null&&(i.selected=!0)}}function Jn(a,i,c){if(i!=null&&(i=""+Ur(i),i!==a.value&&(a.value=i),c==null)){a.defaultValue!==i&&(a.defaultValue=i);return}a.defaultValue=c!=null?""+Ur(c):""}function xa(a,i,c,d){if(i==null){if(d!=null){if(c!=null)throw Error(n(92));if(W(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),i=c}c=Ur(i),a.defaultValue=c,d=a.textContent,d===c&&d!==""&&d!==null&&(a.value=d)}function ea(a,i){if(i){var c=a.firstChild;if(c&&c===a.lastChild&&c.nodeType===3){c.nodeValue=i;return}}a.textContent=i}var no=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Xa(a,i,c){var d=i.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?a.setProperty(i,""):i==="float"?a.cssFloat="":a[i]="":d?a.setProperty(i,c):typeof c!="number"||c===0||no.has(i)?i==="float"?a.cssFloat=c:a[i]=(""+c).trim():a[i]=c+"px"}function ga(a,i,c){if(i!=null&&typeof i!="object")throw Error(n(62));if(a=a.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||i!=null&&i.hasOwnProperty(d)||(d.indexOf("--")===0?a.setProperty(d,""):d==="float"?a.cssFloat="":a[d]="");for(var x in i)d=i[x],i.hasOwnProperty(x)&&c[x]!==d&&Xa(a,x,d)}else for(var b in i)i.hasOwnProperty(b)&&Xa(a,b,i[b])}function ao(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var so=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),pl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ka(a){return pl.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Cs=null;function io(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var ya=null,va=null;function Ox(a){var i=ee(a);if(i&&(a=i.stateNode)){var c=a[Lt]||null;e:switch(a=i.stateNode,i.type){case"input":if(pi(a,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),i=c.name,c.type==="radio"&&i!=null){for(c=a;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+vt(""+i)+'"][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==a&&d.form===a.form){var x=d[Lt]||null;if(!x)throw Error(n(90));pi(d,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<c.length;i++)d=c[i],d.form===a.form&&yu(d)}break e;case"textarea":Jn(a,c.value,c.defaultValue);break e;case"select":i=c.value,i!=null&&Dr(a,!!c.multiple,i,!1)}}}var Zf=!1;function Rx(a,i,c){if(Zf)return a(i,c);Zf=!0;try{var d=a(i);return d}finally{if(Zf=!1,(ya!==null||va!==null)&&(nd(),ya&&(i=ya,a=va,va=ya=null,Ox(i),a)))for(i=0;i<a.length;i++)Ox(a[i])}}function xl(a,i){var c=a.stateNode;if(c===null)return null;var d=c[Lt]||null;if(d===null)return null;c=d[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(a=a.type,d=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!d;break e;default:a=!1}if(a)return null;if(c&&typeof c!="function")throw Error(n(231,i,typeof c));return c}var Qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jf=!1;if(Qa)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){Jf=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{Jf=!1}var As=null,e0=null,vu=null;function Mx(){if(vu)return vu;var a,i=e0,c=i.length,d,x="value"in As?As.value:As.textContent,b=x.length;for(a=0;a<c&&i[a]===x[a];a++);var A=c-a;for(d=1;d<=A&&i[c-d]===x[b-d];d++);return vu=x.slice(a,1<d?1-d:void 0)}function bu(a){var i=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&i===13&&(a=13)):a=i,a===10&&(a=13),32<=a||a===13?a:0}function wu(){return!0}function Fx(){return!1}function Cn(a){function i(c,d,x,b,A){this._reactName=c,this._targetInst=x,this.type=d,this.nativeEvent=b,this.target=A,this.currentTarget=null;for(var B in a)a.hasOwnProperty(B)&&(c=a[B],this[B]=c?c(b):b[B]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?wu:Fx,this.isPropagationStopped=Fx,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=wu)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=wu)},persist:function(){},isPersistent:wu}),i}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Su=Cn(xi),yl=p({},xi,{view:0,detail:0}),gN=Cn(yl),t0,r0,vl,Nu=p({},yl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a0,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==vl&&(vl&&a.type==="mousemove"?(t0=a.screenX-vl.screenX,r0=a.screenY-vl.screenY):r0=t0=0,vl=a),t0)},movementY:function(a){return"movementY"in a?a.movementY:r0}}),Lx=Cn(Nu),yN=p({},Nu,{dataTransfer:0}),vN=Cn(yN),bN=p({},yl,{relatedTarget:0}),n0=Cn(bN),wN=p({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),SN=Cn(wN),NN=p({},xi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),TN=Cn(NN),EN=p({},xi,{data:0}),Px=Cn(EN),_N={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},AN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jN(a){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(a):(a=AN[a])?!!i[a]:!1}function a0(){return jN}var DN=p({},yl,{key:function(a){if(a.key){var i=_N[a.key]||a.key;if(i!=="Unidentified")return i}return a.type==="keypress"?(a=bu(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?CN[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a0,charCode:function(a){return a.type==="keypress"?bu(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?bu(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),kN=Cn(DN),ON=p({},Nu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bx=Cn(ON),RN=p({},yl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a0}),MN=Cn(RN),FN=p({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),LN=Cn(FN),PN=p({},Nu,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),BN=Cn(PN),UN=p({},xi,{newState:0,oldState:0}),IN=Cn(UN),zN=[9,13,27,32],s0=Qa&&"CompositionEvent"in window,bl=null;Qa&&"documentMode"in document&&(bl=document.documentMode);var VN=Qa&&"TextEvent"in window&&!bl,Ux=Qa&&(!s0||bl&&8<bl&&11>=bl),Ix=" ",zx=!1;function Vx(a,i){switch(a){case"keyup":return zN.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hx(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var oo=!1;function HN(a,i){switch(a){case"compositionend":return Hx(i);case"keypress":return i.which!==32?null:(zx=!0,Ix);case"textInput":return a=i.data,a===Ix&&zx?null:a;default:return null}}function YN(a,i){if(oo)return a==="compositionend"||!s0&&Vx(a,i)?(a=Mx(),vu=e0=As=null,oo=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ux&&i.locale!=="ko"?null:i.data;default:return null}}var GN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yx(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i==="input"?!!GN[a.type]:i==="textarea"}function Gx(a,i,c,d){ya?va?va.push(d):va=[d]:ya=d,i=cd(i,"onChange"),0<i.length&&(c=new Su("onChange","change",null,c,d),a.push({event:c,listeners:i}))}var wl=null,Sl=null;function qN(a){Ey(a,0)}function Tu(a){var i=ve(a);if(yu(i))return a}function qx(a,i){if(a==="change")return i}var $x=!1;if(Qa){var i0;if(Qa){var o0="oninput"in document;if(!o0){var Wx=document.createElement("div");Wx.setAttribute("oninput","return;"),o0=typeof Wx.oninput=="function"}i0=o0}else i0=!1;$x=i0&&(!document.documentMode||9<document.documentMode)}function Xx(){wl&&(wl.detachEvent("onpropertychange",Kx),Sl=wl=null)}function Kx(a){if(a.propertyName==="value"&&Tu(Sl)){var i=[];Gx(i,Sl,a,io(a)),Rx(qN,i)}}function $N(a,i,c){a==="focusin"?(Xx(),wl=i,Sl=c,wl.attachEvent("onpropertychange",Kx)):a==="focusout"&&Xx()}function WN(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Tu(Sl)}function XN(a,i){if(a==="click")return Tu(i)}function KN(a,i){if(a==="input"||a==="change")return Tu(i)}function QN(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var In=typeof Object.is=="function"?Object.is:QN;function Nl(a,i){if(In(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var c=Object.keys(a),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var x=c[d];if(!Ge.call(i,x)||!In(a[x],i[x]))return!1}return!0}function Qx(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Zx(a,i){var c=Qx(a);a=0;for(var d;c;){if(c.nodeType===3){if(d=a+c.textContent.length,a<=i&&d>=i)return{node:c,offset:i-a};a=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Qx(c)}}function Jx(a,i){return a&&i?a===i?!0:a&&a.nodeType===3?!1:i&&i.nodeType===3?Jx(a,i.parentNode):"contains"in a?a.contains(i):a.compareDocumentPosition?!!(a.compareDocumentPosition(i)&16):!1:!1}function eg(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var i=ro(a.document);i instanceof a.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)a=i.contentWindow;else break;i=ro(a.document)}return i}function l0(a){var i=a&&a.nodeName&&a.nodeName.toLowerCase();return i&&(i==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||i==="textarea"||a.contentEditable==="true")}var ZN=Qa&&"documentMode"in document&&11>=document.documentMode,lo=null,c0=null,Tl=null,u0=!1;function tg(a,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;u0||lo==null||lo!==ro(d)||(d=lo,"selectionStart"in d&&l0(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Tl&&Nl(Tl,d)||(Tl=d,d=cd(c0,"onSelect"),0<d.length&&(i=new Su("onSelect","select",null,i,c),a.push({event:i,listeners:d}),i.target=lo)))}function gi(a,i){var c={};return c[a.toLowerCase()]=i.toLowerCase(),c["Webkit"+a]="webkit"+i,c["Moz"+a]="moz"+i,c}var co={animationend:gi("Animation","AnimationEnd"),animationiteration:gi("Animation","AnimationIteration"),animationstart:gi("Animation","AnimationStart"),transitionrun:gi("Transition","TransitionRun"),transitionstart:gi("Transition","TransitionStart"),transitioncancel:gi("Transition","TransitionCancel"),transitionend:gi("Transition","TransitionEnd")},d0={},rg={};Qa&&(rg=document.createElement("div").style,"AnimationEvent"in window||(delete co.animationend.animation,delete co.animationiteration.animation,delete co.animationstart.animation),"TransitionEvent"in window||delete co.transitionend.transition);function yi(a){if(d0[a])return d0[a];if(!co[a])return a;var i=co[a],c;for(c in i)if(i.hasOwnProperty(c)&&c in rg)return d0[a]=i[c];return a}var ng=yi("animationend"),ag=yi("animationiteration"),sg=yi("animationstart"),JN=yi("transitionrun"),eT=yi("transitionstart"),tT=yi("transitioncancel"),ig=yi("transitionend"),og=new Map,f0="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");f0.push("scrollEnd");function ba(a,i){og.set(a,i),L(i,[a])}var lg=new WeakMap;function ta(a,i){if(typeof a=="object"&&a!==null){var c=lg.get(a);return c!==void 0?c:(i={value:a,source:i,stack:_n(i)},lg.set(a,i),i)}return{value:a,source:i,stack:_n(i)}}var ra=[],uo=0,h0=0;function Eu(){for(var a=uo,i=h0=uo=0;i<a;){var c=ra[i];ra[i++]=null;var d=ra[i];ra[i++]=null;var x=ra[i];ra[i++]=null;var b=ra[i];if(ra[i++]=null,d!==null&&x!==null){var A=d.pending;A===null?x.next=x:(x.next=A.next,A.next=x),d.pending=x}b!==0&&cg(c,x,b)}}function _u(a,i,c,d){ra[uo++]=a,ra[uo++]=i,ra[uo++]=c,ra[uo++]=d,h0|=d,a.lanes|=d,a=a.alternate,a!==null&&(a.lanes|=d)}function m0(a,i,c,d){return _u(a,i,c,d),Cu(a)}function fo(a,i){return _u(a,null,null,i),Cu(a)}function cg(a,i,c){a.lanes|=c;var d=a.alternate;d!==null&&(d.lanes|=c);for(var x=!1,b=a.return;b!==null;)b.childLanes|=c,d=b.alternate,d!==null&&(d.childLanes|=c),b.tag===22&&(a=b.stateNode,a===null||a._visibility&1||(x=!0)),a=b,b=b.return;return a.tag===3?(b=a.stateNode,x&&i!==null&&(x=31-Ft(c),a=b.hiddenUpdates,d=a[x],d===null?a[x]=[i]:d.push(i),i.lane=c|536870912),b):null}function Cu(a){if(50<Xl)throw Xl=0,bh=null,Error(n(185));for(var i=a.return;i!==null;)a=i,i=a.return;return a.tag===3?a.stateNode:null}var ho={};function rT(a,i,c,d){this.tag=a,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(a,i,c,d){return new rT(a,i,c,d)}function p0(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Za(a,i){var c=a.alternate;return c===null?(c=zn(a.tag,i,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=i,c.type=a.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=a.flags&65011712,c.childLanes=a.childLanes,c.lanes=a.lanes,c.child=a.child,c.memoizedProps=a.memoizedProps,c.memoizedState=a.memoizedState,c.updateQueue=a.updateQueue,i=a.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=a.sibling,c.index=a.index,c.ref=a.ref,c.refCleanup=a.refCleanup,c}function ug(a,i){a.flags&=65011714;var c=a.alternate;return c===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=c.childLanes,a.lanes=c.lanes,a.child=c.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=c.memoizedProps,a.memoizedState=c.memoizedState,a.updateQueue=c.updateQueue,a.type=c.type,i=c.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),a}function Au(a,i,c,d,x,b){var A=0;if(d=a,typeof a=="function")p0(a)&&(A=1);else if(typeof a=="string")A=aE(a,c,z.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case K:return a=zn(31,c,i,x),a.elementType=K,a.lanes=b,a;case S:return vi(c.children,x,b,i);case N:A=8,x|=24;break;case w:return a=zn(12,c,i,x|2),a.elementType=w,a.lanes=b,a;case j:return a=zn(13,c,i,x),a.elementType=j,a.lanes=b,a;case q:return a=zn(19,c,i,x),a.elementType=q,a.lanes=b,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:case T:A=10;break e;case C:A=9;break e;case O:A=11;break e;case D:A=14;break e;case U:A=16,d=null;break e}A=29,c=Error(n(130,a===null?"null":typeof a,"")),d=null}return i=zn(A,c,i,x),i.elementType=a,i.type=d,i.lanes=b,i}function vi(a,i,c,d){return a=zn(7,a,d,i),a.lanes=c,a}function x0(a,i,c){return a=zn(6,a,null,i),a.lanes=c,a}function g0(a,i,c){return i=zn(4,a.children!==null?a.children:[],a.key,i),i.lanes=c,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}var mo=[],po=0,ju=null,Du=0,na=[],aa=0,bi=null,Ja=1,es="";function wi(a,i){mo[po++]=Du,mo[po++]=ju,ju=a,Du=i}function dg(a,i,c){na[aa++]=Ja,na[aa++]=es,na[aa++]=bi,bi=a;var d=Ja;a=es;var x=32-Ft(d)-1;d&=~(1<<x),c+=1;var b=32-Ft(i)+x;if(30<b){var A=x-x%5;b=(d&(1<<A)-1).toString(32),d>>=A,x-=A,Ja=1<<32-Ft(i)+x|c<<x|d,es=b+a}else Ja=1<<b|c<<x|d,es=a}function y0(a){a.return!==null&&(wi(a,1),dg(a,1,0))}function v0(a){for(;a===ju;)ju=mo[--po],mo[po]=null,Du=mo[--po],mo[po]=null;for(;a===bi;)bi=na[--aa],na[aa]=null,es=na[--aa],na[aa]=null,Ja=na[--aa],na[aa]=null}var bn=null,vr=null,Pt=!1,Si=null,Fa=!1,b0=Error(n(519));function Ni(a){var i=Error(n(418,""));throw Cl(ta(i,a)),b0}function fg(a){var i=a.stateNode,c=a.type,d=a.memoizedProps;switch(i[ar]=a,i[Lt]=d,c){case"dialog":Dt("cancel",i),Dt("close",i);break;case"iframe":case"object":case"embed":Dt("load",i);break;case"video":case"audio":for(c=0;c<Ql.length;c++)Dt(Ql[c],i);break;case"source":Dt("error",i);break;case"img":case"image":case"link":Dt("error",i),Dt("load",i);break;case"details":Dt("toggle",i);break;case"input":Dt("invalid",i),Ma(i,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),mi(i);break;case"select":Dt("invalid",i);break;case"textarea":Dt("invalid",i),xa(i,d.value,d.defaultValue,d.children),mi(i)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||i.textContent===""+c||d.suppressHydrationWarning===!0||jy(i.textContent,c)?(d.popover!=null&&(Dt("beforetoggle",i),Dt("toggle",i)),d.onScroll!=null&&Dt("scroll",i),d.onScrollEnd!=null&&Dt("scrollend",i),d.onClick!=null&&(i.onclick=ud),i=!0):i=!1,i||Ni(a)}function hg(a){for(bn=a.return;bn;)switch(bn.tag){case 5:case 13:Fa=!1;return;case 27:case 3:Fa=!0;return;default:bn=bn.return}}function El(a){if(a!==bn)return!1;if(!Pt)return hg(a),Pt=!0,!1;var i=a.tag,c;if((c=i!==3&&i!==27)&&((c=i===5)&&(c=a.type,c=!(c!=="form"&&c!=="button")||Lh(a.type,a.memoizedProps)),c=!c),c&&vr&&Ni(a),hg(a),i===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,i=0;a;){if(a.nodeType===8)if(c=a.data,c==="/$"){if(i===0){vr=Sa(a.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++;a=a.nextSibling}vr=null}}else i===27?(i=vr,Ys(a.type)?(a=Ih,Ih=null,vr=a):vr=i):vr=bn?Sa(a.stateNode.nextSibling):null;return!0}function _l(){vr=bn=null,Pt=!1}function mg(){var a=Si;return a!==null&&(Dn===null?Dn=a:Dn.push.apply(Dn,a),Si=null),a}function Cl(a){Si===null?Si=[a]:Si.push(a)}var w0=ne(null),Ti=null,ts=null;function js(a,i,c){H(w0,i._currentValue),i._currentValue=c}function rs(a){a._currentValue=w0.current,P(w0)}function S0(a,i,c){for(;a!==null;){var d=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),a===c)break;a=a.return}}function N0(a,i,c,d){var x=a.child;for(x!==null&&(x.return=a);x!==null;){var b=x.dependencies;if(b!==null){var A=x.child;b=b.firstContext;e:for(;b!==null;){var B=b;b=x;for(var ae=0;ae<i.length;ae++)if(B.context===i[ae]){b.lanes|=c,B=b.alternate,B!==null&&(B.lanes|=c),S0(b.return,c,a),d||(A=null);break e}b=B.next}}else if(x.tag===18){if(A=x.return,A===null)throw Error(n(341));A.lanes|=c,b=A.alternate,b!==null&&(b.lanes|=c),S0(A,c,a),A=null}else A=x.child;if(A!==null)A.return=x;else for(A=x;A!==null;){if(A===a){A=null;break}if(x=A.sibling,x!==null){x.return=A.return,A=x;break}A=A.return}x=A}}function Al(a,i,c,d){a=null;for(var x=i,b=!1;x!==null;){if(!b){if((x.flags&524288)!==0)b=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var A=x.alternate;if(A===null)throw Error(n(387));if(A=A.memoizedProps,A!==null){var B=x.type;In(x.pendingProps.value,A.value)||(a!==null?a.push(B):a=[B])}}else if(x===re.current){if(A=x.alternate,A===null)throw Error(n(387));A.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(a!==null?a.push(nc):a=[nc])}x=x.return}a!==null&&N0(i,a,c,d),i.flags|=262144}function ku(a){for(a=a.firstContext;a!==null;){if(!In(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Ei(a){Ti=a,ts=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function hn(a){return pg(Ti,a)}function Ou(a,i){return Ti===null&&Ei(a),pg(a,i)}function pg(a,i){var c=i._currentValue;if(i={context:i,memoizedValue:c,next:null},ts===null){if(a===null)throw Error(n(308));ts=i,a.dependencies={lanes:0,firstContext:i},a.flags|=524288}else ts=ts.next=i;return c}var nT=typeof AbortController<"u"?AbortController:function(){var a=[],i=this.signal={aborted:!1,addEventListener:function(c,d){a.push(d)}};this.abort=function(){i.aborted=!0,a.forEach(function(c){return c()})}},aT=e.unstable_scheduleCallback,sT=e.unstable_NormalPriority,Ir={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function T0(){return{controller:new nT,data:new Map,refCount:0}}function jl(a){a.refCount--,a.refCount===0&&aT(sT,function(){a.controller.abort()})}var Dl=null,E0=0,xo=0,go=null;function iT(a,i){if(Dl===null){var c=Dl=[];E0=0,xo=Ch(),go={status:"pending",value:void 0,then:function(d){c.push(d)}}}return E0++,i.then(xg,xg),i}function xg(){if(--E0===0&&Dl!==null){go!==null&&(go.status="fulfilled");var a=Dl;Dl=null,xo=0,go=null;for(var i=0;i<a.length;i++)(0,a[i])()}}function oT(a,i){var c=[],d={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return a.then(function(){d.status="fulfilled",d.value=i;for(var x=0;x<c.length;x++)(0,c[x])(i)},function(x){for(d.status="rejected",d.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),d}var gg=F.S;F.S=function(a,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&iT(a,i),gg!==null&&gg(a,i)};var _i=ne(null);function _0(){var a=_i.current;return a!==null?a:sr.pooledCache}function Ru(a,i){i===null?H(_i,_i.current):H(_i,i.pool)}function yg(){var a=_0();return a===null?null:{parent:Ir._currentValue,pool:a}}var kl=Error(n(460)),vg=Error(n(474)),Mu=Error(n(542)),C0={then:function(){}};function bg(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Fu(){}function wg(a,i,c){switch(c=a[c],c===void 0?a.push(i):c!==i&&(i.then(Fu,Fu),i=c),i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Ng(a),a;default:if(typeof i.status=="string")i.then(Fu,Fu);else{if(a=sr,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=i,a.status="pending",a.then(function(d){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=d}},function(d){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=d}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw a=i.reason,Ng(a),a}throw Ol=i,kl}}var Ol=null;function Sg(){if(Ol===null)throw Error(n(459));var a=Ol;return Ol=null,a}function Ng(a){if(a===kl||a===Mu)throw Error(n(483))}var Ds=!1;function A0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function j0(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ks(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Os(a,i,c){var d=a.updateQueue;if(d===null)return null;if(d=d.shared,(Yt&2)!==0){var x=d.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),d.pending=i,i=Cu(a),cg(a,null,c),i}return _u(a,d,i,c),Cu(a)}function Rl(a,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194048)!==0)){var d=i.lanes;d&=a.pendingLanes,c|=d,i.lanes=c,yt(a,c)}}function D0(a,i){var c=a.updateQueue,d=a.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var x=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var A={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?x=b=A:b=b.next=A,c=c.next}while(c!==null);b===null?x=b=i:b=b.next=i}else x=b=i;c={baseState:d.baseState,firstBaseUpdate:x,lastBaseUpdate:b,shared:d.shared,callbacks:d.callbacks},a.updateQueue=c;return}a=c.lastBaseUpdate,a===null?c.firstBaseUpdate=i:a.next=i,c.lastBaseUpdate=i}var k0=!1;function Ml(){if(k0){var a=go;if(a!==null)throw a}}function Fl(a,i,c,d){k0=!1;var x=a.updateQueue;Ds=!1;var b=x.firstBaseUpdate,A=x.lastBaseUpdate,B=x.shared.pending;if(B!==null){x.shared.pending=null;var ae=B,be=ae.next;ae.next=null,A===null?b=be:A.next=be,A=ae;var Me=a.alternate;Me!==null&&(Me=Me.updateQueue,B=Me.lastBaseUpdate,B!==A&&(B===null?Me.firstBaseUpdate=be:B.next=be,Me.lastBaseUpdate=ae))}if(b!==null){var Le=x.baseState;A=0,Me=be=ae=null,B=b;do{var Ne=B.lane&-536870913,Ee=Ne!==B.lane;if(Ee?(kt&Ne)===Ne:(d&Ne)===Ne){Ne!==0&&Ne===xo&&(k0=!0),Me!==null&&(Me=Me.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var mt=a,dt=B;Ne=i;var Jt=c;switch(dt.tag){case 1:if(mt=dt.payload,typeof mt=="function"){Le=mt.call(Jt,Le,Ne);break e}Le=mt;break e;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=dt.payload,Ne=typeof mt=="function"?mt.call(Jt,Le,Ne):mt,Ne==null)break e;Le=p({},Le,Ne);break e;case 2:Ds=!0}}Ne=B.callback,Ne!==null&&(a.flags|=64,Ee&&(a.flags|=8192),Ee=x.callbacks,Ee===null?x.callbacks=[Ne]:Ee.push(Ne))}else Ee={lane:Ne,tag:B.tag,payload:B.payload,callback:B.callback,next:null},Me===null?(be=Me=Ee,ae=Le):Me=Me.next=Ee,A|=Ne;if(B=B.next,B===null){if(B=x.shared.pending,B===null)break;Ee=B,B=Ee.next,Ee.next=null,x.lastBaseUpdate=Ee,x.shared.pending=null}}while(!0);Me===null&&(ae=Le),x.baseState=ae,x.firstBaseUpdate=be,x.lastBaseUpdate=Me,b===null&&(x.shared.lanes=0),Is|=A,a.lanes=A,a.memoizedState=Le}}function Tg(a,i){if(typeof a!="function")throw Error(n(191,a));a.call(i)}function Eg(a,i){var c=a.callbacks;if(c!==null)for(a.callbacks=null,a=0;a<c.length;a++)Tg(c[a],i)}var yo=ne(null),Lu=ne(0);function _g(a,i){a=cs,H(Lu,a),H(yo,i),cs=a|i.baseLanes}function O0(){H(Lu,cs),H(yo,yo.current)}function R0(){cs=Lu.current,P(yo),P(Lu)}var Rs=0,Et=null,Qt=null,kr=null,Pu=!1,vo=!1,Ci=!1,Bu=0,Ll=0,bo=null,lT=0;function _r(){throw Error(n(321))}function M0(a,i){if(i===null)return!1;for(var c=0;c<i.length&&c<a.length;c++)if(!In(a[c],i[c]))return!1;return!0}function F0(a,i,c,d,x,b){return Rs=b,Et=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,F.H=a===null||a.memoizedState===null?c1:u1,Ci=!1,b=c(d,x),Ci=!1,vo&&(b=Ag(i,c,d,x)),Cg(a),b}function Cg(a){F.H=Yu;var i=Qt!==null&&Qt.next!==null;if(Rs=0,kr=Qt=Et=null,Pu=!1,Ll=0,bo=null,i)throw Error(n(300));a===null||Gr||(a=a.dependencies,a!==null&&ku(a)&&(Gr=!0))}function Ag(a,i,c,d){Et=a;var x=0;do{if(vo&&(bo=null),Ll=0,vo=!1,25<=x)throw Error(n(301));if(x+=1,kr=Qt=null,a.updateQueue!=null){var b=a.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}F.H=pT,b=i(c,d)}while(vo);return b}function cT(){var a=F.H,i=a.useState()[0];return i=typeof i.then=="function"?Pl(i):i,a=a.useState()[0],(Qt!==null?Qt.memoizedState:null)!==a&&(Et.flags|=1024),i}function L0(){var a=Bu!==0;return Bu=0,a}function P0(a,i,c){i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~c}function B0(a){if(Pu){for(a=a.memoizedState;a!==null;){var i=a.queue;i!==null&&(i.pending=null),a=a.next}Pu=!1}Rs=0,kr=Qt=Et=null,vo=!1,Ll=Bu=0,bo=null}function An(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?Et.memoizedState=kr=a:kr=kr.next=a,kr}function Or(){if(Qt===null){var a=Et.alternate;a=a!==null?a.memoizedState:null}else a=Qt.next;var i=kr===null?Et.memoizedState:kr.next;if(i!==null)kr=i,Qt=a;else{if(a===null)throw Et.alternate===null?Error(n(467)):Error(n(310));Qt=a,a={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},kr===null?Et.memoizedState=kr=a:kr=kr.next=a}return kr}function U0(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Pl(a){var i=Ll;return Ll+=1,bo===null&&(bo=[]),a=wg(bo,a,i),i=Et,(kr===null?i.memoizedState:kr.next)===null&&(i=i.alternate,F.H=i===null||i.memoizedState===null?c1:u1),a}function Uu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Pl(a);if(a.$$typeof===T)return hn(a)}throw Error(n(438,String(a)))}function I0(a){var i=null,c=Et.updateQueue;if(c!==null&&(i=c.memoCache),i==null){var d=Et.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(i={data:d.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),c===null&&(c=U0(),Et.updateQueue=c),c.memoCache=i,c=i.data[i.index],c===void 0)for(c=i.data[i.index]=Array(a),d=0;d<a;d++)c[d]=ie;return i.index++,c}function ns(a,i){return typeof i=="function"?i(a):i}function Iu(a){var i=Or();return z0(i,Qt,a)}function z0(a,i,c){var d=a.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var x=a.baseQueue,b=d.pending;if(b!==null){if(x!==null){var A=x.next;x.next=b.next,b.next=A}i.baseQueue=x=b,d.pending=null}if(b=a.baseState,x===null)a.memoizedState=b;else{i=x.next;var B=A=null,ae=null,be=i,Me=!1;do{var Le=be.lane&-536870913;if(Le!==be.lane?(kt&Le)===Le:(Rs&Le)===Le){var Ne=be.revertLane;if(Ne===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null}),Le===xo&&(Me=!0);else if((Rs&Ne)===Ne){be=be.next,Ne===xo&&(Me=!0);continue}else Le={lane:0,revertLane:be.revertLane,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},ae===null?(B=ae=Le,A=b):ae=ae.next=Le,Et.lanes|=Ne,Is|=Ne;Le=be.action,Ci&&c(b,Le),b=be.hasEagerState?be.eagerState:c(b,Le)}else Ne={lane:Le,revertLane:be.revertLane,action:be.action,hasEagerState:be.hasEagerState,eagerState:be.eagerState,next:null},ae===null?(B=ae=Ne,A=b):ae=ae.next=Ne,Et.lanes|=Le,Is|=Le;be=be.next}while(be!==null&&be!==i);if(ae===null?A=b:ae.next=B,!In(b,a.memoizedState)&&(Gr=!0,Me&&(c=go,c!==null)))throw c;a.memoizedState=b,a.baseState=A,a.baseQueue=ae,d.lastRenderedState=b}return x===null&&(d.lanes=0),[a.memoizedState,d.dispatch]}function V0(a){var i=Or(),c=i.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=a;var d=c.dispatch,x=c.pending,b=i.memoizedState;if(x!==null){c.pending=null;var A=x=x.next;do b=a(b,A.action),A=A.next;while(A!==x);In(b,i.memoizedState)||(Gr=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),c.lastRenderedState=b}return[b,d]}function jg(a,i,c){var d=Et,x=Or(),b=Pt;if(b){if(c===void 0)throw Error(n(407));c=c()}else c=i();var A=!In((Qt||x).memoizedState,c);A&&(x.memoizedState=c,Gr=!0),x=x.queue;var B=Og.bind(null,d,x,a);if(Bl(2048,8,B,[a]),x.getSnapshot!==i||A||kr!==null&&kr.memoizedState.tag&1){if(d.flags|=2048,wo(9,zu(),kg.bind(null,d,x,c,i),null),sr===null)throw Error(n(349));b||(Rs&124)!==0||Dg(d,i,c)}return c}function Dg(a,i,c){a.flags|=16384,a={getSnapshot:i,value:c},i=Et.updateQueue,i===null?(i=U0(),Et.updateQueue=i,i.stores=[a]):(c=i.stores,c===null?i.stores=[a]:c.push(a))}function kg(a,i,c,d){i.value=c,i.getSnapshot=d,Rg(i)&&Mg(a)}function Og(a,i,c){return c(function(){Rg(i)&&Mg(a)})}function Rg(a){var i=a.getSnapshot;a=a.value;try{var c=i();return!In(a,c)}catch{return!0}}function Mg(a){var i=fo(a,2);i!==null&&qn(i,a,2)}function H0(a){var i=An();if(typeof a=="function"){var c=a;if(a=c(),Ci){gt(!0);try{c()}finally{gt(!1)}}}return i.memoizedState=i.baseState=a,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:a},i}function Fg(a,i,c,d){return a.baseState=c,z0(a,Qt,typeof d=="function"?d:ns)}function uT(a,i,c,d,x){if(Hu(a))throw Error(n(485));if(a=i.action,a!==null){var b={payload:x,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(A){b.listeners.push(A)}};F.T!==null?c(!0):b.isTransition=!1,d(b),c=i.pending,c===null?(b.next=i.pending=b,Lg(i,b)):(b.next=c.next,i.pending=c.next=b)}}function Lg(a,i){var c=i.action,d=i.payload,x=a.state;if(i.isTransition){var b=F.T,A={};F.T=A;try{var B=c(x,d),ae=F.S;ae!==null&&ae(A,B),Pg(a,i,B)}catch(be){Y0(a,i,be)}finally{F.T=b}}else try{b=c(x,d),Pg(a,i,b)}catch(be){Y0(a,i,be)}}function Pg(a,i,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){Bg(a,i,d)},function(d){return Y0(a,i,d)}):Bg(a,i,c)}function Bg(a,i,c){i.status="fulfilled",i.value=c,Ug(i),a.state=c,i=a.pending,i!==null&&(c=i.next,c===i?a.pending=null:(c=c.next,i.next=c,Lg(a,c)))}function Y0(a,i,c){var d=a.pending;if(a.pending=null,d!==null){d=d.next;do i.status="rejected",i.reason=c,Ug(i),i=i.next;while(i!==d)}a.action=null}function Ug(a){a=a.listeners;for(var i=0;i<a.length;i++)(0,a[i])()}function Ig(a,i){return i}function zg(a,i){if(Pt){var c=sr.formState;if(c!==null){e:{var d=Et;if(Pt){if(vr){t:{for(var x=vr,b=Fa;x.nodeType!==8;){if(!b){x=null;break t}if(x=Sa(x.nextSibling),x===null){x=null;break t}}b=x.data,x=b==="F!"||b==="F"?x:null}if(x){vr=Sa(x.nextSibling),d=x.data==="F!";break e}}Ni(d)}d=!1}d&&(i=c[0])}}return c=An(),c.memoizedState=c.baseState=i,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ig,lastRenderedState:i},c.queue=d,c=i1.bind(null,Et,d),d.dispatch=c,d=H0(!1),b=X0.bind(null,Et,!1,d.queue),d=An(),x={state:i,dispatch:null,action:a,pending:null},d.queue=x,c=uT.bind(null,Et,x,b,c),x.dispatch=c,d.memoizedState=a,[i,c,!1]}function Vg(a){var i=Or();return Hg(i,Qt,a)}function Hg(a,i,c){if(i=z0(a,i,Ig)[0],a=Iu(ns)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var d=Pl(i)}catch(A){throw A===kl?Mu:A}else d=i;i=Or();var x=i.queue,b=x.dispatch;return c!==i.memoizedState&&(Et.flags|=2048,wo(9,zu(),dT.bind(null,x,c),null)),[d,b,a]}function dT(a,i){a.action=i}function Yg(a){var i=Or(),c=Qt;if(c!==null)return Hg(i,c,a);Or(),i=i.memoizedState,c=Or();var d=c.queue.dispatch;return c.memoizedState=a,[i,d,!1]}function wo(a,i,c,d){return a={tag:a,create:c,deps:d,inst:i,next:null},i=Et.updateQueue,i===null&&(i=U0(),Et.updateQueue=i),c=i.lastEffect,c===null?i.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,i.lastEffect=a),a}function zu(){return{destroy:void 0,resource:void 0}}function Gg(){return Or().memoizedState}function Vu(a,i,c,d){var x=An();d=d===void 0?null:d,Et.flags|=a,x.memoizedState=wo(1|i,zu(),c,d)}function Bl(a,i,c,d){var x=Or();d=d===void 0?null:d;var b=x.memoizedState.inst;Qt!==null&&d!==null&&M0(d,Qt.memoizedState.deps)?x.memoizedState=wo(i,b,c,d):(Et.flags|=a,x.memoizedState=wo(1|i,b,c,d))}function qg(a,i){Vu(8390656,8,a,i)}function $g(a,i){Bl(2048,8,a,i)}function Wg(a,i){return Bl(4,2,a,i)}function Xg(a,i){return Bl(4,4,a,i)}function Kg(a,i){if(typeof i=="function"){a=a();var c=i(a);return function(){typeof c=="function"?c():i(null)}}if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function Qg(a,i,c){c=c!=null?c.concat([a]):null,Bl(4,4,Kg.bind(null,i,a),c)}function G0(){}function Zg(a,i){var c=Or();i=i===void 0?null:i;var d=c.memoizedState;return i!==null&&M0(i,d[1])?d[0]:(c.memoizedState=[a,i],a)}function Jg(a,i){var c=Or();i=i===void 0?null:i;var d=c.memoizedState;if(i!==null&&M0(i,d[1]))return d[0];if(d=a(),Ci){gt(!0);try{a()}finally{gt(!1)}}return c.memoizedState=[d,i],d}function q0(a,i,c){return c===void 0||(Rs&1073741824)!==0?a.memoizedState=i:(a.memoizedState=c,a=ry(),Et.lanes|=a,Is|=a,c)}function e1(a,i,c,d){return In(c,i)?c:yo.current!==null?(a=q0(a,c,d),In(a,i)||(Gr=!0),a):(Rs&42)===0?(Gr=!0,a.memoizedState=c):(a=ry(),Et.lanes|=a,Is|=a,i)}function t1(a,i,c,d,x){var b=Z.p;Z.p=b!==0&&8>b?b:8;var A=F.T,B={};F.T=B,X0(a,!1,i,c);try{var ae=x(),be=F.S;if(be!==null&&be(B,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Me=oT(ae,d);Ul(a,i,Me,Gn(a))}else Ul(a,i,d,Gn(a))}catch(Le){Ul(a,i,{then:function(){},status:"rejected",reason:Le},Gn())}finally{Z.p=b,F.T=A}}function fT(){}function $0(a,i,c,d){if(a.tag!==5)throw Error(n(476));var x=r1(a).queue;t1(a,x,i,oe,c===null?fT:function(){return n1(a),c(d)})}function r1(a){var i=a.memoizedState;if(i!==null)return i;i={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:oe},next:null};var c={};return i.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:c},next:null},a.memoizedState=i,a=a.alternate,a!==null&&(a.memoizedState=i),i}function n1(a){var i=r1(a).next.queue;Ul(a,i,{},Gn())}function W0(){return hn(nc)}function a1(){return Or().memoizedState}function s1(){return Or().memoizedState}function hT(a){for(var i=a.return;i!==null;){switch(i.tag){case 24:case 3:var c=Gn();a=ks(c);var d=Os(i,a,c);d!==null&&(qn(d,i,c),Rl(d,i,c)),i={cache:T0()},a.payload=i;return}i=i.return}}function mT(a,i,c){var d=Gn();c={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},Hu(a)?o1(i,c):(c=m0(a,i,c,d),c!==null&&(qn(c,a,d),l1(c,i,d)))}function i1(a,i,c){var d=Gn();Ul(a,i,c,d)}function Ul(a,i,c,d){var x={lane:d,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(Hu(a))o1(i,x);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var A=i.lastRenderedState,B=b(A,c);if(x.hasEagerState=!0,x.eagerState=B,In(B,A))return _u(a,i,x,0),sr===null&&Eu(),!1}catch{}finally{}if(c=m0(a,i,x,d),c!==null)return qn(c,a,d),l1(c,i,d),!0}return!1}function X0(a,i,c,d){if(d={lane:2,revertLane:Ch(),action:d,hasEagerState:!1,eagerState:null,next:null},Hu(a)){if(i)throw Error(n(479))}else i=m0(a,c,d,2),i!==null&&qn(i,a,2)}function Hu(a){var i=a.alternate;return a===Et||i!==null&&i===Et}function o1(a,i){vo=Pu=!0;var c=a.pending;c===null?i.next=i:(i.next=c.next,c.next=i),a.pending=i}function l1(a,i,c){if((c&4194048)!==0){var d=i.lanes;d&=a.pendingLanes,c|=d,i.lanes=c,yt(a,c)}}var Yu={readContext:hn,use:Uu,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useLayoutEffect:_r,useInsertionEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useSyncExternalStore:_r,useId:_r,useHostTransitionStatus:_r,useFormState:_r,useActionState:_r,useOptimistic:_r,useMemoCache:_r,useCacheRefresh:_r},c1={readContext:hn,use:Uu,useCallback:function(a,i){return An().memoizedState=[a,i===void 0?null:i],a},useContext:hn,useEffect:qg,useImperativeHandle:function(a,i,c){c=c!=null?c.concat([a]):null,Vu(4194308,4,Kg.bind(null,i,a),c)},useLayoutEffect:function(a,i){return Vu(4194308,4,a,i)},useInsertionEffect:function(a,i){Vu(4,2,a,i)},useMemo:function(a,i){var c=An();i=i===void 0?null:i;var d=a();if(Ci){gt(!0);try{a()}finally{gt(!1)}}return c.memoizedState=[d,i],d},useReducer:function(a,i,c){var d=An();if(c!==void 0){var x=c(i);if(Ci){gt(!0);try{c(i)}finally{gt(!1)}}}else x=i;return d.memoizedState=d.baseState=x,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:x},d.queue=a,a=a.dispatch=mT.bind(null,Et,a),[d.memoizedState,a]},useRef:function(a){var i=An();return a={current:a},i.memoizedState=a},useState:function(a){a=H0(a);var i=a.queue,c=i1.bind(null,Et,i);return i.dispatch=c,[a.memoizedState,c]},useDebugValue:G0,useDeferredValue:function(a,i){var c=An();return q0(c,a,i)},useTransition:function(){var a=H0(!1);return a=t1.bind(null,Et,a.queue,!0,!1),An().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,i,c){var d=Et,x=An();if(Pt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=i(),sr===null)throw Error(n(349));(kt&124)!==0||Dg(d,i,c)}x.memoizedState=c;var b={value:c,getSnapshot:i};return x.queue=b,qg(Og.bind(null,d,b,a),[a]),d.flags|=2048,wo(9,zu(),kg.bind(null,d,b,c,i),null),c},useId:function(){var a=An(),i=sr.identifierPrefix;if(Pt){var c=es,d=Ja;c=(d&~(1<<32-Ft(d)-1)).toString(32)+c,i=""+i+"R"+c,c=Bu++,0<c&&(i+="H"+c.toString(32)),i+=""}else c=lT++,i=""+i+"r"+c.toString(32)+"";return a.memoizedState=i},useHostTransitionStatus:W0,useFormState:zg,useActionState:zg,useOptimistic:function(a){var i=An();i.memoizedState=i.baseState=a;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=c,i=X0.bind(null,Et,!0,c),c.dispatch=i,[a,i]},useMemoCache:I0,useCacheRefresh:function(){return An().memoizedState=hT.bind(null,Et)}},u1={readContext:hn,use:Uu,useCallback:Zg,useContext:hn,useEffect:$g,useImperativeHandle:Qg,useInsertionEffect:Wg,useLayoutEffect:Xg,useMemo:Jg,useReducer:Iu,useRef:Gg,useState:function(){return Iu(ns)},useDebugValue:G0,useDeferredValue:function(a,i){var c=Or();return e1(c,Qt.memoizedState,a,i)},useTransition:function(){var a=Iu(ns)[0],i=Or().memoizedState;return[typeof a=="boolean"?a:Pl(a),i]},useSyncExternalStore:jg,useId:a1,useHostTransitionStatus:W0,useFormState:Vg,useActionState:Vg,useOptimistic:function(a,i){var c=Or();return Fg(c,Qt,a,i)},useMemoCache:I0,useCacheRefresh:s1},pT={readContext:hn,use:Uu,useCallback:Zg,useContext:hn,useEffect:$g,useImperativeHandle:Qg,useInsertionEffect:Wg,useLayoutEffect:Xg,useMemo:Jg,useReducer:V0,useRef:Gg,useState:function(){return V0(ns)},useDebugValue:G0,useDeferredValue:function(a,i){var c=Or();return Qt===null?q0(c,a,i):e1(c,Qt.memoizedState,a,i)},useTransition:function(){var a=V0(ns)[0],i=Or().memoizedState;return[typeof a=="boolean"?a:Pl(a),i]},useSyncExternalStore:jg,useId:a1,useHostTransitionStatus:W0,useFormState:Yg,useActionState:Yg,useOptimistic:function(a,i){var c=Or();return Qt!==null?Fg(c,Qt,a,i):(c.baseState=a,[a,c.queue.dispatch])},useMemoCache:I0,useCacheRefresh:s1},So=null,Il=0;function Gu(a){var i=Il;return Il+=1,So===null&&(So=[]),wg(So,a,i)}function zl(a,i){i=i.props.ref,a.ref=i!==void 0?i:null}function qu(a,i){throw i.$$typeof===g?Error(n(525)):(a=Object.prototype.toString.call(i),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a)))}function d1(a){var i=a._init;return i(a._payload)}function f1(a){function i(he,ue){if(a){var ye=he.deletions;ye===null?(he.deletions=[ue],he.flags|=16):ye.push(ue)}}function c(he,ue){if(!a)return null;for(;ue!==null;)i(he,ue),ue=ue.sibling;return null}function d(he){for(var ue=new Map;he!==null;)he.key!==null?ue.set(he.key,he):ue.set(he.index,he),he=he.sibling;return ue}function x(he,ue){return he=Za(he,ue),he.index=0,he.sibling=null,he}function b(he,ue,ye){return he.index=ye,a?(ye=he.alternate,ye!==null?(ye=ye.index,ye<ue?(he.flags|=67108866,ue):ye):(he.flags|=67108866,ue)):(he.flags|=1048576,ue)}function A(he){return a&&he.alternate===null&&(he.flags|=67108866),he}function B(he,ue,ye,Fe){return ue===null||ue.tag!==6?(ue=x0(ye,he.mode,Fe),ue.return=he,ue):(ue=x(ue,ye),ue.return=he,ue)}function ae(he,ue,ye,Fe){var tt=ye.type;return tt===S?Me(he,ue,ye.props.children,Fe,ye.key):ue!==null&&(ue.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===U&&d1(tt)===ue.type)?(ue=x(ue,ye.props),zl(ue,ye),ue.return=he,ue):(ue=Au(ye.type,ye.key,ye.props,null,he.mode,Fe),zl(ue,ye),ue.return=he,ue)}function be(he,ue,ye,Fe){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==ye.containerInfo||ue.stateNode.implementation!==ye.implementation?(ue=g0(ye,he.mode,Fe),ue.return=he,ue):(ue=x(ue,ye.children||[]),ue.return=he,ue)}function Me(he,ue,ye,Fe,tt){return ue===null||ue.tag!==7?(ue=vi(ye,he.mode,Fe,tt),ue.return=he,ue):(ue=x(ue,ye),ue.return=he,ue)}function Le(he,ue,ye){if(typeof ue=="string"&&ue!==""||typeof ue=="number"||typeof ue=="bigint")return ue=x0(""+ue,he.mode,ye),ue.return=he,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case y:return ye=Au(ue.type,ue.key,ue.props,null,he.mode,ye),zl(ye,ue),ye.return=he,ye;case v:return ue=g0(ue,he.mode,ye),ue.return=he,ue;case U:var Fe=ue._init;return ue=Fe(ue._payload),Le(he,ue,ye)}if(W(ue)||G(ue))return ue=vi(ue,he.mode,ye,null),ue.return=he,ue;if(typeof ue.then=="function")return Le(he,Gu(ue),ye);if(ue.$$typeof===T)return Le(he,Ou(he,ue),ye);qu(he,ue)}return null}function Ne(he,ue,ye,Fe){var tt=ue!==null?ue.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return tt!==null?null:B(he,ue,""+ye,Fe);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case y:return ye.key===tt?ae(he,ue,ye,Fe):null;case v:return ye.key===tt?be(he,ue,ye,Fe):null;case U:return tt=ye._init,ye=tt(ye._payload),Ne(he,ue,ye,Fe)}if(W(ye)||G(ye))return tt!==null?null:Me(he,ue,ye,Fe,null);if(typeof ye.then=="function")return Ne(he,ue,Gu(ye),Fe);if(ye.$$typeof===T)return Ne(he,ue,Ou(he,ye),Fe);qu(he,ye)}return null}function Ee(he,ue,ye,Fe,tt){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return he=he.get(ye)||null,B(ue,he,""+Fe,tt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case y:return he=he.get(Fe.key===null?ye:Fe.key)||null,ae(ue,he,Fe,tt);case v:return he=he.get(Fe.key===null?ye:Fe.key)||null,be(ue,he,Fe,tt);case U:var Ct=Fe._init;return Fe=Ct(Fe._payload),Ee(he,ue,ye,Fe,tt)}if(W(Fe)||G(Fe))return he=he.get(ye)||null,Me(ue,he,Fe,tt,null);if(typeof Fe.then=="function")return Ee(he,ue,ye,Gu(Fe),tt);if(Fe.$$typeof===T)return Ee(he,ue,ye,Ou(ue,Fe),tt);qu(ue,Fe)}return null}function mt(he,ue,ye,Fe){for(var tt=null,Ct=null,it=ue,ft=ue=0,$r=null;it!==null&&ft<ye.length;ft++){it.index>ft?($r=it,it=null):$r=it.sibling;var Rt=Ne(he,it,ye[ft],Fe);if(Rt===null){it===null&&(it=$r);break}a&&it&&Rt.alternate===null&&i(he,it),ue=b(Rt,ue,ft),Ct===null?tt=Rt:Ct.sibling=Rt,Ct=Rt,it=$r}if(ft===ye.length)return c(he,it),Pt&&wi(he,ft),tt;if(it===null){for(;ft<ye.length;ft++)it=Le(he,ye[ft],Fe),it!==null&&(ue=b(it,ue,ft),Ct===null?tt=it:Ct.sibling=it,Ct=it);return Pt&&wi(he,ft),tt}for(it=d(it);ft<ye.length;ft++)$r=Ee(it,he,ft,ye[ft],Fe),$r!==null&&(a&&$r.alternate!==null&&it.delete($r.key===null?ft:$r.key),ue=b($r,ue,ft),Ct===null?tt=$r:Ct.sibling=$r,Ct=$r);return a&&it.forEach(function(Xs){return i(he,Xs)}),Pt&&wi(he,ft),tt}function dt(he,ue,ye,Fe){if(ye==null)throw Error(n(151));for(var tt=null,Ct=null,it=ue,ft=ue=0,$r=null,Rt=ye.next();it!==null&&!Rt.done;ft++,Rt=ye.next()){it.index>ft?($r=it,it=null):$r=it.sibling;var Xs=Ne(he,it,Rt.value,Fe);if(Xs===null){it===null&&(it=$r);break}a&&it&&Xs.alternate===null&&i(he,it),ue=b(Xs,ue,ft),Ct===null?tt=Xs:Ct.sibling=Xs,Ct=Xs,it=$r}if(Rt.done)return c(he,it),Pt&&wi(he,ft),tt;if(it===null){for(;!Rt.done;ft++,Rt=ye.next())Rt=Le(he,Rt.value,Fe),Rt!==null&&(ue=b(Rt,ue,ft),Ct===null?tt=Rt:Ct.sibling=Rt,Ct=Rt);return Pt&&wi(he,ft),tt}for(it=d(it);!Rt.done;ft++,Rt=ye.next())Rt=Ee(it,he,ft,Rt.value,Fe),Rt!==null&&(a&&Rt.alternate!==null&&it.delete(Rt.key===null?ft:Rt.key),ue=b(Rt,ue,ft),Ct===null?tt=Rt:Ct.sibling=Rt,Ct=Rt);return a&&it.forEach(function(xE){return i(he,xE)}),Pt&&wi(he,ft),tt}function Jt(he,ue,ye,Fe){if(typeof ye=="object"&&ye!==null&&ye.type===S&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case y:e:{for(var tt=ye.key;ue!==null;){if(ue.key===tt){if(tt=ye.type,tt===S){if(ue.tag===7){c(he,ue.sibling),Fe=x(ue,ye.props.children),Fe.return=he,he=Fe;break e}}else if(ue.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===U&&d1(tt)===ue.type){c(he,ue.sibling),Fe=x(ue,ye.props),zl(Fe,ye),Fe.return=he,he=Fe;break e}c(he,ue);break}else i(he,ue);ue=ue.sibling}ye.type===S?(Fe=vi(ye.props.children,he.mode,Fe,ye.key),Fe.return=he,he=Fe):(Fe=Au(ye.type,ye.key,ye.props,null,he.mode,Fe),zl(Fe,ye),Fe.return=he,he=Fe)}return A(he);case v:e:{for(tt=ye.key;ue!==null;){if(ue.key===tt)if(ue.tag===4&&ue.stateNode.containerInfo===ye.containerInfo&&ue.stateNode.implementation===ye.implementation){c(he,ue.sibling),Fe=x(ue,ye.children||[]),Fe.return=he,he=Fe;break e}else{c(he,ue);break}else i(he,ue);ue=ue.sibling}Fe=g0(ye,he.mode,Fe),Fe.return=he,he=Fe}return A(he);case U:return tt=ye._init,ye=tt(ye._payload),Jt(he,ue,ye,Fe)}if(W(ye))return mt(he,ue,ye,Fe);if(G(ye)){if(tt=G(ye),typeof tt!="function")throw Error(n(150));return ye=tt.call(ye),dt(he,ue,ye,Fe)}if(typeof ye.then=="function")return Jt(he,ue,Gu(ye),Fe);if(ye.$$typeof===T)return Jt(he,ue,Ou(he,ye),Fe);qu(he,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint"?(ye=""+ye,ue!==null&&ue.tag===6?(c(he,ue.sibling),Fe=x(ue,ye),Fe.return=he,he=Fe):(c(he,ue),Fe=x0(ye,he.mode,Fe),Fe.return=he,he=Fe),A(he)):c(he,ue)}return function(he,ue,ye,Fe){try{Il=0;var tt=Jt(he,ue,ye,Fe);return So=null,tt}catch(it){if(it===kl||it===Mu)throw it;var Ct=zn(29,it,null,he.mode);return Ct.lanes=Fe,Ct.return=he,Ct}finally{}}}var No=f1(!0),h1=f1(!1),sa=ne(null),La=null;function Ms(a){var i=a.alternate;H(zr,zr.current&1),H(sa,a),La===null&&(i===null||yo.current!==null||i.memoizedState!==null)&&(La=a)}function m1(a){if(a.tag===22){if(H(zr,zr.current),H(sa,a),La===null){var i=a.alternate;i!==null&&i.memoizedState!==null&&(La=a)}}else Fs()}function Fs(){H(zr,zr.current),H(sa,sa.current)}function as(a){P(sa),La===a&&(La=null),P(zr)}var zr=ne(0);function $u(a){for(var i=a;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||Uh(c)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function K0(a,i,c,d){i=a.memoizedState,c=c(d,i),c=c==null?i:p({},i,c),a.memoizedState=c,a.lanes===0&&(a.updateQueue.baseState=c)}var Q0={enqueueSetState:function(a,i,c){a=a._reactInternals;var d=Gn(),x=ks(d);x.payload=i,c!=null&&(x.callback=c),i=Os(a,x,d),i!==null&&(qn(i,a,d),Rl(i,a,d))},enqueueReplaceState:function(a,i,c){a=a._reactInternals;var d=Gn(),x=ks(d);x.tag=1,x.payload=i,c!=null&&(x.callback=c),i=Os(a,x,d),i!==null&&(qn(i,a,d),Rl(i,a,d))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var c=Gn(),d=ks(c);d.tag=2,i!=null&&(d.callback=i),i=Os(a,d,c),i!==null&&(qn(i,a,c),Rl(i,a,c))}};function p1(a,i,c,d,x,b,A){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(d,b,A):i.prototype&&i.prototype.isPureReactComponent?!Nl(c,d)||!Nl(x,b):!0}function x1(a,i,c,d){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==a&&Q0.enqueueReplaceState(i,i.state,null)}function Ai(a,i){var c=i;if("ref"in i){c={};for(var d in i)d!=="ref"&&(c[d]=i[d])}if(a=a.defaultProps){c===i&&(c=p({},c));for(var x in a)c[x]===void 0&&(c[x]=a[x])}return c}var Wu=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function g1(a){Wu(a)}function y1(a){console.error(a)}function v1(a){Wu(a)}function Xu(a,i){try{var c=a.onUncaughtError;c(i.value,{componentStack:i.stack})}catch(d){setTimeout(function(){throw d})}}function b1(a,i,c){try{var d=a.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Z0(a,i,c){return c=ks(c),c.tag=3,c.payload={element:null},c.callback=function(){Xu(a,i)},c}function w1(a){return a=ks(a),a.tag=3,a}function S1(a,i,c,d){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var b=d.value;a.payload=function(){return x(b)},a.callback=function(){b1(i,c,d)}}var A=c.stateNode;A!==null&&typeof A.componentDidCatch=="function"&&(a.callback=function(){b1(i,c,d),typeof x!="function"&&(zs===null?zs=new Set([this]):zs.add(this));var B=d.stack;this.componentDidCatch(d.value,{componentStack:B!==null?B:""})})}function xT(a,i,c,d,x){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(i=c.alternate,i!==null&&Al(i,c,x,!0),c=sa.current,c!==null){switch(c.tag){case 13:return La===null?Sh():c.alternate===null&&br===0&&(br=3),c.flags&=-257,c.flags|=65536,c.lanes=x,d===C0?c.flags|=16384:(i=c.updateQueue,i===null?c.updateQueue=new Set([d]):i.add(d),Th(a,d,x)),!1;case 22:return c.flags|=65536,d===C0?c.flags|=16384:(i=c.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=i):(c=i.retryQueue,c===null?i.retryQueue=new Set([d]):c.add(d)),Th(a,d,x)),!1}throw Error(n(435,c.tag))}return Th(a,d,x),Sh(),!1}if(Pt)return i=sa.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,d!==b0&&(a=Error(n(422),{cause:d}),Cl(ta(a,c)))):(d!==b0&&(i=Error(n(423),{cause:d}),Cl(ta(i,c))),a=a.current.alternate,a.flags|=65536,x&=-x,a.lanes|=x,d=ta(d,c),x=Z0(a.stateNode,d,x),D0(a,x),br!==4&&(br=2)),!1;var b=Error(n(520),{cause:d});if(b=ta(b,c),Wl===null?Wl=[b]:Wl.push(b),br!==4&&(br=2),i===null)return!0;d=ta(d,c),c=i;do{switch(c.tag){case 3:return c.flags|=65536,a=x&-x,c.lanes|=a,a=Z0(c.stateNode,d,a),D0(c,a),!1;case 1:if(i=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(zs===null||!zs.has(b))))return c.flags|=65536,x&=-x,c.lanes|=x,x=w1(x),S1(x,a,c,d),D0(c,x),!1}c=c.return}while(c!==null);return!1}var N1=Error(n(461)),Gr=!1;function en(a,i,c,d){i.child=a===null?h1(i,null,c,d):No(i,a.child,c,d)}function T1(a,i,c,d,x){c=c.render;var b=i.ref;if("ref"in d){var A={};for(var B in d)B!=="ref"&&(A[B]=d[B])}else A=d;return Ei(i),d=F0(a,i,c,A,b,x),B=L0(),a!==null&&!Gr?(P0(a,i,x),ss(a,i,x)):(Pt&&B&&y0(i),i.flags|=1,en(a,i,d,x),i.child)}function E1(a,i,c,d,x){if(a===null){var b=c.type;return typeof b=="function"&&!p0(b)&&b.defaultProps===void 0&&c.compare===null?(i.tag=15,i.type=b,_1(a,i,b,d,x)):(a=Au(c.type,null,d,i,i.mode,x),a.ref=i.ref,a.return=i,i.child=a)}if(b=a.child,!ih(a,x)){var A=b.memoizedProps;if(c=c.compare,c=c!==null?c:Nl,c(A,d)&&a.ref===i.ref)return ss(a,i,x)}return i.flags|=1,a=Za(b,d),a.ref=i.ref,a.return=i,i.child=a}function _1(a,i,c,d,x){if(a!==null){var b=a.memoizedProps;if(Nl(b,d)&&a.ref===i.ref)if(Gr=!1,i.pendingProps=d=b,ih(a,x))(a.flags&131072)!==0&&(Gr=!0);else return i.lanes=a.lanes,ss(a,i,x)}return J0(a,i,c,d,x)}function C1(a,i,c){var d=i.pendingProps,x=d.children,b=a!==null?a.memoizedState:null;if(d.mode==="hidden"){if((i.flags&128)!==0){if(d=b!==null?b.baseLanes|c:c,a!==null){for(x=i.child=a.child,b=0;x!==null;)b=b|x.lanes|x.childLanes,x=x.sibling;i.childLanes=b&~d}else i.childLanes=0,i.child=null;return A1(a,i,d,c)}if((c&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},a!==null&&Ru(i,b!==null?b.cachePool:null),b!==null?_g(i,b):O0(),m1(i);else return i.lanes=i.childLanes=536870912,A1(a,i,b!==null?b.baseLanes|c:c,c)}else b!==null?(Ru(i,b.cachePool),_g(i,b),Fs(),i.memoizedState=null):(a!==null&&Ru(i,null),O0(),Fs());return en(a,i,x,c),i.child}function A1(a,i,c,d){var x=_0();return x=x===null?null:{parent:Ir._currentValue,pool:x},i.memoizedState={baseLanes:c,cachePool:x},a!==null&&Ru(i,null),O0(),m1(i),a!==null&&Al(a,i,d,!0),null}function Ku(a,i){var c=i.ref;if(c===null)a!==null&&a.ref!==null&&(i.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(a===null||a.ref!==c)&&(i.flags|=4194816)}}function J0(a,i,c,d,x){return Ei(i),c=F0(a,i,c,d,void 0,x),d=L0(),a!==null&&!Gr?(P0(a,i,x),ss(a,i,x)):(Pt&&d&&y0(i),i.flags|=1,en(a,i,c,x),i.child)}function j1(a,i,c,d,x,b){return Ei(i),i.updateQueue=null,c=Ag(i,d,c,x),Cg(a),d=L0(),a!==null&&!Gr?(P0(a,i,b),ss(a,i,b)):(Pt&&d&&y0(i),i.flags|=1,en(a,i,c,b),i.child)}function D1(a,i,c,d,x){if(Ei(i),i.stateNode===null){var b=ho,A=c.contextType;typeof A=="object"&&A!==null&&(b=hn(A)),b=new c(d,b),i.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Q0,i.stateNode=b,b._reactInternals=i,b=i.stateNode,b.props=d,b.state=i.memoizedState,b.refs={},A0(i),A=c.contextType,b.context=typeof A=="object"&&A!==null?hn(A):ho,b.state=i.memoizedState,A=c.getDerivedStateFromProps,typeof A=="function"&&(K0(i,c,A,d),b.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(A=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),A!==b.state&&Q0.enqueueReplaceState(b,b.state,null),Fl(i,d,b,x),Ml(),b.state=i.memoizedState),typeof b.componentDidMount=="function"&&(i.flags|=4194308),d=!0}else if(a===null){b=i.stateNode;var B=i.memoizedProps,ae=Ai(c,B);b.props=ae;var be=b.context,Me=c.contextType;A=ho,typeof Me=="object"&&Me!==null&&(A=hn(Me));var Le=c.getDerivedStateFromProps;Me=typeof Le=="function"||typeof b.getSnapshotBeforeUpdate=="function",B=i.pendingProps!==B,Me||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(B||be!==A)&&x1(i,b,d,A),Ds=!1;var Ne=i.memoizedState;b.state=Ne,Fl(i,d,b,x),Ml(),be=i.memoizedState,B||Ne!==be||Ds?(typeof Le=="function"&&(K0(i,c,Le,d),be=i.memoizedState),(ae=Ds||p1(i,c,ae,d,Ne,be,A))?(Me||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(i.flags|=4194308)):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=be),b.props=d,b.state=be,b.context=A,d=ae):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{b=i.stateNode,j0(a,i),A=i.memoizedProps,Me=Ai(c,A),b.props=Me,Le=i.pendingProps,Ne=b.context,be=c.contextType,ae=ho,typeof be=="object"&&be!==null&&(ae=hn(be)),B=c.getDerivedStateFromProps,(be=typeof B=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(A!==Le||Ne!==ae)&&x1(i,b,d,ae),Ds=!1,Ne=i.memoizedState,b.state=Ne,Fl(i,d,b,x),Ml();var Ee=i.memoizedState;A!==Le||Ne!==Ee||Ds||a!==null&&a.dependencies!==null&&ku(a.dependencies)?(typeof B=="function"&&(K0(i,c,B,d),Ee=i.memoizedState),(Me=Ds||p1(i,c,Me,d,Ne,Ee,ae)||a!==null&&a.dependencies!==null&&ku(a.dependencies))?(be||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,Ee,ae),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,Ee,ae)),typeof b.componentDidUpdate=="function"&&(i.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof b.componentDidUpdate!="function"||A===a.memoizedProps&&Ne===a.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&Ne===a.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=Ee),b.props=d,b.state=Ee,b.context=ae,d=Me):(typeof b.componentDidUpdate!="function"||A===a.memoizedProps&&Ne===a.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||A===a.memoizedProps&&Ne===a.memoizedState||(i.flags|=1024),d=!1)}return b=d,Ku(a,i),d=(i.flags&128)!==0,b||d?(b=i.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:b.render(),i.flags|=1,a!==null&&d?(i.child=No(i,a.child,null,x),i.child=No(i,null,c,x)):en(a,i,c,x),i.memoizedState=b.state,a=i.child):a=ss(a,i,x),a}function k1(a,i,c,d){return _l(),i.flags|=256,en(a,i,c,d),i.child}var eh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function th(a){return{baseLanes:a,cachePool:yg()}}function rh(a,i,c){return a=a!==null?a.childLanes&~c:0,i&&(a|=ia),a}function O1(a,i,c){var d=i.pendingProps,x=!1,b=(i.flags&128)!==0,A;if((A=b)||(A=a!==null&&a.memoizedState===null?!1:(zr.current&2)!==0),A&&(x=!0,i.flags&=-129),A=(i.flags&32)!==0,i.flags&=-33,a===null){if(Pt){if(x?Ms(i):Fs(),Pt){var B=vr,ae;if(ae=B){e:{for(ae=B,B=Fa;ae.nodeType!==8;){if(!B){B=null;break e}if(ae=Sa(ae.nextSibling),ae===null){B=null;break e}}B=ae}B!==null?(i.memoizedState={dehydrated:B,treeContext:bi!==null?{id:Ja,overflow:es}:null,retryLane:536870912,hydrationErrors:null},ae=zn(18,null,null,0),ae.stateNode=B,ae.return=i,i.child=ae,bn=i,vr=null,ae=!0):ae=!1}ae||Ni(i)}if(B=i.memoizedState,B!==null&&(B=B.dehydrated,B!==null))return Uh(B)?i.lanes=32:i.lanes=536870912,null;as(i)}return B=d.children,d=d.fallback,x?(Fs(),x=i.mode,B=Qu({mode:"hidden",children:B},x),d=vi(d,x,c,null),B.return=i,d.return=i,B.sibling=d,i.child=B,x=i.child,x.memoizedState=th(c),x.childLanes=rh(a,A,c),i.memoizedState=eh,d):(Ms(i),nh(i,B))}if(ae=a.memoizedState,ae!==null&&(B=ae.dehydrated,B!==null)){if(b)i.flags&256?(Ms(i),i.flags&=-257,i=ah(a,i,c)):i.memoizedState!==null?(Fs(),i.child=a.child,i.flags|=128,i=null):(Fs(),x=d.fallback,B=i.mode,d=Qu({mode:"visible",children:d.children},B),x=vi(x,B,c,null),x.flags|=2,d.return=i,x.return=i,d.sibling=x,i.child=d,No(i,a.child,null,c),d=i.child,d.memoizedState=th(c),d.childLanes=rh(a,A,c),i.memoizedState=eh,i=x);else if(Ms(i),Uh(B)){if(A=B.nextSibling&&B.nextSibling.dataset,A)var be=A.dgst;A=be,d=Error(n(419)),d.stack="",d.digest=A,Cl({value:d,source:null,stack:null}),i=ah(a,i,c)}else if(Gr||Al(a,i,c,!1),A=(c&a.childLanes)!==0,Gr||A){if(A=sr,A!==null&&(d=c&-c,d=(d&42)!==0?1:Ye(d),d=(d&(A.suspendedLanes|c))!==0?0:d,d!==0&&d!==ae.retryLane))throw ae.retryLane=d,fo(a,d),qn(A,a,d),N1;B.data==="$?"||Sh(),i=ah(a,i,c)}else B.data==="$?"?(i.flags|=192,i.child=a.child,i=null):(a=ae.treeContext,vr=Sa(B.nextSibling),bn=i,Pt=!0,Si=null,Fa=!1,a!==null&&(na[aa++]=Ja,na[aa++]=es,na[aa++]=bi,Ja=a.id,es=a.overflow,bi=i),i=nh(i,d.children),i.flags|=4096);return i}return x?(Fs(),x=d.fallback,B=i.mode,ae=a.child,be=ae.sibling,d=Za(ae,{mode:"hidden",children:d.children}),d.subtreeFlags=ae.subtreeFlags&65011712,be!==null?x=Za(be,x):(x=vi(x,B,c,null),x.flags|=2),x.return=i,d.return=i,d.sibling=x,i.child=d,d=x,x=i.child,B=a.child.memoizedState,B===null?B=th(c):(ae=B.cachePool,ae!==null?(be=Ir._currentValue,ae=ae.parent!==be?{parent:be,pool:be}:ae):ae=yg(),B={baseLanes:B.baseLanes|c,cachePool:ae}),x.memoizedState=B,x.childLanes=rh(a,A,c),i.memoizedState=eh,d):(Ms(i),c=a.child,a=c.sibling,c=Za(c,{mode:"visible",children:d.children}),c.return=i,c.sibling=null,a!==null&&(A=i.deletions,A===null?(i.deletions=[a],i.flags|=16):A.push(a)),i.child=c,i.memoizedState=null,c)}function nh(a,i){return i=Qu({mode:"visible",children:i},a.mode),i.return=a,a.child=i}function Qu(a,i){return a=zn(22,a,null,i),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function ah(a,i,c){return No(i,a.child,null,c),a=nh(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function R1(a,i,c){a.lanes|=i;var d=a.alternate;d!==null&&(d.lanes|=i),S0(a.return,i,c)}function sh(a,i,c,d,x){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:x}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=d,b.tail=c,b.tailMode=x)}function M1(a,i,c){var d=i.pendingProps,x=d.revealOrder,b=d.tail;if(en(a,i,d.children,c),d=zr.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&R1(a,c,i);else if(a.tag===19)R1(a,c,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}d&=1}switch(H(zr,d),x){case"forwards":for(c=i.child,x=null;c!==null;)a=c.alternate,a!==null&&$u(a)===null&&(x=c),c=c.sibling;c=x,c===null?(x=i.child,i.child=null):(x=c.sibling,c.sibling=null),sh(i,!1,x,c,b);break;case"backwards":for(c=null,x=i.child,i.child=null;x!==null;){if(a=x.alternate,a!==null&&$u(a)===null){i.child=x;break}a=x.sibling,x.sibling=c,c=x,x=a}sh(i,!0,c,null,b);break;case"together":sh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ss(a,i,c){if(a!==null&&(i.dependencies=a.dependencies),Is|=i.lanes,(c&i.childLanes)===0)if(a!==null){if(Al(a,i,c,!1),(c&i.childLanes)===0)return null}else return null;if(a!==null&&i.child!==a.child)throw Error(n(153));if(i.child!==null){for(a=i.child,c=Za(a,a.pendingProps),i.child=c,c.return=i;a.sibling!==null;)a=a.sibling,c=c.sibling=Za(a,a.pendingProps),c.return=i;c.sibling=null}return i.child}function ih(a,i){return(a.lanes&i)!==0?!0:(a=a.dependencies,!!(a!==null&&ku(a)))}function gT(a,i,c){switch(i.tag){case 3:me(i,i.stateNode.containerInfo),js(i,Ir,a.memoizedState.cache),_l();break;case 27:case 5:Re(i);break;case 4:me(i,i.stateNode.containerInfo);break;case 10:js(i,i.type,i.memoizedProps.value);break;case 13:var d=i.memoizedState;if(d!==null)return d.dehydrated!==null?(Ms(i),i.flags|=128,null):(c&i.child.childLanes)!==0?O1(a,i,c):(Ms(i),a=ss(a,i,c),a!==null?a.sibling:null);Ms(i);break;case 19:var x=(a.flags&128)!==0;if(d=(c&i.childLanes)!==0,d||(Al(a,i,c,!1),d=(c&i.childLanes)!==0),x){if(d)return M1(a,i,c);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),H(zr,zr.current),d)break;return null;case 22:case 23:return i.lanes=0,C1(a,i,c);case 24:js(i,Ir,a.memoizedState.cache)}return ss(a,i,c)}function F1(a,i,c){if(a!==null)if(a.memoizedProps!==i.pendingProps)Gr=!0;else{if(!ih(a,c)&&(i.flags&128)===0)return Gr=!1,gT(a,i,c);Gr=(a.flags&131072)!==0}else Gr=!1,Pt&&(i.flags&1048576)!==0&&dg(i,Du,i.index);switch(i.lanes=0,i.tag){case 16:e:{a=i.pendingProps;var d=i.elementType,x=d._init;if(d=x(d._payload),i.type=d,typeof d=="function")p0(d)?(a=Ai(d,a),i.tag=1,i=D1(null,i,d,a,c)):(i.tag=0,i=J0(null,i,d,a,c));else{if(d!=null){if(x=d.$$typeof,x===O){i.tag=11,i=T1(null,i,d,a,c);break e}else if(x===D){i.tag=14,i=E1(null,i,d,a,c);break e}}throw i=J(d)||d,Error(n(306,i,""))}}return i;case 0:return J0(a,i,i.type,i.pendingProps,c);case 1:return d=i.type,x=Ai(d,i.pendingProps),D1(a,i,d,x,c);case 3:e:{if(me(i,i.stateNode.containerInfo),a===null)throw Error(n(387));d=i.pendingProps;var b=i.memoizedState;x=b.element,j0(a,i),Fl(i,d,null,c);var A=i.memoizedState;if(d=A.cache,js(i,Ir,d),d!==b.cache&&N0(i,[Ir],c,!0),Ml(),d=A.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:A.cache},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){i=k1(a,i,d,c);break e}else if(d!==x){x=ta(Error(n(424)),i),Cl(x),i=k1(a,i,d,c);break e}else{switch(a=i.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(vr=Sa(a.firstChild),bn=i,Pt=!0,Si=null,Fa=!0,c=h1(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(_l(),d===x){i=ss(a,i,c);break e}en(a,i,d,c)}i=i.child}return i;case 26:return Ku(a,i),a===null?(c=Uy(i.type,null,i.pendingProps,null))?i.memoizedState=c:Pt||(c=i.type,a=i.pendingProps,d=dd(ce.current).createElement(c),d[ar]=i,d[Lt]=a,rn(d,c,a),pe(d),i.stateNode=d):i.memoizedState=Uy(i.type,a.memoizedProps,i.pendingProps,a.memoizedState),null;case 27:return Re(i),a===null&&Pt&&(d=i.stateNode=Ly(i.type,i.pendingProps,ce.current),bn=i,Fa=!0,x=vr,Ys(i.type)?(Ih=x,vr=Sa(d.firstChild)):vr=x),en(a,i,i.pendingProps.children,c),Ku(a,i),a===null&&(i.flags|=4194304),i.child;case 5:return a===null&&Pt&&((x=d=vr)&&(d=GT(d,i.type,i.pendingProps,Fa),d!==null?(i.stateNode=d,bn=i,vr=Sa(d.firstChild),Fa=!1,x=!0):x=!1),x||Ni(i)),Re(i),x=i.type,b=i.pendingProps,A=a!==null?a.memoizedProps:null,d=b.children,Lh(x,b)?d=null:A!==null&&Lh(x,A)&&(i.flags|=32),i.memoizedState!==null&&(x=F0(a,i,cT,null,null,c),nc._currentValue=x),Ku(a,i),en(a,i,d,c),i.child;case 6:return a===null&&Pt&&((a=c=vr)&&(c=qT(c,i.pendingProps,Fa),c!==null?(i.stateNode=c,bn=i,vr=null,a=!0):a=!1),a||Ni(i)),null;case 13:return O1(a,i,c);case 4:return me(i,i.stateNode.containerInfo),d=i.pendingProps,a===null?i.child=No(i,null,d,c):en(a,i,d,c),i.child;case 11:return T1(a,i,i.type,i.pendingProps,c);case 7:return en(a,i,i.pendingProps,c),i.child;case 8:return en(a,i,i.pendingProps.children,c),i.child;case 12:return en(a,i,i.pendingProps.children,c),i.child;case 10:return d=i.pendingProps,js(i,i.type,d.value),en(a,i,d.children,c),i.child;case 9:return x=i.type._context,d=i.pendingProps.children,Ei(i),x=hn(x),d=d(x),i.flags|=1,en(a,i,d,c),i.child;case 14:return E1(a,i,i.type,i.pendingProps,c);case 15:return _1(a,i,i.type,i.pendingProps,c);case 19:return M1(a,i,c);case 31:return d=i.pendingProps,c=i.mode,d={mode:d.mode,children:d.children},a===null?(c=Qu(d,c),c.ref=i.ref,i.child=c,c.return=i,i=c):(c=Za(a.child,d),c.ref=i.ref,i.child=c,c.return=i,i=c),i;case 22:return C1(a,i,c);case 24:return Ei(i),d=hn(Ir),a===null?(x=_0(),x===null&&(x=sr,b=T0(),x.pooledCache=b,b.refCount++,b!==null&&(x.pooledCacheLanes|=c),x=b),i.memoizedState={parent:d,cache:x},A0(i),js(i,Ir,x)):((a.lanes&c)!==0&&(j0(a,i),Fl(i,null,null,c),Ml()),x=a.memoizedState,b=i.memoizedState,x.parent!==d?(x={parent:d,cache:d},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),js(i,Ir,d)):(d=b.cache,js(i,Ir,d),d!==x.cache&&N0(i,[Ir],c,!0))),en(a,i,i.pendingProps.children,c),i.child;case 29:throw i.pendingProps}throw Error(n(156,i.tag))}function is(a){a.flags|=4}function L1(a,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!Yy(i)){if(i=sa.current,i!==null&&((kt&4194048)===kt?La!==null:(kt&62914560)!==kt&&(kt&536870912)===0||i!==La))throw Ol=C0,vg;a.flags|=8192}}function Zu(a,i){i!==null&&(a.flags|=4),a.flags&16384&&(i=a.tag!==22?Se():536870912,a.lanes|=i,Co|=i)}function Vl(a,i){if(!Pt)switch(a.tailMode){case"hidden":i=a.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a.tail=null:c.sibling=null;break;case"collapsed":c=a.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:d.sibling=null}}function mr(a){var i=a.alternate!==null&&a.alternate.child===a.child,c=0,d=0;if(i)for(var x=a.child;x!==null;)c|=x.lanes|x.childLanes,d|=x.subtreeFlags&65011712,d|=x.flags&65011712,x.return=a,x=x.sibling;else for(x=a.child;x!==null;)c|=x.lanes|x.childLanes,d|=x.subtreeFlags,d|=x.flags,x.return=a,x=x.sibling;return a.subtreeFlags|=d,a.childLanes=c,i}function yT(a,i,c){var d=i.pendingProps;switch(v0(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(i),null;case 1:return mr(i),null;case 3:return c=i.stateNode,d=null,a!==null&&(d=a.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),rs(Ir),je(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(a===null||a.child===null)&&(El(i)?is(i):a===null||a.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,mg())),mr(i),null;case 26:return c=i.memoizedState,a===null?(is(i),c!==null?(mr(i),L1(i,c)):(mr(i),i.flags&=-16777217)):c?c!==a.memoizedState?(is(i),mr(i),L1(i,c)):(mr(i),i.flags&=-16777217):(a.memoizedProps!==d&&is(i),mr(i),i.flags&=-16777217),null;case 27:We(i),c=ce.current;var x=i.type;if(a!==null&&i.stateNode!=null)a.memoizedProps!==d&&is(i);else{if(!d){if(i.stateNode===null)throw Error(n(166));return mr(i),null}a=z.current,El(i)?fg(i):(a=Ly(x,d,c),i.stateNode=a,is(i))}return mr(i),null;case 5:if(We(i),c=i.type,a!==null&&i.stateNode!=null)a.memoizedProps!==d&&is(i);else{if(!d){if(i.stateNode===null)throw Error(n(166));return mr(i),null}if(a=z.current,El(i))fg(i);else{switch(x=dd(ce.current),a){case 1:a=x.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:a=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":a=x.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":a=x.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":a=x.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof d.is=="string"?x.createElement("select",{is:d.is}):x.createElement("select"),d.multiple?a.multiple=!0:d.size&&(a.size=d.size);break;default:a=typeof d.is=="string"?x.createElement(c,{is:d.is}):x.createElement(c)}}a[ar]=i,a[Lt]=d;e:for(x=i.child;x!==null;){if(x.tag===5||x.tag===6)a.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===i)break e;for(;x.sibling===null;){if(x.return===null||x.return===i)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}i.stateNode=a;e:switch(rn(a,c,d),c){case"button":case"input":case"select":case"textarea":a=!!d.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&is(i)}}return mr(i),i.flags&=-16777217,null;case 6:if(a&&i.stateNode!=null)a.memoizedProps!==d&&is(i);else{if(typeof d!="string"&&i.stateNode===null)throw Error(n(166));if(a=ce.current,El(i)){if(a=i.stateNode,c=i.memoizedProps,d=null,x=bn,x!==null)switch(x.tag){case 27:case 5:d=x.memoizedProps}a[ar]=i,a=!!(a.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||jy(a.nodeValue,c)),a||Ni(i)}else a=dd(a).createTextNode(d),a[ar]=i,i.stateNode=a}return mr(i),null;case 13:if(d=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(x=El(i),d!==null&&d.dehydrated!==null){if(a===null){if(!x)throw Error(n(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));x[ar]=i}else _l(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;mr(i),x=!1}else x=mg(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(as(i),i):(as(i),null)}if(as(i),(i.flags&128)!==0)return i.lanes=c,i;if(c=d!==null,a=a!==null&&a.memoizedState!==null,c){d=i.child,x=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(x=d.alternate.memoizedState.cachePool.pool);var b=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==x&&(d.flags|=2048)}return c!==a&&c&&(i.child.flags|=8192),Zu(i,i.updateQueue),mr(i),null;case 4:return je(),a===null&&kh(i.stateNode.containerInfo),mr(i),null;case 10:return rs(i.type),mr(i),null;case 19:if(P(zr),x=i.memoizedState,x===null)return mr(i),null;if(d=(i.flags&128)!==0,b=x.rendering,b===null)if(d)Vl(x,!1);else{if(br!==0||a!==null&&(a.flags&128)!==0)for(a=i.child;a!==null;){if(b=$u(a),b!==null){for(i.flags|=128,Vl(x,!1),a=b.updateQueue,i.updateQueue=a,Zu(i,a),i.subtreeFlags=0,a=c,c=i.child;c!==null;)ug(c,a),c=c.sibling;return H(zr,zr.current&1|2),i.child}a=a.sibling}x.tail!==null&&_e()>td&&(i.flags|=128,d=!0,Vl(x,!1),i.lanes=4194304)}else{if(!d)if(a=$u(b),a!==null){if(i.flags|=128,d=!0,a=a.updateQueue,i.updateQueue=a,Zu(i,a),Vl(x,!0),x.tail===null&&x.tailMode==="hidden"&&!b.alternate&&!Pt)return mr(i),null}else 2*_e()-x.renderingStartTime>td&&c!==536870912&&(i.flags|=128,d=!0,Vl(x,!1),i.lanes=4194304);x.isBackwards?(b.sibling=i.child,i.child=b):(a=x.last,a!==null?a.sibling=b:i.child=b,x.last=b)}return x.tail!==null?(i=x.tail,x.rendering=i,x.tail=i.sibling,x.renderingStartTime=_e(),i.sibling=null,a=zr.current,H(zr,d?a&1|2:a&1),i):(mr(i),null);case 22:case 23:return as(i),R0(),d=i.memoizedState!==null,a!==null?a.memoizedState!==null!==d&&(i.flags|=8192):d&&(i.flags|=8192),d?(c&536870912)!==0&&(i.flags&128)===0&&(mr(i),i.subtreeFlags&6&&(i.flags|=8192)):mr(i),c=i.updateQueue,c!==null&&Zu(i,c.retryQueue),c=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),d=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),d!==c&&(i.flags|=2048),a!==null&&P(_i),null;case 24:return c=null,a!==null&&(c=a.memoizedState.cache),i.memoizedState.cache!==c&&(i.flags|=2048),rs(Ir),mr(i),null;case 25:return null;case 30:return null}throw Error(n(156,i.tag))}function vT(a,i){switch(v0(i),i.tag){case 1:return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return rs(Ir),je(),a=i.flags,(a&65536)!==0&&(a&128)===0?(i.flags=a&-65537|128,i):null;case 26:case 27:case 5:return We(i),null;case 13:if(as(i),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(n(340));_l()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return P(zr),null;case 4:return je(),null;case 10:return rs(i.type),null;case 22:case 23:return as(i),R0(),a!==null&&P(_i),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 24:return rs(Ir),null;case 25:return null;default:return null}}function P1(a,i){switch(v0(i),i.tag){case 3:rs(Ir),je();break;case 26:case 27:case 5:We(i);break;case 4:je();break;case 13:as(i);break;case 19:P(zr);break;case 10:rs(i.type);break;case 22:case 23:as(i),R0(),a!==null&&P(_i);break;case 24:rs(Ir)}}function Hl(a,i){try{var c=i.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var x=d.next;c=x;do{if((c.tag&a)===a){d=void 0;var b=c.create,A=c.inst;d=b(),A.destroy=d}c=c.next}while(c!==x)}}catch(B){nr(i,i.return,B)}}function Ls(a,i,c){try{var d=i.updateQueue,x=d!==null?d.lastEffect:null;if(x!==null){var b=x.next;d=b;do{if((d.tag&a)===a){var A=d.inst,B=A.destroy;if(B!==void 0){A.destroy=void 0,x=i;var ae=c,be=B;try{be()}catch(Me){nr(x,ae,Me)}}}d=d.next}while(d!==b)}}catch(Me){nr(i,i.return,Me)}}function B1(a){var i=a.updateQueue;if(i!==null){var c=a.stateNode;try{Eg(i,c)}catch(d){nr(a,a.return,d)}}}function U1(a,i,c){c.props=Ai(a.type,a.memoizedProps),c.state=a.memoizedState;try{c.componentWillUnmount()}catch(d){nr(a,i,d)}}function Yl(a,i){try{var c=a.ref;if(c!==null){switch(a.tag){case 26:case 27:case 5:var d=a.stateNode;break;case 30:d=a.stateNode;break;default:d=a.stateNode}typeof c=="function"?a.refCleanup=c(d):c.current=d}}catch(x){nr(a,i,x)}}function Pa(a,i){var c=a.ref,d=a.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(x){nr(a,i,x)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){nr(a,i,x)}else c.current=null}function I1(a){var i=a.type,c=a.memoizedProps,d=a.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(x){nr(a,a.return,x)}}function oh(a,i,c){try{var d=a.stateNode;IT(d,a.type,c,i),d[Lt]=i}catch(x){nr(a,a.return,x)}}function z1(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Ys(a.type)||a.tag===4}function lh(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||z1(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Ys(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function ch(a,i,c){var d=a.tag;if(d===5||d===6)a=a.stateNode,i?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(a,i):(i=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,i.appendChild(a),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=ud));else if(d!==4&&(d===27&&Ys(a.type)&&(c=a.stateNode,i=null),a=a.child,a!==null))for(ch(a,i,c),a=a.sibling;a!==null;)ch(a,i,c),a=a.sibling}function Ju(a,i,c){var d=a.tag;if(d===5||d===6)a=a.stateNode,i?c.insertBefore(a,i):c.appendChild(a);else if(d!==4&&(d===27&&Ys(a.type)&&(c=a.stateNode),a=a.child,a!==null))for(Ju(a,i,c),a=a.sibling;a!==null;)Ju(a,i,c),a=a.sibling}function V1(a){var i=a.stateNode,c=a.memoizedProps;try{for(var d=a.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);rn(i,d,c),i[ar]=a,i[Lt]=c}catch(b){nr(a,a.return,b)}}var os=!1,Cr=!1,uh=!1,H1=typeof WeakSet=="function"?WeakSet:Set,qr=null;function bT(a,i){if(a=a.containerInfo,Mh=gd,a=eg(a),l0(a)){if("selectionStart"in a)var c={start:a.selectionStart,end:a.selectionEnd};else e:{c=(c=a.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var x=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var A=0,B=-1,ae=-1,be=0,Me=0,Le=a,Ne=null;t:for(;;){for(var Ee;Le!==c||x!==0&&Le.nodeType!==3||(B=A+x),Le!==b||d!==0&&Le.nodeType!==3||(ae=A+d),Le.nodeType===3&&(A+=Le.nodeValue.length),(Ee=Le.firstChild)!==null;)Ne=Le,Le=Ee;for(;;){if(Le===a)break t;if(Ne===c&&++be===x&&(B=A),Ne===b&&++Me===d&&(ae=A),(Ee=Le.nextSibling)!==null)break;Le=Ne,Ne=Le.parentNode}Le=Ee}c=B===-1||ae===-1?null:{start:B,end:ae}}else c=null}c=c||{start:0,end:0}}else c=null;for(Fh={focusedElem:a,selectionRange:c},gd=!1,qr=i;qr!==null;)if(i=qr,a=i.child,(i.subtreeFlags&1024)!==0&&a!==null)a.return=i,qr=a;else for(;qr!==null;){switch(i=qr,b=i.alternate,a=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&b!==null){a=void 0,c=i,x=b.memoizedProps,b=b.memoizedState,d=c.stateNode;try{var mt=Ai(c.type,x,c.elementType===c.type);a=d.getSnapshotBeforeUpdate(mt,b),d.__reactInternalSnapshotBeforeUpdate=a}catch(dt){nr(c,c.return,dt)}}break;case 3:if((a&1024)!==0){if(a=i.stateNode.containerInfo,c=a.nodeType,c===9)Bh(a);else if(c===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Bh(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=i.sibling,a!==null){a.return=i.return,qr=a;break}qr=i.return}}function Y1(a,i,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Ps(a,c),d&4&&Hl(5,c);break;case 1:if(Ps(a,c),d&4)if(a=c.stateNode,i===null)try{a.componentDidMount()}catch(A){nr(c,c.return,A)}else{var x=Ai(c.type,i.memoizedProps);i=i.memoizedState;try{a.componentDidUpdate(x,i,a.__reactInternalSnapshotBeforeUpdate)}catch(A){nr(c,c.return,A)}}d&64&&B1(c),d&512&&Yl(c,c.return);break;case 3:if(Ps(a,c),d&64&&(a=c.updateQueue,a!==null)){if(i=null,c.child!==null)switch(c.child.tag){case 27:case 5:i=c.child.stateNode;break;case 1:i=c.child.stateNode}try{Eg(a,i)}catch(A){nr(c,c.return,A)}}break;case 27:i===null&&d&4&&V1(c);case 26:case 5:Ps(a,c),i===null&&d&4&&I1(c),d&512&&Yl(c,c.return);break;case 12:Ps(a,c);break;case 13:Ps(a,c),d&4&&$1(a,c),d&64&&(a=c.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(c=jT.bind(null,c),$T(a,c))));break;case 22:if(d=c.memoizedState!==null||os,!d){i=i!==null&&i.memoizedState!==null||Cr,x=os;var b=Cr;os=d,(Cr=i)&&!b?Bs(a,c,(c.subtreeFlags&8772)!==0):Ps(a,c),os=x,Cr=b}break;case 30:break;default:Ps(a,c)}}function G1(a){var i=a.alternate;i!==null&&(a.alternate=null,G1(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&Y(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var cr=null,jn=!1;function ls(a,i,c){for(c=c.child;c!==null;)q1(a,i,c),c=c.sibling}function q1(a,i,c){if(Xe&&typeof Xe.onCommitFiberUnmount=="function")try{Xe.onCommitFiberUnmount(Qe,c)}catch{}switch(c.tag){case 26:Cr||Pa(c,i),ls(a,i,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Cr||Pa(c,i);var d=cr,x=jn;Ys(c.type)&&(cr=c.stateNode,jn=!1),ls(a,i,c),Jl(c.stateNode),cr=d,jn=x;break;case 5:Cr||Pa(c,i);case 6:if(d=cr,x=jn,cr=null,ls(a,i,c),cr=d,jn=x,cr!==null)if(jn)try{(cr.nodeType===9?cr.body:cr.nodeName==="HTML"?cr.ownerDocument.body:cr).removeChild(c.stateNode)}catch(b){nr(c,i,b)}else try{cr.removeChild(c.stateNode)}catch(b){nr(c,i,b)}break;case 18:cr!==null&&(jn?(a=cr,My(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,c.stateNode),oc(a)):My(cr,c.stateNode));break;case 4:d=cr,x=jn,cr=c.stateNode.containerInfo,jn=!0,ls(a,i,c),cr=d,jn=x;break;case 0:case 11:case 14:case 15:Cr||Ls(2,c,i),Cr||Ls(4,c,i),ls(a,i,c);break;case 1:Cr||(Pa(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"&&U1(c,i,d)),ls(a,i,c);break;case 21:ls(a,i,c);break;case 22:Cr=(d=Cr)||c.memoizedState!==null,ls(a,i,c),Cr=d;break;default:ls(a,i,c)}}function $1(a,i){if(i.memoizedState===null&&(a=i.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{oc(a)}catch(c){nr(i,i.return,c)}}function wT(a){switch(a.tag){case 13:case 19:var i=a.stateNode;return i===null&&(i=a.stateNode=new H1),i;case 22:return a=a.stateNode,i=a._retryCache,i===null&&(i=a._retryCache=new H1),i;default:throw Error(n(435,a.tag))}}function dh(a,i){var c=wT(a);i.forEach(function(d){var x=DT.bind(null,a,d);c.has(d)||(c.add(d),d.then(x,x))})}function Vn(a,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var x=c[d],b=a,A=i,B=A;e:for(;B!==null;){switch(B.tag){case 27:if(Ys(B.type)){cr=B.stateNode,jn=!1;break e}break;case 5:cr=B.stateNode,jn=!1;break e;case 3:case 4:cr=B.stateNode.containerInfo,jn=!0;break e}B=B.return}if(cr===null)throw Error(n(160));q1(b,A,x),cr=null,jn=!1,b=x.alternate,b!==null&&(b.return=null),x.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)W1(i,a),i=i.sibling}var wa=null;function W1(a,i){var c=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Vn(i,a),Hn(a),d&4&&(Ls(3,a,a.return),Hl(3,a),Ls(5,a,a.return));break;case 1:Vn(i,a),Hn(a),d&512&&(Cr||c===null||Pa(c,c.return)),d&64&&os&&(a=a.updateQueue,a!==null&&(d=a.callbacks,d!==null&&(c=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var x=wa;if(Vn(i,a),Hn(a),d&512&&(Cr||c===null||Pa(c,c.return)),d&4){var b=c!==null?c.memoizedState:null;if(d=a.memoizedState,c===null)if(d===null)if(a.stateNode===null){e:{d=a.type,c=a.memoizedProps,x=x.ownerDocument||x;t:switch(d){case"title":b=x.getElementsByTagName("title")[0],(!b||b[V]||b[ar]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=x.createElement(d),x.head.insertBefore(b,x.querySelector("head > title"))),rn(b,d,c),b[ar]=a,pe(b),d=b;break e;case"link":var A=Vy("link","href",x).get(d+(c.href||""));if(A){for(var B=0;B<A.length;B++)if(b=A[B],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){A.splice(B,1);break t}}b=x.createElement(d),rn(b,d,c),x.head.appendChild(b);break;case"meta":if(A=Vy("meta","content",x).get(d+(c.content||""))){for(B=0;B<A.length;B++)if(b=A[B],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){A.splice(B,1);break t}}b=x.createElement(d),rn(b,d,c),x.head.appendChild(b);break;default:throw Error(n(468,d))}b[ar]=a,pe(b),d=b}a.stateNode=d}else Hy(x,a.type,a.stateNode);else a.stateNode=zy(x,d,a.memoizedProps);else b!==d?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,d===null?Hy(x,a.type,a.stateNode):zy(x,d,a.memoizedProps)):d===null&&a.stateNode!==null&&oh(a,a.memoizedProps,c.memoizedProps)}break;case 27:Vn(i,a),Hn(a),d&512&&(Cr||c===null||Pa(c,c.return)),c!==null&&d&4&&oh(a,a.memoizedProps,c.memoizedProps);break;case 5:if(Vn(i,a),Hn(a),d&512&&(Cr||c===null||Pa(c,c.return)),a.flags&32){x=a.stateNode;try{ea(x,"")}catch(Ee){nr(a,a.return,Ee)}}d&4&&a.stateNode!=null&&(x=a.memoizedProps,oh(a,x,c!==null?c.memoizedProps:x)),d&1024&&(uh=!0);break;case 6:if(Vn(i,a),Hn(a),d&4){if(a.stateNode===null)throw Error(n(162));d=a.memoizedProps,c=a.stateNode;try{c.nodeValue=d}catch(Ee){nr(a,a.return,Ee)}}break;case 3:if(md=null,x=wa,wa=fd(i.containerInfo),Vn(i,a),wa=x,Hn(a),d&4&&c!==null&&c.memoizedState.isDehydrated)try{oc(i.containerInfo)}catch(Ee){nr(a,a.return,Ee)}uh&&(uh=!1,X1(a));break;case 4:d=wa,wa=fd(a.stateNode.containerInfo),Vn(i,a),Hn(a),wa=d;break;case 12:Vn(i,a),Hn(a);break;case 13:Vn(i,a),Hn(a),a.child.flags&8192&&a.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(gh=_e()),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,dh(a,d)));break;case 22:x=a.memoizedState!==null;var ae=c!==null&&c.memoizedState!==null,be=os,Me=Cr;if(os=be||x,Cr=Me||ae,Vn(i,a),Cr=Me,os=be,Hn(a),d&8192)e:for(i=a.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(c===null||ae||os||Cr||ji(a)),c=null,i=a;;){if(i.tag===5||i.tag===26){if(c===null){ae=c=i;try{if(b=ae.stateNode,x)A=b.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{B=ae.stateNode;var Le=ae.memoizedProps.style,Ne=Le!=null&&Le.hasOwnProperty("display")?Le.display:null;B.style.display=Ne==null||typeof Ne=="boolean"?"":(""+Ne).trim()}}catch(Ee){nr(ae,ae.return,Ee)}}}else if(i.tag===6){if(c===null){ae=i;try{ae.stateNode.nodeValue=x?"":ae.memoizedProps}catch(Ee){nr(ae,ae.return,Ee)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}d&4&&(d=a.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,dh(a,c))));break;case 19:Vn(i,a),Hn(a),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,dh(a,d)));break;case 30:break;case 21:break;default:Vn(i,a),Hn(a)}}function Hn(a){var i=a.flags;if(i&2){try{for(var c,d=a.return;d!==null;){if(z1(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var x=c.stateNode,b=lh(a);Ju(a,b,x);break;case 5:var A=c.stateNode;c.flags&32&&(ea(A,""),c.flags&=-33);var B=lh(a);Ju(a,B,A);break;case 3:case 4:var ae=c.stateNode.containerInfo,be=lh(a);ch(a,be,ae);break;default:throw Error(n(161))}}catch(Me){nr(a,a.return,Me)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function X1(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var i=a;X1(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),a=a.sibling}}function Ps(a,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Y1(a,i.alternate,i),i=i.sibling}function ji(a){for(a=a.child;a!==null;){var i=a;switch(i.tag){case 0:case 11:case 14:case 15:Ls(4,i,i.return),ji(i);break;case 1:Pa(i,i.return);var c=i.stateNode;typeof c.componentWillUnmount=="function"&&U1(i,i.return,c),ji(i);break;case 27:Jl(i.stateNode);case 26:case 5:Pa(i,i.return),ji(i);break;case 22:i.memoizedState===null&&ji(i);break;case 30:ji(i);break;default:ji(i)}a=a.sibling}}function Bs(a,i,c){for(c=c&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var d=i.alternate,x=a,b=i,A=b.flags;switch(b.tag){case 0:case 11:case 15:Bs(x,b,c),Hl(4,b);break;case 1:if(Bs(x,b,c),d=b,x=d.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(be){nr(d,d.return,be)}if(d=b,x=d.updateQueue,x!==null){var B=d.stateNode;try{var ae=x.shared.hiddenCallbacks;if(ae!==null)for(x.shared.hiddenCallbacks=null,x=0;x<ae.length;x++)Tg(ae[x],B)}catch(be){nr(d,d.return,be)}}c&&A&64&&B1(b),Yl(b,b.return);break;case 27:V1(b);case 26:case 5:Bs(x,b,c),c&&d===null&&A&4&&I1(b),Yl(b,b.return);break;case 12:Bs(x,b,c);break;case 13:Bs(x,b,c),c&&A&4&&$1(x,b);break;case 22:b.memoizedState===null&&Bs(x,b,c),Yl(b,b.return);break;case 30:break;default:Bs(x,b,c)}i=i.sibling}}function fh(a,i){var c=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),a=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(a=i.memoizedState.cachePool.pool),a!==c&&(a!=null&&a.refCount++,c!=null&&jl(c))}function hh(a,i){a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&jl(a))}function Ba(a,i,c,d){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)K1(a,i,c,d),i=i.sibling}function K1(a,i,c,d){var x=i.flags;switch(i.tag){case 0:case 11:case 15:Ba(a,i,c,d),x&2048&&Hl(9,i);break;case 1:Ba(a,i,c,d);break;case 3:Ba(a,i,c,d),x&2048&&(a=null,i.alternate!==null&&(a=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==a&&(i.refCount++,a!=null&&jl(a)));break;case 12:if(x&2048){Ba(a,i,c,d),a=i.stateNode;try{var b=i.memoizedProps,A=b.id,B=b.onPostCommit;typeof B=="function"&&B(A,i.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ae){nr(i,i.return,ae)}}else Ba(a,i,c,d);break;case 13:Ba(a,i,c,d);break;case 23:break;case 22:b=i.stateNode,A=i.alternate,i.memoizedState!==null?b._visibility&2?Ba(a,i,c,d):Gl(a,i):b._visibility&2?Ba(a,i,c,d):(b._visibility|=2,To(a,i,c,d,(i.subtreeFlags&10256)!==0)),x&2048&&fh(A,i);break;case 24:Ba(a,i,c,d),x&2048&&hh(i.alternate,i);break;default:Ba(a,i,c,d)}}function To(a,i,c,d,x){for(x=x&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var b=a,A=i,B=c,ae=d,be=A.flags;switch(A.tag){case 0:case 11:case 15:To(b,A,B,ae,x),Hl(8,A);break;case 23:break;case 22:var Me=A.stateNode;A.memoizedState!==null?Me._visibility&2?To(b,A,B,ae,x):Gl(b,A):(Me._visibility|=2,To(b,A,B,ae,x)),x&&be&2048&&fh(A.alternate,A);break;case 24:To(b,A,B,ae,x),x&&be&2048&&hh(A.alternate,A);break;default:To(b,A,B,ae,x)}i=i.sibling}}function Gl(a,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var c=a,d=i,x=d.flags;switch(d.tag){case 22:Gl(c,d),x&2048&&fh(d.alternate,d);break;case 24:Gl(c,d),x&2048&&hh(d.alternate,d);break;default:Gl(c,d)}i=i.sibling}}var ql=8192;function Eo(a){if(a.subtreeFlags&ql)for(a=a.child;a!==null;)Q1(a),a=a.sibling}function Q1(a){switch(a.tag){case 26:Eo(a),a.flags&ql&&a.memoizedState!==null&&iE(wa,a.memoizedState,a.memoizedProps);break;case 5:Eo(a);break;case 3:case 4:var i=wa;wa=fd(a.stateNode.containerInfo),Eo(a),wa=i;break;case 22:a.memoizedState===null&&(i=a.alternate,i!==null&&i.memoizedState!==null?(i=ql,ql=16777216,Eo(a),ql=i):Eo(a));break;default:Eo(a)}}function Z1(a){var i=a.alternate;if(i!==null&&(a=i.child,a!==null)){i.child=null;do i=a.sibling,a.sibling=null,a=i;while(a!==null)}}function $l(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];qr=d,ey(d,a)}Z1(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)J1(a),a=a.sibling}function J1(a){switch(a.tag){case 0:case 11:case 15:$l(a),a.flags&2048&&Ls(9,a,a.return);break;case 3:$l(a);break;case 12:$l(a);break;case 22:var i=a.stateNode;a.memoizedState!==null&&i._visibility&2&&(a.return===null||a.return.tag!==13)?(i._visibility&=-3,ed(a)):$l(a);break;default:$l(a)}}function ed(a){var i=a.deletions;if((a.flags&16)!==0){if(i!==null)for(var c=0;c<i.length;c++){var d=i[c];qr=d,ey(d,a)}Z1(a)}for(a=a.child;a!==null;){switch(i=a,i.tag){case 0:case 11:case 15:Ls(8,i,i.return),ed(i);break;case 22:c=i.stateNode,c._visibility&2&&(c._visibility&=-3,ed(i));break;default:ed(i)}a=a.sibling}}function ey(a,i){for(;qr!==null;){var c=qr;switch(c.tag){case 0:case 11:case 15:Ls(8,c,i);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:jl(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,qr=d;else e:for(c=a;qr!==null;){d=qr;var x=d.sibling,b=d.return;if(G1(d),d===c){qr=null;break e}if(x!==null){x.return=b,qr=x;break e}qr=b}}}var ST={getCacheForType:function(a){var i=hn(Ir),c=i.data.get(a);return c===void 0&&(c=a(),i.data.set(a,c)),c}},NT=typeof WeakMap=="function"?WeakMap:Map,Yt=0,sr=null,jt=null,kt=0,Gt=0,Yn=null,Us=!1,_o=!1,mh=!1,cs=0,br=0,Is=0,Di=0,ph=0,ia=0,Co=0,Wl=null,Dn=null,xh=!1,gh=0,td=1/0,rd=null,zs=null,tn=0,Vs=null,Ao=null,jo=0,yh=0,vh=null,ty=null,Xl=0,bh=null;function Gn(){if((Yt&2)!==0&&kt!==0)return kt&-kt;if(F.T!==null){var a=xo;return a!==0?a:Ch()}return Jr()}function ry(){ia===0&&(ia=(kt&536870912)===0||Pt?I():536870912);var a=sa.current;return a!==null&&(a.flags|=32),ia}function qn(a,i,c){(a===sr&&(Gt===2||Gt===9)||a.cancelPendingCommit!==null)&&(Do(a,0),Hs(a,kt,ia,!1)),Ie(a,c),((Yt&2)===0||a!==sr)&&(a===sr&&((Yt&2)===0&&(Di|=c),br===4&&Hs(a,kt,ia,!1)),Ua(a))}function ny(a,i,c){if((Yt&6)!==0)throw Error(n(327));var d=!c&&(i&124)===0&&(i&a.expiredLanes)===0||Er(a,i),x=d?_T(a,i):Nh(a,i,!0),b=d;do{if(x===0){_o&&!d&&Hs(a,i,0,!1);break}else{if(c=a.current.alternate,b&&!TT(c)){x=Nh(a,i,!1),b=!1;continue}if(x===2){if(b=i,a.errorRecoveryDisabledLanes&b)var A=0;else A=a.pendingLanes&-536870913,A=A!==0?A:A&536870912?536870912:0;if(A!==0){i=A;e:{var B=a;x=Wl;var ae=B.current.memoizedState.isDehydrated;if(ae&&(Do(B,A).flags|=256),A=Nh(B,A,!1),A!==2){if(mh&&!ae){B.errorRecoveryDisabledLanes|=b,Di|=b,x=4;break e}b=Dn,Dn=x,b!==null&&(Dn===null?Dn=b:Dn.push.apply(Dn,b))}x=A}if(b=!1,x!==2)continue}}if(x===1){Do(a,0),Hs(a,i,0,!0);break}e:{switch(d=a,b=x,b){case 0:case 1:throw Error(n(345));case 4:if((i&4194048)!==i)break;case 6:Hs(d,i,ia,!Us);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((i&62914560)===i&&(x=gh+300-_e(),10<x)){if(Hs(d,i,ia,!Us),dn(d,0,!0)!==0)break e;d.timeoutHandle=Oy(ay.bind(null,d,c,Dn,rd,xh,i,ia,Di,Co,Us,b,2,-0,0),x);break e}ay(d,c,Dn,rd,xh,i,ia,Di,Co,Us,b,0,-0,0)}}break}while(!0);Ua(a)}function ay(a,i,c,d,x,b,A,B,ae,be,Me,Le,Ne,Ee){if(a.timeoutHandle=-1,Le=i.subtreeFlags,(Le&8192||(Le&16785408)===16785408)&&(rc={stylesheets:null,count:0,unsuspend:sE},Q1(i),Le=oE(),Le!==null)){a.cancelPendingCommit=Le(dy.bind(null,a,i,b,c,d,x,A,B,ae,Me,1,Ne,Ee)),Hs(a,b,A,!be);return}dy(a,i,b,c,d,x,A,B,ae)}function TT(a){for(var i=a;;){var c=i.tag;if((c===0||c===11||c===15)&&i.flags&16384&&(c=i.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var x=c[d],b=x.getSnapshot;x=x.value;try{if(!In(b(),x))return!1}catch{return!1}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Hs(a,i,c,d){i&=~ph,i&=~Di,a.suspendedLanes|=i,a.pingedLanes&=~i,d&&(a.warmLanes|=i),d=a.expirationTimes;for(var x=i;0<x;){var b=31-Ft(x),A=1<<b;d[b]=-1,x&=~A}c!==0&&lt(a,c,i)}function nd(){return(Yt&6)===0?(Kl(0),!1):!0}function wh(){if(jt!==null){if(Gt===0)var a=jt.return;else a=jt,ts=Ti=null,B0(a),So=null,Il=0,a=jt;for(;a!==null;)P1(a.alternate,a),a=a.return;jt=null}}function Do(a,i){var c=a.timeoutHandle;c!==-1&&(a.timeoutHandle=-1,VT(c)),c=a.cancelPendingCommit,c!==null&&(a.cancelPendingCommit=null,c()),wh(),sr=a,jt=c=Za(a.current,null),kt=i,Gt=0,Yn=null,Us=!1,_o=Er(a,i),mh=!1,Co=ia=ph=Di=Is=br=0,Dn=Wl=null,xh=!1,(i&8)!==0&&(i|=i&32);var d=a.entangledLanes;if(d!==0)for(a=a.entanglements,d&=i;0<d;){var x=31-Ft(d),b=1<<x;i|=a[x],d&=~b}return cs=i,Eu(),c}function sy(a,i){Et=null,F.H=Yu,i===kl||i===Mu?(i=Sg(),Gt=3):i===vg?(i=Sg(),Gt=4):Gt=i===N1?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Yn=i,jt===null&&(br=1,Xu(a,ta(i,a.current)))}function iy(){var a=F.H;return F.H=Yu,a===null?Yu:a}function oy(){var a=F.A;return F.A=ST,a}function Sh(){br=4,Us||(kt&4194048)!==kt&&sa.current!==null||(_o=!0),(Is&134217727)===0&&(Di&134217727)===0||sr===null||Hs(sr,kt,ia,!1)}function Nh(a,i,c){var d=Yt;Yt|=2;var x=iy(),b=oy();(sr!==a||kt!==i)&&(rd=null,Do(a,i)),i=!1;var A=br;e:do try{if(Gt!==0&&jt!==null){var B=jt,ae=Yn;switch(Gt){case 8:wh(),A=6;break e;case 3:case 2:case 9:case 6:sa.current===null&&(i=!0);var be=Gt;if(Gt=0,Yn=null,ko(a,B,ae,be),c&&_o){A=0;break e}break;default:be=Gt,Gt=0,Yn=null,ko(a,B,ae,be)}}ET(),A=br;break}catch(Me){sy(a,Me)}while(!0);return i&&a.shellSuspendCounter++,ts=Ti=null,Yt=d,F.H=x,F.A=b,jt===null&&(sr=null,kt=0,Eu()),A}function ET(){for(;jt!==null;)ly(jt)}function _T(a,i){var c=Yt;Yt|=2;var d=iy(),x=oy();sr!==a||kt!==i?(rd=null,td=_e()+500,Do(a,i)):_o=Er(a,i);e:do try{if(Gt!==0&&jt!==null){i=jt;var b=Yn;t:switch(Gt){case 1:Gt=0,Yn=null,ko(a,i,b,1);break;case 2:case 9:if(bg(b)){Gt=0,Yn=null,cy(i);break}i=function(){Gt!==2&&Gt!==9||sr!==a||(Gt=7),Ua(a)},b.then(i,i);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:bg(b)?(Gt=0,Yn=null,cy(i)):(Gt=0,Yn=null,ko(a,i,b,7));break;case 5:var A=null;switch(jt.tag){case 26:A=jt.memoizedState;case 5:case 27:var B=jt;if(!A||Yy(A)){Gt=0,Yn=null;var ae=B.sibling;if(ae!==null)jt=ae;else{var be=B.return;be!==null?(jt=be,ad(be)):jt=null}break t}}Gt=0,Yn=null,ko(a,i,b,5);break;case 6:Gt=0,Yn=null,ko(a,i,b,6);break;case 8:wh(),br=6;break e;default:throw Error(n(462))}}CT();break}catch(Me){sy(a,Me)}while(!0);return ts=Ti=null,F.H=d,F.A=x,Yt=c,jt!==null?0:(sr=null,kt=0,Eu(),br)}function CT(){for(;jt!==null&&!ge();)ly(jt)}function ly(a){var i=F1(a.alternate,a,cs);a.memoizedProps=a.pendingProps,i===null?ad(a):jt=i}function cy(a){var i=a,c=i.alternate;switch(i.tag){case 15:case 0:i=j1(c,i,i.pendingProps,i.type,void 0,kt);break;case 11:i=j1(c,i,i.pendingProps,i.type.render,i.ref,kt);break;case 5:B0(i);default:P1(c,i),i=jt=ug(i,cs),i=F1(c,i,cs)}a.memoizedProps=a.pendingProps,i===null?ad(a):jt=i}function ko(a,i,c,d){ts=Ti=null,B0(i),So=null,Il=0;var x=i.return;try{if(xT(a,x,i,c,kt)){br=1,Xu(a,ta(c,a.current)),jt=null;return}}catch(b){if(x!==null)throw jt=x,b;br=1,Xu(a,ta(c,a.current)),jt=null;return}i.flags&32768?(Pt||d===1?a=!0:_o||(kt&536870912)!==0?a=!1:(Us=a=!0,(d===2||d===9||d===3||d===6)&&(d=sa.current,d!==null&&d.tag===13&&(d.flags|=16384))),uy(i,a)):ad(i)}function ad(a){var i=a;do{if((i.flags&32768)!==0){uy(i,Us);return}a=i.return;var c=yT(i.alternate,i,cs);if(c!==null){jt=c;return}if(i=i.sibling,i!==null){jt=i;return}jt=i=a}while(i!==null);br===0&&(br=5)}function uy(a,i){do{var c=vT(a.alternate,a);if(c!==null){c.flags&=32767,jt=c;return}if(c=a.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!i&&(a=a.sibling,a!==null)){jt=a;return}jt=a=c}while(a!==null);br=6,jt=null}function dy(a,i,c,d,x,b,A,B,ae){a.cancelPendingCommit=null;do sd();while(tn!==0);if((Yt&6)!==0)throw Error(n(327));if(i!==null){if(i===a.current)throw Error(n(177));if(b=i.lanes|i.childLanes,b|=h0,st(a,c,b,A,B,ae),a===sr&&(jt=sr=null,kt=0),Ao=i,Vs=a,jo=c,yh=b,vh=x,ty=d,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,kT(ot,function(){return xy(),null})):(a.callbackNode=null,a.callbackPriority=0),d=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||d){d=F.T,F.T=null,x=Z.p,Z.p=2,A=Yt,Yt|=4;try{bT(a,i,c)}finally{Yt=A,Z.p=x,F.T=d}}tn=1,fy(),hy(),my()}}function fy(){if(tn===1){tn=0;var a=Vs,i=Ao,c=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||c){c=F.T,F.T=null;var d=Z.p;Z.p=2;var x=Yt;Yt|=4;try{W1(i,a);var b=Fh,A=eg(a.containerInfo),B=b.focusedElem,ae=b.selectionRange;if(A!==B&&B&&B.ownerDocument&&Jx(B.ownerDocument.documentElement,B)){if(ae!==null&&l0(B)){var be=ae.start,Me=ae.end;if(Me===void 0&&(Me=be),"selectionStart"in B)B.selectionStart=be,B.selectionEnd=Math.min(Me,B.value.length);else{var Le=B.ownerDocument||document,Ne=Le&&Le.defaultView||window;if(Ne.getSelection){var Ee=Ne.getSelection(),mt=B.textContent.length,dt=Math.min(ae.start,mt),Jt=ae.end===void 0?dt:Math.min(ae.end,mt);!Ee.extend&&dt>Jt&&(A=Jt,Jt=dt,dt=A);var he=Zx(B,dt),ue=Zx(B,Jt);if(he&&ue&&(Ee.rangeCount!==1||Ee.anchorNode!==he.node||Ee.anchorOffset!==he.offset||Ee.focusNode!==ue.node||Ee.focusOffset!==ue.offset)){var ye=Le.createRange();ye.setStart(he.node,he.offset),Ee.removeAllRanges(),dt>Jt?(Ee.addRange(ye),Ee.extend(ue.node,ue.offset)):(ye.setEnd(ue.node,ue.offset),Ee.addRange(ye))}}}}for(Le=[],Ee=B;Ee=Ee.parentNode;)Ee.nodeType===1&&Le.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<Le.length;B++){var Fe=Le[B];Fe.element.scrollLeft=Fe.left,Fe.element.scrollTop=Fe.top}}gd=!!Mh,Fh=Mh=null}finally{Yt=x,Z.p=d,F.T=c}}a.current=i,tn=2}}function hy(){if(tn===2){tn=0;var a=Vs,i=Ao,c=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||c){c=F.T,F.T=null;var d=Z.p;Z.p=2;var x=Yt;Yt|=4;try{Y1(a,i.alternate,i)}finally{Yt=x,Z.p=d,F.T=c}}tn=3}}function my(){if(tn===4||tn===3){tn=0,Ce();var a=Vs,i=Ao,c=jo,d=ty;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?tn=5:(tn=0,Ao=Vs=null,py(a,a.pendingLanes));var x=a.pendingLanes;if(x===0&&(zs=null),Yr(c),i=i.stateNode,Xe&&typeof Xe.onCommitFiberRoot=="function")try{Xe.onCommitFiberRoot(Qe,i,void 0,(i.current.flags&128)===128)}catch{}if(d!==null){i=F.T,x=Z.p,Z.p=2,F.T=null;try{for(var b=a.onRecoverableError,A=0;A<d.length;A++){var B=d[A];b(B.value,{componentStack:B.stack})}}finally{F.T=i,Z.p=x}}(jo&3)!==0&&sd(),Ua(a),x=a.pendingLanes,(c&4194090)!==0&&(x&42)!==0?a===bh?Xl++:(Xl=0,bh=a):Xl=0,Kl(0)}}function py(a,i){(a.pooledCacheLanes&=i)===0&&(i=a.pooledCache,i!=null&&(a.pooledCache=null,jl(i)))}function sd(a){return fy(),hy(),my(),xy()}function xy(){if(tn!==5)return!1;var a=Vs,i=yh;yh=0;var c=Yr(jo),d=F.T,x=Z.p;try{Z.p=32>c?32:c,F.T=null,c=vh,vh=null;var b=Vs,A=jo;if(tn=0,Ao=Vs=null,jo=0,(Yt&6)!==0)throw Error(n(331));var B=Yt;if(Yt|=4,J1(b.current),K1(b,b.current,A,c),Yt=B,Kl(0,!1),Xe&&typeof Xe.onPostCommitFiberRoot=="function")try{Xe.onPostCommitFiberRoot(Qe,b)}catch{}return!0}finally{Z.p=x,F.T=d,py(a,i)}}function gy(a,i,c){i=ta(c,i),i=Z0(a.stateNode,i,2),a=Os(a,i,2),a!==null&&(Ie(a,2),Ua(a))}function nr(a,i,c){if(a.tag===3)gy(a,a,c);else for(;i!==null;){if(i.tag===3){gy(i,a,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(zs===null||!zs.has(d))){a=ta(c,a),c=w1(2),d=Os(i,c,2),d!==null&&(S1(c,d,i,a),Ie(d,2),Ua(d));break}}i=i.return}}function Th(a,i,c){var d=a.pingCache;if(d===null){d=a.pingCache=new NT;var x=new Set;d.set(i,x)}else x=d.get(i),x===void 0&&(x=new Set,d.set(i,x));x.has(c)||(mh=!0,x.add(c),a=AT.bind(null,a,i,c),i.then(a,a))}function AT(a,i,c){var d=a.pingCache;d!==null&&d.delete(i),a.pingedLanes|=a.suspendedLanes&c,a.warmLanes&=~c,sr===a&&(kt&c)===c&&(br===4||br===3&&(kt&62914560)===kt&&300>_e()-gh?(Yt&2)===0&&Do(a,0):ph|=c,Co===kt&&(Co=0)),Ua(a)}function yy(a,i){i===0&&(i=Se()),a=fo(a,i),a!==null&&(Ie(a,i),Ua(a))}function jT(a){var i=a.memoizedState,c=0;i!==null&&(c=i.retryLane),yy(a,c)}function DT(a,i){var c=0;switch(a.tag){case 13:var d=a.stateNode,x=a.memoizedState;x!==null&&(c=x.retryLane);break;case 19:d=a.stateNode;break;case 22:d=a.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(i),yy(a,c)}function kT(a,i){return Ve(a,i)}var id=null,Oo=null,Eh=!1,od=!1,_h=!1,ki=0;function Ua(a){a!==Oo&&a.next===null&&(Oo===null?id=Oo=a:Oo=Oo.next=a),od=!0,Eh||(Eh=!0,RT())}function Kl(a,i){if(!_h&&od){_h=!0;do for(var c=!1,d=id;d!==null;){if(a!==0){var x=d.pendingLanes;if(x===0)var b=0;else{var A=d.suspendedLanes,B=d.pingedLanes;b=(1<<31-Ft(42|a)+1)-1,b&=x&~(A&~B),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,Sy(d,b))}else b=kt,b=dn(d,d===sr?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(b&3)===0||Er(d,b)||(c=!0,Sy(d,b));d=d.next}while(c);_h=!1}}function OT(){vy()}function vy(){od=Eh=!1;var a=0;ki!==0&&(zT()&&(a=ki),ki=0);for(var i=_e(),c=null,d=id;d!==null;){var x=d.next,b=by(d,i);b===0?(d.next=null,c===null?id=x:c.next=x,x===null&&(Oo=c)):(c=d,(a!==0||(b&3)!==0)&&(od=!0)),d=x}Kl(a)}function by(a,i){for(var c=a.suspendedLanes,d=a.pingedLanes,x=a.expirationTimes,b=a.pendingLanes&-62914561;0<b;){var A=31-Ft(b),B=1<<A,ae=x[A];ae===-1?((B&c)===0||(B&d)!==0)&&(x[A]=Un(B,i)):ae<=i&&(a.expiredLanes|=B),b&=~B}if(i=sr,c=kt,c=dn(a,a===i?c:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d=a.callbackNode,c===0||a===i&&(Gt===2||Gt===9)||a.cancelPendingCommit!==null)return d!==null&&d!==null&&He(d),a.callbackNode=null,a.callbackPriority=0;if((c&3)===0||Er(a,c)){if(i=c&-c,i===a.callbackPriority)return i;switch(d!==null&&He(d),Yr(c)){case 2:case 8:c=rt;break;case 32:c=ot;break;case 268435456:c=Ze;break;default:c=ot}return d=wy.bind(null,a),c=Ve(c,d),a.callbackPriority=i,a.callbackNode=c,i}return d!==null&&d!==null&&He(d),a.callbackPriority=2,a.callbackNode=null,2}function wy(a,i){if(tn!==0&&tn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var c=a.callbackNode;if(sd()&&a.callbackNode!==c)return null;var d=kt;return d=dn(a,a===sr?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d===0?null:(ny(a,d,i),by(a,_e()),a.callbackNode!=null&&a.callbackNode===c?wy.bind(null,a):null)}function Sy(a,i){if(sd())return null;ny(a,i,!0)}function RT(){HT(function(){(Yt&6)!==0?Ve(Ke,OT):vy()})}function Ch(){return ki===0&&(ki=I()),ki}function Ny(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Ka(""+a)}function Ty(a,i){var c=i.ownerDocument.createElement("input");return c.name=i.name,c.value=i.value,a.id&&c.setAttribute("form",a.id),i.parentNode.insertBefore(c,i),a=new FormData(a),c.parentNode.removeChild(c),a}function MT(a,i,c,d,x){if(i==="submit"&&c&&c.stateNode===x){var b=Ny((x[Lt]||null).action),A=d.submitter;A&&(i=(i=A[Lt]||null)?Ny(i.formAction):A.getAttribute("formAction"),i!==null&&(b=i,A=null));var B=new Su("action","action",null,d,x);a.push({event:B,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(ki!==0){var ae=A?Ty(x,A):new FormData(x);$0(c,{pending:!0,data:ae,method:x.method,action:b},null,ae)}}else typeof b=="function"&&(B.preventDefault(),ae=A?Ty(x,A):new FormData(x),$0(c,{pending:!0,data:ae,method:x.method,action:b},b,ae))},currentTarget:x}]})}}for(var Ah=0;Ah<f0.length;Ah++){var jh=f0[Ah],FT=jh.toLowerCase(),LT=jh[0].toUpperCase()+jh.slice(1);ba(FT,"on"+LT)}ba(ng,"onAnimationEnd"),ba(ag,"onAnimationIteration"),ba(sg,"onAnimationStart"),ba("dblclick","onDoubleClick"),ba("focusin","onFocus"),ba("focusout","onBlur"),ba(JN,"onTransitionRun"),ba(eT,"onTransitionStart"),ba(tT,"onTransitionCancel"),ba(ig,"onTransitionEnd"),se("onMouseEnter",["mouseout","mouseover"]),se("onMouseLeave",["mouseout","mouseover"]),se("onPointerEnter",["pointerout","pointerover"]),se("onPointerLeave",["pointerout","pointerover"]),L("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),L("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),L("onBeforeInput",["compositionend","keypress","textInput","paste"]),L("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),L("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),L("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PT=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ql));function Ey(a,i){i=(i&4)!==0;for(var c=0;c<a.length;c++){var d=a[c],x=d.event;d=d.listeners;e:{var b=void 0;if(i)for(var A=d.length-1;0<=A;A--){var B=d[A],ae=B.instance,be=B.currentTarget;if(B=B.listener,ae!==b&&x.isPropagationStopped())break e;b=B,x.currentTarget=be;try{b(x)}catch(Me){Wu(Me)}x.currentTarget=null,b=ae}else for(A=0;A<d.length;A++){if(B=d[A],ae=B.instance,be=B.currentTarget,B=B.listener,ae!==b&&x.isPropagationStopped())break e;b=B,x.currentTarget=be;try{b(x)}catch(Me){Wu(Me)}x.currentTarget=null,b=ae}}}}function Dt(a,i){var c=i[Ra];c===void 0&&(c=i[Ra]=new Set);var d=a+"__bubble";c.has(d)||(_y(i,a,2,!1),c.add(d))}function Dh(a,i,c){var d=0;i&&(d|=4),_y(c,a,d,i)}var ld="_reactListening"+Math.random().toString(36).slice(2);function kh(a){if(!a[ld]){a[ld]=!0,we.forEach(function(c){c!=="selectionchange"&&(PT.has(c)||Dh(c,!1,a),Dh(c,!0,a))});var i=a.nodeType===9?a:a.ownerDocument;i===null||i[ld]||(i[ld]=!0,Dh("selectionchange",!1,i))}}function _y(a,i,c,d){switch(Ky(i)){case 2:var x=uE;break;case 8:x=dE;break;default:x=Gh}c=x.bind(null,i,c,a),x=void 0,!Jf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),d?x!==void 0?a.addEventListener(i,c,{capture:!0,passive:x}):a.addEventListener(i,c,!0):x!==void 0?a.addEventListener(i,c,{passive:x}):a.addEventListener(i,c,!1)}function Oh(a,i,c,d,x){var b=d;if((i&1)===0&&(i&2)===0&&d!==null)e:for(;;){if(d===null)return;var A=d.tag;if(A===3||A===4){var B=d.stateNode.containerInfo;if(B===x)break;if(A===4)for(A=d.return;A!==null;){var ae=A.tag;if((ae===3||ae===4)&&A.stateNode.containerInfo===x)return;A=A.return}for(;B!==null;){if(A=Q(B),A===null)return;if(ae=A.tag,ae===5||ae===6||ae===26||ae===27){d=b=A;continue e}B=B.parentNode}}d=d.return}Rx(function(){var be=b,Me=io(c),Le=[];e:{var Ne=og.get(a);if(Ne!==void 0){var Ee=Su,mt=a;switch(a){case"keypress":if(bu(c)===0)break e;case"keydown":case"keyup":Ee=kN;break;case"focusin":mt="focus",Ee=n0;break;case"focusout":mt="blur",Ee=n0;break;case"beforeblur":case"afterblur":Ee=n0;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Lx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=vN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=MN;break;case ng:case ag:case sg:Ee=SN;break;case ig:Ee=LN;break;case"scroll":case"scrollend":Ee=gN;break;case"wheel":Ee=BN;break;case"copy":case"cut":case"paste":Ee=TN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Bx;break;case"toggle":case"beforetoggle":Ee=IN}var dt=(i&4)!==0,Jt=!dt&&(a==="scroll"||a==="scrollend"),he=dt?Ne!==null?Ne+"Capture":null:Ne;dt=[];for(var ue=be,ye;ue!==null;){var Fe=ue;if(ye=Fe.stateNode,Fe=Fe.tag,Fe!==5&&Fe!==26&&Fe!==27||ye===null||he===null||(Fe=xl(ue,he),Fe!=null&&dt.push(Zl(ue,Fe,ye))),Jt)break;ue=ue.return}0<dt.length&&(Ne=new Ee(Ne,mt,null,c,Me),Le.push({event:Ne,listeners:dt}))}}if((i&7)===0){e:{if(Ne=a==="mouseover"||a==="pointerover",Ee=a==="mouseout"||a==="pointerout",Ne&&c!==Cs&&(mt=c.relatedTarget||c.fromElement)&&(Q(mt)||mt[Br]))break e;if((Ee||Ne)&&(Ne=Me.window===Me?Me:(Ne=Me.ownerDocument)?Ne.defaultView||Ne.parentWindow:window,Ee?(mt=c.relatedTarget||c.toElement,Ee=be,mt=mt?Q(mt):null,mt!==null&&(Jt=l(mt),dt=mt.tag,mt!==Jt||dt!==5&&dt!==27&&dt!==6)&&(mt=null)):(Ee=null,mt=be),Ee!==mt)){if(dt=Lx,Fe="onMouseLeave",he="onMouseEnter",ue="mouse",(a==="pointerout"||a==="pointerover")&&(dt=Bx,Fe="onPointerLeave",he="onPointerEnter",ue="pointer"),Jt=Ee==null?Ne:ve(Ee),ye=mt==null?Ne:ve(mt),Ne=new dt(Fe,ue+"leave",Ee,c,Me),Ne.target=Jt,Ne.relatedTarget=ye,Fe=null,Q(Me)===be&&(dt=new dt(he,ue+"enter",mt,c,Me),dt.target=ye,dt.relatedTarget=Jt,Fe=dt),Jt=Fe,Ee&&mt)t:{for(dt=Ee,he=mt,ue=0,ye=dt;ye;ye=Ro(ye))ue++;for(ye=0,Fe=he;Fe;Fe=Ro(Fe))ye++;for(;0<ue-ye;)dt=Ro(dt),ue--;for(;0<ye-ue;)he=Ro(he),ye--;for(;ue--;){if(dt===he||he!==null&&dt===he.alternate)break t;dt=Ro(dt),he=Ro(he)}dt=null}else dt=null;Ee!==null&&Cy(Le,Ne,Ee,dt,!1),mt!==null&&Jt!==null&&Cy(Le,Jt,mt,dt,!0)}}e:{if(Ne=be?ve(be):window,Ee=Ne.nodeName&&Ne.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&Ne.type==="file")var tt=qx;else if(Yx(Ne))if($x)tt=KN;else{tt=WN;var Ct=$N}else Ee=Ne.nodeName,!Ee||Ee.toLowerCase()!=="input"||Ne.type!=="checkbox"&&Ne.type!=="radio"?be&&ao(be.elementType)&&(tt=qx):tt=XN;if(tt&&(tt=tt(a,be))){Gx(Le,tt,c,Me);break e}Ct&&Ct(a,Ne,be),a==="focusout"&&be&&Ne.type==="number"&&be.memoizedProps.value!=null&&_s(Ne,"number",Ne.value)}switch(Ct=be?ve(be):window,a){case"focusin":(Yx(Ct)||Ct.contentEditable==="true")&&(lo=Ct,c0=be,Tl=null);break;case"focusout":Tl=c0=lo=null;break;case"mousedown":u0=!0;break;case"contextmenu":case"mouseup":case"dragend":u0=!1,tg(Le,c,Me);break;case"selectionchange":if(ZN)break;case"keydown":case"keyup":tg(Le,c,Me)}var it;if(s0)e:{switch(a){case"compositionstart":var ft="onCompositionStart";break e;case"compositionend":ft="onCompositionEnd";break e;case"compositionupdate":ft="onCompositionUpdate";break e}ft=void 0}else oo?Vx(a,c)&&(ft="onCompositionEnd"):a==="keydown"&&c.keyCode===229&&(ft="onCompositionStart");ft&&(Ux&&c.locale!=="ko"&&(oo||ft!=="onCompositionStart"?ft==="onCompositionEnd"&&oo&&(it=Mx()):(As=Me,e0="value"in As?As.value:As.textContent,oo=!0)),Ct=cd(be,ft),0<Ct.length&&(ft=new Px(ft,a,null,c,Me),Le.push({event:ft,listeners:Ct}),it?ft.data=it:(it=Hx(c),it!==null&&(ft.data=it)))),(it=VN?HN(a,c):YN(a,c))&&(ft=cd(be,"onBeforeInput"),0<ft.length&&(Ct=new Px("onBeforeInput","beforeinput",null,c,Me),Le.push({event:Ct,listeners:ft}),Ct.data=it)),MT(Le,a,be,c,Me)}Ey(Le,i)})}function Zl(a,i,c){return{instance:a,listener:i,currentTarget:c}}function cd(a,i){for(var c=i+"Capture",d=[];a!==null;){var x=a,b=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||b===null||(x=xl(a,c),x!=null&&d.unshift(Zl(a,x,b)),x=xl(a,i),x!=null&&d.push(Zl(a,x,b))),a.tag===3)return d;a=a.return}return[]}function Ro(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Cy(a,i,c,d,x){for(var b=i._reactName,A=[];c!==null&&c!==d;){var B=c,ae=B.alternate,be=B.stateNode;if(B=B.tag,ae!==null&&ae===d)break;B!==5&&B!==26&&B!==27||be===null||(ae=be,x?(be=xl(c,b),be!=null&&A.unshift(Zl(c,be,ae))):x||(be=xl(c,b),be!=null&&A.push(Zl(c,be,ae)))),c=c.return}A.length!==0&&a.push({event:i,listeners:A})}var BT=/\r\n?/g,UT=/\u0000|\uFFFD/g;function Ay(a){return(typeof a=="string"?a:""+a).replace(BT,`
`).replace(UT,"")}function jy(a,i){return i=Ay(i),Ay(a)===i}function ud(){}function Zt(a,i,c,d,x,b){switch(c){case"children":typeof d=="string"?i==="body"||i==="textarea"&&d===""||ea(a,d):(typeof d=="number"||typeof d=="bigint")&&i!=="body"&&ea(a,""+d);break;case"className":ct(a,"class",d);break;case"tabIndex":ct(a,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(a,c,d);break;case"style":ga(a,d,b);break;case"data":if(i!=="object"){ct(a,"data",d);break}case"src":case"href":if(d===""&&(i!=="a"||c!=="href")){a.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(c);break}d=Ka(""+d),a.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){a.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(i!=="input"&&Zt(a,i,"name",x.name,x,null),Zt(a,i,"formEncType",x.formEncType,x,null),Zt(a,i,"formMethod",x.formMethod,x,null),Zt(a,i,"formTarget",x.formTarget,x,null)):(Zt(a,i,"encType",x.encType,x,null),Zt(a,i,"method",x.method,x,null),Zt(a,i,"target",x.target,x,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(c);break}d=Ka(""+d),a.setAttribute(c,d);break;case"onClick":d!=null&&(a.onclick=ud);break;case"onScroll":d!=null&&Dt("scroll",a);break;case"onScrollEnd":d!=null&&Dt("scrollend",a);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(x.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"multiple":a.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":a.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){a.removeAttribute("xlink:href");break}c=Ka(""+d),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(c,""+d):a.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(c,""):a.removeAttribute(c);break;case"capture":case"download":d===!0?a.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(c,d):a.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?a.setAttribute(c,d):a.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?a.removeAttribute(c):a.setAttribute(c,d);break;case"popover":Dt("beforetoggle",a),Dt("toggle",a),Je(a,"popover",d);break;case"xlinkActuate":ut(a,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":ut(a,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":ut(a,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":ut(a,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":ut(a,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":ut(a,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":ut(a,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":ut(a,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":ut(a,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Je(a,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=so.get(c)||c,Je(a,c,d))}}function Rh(a,i,c,d,x,b){switch(c){case"style":ga(a,d,b);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(x.children!=null)throw Error(n(60));a.innerHTML=c}}break;case"children":typeof d=="string"?ea(a,d):(typeof d=="number"||typeof d=="bigint")&&ea(a,""+d);break;case"onScroll":d!=null&&Dt("scroll",a);break;case"onScrollEnd":d!=null&&Dt("scrollend",a);break;case"onClick":d!=null&&(a.onclick=ud);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Te.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),i=c.slice(2,x?c.length-7:void 0),b=a[Lt]||null,b=b!=null?b[c]:null,typeof b=="function"&&a.removeEventListener(i,b,x),typeof d=="function")){typeof b!="function"&&b!==null&&(c in a?a[c]=null:a.hasAttribute(c)&&a.removeAttribute(c)),a.addEventListener(i,d,x);break e}c in a?a[c]=d:d===!0?a.setAttribute(c,""):Je(a,c,d)}}}function rn(a,i,c){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Dt("error",a),Dt("load",a);var d=!1,x=!1,b;for(b in c)if(c.hasOwnProperty(b)){var A=c[b];if(A!=null)switch(b){case"src":d=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Zt(a,i,b,A,c,null)}}x&&Zt(a,i,"srcSet",c.srcSet,c,null),d&&Zt(a,i,"src",c.src,c,null);return;case"input":Dt("invalid",a);var B=b=A=x=null,ae=null,be=null;for(d in c)if(c.hasOwnProperty(d)){var Me=c[d];if(Me!=null)switch(d){case"name":x=Me;break;case"type":A=Me;break;case"checked":ae=Me;break;case"defaultChecked":be=Me;break;case"value":b=Me;break;case"defaultValue":B=Me;break;case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(n(137,i));break;default:Zt(a,i,d,Me,c,null)}}Ma(a,b,B,ae,be,A,x,!1),mi(a);return;case"select":Dt("invalid",a),d=A=b=null;for(x in c)if(c.hasOwnProperty(x)&&(B=c[x],B!=null))switch(x){case"value":b=B;break;case"defaultValue":A=B;break;case"multiple":d=B;default:Zt(a,i,x,B,c,null)}i=b,c=A,a.multiple=!!d,i!=null?Dr(a,!!d,i,!1):c!=null&&Dr(a,!!d,c,!0);return;case"textarea":Dt("invalid",a),b=x=d=null;for(A in c)if(c.hasOwnProperty(A)&&(B=c[A],B!=null))switch(A){case"value":d=B;break;case"defaultValue":x=B;break;case"children":b=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:Zt(a,i,A,B,c,null)}xa(a,d,x,b),mi(a);return;case"option":for(ae in c)if(c.hasOwnProperty(ae)&&(d=c[ae],d!=null))switch(ae){case"selected":a.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Zt(a,i,ae,d,c,null)}return;case"dialog":Dt("beforetoggle",a),Dt("toggle",a),Dt("cancel",a),Dt("close",a);break;case"iframe":case"object":Dt("load",a);break;case"video":case"audio":for(d=0;d<Ql.length;d++)Dt(Ql[d],a);break;case"image":Dt("error",a),Dt("load",a);break;case"details":Dt("toggle",a);break;case"embed":case"source":case"link":Dt("error",a),Dt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(be in c)if(c.hasOwnProperty(be)&&(d=c[be],d!=null))switch(be){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,i));default:Zt(a,i,be,d,c,null)}return;default:if(ao(i)){for(Me in c)c.hasOwnProperty(Me)&&(d=c[Me],d!==void 0&&Rh(a,i,Me,d,c,void 0));return}}for(B in c)c.hasOwnProperty(B)&&(d=c[B],d!=null&&Zt(a,i,B,d,c,null))}function IT(a,i,c,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,b=null,A=null,B=null,ae=null,be=null,Me=null;for(Ee in c){var Le=c[Ee];if(c.hasOwnProperty(Ee)&&Le!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":ae=Le;default:d.hasOwnProperty(Ee)||Zt(a,i,Ee,null,d,Le)}}for(var Ne in d){var Ee=d[Ne];if(Le=c[Ne],d.hasOwnProperty(Ne)&&(Ee!=null||Le!=null))switch(Ne){case"type":b=Ee;break;case"name":x=Ee;break;case"checked":be=Ee;break;case"defaultChecked":Me=Ee;break;case"value":A=Ee;break;case"defaultValue":B=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,i));break;default:Ee!==Le&&Zt(a,i,Ne,Ee,d,Le)}}pi(a,A,B,ae,be,Me,b,x);return;case"select":Ee=A=B=Ne=null;for(b in c)if(ae=c[b],c.hasOwnProperty(b)&&ae!=null)switch(b){case"value":break;case"multiple":Ee=ae;default:d.hasOwnProperty(b)||Zt(a,i,b,null,d,ae)}for(x in d)if(b=d[x],ae=c[x],d.hasOwnProperty(x)&&(b!=null||ae!=null))switch(x){case"value":Ne=b;break;case"defaultValue":B=b;break;case"multiple":A=b;default:b!==ae&&Zt(a,i,x,b,d,ae)}i=B,c=A,d=Ee,Ne!=null?Dr(a,!!c,Ne,!1):!!d!=!!c&&(i!=null?Dr(a,!!c,i,!0):Dr(a,!!c,c?[]:"",!1));return;case"textarea":Ee=Ne=null;for(B in c)if(x=c[B],c.hasOwnProperty(B)&&x!=null&&!d.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:Zt(a,i,B,null,d,x)}for(A in d)if(x=d[A],b=c[A],d.hasOwnProperty(A)&&(x!=null||b!=null))switch(A){case"value":Ne=x;break;case"defaultValue":Ee=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:x!==b&&Zt(a,i,A,x,d,b)}Jn(a,Ne,Ee);return;case"option":for(var mt in c)if(Ne=c[mt],c.hasOwnProperty(mt)&&Ne!=null&&!d.hasOwnProperty(mt))switch(mt){case"selected":a.selected=!1;break;default:Zt(a,i,mt,null,d,Ne)}for(ae in d)if(Ne=d[ae],Ee=c[ae],d.hasOwnProperty(ae)&&Ne!==Ee&&(Ne!=null||Ee!=null))switch(ae){case"selected":a.selected=Ne&&typeof Ne!="function"&&typeof Ne!="symbol";break;default:Zt(a,i,ae,Ne,d,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var dt in c)Ne=c[dt],c.hasOwnProperty(dt)&&Ne!=null&&!d.hasOwnProperty(dt)&&Zt(a,i,dt,null,d,Ne);for(be in d)if(Ne=d[be],Ee=c[be],d.hasOwnProperty(be)&&Ne!==Ee&&(Ne!=null||Ee!=null))switch(be){case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,i));break;default:Zt(a,i,be,Ne,d,Ee)}return;default:if(ao(i)){for(var Jt in c)Ne=c[Jt],c.hasOwnProperty(Jt)&&Ne!==void 0&&!d.hasOwnProperty(Jt)&&Rh(a,i,Jt,void 0,d,Ne);for(Me in d)Ne=d[Me],Ee=c[Me],!d.hasOwnProperty(Me)||Ne===Ee||Ne===void 0&&Ee===void 0||Rh(a,i,Me,Ne,d,Ee);return}}for(var he in c)Ne=c[he],c.hasOwnProperty(he)&&Ne!=null&&!d.hasOwnProperty(he)&&Zt(a,i,he,null,d,Ne);for(Le in d)Ne=d[Le],Ee=c[Le],!d.hasOwnProperty(Le)||Ne===Ee||Ne==null&&Ee==null||Zt(a,i,Le,Ne,d,Ee)}var Mh=null,Fh=null;function dd(a){return a.nodeType===9?a:a.ownerDocument}function Dy(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ky(a,i){if(a===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&i==="foreignObject"?0:a}function Lh(a,i){return a==="textarea"||a==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ph=null;function zT(){var a=window.event;return a&&a.type==="popstate"?a===Ph?!1:(Ph=a,!0):(Ph=null,!1)}var Oy=typeof setTimeout=="function"?setTimeout:void 0,VT=typeof clearTimeout=="function"?clearTimeout:void 0,Ry=typeof Promise=="function"?Promise:void 0,HT=typeof queueMicrotask=="function"?queueMicrotask:typeof Ry<"u"?function(a){return Ry.resolve(null).then(a).catch(YT)}:Oy;function YT(a){setTimeout(function(){throw a})}function Ys(a){return a==="head"}function My(a,i){var c=i,d=0,x=0;do{var b=c.nextSibling;if(a.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(0<d&&8>d){c=d;var A=a.ownerDocument;if(c&1&&Jl(A.documentElement),c&2&&Jl(A.body),c&4)for(c=A.head,Jl(c),A=c.firstChild;A;){var B=A.nextSibling,ae=A.nodeName;A[V]||ae==="SCRIPT"||ae==="STYLE"||ae==="LINK"&&A.rel.toLowerCase()==="stylesheet"||c.removeChild(A),A=B}}if(x===0){a.removeChild(b),oc(i);return}x--}else c==="$"||c==="$?"||c==="$!"?x++:d=c.charCodeAt(0)-48;else d=0;c=b}while(c);oc(i)}function Bh(a){var i=a.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var c=i;switch(i=i.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Bh(c),Y(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}a.removeChild(c)}}function GT(a,i,c,d){for(;a.nodeType===1;){var x=c;if(a.nodeName.toLowerCase()!==i.toLowerCase()){if(!d&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(d){if(!a[V])switch(i){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(b=a.getAttribute("rel"),b==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(b!==x.rel||a.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||a.getAttribute("title")!==(x.title==null?null:x.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(b=a.getAttribute("src"),(b!==(x.src==null?null:x.src)||a.getAttribute("type")!==(x.type==null?null:x.type)||a.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&b&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(i==="input"&&a.type==="hidden"){var b=x.name==null?null:""+x.name;if(x.type==="hidden"&&a.getAttribute("name")===b)return a}else return a;if(a=Sa(a.nextSibling),a===null)break}return null}function qT(a,i,c){if(i==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!c||(a=Sa(a.nextSibling),a===null))return null;return a}function Uh(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function $T(a,i){var c=a.ownerDocument;if(a.data!=="$?"||c.readyState==="complete")i();else{var d=function(){i(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),a._reactRetry=d}}function Sa(a){for(;a!=null;a=a.nextSibling){var i=a.nodeType;if(i===1||i===3)break;if(i===8){if(i=a.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return a}var Ih=null;function Fy(a){a=a.previousSibling;for(var i=0;a;){if(a.nodeType===8){var c=a.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return a;i--}else c==="/$"&&i++}a=a.previousSibling}return null}function Ly(a,i,c){switch(i=dd(c),a){case"html":if(a=i.documentElement,!a)throw Error(n(452));return a;case"head":if(a=i.head,!a)throw Error(n(453));return a;case"body":if(a=i.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function Jl(a){for(var i=a.attributes;i.length;)a.removeAttributeNode(i[0]);Y(a)}var oa=new Map,Py=new Set;function fd(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var us=Z.d;Z.d={f:WT,r:XT,D:KT,C:QT,L:ZT,m:JT,X:tE,S:eE,M:rE};function WT(){var a=us.f(),i=nd();return a||i}function XT(a){var i=ee(a);i!==null&&i.tag===5&&i.type==="form"?n1(i):us.r(a)}var Mo=typeof document>"u"?null:document;function By(a,i,c){var d=Mo;if(d&&typeof i=="string"&&i){var x=vt(i);x='link[rel="'+a+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),Py.has(x)||(Py.add(x),a={rel:a,crossOrigin:c,href:i},d.querySelector(x)===null&&(i=d.createElement("link"),rn(i,"link",a),pe(i),d.head.appendChild(i)))}}function KT(a){us.D(a),By("dns-prefetch",a,null)}function QT(a,i){us.C(a,i),By("preconnect",a,i)}function ZT(a,i,c){us.L(a,i,c);var d=Mo;if(d&&a&&i){var x='link[rel="preload"][as="'+vt(i)+'"]';i==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+vt(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+vt(c.imageSizes)+'"]')):x+='[href="'+vt(a)+'"]';var b=x;switch(i){case"style":b=Fo(a);break;case"script":b=Lo(a)}oa.has(b)||(a=p({rel:"preload",href:i==="image"&&c&&c.imageSrcSet?void 0:a,as:i},c),oa.set(b,a),d.querySelector(x)!==null||i==="style"&&d.querySelector(ec(b))||i==="script"&&d.querySelector(tc(b))||(i=d.createElement("link"),rn(i,"link",a),pe(i),d.head.appendChild(i)))}}function JT(a,i){us.m(a,i);var c=Mo;if(c&&a){var d=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+vt(d)+'"][href="'+vt(a)+'"]',b=x;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Lo(a)}if(!oa.has(b)&&(a=p({rel:"modulepreload",href:a},i),oa.set(b,a),c.querySelector(x)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(tc(b)))return}d=c.createElement("link"),rn(d,"link",a),pe(d),c.head.appendChild(d)}}}function eE(a,i,c){us.S(a,i,c);var d=Mo;if(d&&a){var x=De(d).hoistableStyles,b=Fo(a);i=i||"default";var A=x.get(b);if(!A){var B={loading:0,preload:null};if(A=d.querySelector(ec(b)))B.loading=5;else{a=p({rel:"stylesheet",href:a,"data-precedence":i},c),(c=oa.get(b))&&zh(a,c);var ae=A=d.createElement("link");pe(ae),rn(ae,"link",a),ae._p=new Promise(function(be,Me){ae.onload=be,ae.onerror=Me}),ae.addEventListener("load",function(){B.loading|=1}),ae.addEventListener("error",function(){B.loading|=2}),B.loading|=4,hd(A,i,d)}A={type:"stylesheet",instance:A,count:1,state:B},x.set(b,A)}}}function tE(a,i){us.X(a,i);var c=Mo;if(c&&a){var d=De(c).hoistableScripts,x=Lo(a),b=d.get(x);b||(b=c.querySelector(tc(x)),b||(a=p({src:a,async:!0},i),(i=oa.get(x))&&Vh(a,i),b=c.createElement("script"),pe(b),rn(b,"link",a),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(x,b))}}function rE(a,i){us.M(a,i);var c=Mo;if(c&&a){var d=De(c).hoistableScripts,x=Lo(a),b=d.get(x);b||(b=c.querySelector(tc(x)),b||(a=p({src:a,async:!0,type:"module"},i),(i=oa.get(x))&&Vh(a,i),b=c.createElement("script"),pe(b),rn(b,"link",a),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(x,b))}}function Uy(a,i,c,d){var x=(x=ce.current)?fd(x):null;if(!x)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(i=Fo(c.href),c=De(x).hoistableStyles,d=c.get(i),d||(d={type:"style",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){a=Fo(c.href);var b=De(x).hoistableStyles,A=b.get(a);if(A||(x=x.ownerDocument||x,A={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(a,A),(b=x.querySelector(ec(a)))&&!b._p&&(A.instance=b,A.state.loading=5),oa.has(a)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},oa.set(a,c),b||nE(x,a,c,A.state))),i&&d===null)throw Error(n(528,""));return A}if(i&&d!==null)throw Error(n(529,""));return null;case"script":return i=c.async,c=c.src,typeof c=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Lo(c),c=De(x).hoistableScripts,d=c.get(i),d||(d={type:"script",instance:null,count:0,state:null},c.set(i,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function Fo(a){return'href="'+vt(a)+'"'}function ec(a){return'link[rel="stylesheet"]['+a+"]"}function Iy(a){return p({},a,{"data-precedence":a.precedence,precedence:null})}function nE(a,i,c,d){a.querySelector('link[rel="preload"][as="style"]['+i+"]")?d.loading=1:(i=a.createElement("link"),d.preload=i,i.addEventListener("load",function(){return d.loading|=1}),i.addEventListener("error",function(){return d.loading|=2}),rn(i,"link",c),pe(i),a.head.appendChild(i))}function Lo(a){return'[src="'+vt(a)+'"]'}function tc(a){return"script[async]"+a}function zy(a,i,c){if(i.count++,i.instance===null)switch(i.type){case"style":var d=a.querySelector('style[data-href~="'+vt(c.href)+'"]');if(d)return i.instance=d,pe(d),d;var x=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(a.ownerDocument||a).createElement("style"),pe(d),rn(d,"style",x),hd(d,c.precedence,a),i.instance=d;case"stylesheet":x=Fo(c.href);var b=a.querySelector(ec(x));if(b)return i.state.loading|=4,i.instance=b,pe(b),b;d=Iy(c),(x=oa.get(x))&&zh(d,x),b=(a.ownerDocument||a).createElement("link"),pe(b);var A=b;return A._p=new Promise(function(B,ae){A.onload=B,A.onerror=ae}),rn(b,"link",d),i.state.loading|=4,hd(b,c.precedence,a),i.instance=b;case"script":return b=Lo(c.src),(x=a.querySelector(tc(b)))?(i.instance=x,pe(x),x):(d=c,(x=oa.get(b))&&(d=p({},c),Vh(d,x)),a=a.ownerDocument||a,x=a.createElement("script"),pe(x),rn(x,"link",d),a.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(n(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(d=i.instance,i.state.loading|=4,hd(d,c.precedence,a));return i.instance}function hd(a,i,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=d.length?d[d.length-1]:null,b=x,A=0;A<d.length;A++){var B=d[A];if(B.dataset.precedence===i)b=B;else if(b!==x)break}b?b.parentNode.insertBefore(a,b.nextSibling):(i=c.nodeType===9?c.head:c,i.insertBefore(a,i.firstChild))}function zh(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.title==null&&(a.title=i.title)}function Vh(a,i){a.crossOrigin==null&&(a.crossOrigin=i.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=i.referrerPolicy),a.integrity==null&&(a.integrity=i.integrity)}var md=null;function Vy(a,i,c){if(md===null){var d=new Map,x=md=new Map;x.set(c,d)}else x=md,d=x.get(c),d||(d=new Map,x.set(c,d));if(d.has(a))return d;for(d.set(a,null),c=c.getElementsByTagName(a),x=0;x<c.length;x++){var b=c[x];if(!(b[V]||b[ar]||a==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var A=b.getAttribute(i)||"";A=a+A;var B=d.get(A);B?B.push(b):d.set(A,[b])}}return d}function Hy(a,i,c){a=a.ownerDocument||a,a.head.insertBefore(c,i==="title"?a.querySelector("head > title"):null)}function aE(a,i,c){if(c===1||i.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return a=i.disabled,typeof i.precedence=="string"&&a==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Yy(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var rc=null;function sE(){}function iE(a,i,c){if(rc===null)throw Error(n(475));var d=rc;if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var x=Fo(c.href),b=a.querySelector(ec(x));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(d.count++,d=pd.bind(d),a.then(d,d)),i.state.loading|=4,i.instance=b,pe(b);return}b=a.ownerDocument||a,c=Iy(c),(x=oa.get(x))&&zh(c,x),b=b.createElement("link"),pe(b);var A=b;A._p=new Promise(function(B,ae){A.onload=B,A.onerror=ae}),rn(b,"link",c),i.instance=b}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(i,a),(a=i.state.preload)&&(i.state.loading&3)===0&&(d.count++,i=pd.bind(d),a.addEventListener("load",i),a.addEventListener("error",i))}}function oE(){if(rc===null)throw Error(n(475));var a=rc;return a.stylesheets&&a.count===0&&Hh(a,a.stylesheets),0<a.count?function(i){var c=setTimeout(function(){if(a.stylesheets&&Hh(a,a.stylesheets),a.unsuspend){var d=a.unsuspend;a.unsuspend=null,d()}},6e4);return a.unsuspend=i,function(){a.unsuspend=null,clearTimeout(c)}}:null}function pd(){if(this.count--,this.count===0){if(this.stylesheets)Hh(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var xd=null;function Hh(a,i){a.stylesheets=null,a.unsuspend!==null&&(a.count++,xd=new Map,i.forEach(lE,a),xd=null,pd.call(a))}function lE(a,i){if(!(i.state.loading&4)){var c=xd.get(a);if(c)var d=c.get(null);else{c=new Map,xd.set(a,c);for(var x=a.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<x.length;b++){var A=x[b];(A.nodeName==="LINK"||A.getAttribute("media")!=="not all")&&(c.set(A.dataset.precedence,A),d=A)}d&&c.set(null,d)}x=i.instance,A=x.getAttribute("data-precedence"),b=c.get(A)||d,b===d&&c.set(null,x),c.set(A,x),this.count++,d=pd.bind(this),x.addEventListener("load",d),x.addEventListener("error",d),b?b.parentNode.insertBefore(x,b.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(x,a.firstChild)),i.state.loading|=4}}var nc={$$typeof:T,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function cE(a,i,c,d,x,b,A,B){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ue(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.hiddenUpdates=Ue(null),this.identifierPrefix=d,this.onUncaughtError=x,this.onCaughtError=b,this.onRecoverableError=A,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function Gy(a,i,c,d,x,b,A,B,ae,be,Me,Le){return a=new cE(a,i,c,A,B,ae,be,Le),i=1,b===!0&&(i|=24),b=zn(3,null,null,i),a.current=b,b.stateNode=a,i=T0(),i.refCount++,a.pooledCache=i,i.refCount++,b.memoizedState={element:d,isDehydrated:c,cache:i},A0(b),a}function qy(a){return a?(a=ho,a):ho}function $y(a,i,c,d,x,b){x=qy(x),d.context===null?d.context=x:d.pendingContext=x,d=ks(i),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=Os(a,d,i),c!==null&&(qn(c,a,i),Rl(c,a,i))}function Wy(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var c=a.retryLane;a.retryLane=c!==0&&c<i?c:i}}function Yh(a,i){Wy(a,i),(a=a.alternate)&&Wy(a,i)}function Xy(a){if(a.tag===13){var i=fo(a,67108864);i!==null&&qn(i,a,67108864),Yh(a,67108864)}}var gd=!0;function uE(a,i,c,d){var x=F.T;F.T=null;var b=Z.p;try{Z.p=2,Gh(a,i,c,d)}finally{Z.p=b,F.T=x}}function dE(a,i,c,d){var x=F.T;F.T=null;var b=Z.p;try{Z.p=8,Gh(a,i,c,d)}finally{Z.p=b,F.T=x}}function Gh(a,i,c,d){if(gd){var x=qh(d);if(x===null)Oh(a,i,d,yd,c),Qy(a,d);else if(hE(x,a,i,c,d))d.stopPropagation();else if(Qy(a,d),i&4&&-1<fE.indexOf(a)){for(;x!==null;){var b=ee(x);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var A=Lr(b.pendingLanes);if(A!==0){var B=b;for(B.pendingLanes|=2,B.entangledLanes|=2;A;){var ae=1<<31-Ft(A);B.entanglements[1]|=ae,A&=~ae}Ua(b),(Yt&6)===0&&(td=_e()+500,Kl(0))}}break;case 13:B=fo(b,2),B!==null&&qn(B,b,2),nd(),Yh(b,2)}if(b=qh(d),b===null&&Oh(a,i,d,yd,c),b===x)break;x=b}x!==null&&d.stopPropagation()}else Oh(a,i,d,null,c)}}function qh(a){return a=io(a),$h(a)}var yd=null;function $h(a){if(yd=null,a=Q(a),a!==null){var i=l(a);if(i===null)a=null;else{var c=i.tag;if(c===13){if(a=u(i),a!==null)return a;a=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;a=null}else i!==a&&(a=null)}}return yd=a,null}function Ky(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case Ke:return 2;case rt:return 8;case ot:case At:return 32;case Ze:return 268435456;default:return 32}default:return 32}}var Wh=!1,Gs=null,qs=null,$s=null,ac=new Map,sc=new Map,Ws=[],fE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qy(a,i){switch(a){case"focusin":case"focusout":Gs=null;break;case"dragenter":case"dragleave":qs=null;break;case"mouseover":case"mouseout":$s=null;break;case"pointerover":case"pointerout":ac.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":sc.delete(i.pointerId)}}function ic(a,i,c,d,x,b){return a===null||a.nativeEvent!==b?(a={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:b,targetContainers:[x]},i!==null&&(i=ee(i),i!==null&&Xy(i)),a):(a.eventSystemFlags|=d,i=a.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),a)}function hE(a,i,c,d,x){switch(i){case"focusin":return Gs=ic(Gs,a,i,c,d,x),!0;case"dragenter":return qs=ic(qs,a,i,c,d,x),!0;case"mouseover":return $s=ic($s,a,i,c,d,x),!0;case"pointerover":var b=x.pointerId;return ac.set(b,ic(ac.get(b)||null,a,i,c,d,x)),!0;case"gotpointercapture":return b=x.pointerId,sc.set(b,ic(sc.get(b)||null,a,i,c,d,x)),!0}return!1}function Zy(a){var i=Q(a.target);if(i!==null){var c=l(i);if(c!==null){if(i=c.tag,i===13){if(i=u(c),i!==null){a.blockedOn=i,Pr(a.priority,function(){if(c.tag===13){var d=Gn();d=Ye(d);var x=fo(c,d);x!==null&&qn(x,c,d),Yh(c,d)}});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){a.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}a.blockedOn=null}function vd(a){if(a.blockedOn!==null)return!1;for(var i=a.targetContainers;0<i.length;){var c=qh(a.nativeEvent);if(c===null){c=a.nativeEvent;var d=new c.constructor(c.type,c);Cs=d,c.target.dispatchEvent(d),Cs=null}else return i=ee(c),i!==null&&Xy(i),a.blockedOn=c,!1;i.shift()}return!0}function Jy(a,i,c){vd(a)&&c.delete(i)}function mE(){Wh=!1,Gs!==null&&vd(Gs)&&(Gs=null),qs!==null&&vd(qs)&&(qs=null),$s!==null&&vd($s)&&($s=null),ac.forEach(Jy),sc.forEach(Jy)}function bd(a,i){a.blockedOn===i&&(a.blockedOn=null,Wh||(Wh=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,mE)))}var wd=null;function ev(a){wd!==a&&(wd=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){wd===a&&(wd=null);for(var i=0;i<a.length;i+=3){var c=a[i],d=a[i+1],x=a[i+2];if(typeof d!="function"){if($h(d||c)===null)continue;break}var b=ee(c);b!==null&&(a.splice(i,3),i-=3,$0(b,{pending:!0,data:x,method:c.method,action:d},d,x))}}))}function oc(a){function i(ae){return bd(ae,a)}Gs!==null&&bd(Gs,a),qs!==null&&bd(qs,a),$s!==null&&bd($s,a),ac.forEach(i),sc.forEach(i);for(var c=0;c<Ws.length;c++){var d=Ws[c];d.blockedOn===a&&(d.blockedOn=null)}for(;0<Ws.length&&(c=Ws[0],c.blockedOn===null);)Zy(c),c.blockedOn===null&&Ws.shift();if(c=(a.ownerDocument||a).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var x=c[d],b=c[d+1],A=x[Lt]||null;if(typeof b=="function")A||ev(c);else if(A){var B=null;if(b&&b.hasAttribute("formAction")){if(x=b,A=b[Lt]||null)B=A.formAction;else if($h(x)!==null)continue}else B=A.action;typeof B=="function"?c[d+1]=B:(c.splice(d,3),d-=3),ev(c)}}}function Xh(a){this._internalRoot=a}Sd.prototype.render=Xh.prototype.render=function(a){var i=this._internalRoot;if(i===null)throw Error(n(409));var c=i.current,d=Gn();$y(c,d,a,i,null,null)},Sd.prototype.unmount=Xh.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var i=a.containerInfo;$y(a.current,2,null,a,null,null),nd(),i[Br]=null}};function Sd(a){this._internalRoot=a}Sd.prototype.unstable_scheduleHydration=function(a){if(a){var i=Jr();a={blockedOn:null,target:a,priority:i};for(var c=0;c<Ws.length&&i!==0&&i<Ws[c].priority;c++);Ws.splice(c,0,a),c===0&&Zy(a)}};var tv=t.version;if(tv!=="19.1.0")throw Error(n(527,tv,"19.1.0"));Z.findDOMNode=function(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=m(i),a=a!==null?f(a):null,a=a===null?null:a.stateNode,a};var pE={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{Qe=Nd.inject(pE),Xe=Nd}catch{}}return cc.createRoot=function(a,i){if(!s(a))throw Error(n(299));var c=!1,d="",x=g1,b=y1,A=v1,B=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(b=i.onCaughtError),i.onRecoverableError!==void 0&&(A=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(B=i.unstable_transitionCallbacks)),i=Gy(a,1,!1,null,null,c,d,x,b,A,B,null),a[Br]=i.current,kh(a),new Xh(i)},cc.hydrateRoot=function(a,i,c){if(!s(a))throw Error(n(299));var d=!1,x="",b=g1,A=y1,B=v1,ae=null,be=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(A=c.onCaughtError),c.onRecoverableError!==void 0&&(B=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(ae=c.unstable_transitionCallbacks),c.formState!==void 0&&(be=c.formState)),i=Gy(a,1,!0,i,c??null,d,x,b,A,B,ae,be),i.context=qy(null),c=i.current,d=Gn(),d=Ye(d),x=ks(d),x.callback=null,Os(c,x,d),c=d,i.current.lanes=c,Ie(i,c),Ua(i),a[Br]=i.current,kh(a),new Sd(i)},cc.version="19.1.0",cc}var dv;function EE(){if(dv)return Zh.exports;dv=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Zh.exports=TE(),Zh.exports}var _E=EE(),uc={},fv;function CE(){if(fv)return uc;fv=1,Object.defineProperty(uc,"__esModule",{value:!0}),uc.parse=u,uc.serialize=f;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,l=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function u(y,v){const S=new l,N=y.length;if(N<2)return S;const w=(v==null?void 0:v.decode)||p;let E=0;do{const C=y.indexOf("=",E);if(C===-1)break;const T=y.indexOf(";",E),O=T===-1?N:T;if(C>O){E=y.lastIndexOf(";",C-1)+1;continue}const j=h(y,E,C),q=m(y,C,j),D=y.slice(j,q);if(S[D]===void 0){let U=h(y,C+1,O),K=m(y,O,U);const ie=w(y.slice(U,K));S[D]=ie}E=O+1}while(E<N);return S}function h(y,v,S){do{const N=y.charCodeAt(v);if(N!==32&&N!==9)return v}while(++v<S);return S}function m(y,v,S){for(;v>S;){const N=y.charCodeAt(--v);if(N!==32&&N!==9)return v+1}return S}function f(y,v,S){const N=(S==null?void 0:S.encode)||encodeURIComponent;if(!e.test(y))throw new TypeError(`argument name is invalid: ${y}`);const w=N(v);if(!t.test(w))throw new TypeError(`argument val is invalid: ${v}`);let E=y+"="+w;if(!S)return E;if(S.maxAge!==void 0){if(!Number.isInteger(S.maxAge))throw new TypeError(`option maxAge is invalid: ${S.maxAge}`);E+="; Max-Age="+S.maxAge}if(S.domain){if(!r.test(S.domain))throw new TypeError(`option domain is invalid: ${S.domain}`);E+="; Domain="+S.domain}if(S.path){if(!n.test(S.path))throw new TypeError(`option path is invalid: ${S.path}`);E+="; Path="+S.path}if(S.expires){if(!g(S.expires)||!Number.isFinite(S.expires.valueOf()))throw new TypeError(`option expires is invalid: ${S.expires}`);E+="; Expires="+S.expires.toUTCString()}if(S.httpOnly&&(E+="; HttpOnly"),S.secure&&(E+="; Secure"),S.partitioned&&(E+="; Partitioned"),S.priority)switch(typeof S.priority=="string"?S.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${S.priority}`)}if(S.sameSite)switch(typeof S.sameSite=="string"?S.sameSite.toLowerCase():S.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${S.sameSite}`)}return E}function p(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function g(y){return s.call(y)==="[object Date]"}return uc}CE();var hv="popstate";function AE(e={}){function t(s,l){let{pathname:u="/",search:h="",hash:m=""}=Xi(s.location.hash.substring(1));return!u.startsWith("/")&&!u.startsWith(".")&&(u="/"+u),Rm("",{pathname:u,search:h,hash:m},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function r(s,l){let u=s.document.querySelector("base"),h="";if(u&&u.getAttribute("href")){let m=s.location.href,f=m.indexOf("#");h=f===-1?m:m.slice(0,f)}return h+"#"+(typeof l=="string"?l:Mc(l))}function n(s,l){ha(s.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(l)})`)}return DE(t,r,n,e)}function hr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ha(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function jE(){return Math.random().toString(36).substring(2,10)}function mv(e,t){return{usr:e.state,key:e.key,idx:t}}function Rm(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Xi(t):t,state:r,key:t&&t.key||n||jE()}}function Mc({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Xi(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function DE(e,t,r,n={}){let{window:s=document.defaultView,v5Compat:l=!1}=n,u=s.history,h="POP",m=null,f=p();f==null&&(f=0,u.replaceState({...u.state,idx:f},""));function p(){return(u.state||{idx:null}).idx}function g(){h="POP";let w=p(),E=w==null?null:w-f;f=w,m&&m({action:h,location:N.location,delta:E})}function y(w,E){h="PUSH";let C=Rm(N.location,w,E);r&&r(C,w),f=p()+1;let T=mv(C,f),O=N.createHref(C);try{u.pushState(T,"",O)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;s.location.assign(O)}l&&m&&m({action:h,location:N.location,delta:1})}function v(w,E){h="REPLACE";let C=Rm(N.location,w,E);r&&r(C,w),f=p();let T=mv(C,f),O=N.createHref(C);u.replaceState(T,"",O),l&&m&&m({action:h,location:N.location,delta:0})}function S(w){let E=s.location.origin!=="null"?s.location.origin:s.location.href,C=typeof w=="string"?w:Mc(w);return C=C.replace(/ $/,"%20"),hr(E,`No window.location.(origin|href) available to create URL for href: ${C}`),new URL(C,E)}let N={get action(){return h},get location(){return e(s,u)},listen(w){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(hv,g),m=w,()=>{s.removeEventListener(hv,g),m=null}},createHref(w){return t(s,w)},createURL:S,encodeLocation(w){let E=S(w);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:y,replace:v,go(w){return u.go(w)}};return N}function Jb(e,t,r="/"){return kE(e,t,r,!1)}function kE(e,t,r,n){let s=typeof t=="string"?Xi(t):t,l=xs(s.pathname||"/",r);if(l==null)return null;let u=ew(e);OE(u);let h=null;for(let m=0;h==null&&m<u.length;++m){let f=HE(l);h=zE(u[m],f,n)}return h}function ew(e,t=[],r=[],n=""){let s=(l,u,h)=>{let m={relativePath:h===void 0?l.path||"":h,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};m.relativePath.startsWith("/")&&(hr(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length));let f=fs([n,m.relativePath]),p=r.concat(m);l.children&&l.children.length>0&&(hr(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),ew(l.children,t,p,f)),!(l.path==null&&!l.index)&&t.push({path:f,score:UE(f,l.index),routesMeta:p})};return e.forEach((l,u)=>{var h;if(l.path===""||!((h=l.path)!=null&&h.includes("?")))s(l,u);else for(let m of tw(l.path))s(l,u,m)}),t}function tw(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return s?[l,""]:[l];let u=tw(n.join("/")),h=[];return h.push(...u.map(m=>m===""?l:[l,m].join("/"))),s&&h.push(...u),h.map(m=>e.startsWith("/")&&m===""?"/":m)}function OE(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:IE(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var RE=/^:[\w-]+$/,ME=3,FE=2,LE=1,PE=10,BE=-2,pv=e=>e==="*";function UE(e,t){let r=e.split("/"),n=r.length;return r.some(pv)&&(n+=BE),t&&(n+=FE),r.filter(s=>!pv(s)).reduce((s,l)=>s+(RE.test(l)?ME:l===""?LE:PE),n)}function IE(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function zE(e,t,r=!1){let{routesMeta:n}=e,s={},l="/",u=[];for(let h=0;h<n.length;++h){let m=n[h],f=h===n.length-1,p=l==="/"?t:t.slice(l.length)||"/",g=Kd({path:m.relativePath,caseSensitive:m.caseSensitive,end:f},p),y=m.route;if(!g&&f&&r&&!n[n.length-1].route.index&&(g=Kd({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},p)),!g)return null;Object.assign(s,g.params),u.push({params:s,pathname:fs([l,g.pathname]),pathnameBase:$E(fs([l,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(l=fs([l,g.pathnameBase]))}return u}function Kd(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=VE(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let l=s[0],u=l.replace(/(.)\/+$/,"$1"),h=s.slice(1);return{params:n.reduce((f,{paramName:p,isOptional:g},y)=>{if(p==="*"){let S=h[y]||"";u=l.slice(0,l.length-S.length).replace(/(.)\/+$/,"$1")}const v=h[y];return g&&!v?f[p]=void 0:f[p]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:u,pattern:e}}function VE(e,t=!1,r=!0){ha(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,m)=>(n.push({paramName:h,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function HE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ha(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function xs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function YE(e,t="/"){let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Xi(e):e;return{pathname:r?r.startsWith("/")?r:GE(r,t):t,search:WE(n),hash:XE(s)}}function GE(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function rm(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function qE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function wp(e){let t=qE(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function Sp(e,t,r,n=!1){let s;typeof e=="string"?s=Xi(e):(s={...e},hr(!s.pathname||!s.pathname.includes("?"),rm("?","pathname","search",s)),hr(!s.pathname||!s.pathname.includes("#"),rm("#","pathname","hash",s)),hr(!s.search||!s.search.includes("#"),rm("#","search","hash",s)));let l=e===""||s.pathname==="",u=l?"/":s.pathname,h;if(u==null)h=r;else{let g=t.length-1;if(!n&&u.startsWith("..")){let y=u.split("/");for(;y[0]==="..";)y.shift(),g-=1;s.pathname=y.join("/")}h=g>=0?t[g]:"/"}let m=YE(s,h),f=u&&u!=="/"&&u.endsWith("/"),p=(l||u===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(f||p)&&(m.pathname+="/"),m}var fs=e=>e.join("/").replace(/\/\/+/g,"/"),$E=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),WE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,XE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function KE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var rw=["POST","PUT","PATCH","DELETE"];new Set(rw);var QE=["GET",...rw];new Set(QE);var al=k.createContext(null);al.displayName="DataRouter";var Cf=k.createContext(null);Cf.displayName="DataRouterState";var nw=k.createContext({isTransitioning:!1});nw.displayName="ViewTransition";var ZE=k.createContext(new Map);ZE.displayName="Fetchers";var JE=k.createContext(null);JE.displayName="Await";var Da=k.createContext(null);Da.displayName="Navigation";var Jc=k.createContext(null);Jc.displayName="Location";var Wa=k.createContext({outlet:null,matches:[],isDataRoute:!1});Wa.displayName="Route";var Np=k.createContext(null);Np.displayName="RouteError";function e_(e,{relative:t}={}){hr(sl(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=k.useContext(Da),{hash:s,pathname:l,search:u}=eu(e,{relative:t}),h=l;return r!=="/"&&(h=l==="/"?r:fs([r,l])),n.createHref({pathname:h,search:u,hash:s})}function sl(){return k.useContext(Jc)!=null}function Ns(){return hr(sl(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(Jc).location}var aw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function sw(e){k.useContext(Da).static||k.useLayoutEffect(e)}function ui(){let{isDataRoute:e}=k.useContext(Wa);return e?h_():t_()}function t_(){hr(sl(),"useNavigate() may be used only in the context of a <Router> component.");let e=k.useContext(al),{basename:t,navigator:r}=k.useContext(Da),{matches:n}=k.useContext(Wa),{pathname:s}=Ns(),l=JSON.stringify(wp(n)),u=k.useRef(!1);return sw(()=>{u.current=!0}),k.useCallback((m,f={})=>{if(ha(u.current,aw),!u.current)return;if(typeof m=="number"){r.go(m);return}let p=Sp(m,JSON.parse(l),s,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:fs([t,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[t,r,l,s,e])}k.createContext(null);function eu(e,{relative:t}={}){let{matches:r}=k.useContext(Wa),{pathname:n}=Ns(),s=JSON.stringify(wp(r));return k.useMemo(()=>Sp(e,JSON.parse(s),n,t==="path"),[e,s,n,t])}function r_(e,t){return iw(e,t)}function iw(e,t,r,n){var C;hr(sl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:l}=k.useContext(Da),{matches:u}=k.useContext(Wa),h=u[u.length-1],m=h?h.params:{},f=h?h.pathname:"/",p=h?h.pathnameBase:"/",g=h&&h.route;{let T=g&&g.path||"";ow(f,!g||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let y=Ns(),v;if(t){let T=typeof t=="string"?Xi(t):t;hr(p==="/"||((C=T.pathname)==null?void 0:C.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${T.pathname}" was given in the \`location\` prop.`),v=T}else v=y;let S=v.pathname||"/",N=S;if(p!=="/"){let T=p.replace(/^\//,"").split("/");N="/"+S.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=!l&&r&&r.matches&&r.matches.length>0?r.matches:Jb(e,{pathname:N});ha(g||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),ha(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=o_(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},m,T.params),pathname:fs([p,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?p:fs([p,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),u,r,n);return t&&E?k.createElement(Jc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},E):E}function n_(){let e=f_(),t=KE(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},u=null;return console.error("Error handled by React Router default ErrorBoundary:",e),u=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:l},"ErrorBoundary")," or"," ",k.createElement("code",{style:l},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},t),r?k.createElement("pre",{style:s},r):null,u)}var a_=k.createElement(n_,null),s_=class extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?k.createElement(Wa.Provider,{value:this.props.routeContext},k.createElement(Np.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function i_({routeContext:e,match:t,children:r}){let n=k.useContext(al);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(Wa.Provider,{value:e},r)}function o_(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let s=e,l=r==null?void 0:r.errors;if(l!=null){let m=s.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);hr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),s=s.slice(0,Math.min(s.length,m+1))}let u=!1,h=-1;if(r)for(let m=0;m<s.length;m++){let f=s[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(h=m),f.route.id){let{loaderData:p,errors:g}=r,y=f.route.loader&&!p.hasOwnProperty(f.route.id)&&(!g||g[f.route.id]===void 0);if(f.route.lazy||y){u=!0,h>=0?s=s.slice(0,h+1):s=[s[0]];break}}}return s.reduceRight((m,f,p)=>{let g,y=!1,v=null,S=null;r&&(g=l&&f.route.id?l[f.route.id]:void 0,v=f.route.errorElement||a_,u&&(h<0&&p===0?(ow("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,S=null):h===p&&(y=!0,S=f.route.hydrateFallbackElement||null)));let N=t.concat(s.slice(0,p+1)),w=()=>{let E;return g?E=v:y?E=S:f.route.Component?E=k.createElement(f.route.Component,null):f.route.element?E=f.route.element:E=m,k.createElement(i_,{match:f,routeContext:{outlet:m,matches:N,isDataRoute:r!=null},children:E})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?k.createElement(s_,{location:r.location,revalidation:r.revalidation,component:v,error:g,children:w(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):w()},null)}function Tp(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function l_(e){let t=k.useContext(al);return hr(t,Tp(e)),t}function c_(e){let t=k.useContext(Cf);return hr(t,Tp(e)),t}function u_(e){let t=k.useContext(Wa);return hr(t,Tp(e)),t}function Ep(e){let t=u_(e),r=t.matches[t.matches.length-1];return hr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function d_(){return Ep("useRouteId")}function f_(){var n;let e=k.useContext(Np),t=c_("useRouteError"),r=Ep("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function h_(){let{router:e}=l_("useNavigate"),t=Ep("useNavigate"),r=k.useRef(!1);return sw(()=>{r.current=!0}),k.useCallback(async(s,l={})=>{ha(r.current,aw),r.current&&(typeof s=="number"?e.navigate(s):await e.navigate(s,{fromRouteId:t,...l}))},[e,t])}var xv={};function ow(e,t,r){!t&&!xv[e]&&(xv[e]=!0,ha(!1,r))}k.memo(m_);function m_({routes:e,future:t,state:r}){return iw(e,void 0,r,t)}function Mm({to:e,replace:t,state:r,relative:n}){hr(sl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=k.useContext(Da);ha(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=k.useContext(Wa),{pathname:u}=Ns(),h=ui(),m=Sp(e,wp(l),u,n==="path"),f=JSON.stringify(m);return k.useEffect(()=>{h(JSON.parse(f),{replace:t,state:r,relative:n})},[h,f,n,t,r]),null}function or(e){hr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function p_({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:s,static:l=!1}){hr(!sl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=e.replace(/^\/*/,"/"),h=k.useMemo(()=>({basename:u,navigator:s,static:l,future:{}}),[u,s,l]);typeof r=="string"&&(r=Xi(r));let{pathname:m="/",search:f="",hash:p="",state:g=null,key:y="default"}=r,v=k.useMemo(()=>{let S=xs(m,u);return S==null?null:{location:{pathname:S,search:f,hash:p,state:g,key:y},navigationType:n}},[u,m,f,p,g,y,n]);return ha(v!=null,`<Router basename="${u}"> is not able to match the URL "${m}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:k.createElement(Da.Provider,{value:h},k.createElement(Jc.Provider,{children:t,value:v}))}function x_({children:e,location:t}){return r_(Fm(e),t)}function Fm(e,t=[]){let r=[];return k.Children.forEach(e,(n,s)=>{if(!k.isValidElement(n))return;let l=[...t,s];if(n.type===k.Fragment){r.push.apply(r,Fm(n.props.children,l));return}hr(n.type===or,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),hr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let u={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(u.children=Fm(n.props.children,l)),r.push(u)}),r}var Ud="get",Id="application/x-www-form-urlencoded";function Af(e){return e!=null&&typeof e.tagName=="string"}function g_(e){return Af(e)&&e.tagName.toLowerCase()==="button"}function y_(e){return Af(e)&&e.tagName.toLowerCase()==="form"}function v_(e){return Af(e)&&e.tagName.toLowerCase()==="input"}function b_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function w_(e,t){return e.button===0&&(!t||t==="_self")&&!b_(e)}var Td=null;function S_(){if(Td===null)try{new FormData(document.createElement("form"),0),Td=!1}catch{Td=!0}return Td}var N_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function nm(e){return e!=null&&!N_.has(e)?(ha(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Id}"`),null):e}function T_(e,t){let r,n,s,l,u;if(y_(e)){let h=e.getAttribute("action");n=h?xs(h,t):null,r=e.getAttribute("method")||Ud,s=nm(e.getAttribute("enctype"))||Id,l=new FormData(e)}else if(g_(e)||v_(e)&&(e.type==="submit"||e.type==="image")){let h=e.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=e.getAttribute("formaction")||h.getAttribute("action");if(n=m?xs(m,t):null,r=e.getAttribute("formmethod")||h.getAttribute("method")||Ud,s=nm(e.getAttribute("formenctype"))||nm(h.getAttribute("enctype"))||Id,l=new FormData(h,e),!S_()){let{name:f,type:p,value:g}=e;if(p==="image"){let y=f?`${f}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else f&&l.append(f,g)}}else{if(Af(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Ud,n=null,s=Id,u=e}return l&&s==="text/plain"&&(u=l,l=void 0),{action:n,method:r.toLowerCase(),encType:s,formData:l,body:u}}function _p(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function E_(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function __(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function C_(e,t,r){let n=await Promise.all(e.map(async s=>{let l=t.routes[s.route.id];if(l){let u=await E_(l,r);return u.links?u.links():[]}return[]}));return k_(n.flat(1).filter(__).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function gv(e,t,r,n,s,l){let u=(m,f)=>r[f]?m.route.id!==r[f].route.id:!0,h=(m,f)=>{var p;return r[f].pathname!==m.pathname||((p=r[f].route.path)==null?void 0:p.endsWith("*"))&&r[f].params["*"]!==m.params["*"]};return l==="assets"?t.filter((m,f)=>u(m,f)||h(m,f)):l==="data"?t.filter((m,f)=>{var g;let p=n.routes[m.route.id];if(!p||!p.hasLoader)return!1;if(u(m,f)||h(m,f))return!0;if(m.route.shouldRevalidate){let y=m.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((g=r[0])==null?void 0:g.params)||{},nextUrl:new URL(e,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function A_(e,t,{includeHydrateFallback:r}={}){return j_(e.map(n=>{let s=t.routes[n.route.id];if(!s)return[];let l=[s.module];return s.clientActionModule&&(l=l.concat(s.clientActionModule)),s.clientLoaderModule&&(l=l.concat(s.clientLoaderModule)),r&&s.hydrateFallbackModule&&(l=l.concat(s.hydrateFallbackModule)),s.imports&&(l=l.concat(s.imports)),l}).flat(1))}function j_(e){return[...new Set(e)]}function D_(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function k_(e,t){let r=new Set;return new Set(t),e.reduce((n,s)=>{let l=JSON.stringify(D_(s));return r.has(l)||(r.add(l),n.push({key:l,link:s})),n},[])}var O_=new Set([100,101,204,205]);function R_(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&xs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function lw(){let e=k.useContext(al);return _p(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function M_(){let e=k.useContext(Cf);return _p(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Cp=k.createContext(void 0);Cp.displayName="FrameworkContext";function cw(){let e=k.useContext(Cp);return _p(e,"You must render this element inside a <HydratedRouter> element"),e}function F_(e,t){let r=k.useContext(Cp),[n,s]=k.useState(!1),[l,u]=k.useState(!1),{onFocus:h,onBlur:m,onMouseEnter:f,onMouseLeave:p,onTouchStart:g}=t,y=k.useRef(null);k.useEffect(()=>{if(e==="render"&&u(!0),e==="viewport"){let N=E=>{E.forEach(C=>{u(C.isIntersecting)})},w=new IntersectionObserver(N,{threshold:.5});return y.current&&w.observe(y.current),()=>{w.disconnect()}}},[e]),k.useEffect(()=>{if(n){let N=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(N)}}},[n]);let v=()=>{s(!0)},S=()=>{s(!1),u(!1)};return r?e!=="intent"?[l,y,{}]:[l,y,{onFocus:dc(h,v),onBlur:dc(m,S),onMouseEnter:dc(f,v),onMouseLeave:dc(p,S),onTouchStart:dc(g,v)}]:[!1,y,{}]}function dc(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function L_({page:e,...t}){let{router:r}=lw(),n=k.useMemo(()=>Jb(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?k.createElement(B_,{page:e,matches:n,...t}):null}function P_(e){let{manifest:t,routeModules:r}=cw(),[n,s]=k.useState([]);return k.useEffect(()=>{let l=!1;return C_(e,t,r).then(u=>{l||s(u)}),()=>{l=!0}},[e,t,r]),n}function B_({page:e,matches:t,...r}){let n=Ns(),{manifest:s,routeModules:l}=cw(),{basename:u}=lw(),{loaderData:h,matches:m}=M_(),f=k.useMemo(()=>gv(e,t,m,s,n,"data"),[e,t,m,s,n]),p=k.useMemo(()=>gv(e,t,m,s,n,"assets"),[e,t,m,s,n]),g=k.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let S=new Set,N=!1;if(t.forEach(E=>{var T;let C=s.routes[E.route.id];!C||!C.hasLoader||(!f.some(O=>O.route.id===E.route.id)&&E.route.id in h&&((T=l[E.route.id])!=null&&T.shouldRevalidate)||C.hasClientLoader?N=!0:S.add(E.route.id))}),S.size===0)return[];let w=R_(e,u);return N&&S.size>0&&w.searchParams.set("_routes",t.filter(E=>S.has(E.route.id)).map(E=>E.route.id).join(",")),[w.pathname+w.search]},[u,h,n,s,f,t,e,l]),y=k.useMemo(()=>A_(p,s),[p,s]),v=P_(p);return k.createElement(k.Fragment,null,g.map(S=>k.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...r})),y.map(S=>k.createElement("link",{key:S,rel:"modulepreload",href:S,...r})),v.map(({key:S,link:N})=>k.createElement("link",{key:S,...N})))}function U_(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var uw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uw&&(window.__reactRouterVersion="7.5.2")}catch{}function I_({basename:e,children:t,window:r}){let n=k.useRef();n.current==null&&(n.current=AE({window:r,v5Compat:!0}));let s=n.current,[l,u]=k.useState({action:s.action,location:s.location}),h=k.useCallback(m=>{k.startTransition(()=>u(m))},[u]);return k.useLayoutEffect(()=>s.listen(h),[s,h]),k.createElement(p_,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:s})}var dw=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Nt=k.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:s,reloadDocument:l,replace:u,state:h,target:m,to:f,preventScrollReset:p,viewTransition:g,...y},v){let{basename:S}=k.useContext(Da),N=typeof f=="string"&&dw.test(f),w,E=!1;if(typeof f=="string"&&N&&(w=f,uw))try{let K=new URL(window.location.href),ie=f.startsWith("//")?new URL(K.protocol+f):new URL(f),te=xs(ie.pathname,S);ie.origin===K.origin&&te!=null?f=te+ie.search+ie.hash:E=!0}catch{ha(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=e_(f,{relative:s}),[T,O,j]=F_(n,y),q=Y_(f,{replace:u,state:h,target:m,preventScrollReset:p,relative:s,viewTransition:g});function D(K){t&&t(K),K.defaultPrevented||q(K)}let U=k.createElement("a",{...y,...j,href:w||C,onClick:E||l?t:D,ref:U_(v,O),target:m,"data-discover":!N&&r==="render"?"true":void 0});return T&&!N?k.createElement(k.Fragment,null,U,k.createElement(L_,{page:C})):U});Nt.displayName="Link";var z_=k.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:s=!1,style:l,to:u,viewTransition:h,children:m,...f},p){let g=eu(u,{relative:f.relative}),y=Ns(),v=k.useContext(Cf),{navigator:S,basename:N}=k.useContext(Da),w=v!=null&&X_(g)&&h===!0,E=S.encodeLocation?S.encodeLocation(g).pathname:g.pathname,C=y.pathname,T=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(C=C.toLowerCase(),T=T?T.toLowerCase():null,E=E.toLowerCase()),T&&N&&(T=xs(T,N)||T);const O=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let j=C===E||!s&&C.startsWith(E)&&C.charAt(O)==="/",q=T!=null&&(T===E||!s&&T.startsWith(E)&&T.charAt(E.length)==="/"),D={isActive:j,isPending:q,isTransitioning:w},U=j?t:void 0,K;typeof n=="function"?K=n(D):K=[n,j?"active":null,q?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let ie=typeof l=="function"?l(D):l;return k.createElement(Nt,{...f,"aria-current":U,className:K,ref:p,style:ie,to:u,viewTransition:h},typeof m=="function"?m(D):m)});z_.displayName="NavLink";var V_=k.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:s,state:l,method:u=Ud,action:h,onSubmit:m,relative:f,preventScrollReset:p,viewTransition:g,...y},v)=>{let S=$_(),N=W_(h,{relative:f}),w=u.toLowerCase()==="get"?"get":"post",E=typeof h=="string"&&dw.test(h),C=T=>{if(m&&m(T),T.defaultPrevented)return;T.preventDefault();let O=T.nativeEvent.submitter,j=(O==null?void 0:O.getAttribute("formmethod"))||u;S(O||T.currentTarget,{fetcherKey:t,method:j,navigate:r,replace:s,state:l,relative:f,preventScrollReset:p,viewTransition:g})};return k.createElement("form",{ref:v,method:w,action:N,onSubmit:n?m:C,...y,"data-discover":!E&&e==="render"?"true":void 0})});V_.displayName="Form";function H_(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fw(e){let t=k.useContext(al);return hr(t,H_(e)),t}function Y_(e,{target:t,replace:r,state:n,preventScrollReset:s,relative:l,viewTransition:u}={}){let h=ui(),m=Ns(),f=eu(e,{relative:l});return k.useCallback(p=>{if(w_(p,t)){p.preventDefault();let g=r!==void 0?r:Mc(m)===Mc(f);h(e,{replace:g,state:n,preventScrollReset:s,relative:l,viewTransition:u})}},[m,h,f,r,n,t,e,s,l,u])}var G_=0,q_=()=>`__${String(++G_)}__`;function $_(){let{router:e}=fw("useSubmit"),{basename:t}=k.useContext(Da),r=d_();return k.useCallback(async(n,s={})=>{let{action:l,method:u,encType:h,formData:m,body:f}=T_(n,t);if(s.navigate===!1){let p=s.fetcherKey||q_();await e.fetch(p,r,s.action||l,{preventScrollReset:s.preventScrollReset,formData:m,body:f,formMethod:s.method||u,formEncType:s.encType||h,flushSync:s.flushSync})}else await e.navigate(s.action||l,{preventScrollReset:s.preventScrollReset,formData:m,body:f,formMethod:s.method||u,formEncType:s.encType||h,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[e,t,r])}function W_(e,{relative:t}={}){let{basename:r}=k.useContext(Da),n=k.useContext(Wa);hr(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),l={...eu(e||".",{relative:t})},u=Ns();if(e==null){l.search=u.search;let h=new URLSearchParams(l.search),m=h.getAll("index");if(m.some(p=>p==="")){h.delete("index"),m.filter(g=>g).forEach(g=>h.append("index",g));let p=h.toString();l.search=p?`?${p}`:""}}return(!e||e===".")&&s.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(l.pathname=l.pathname==="/"?r:fs([r,l.pathname])),Mc(l)}function X_(e,t={}){let r=k.useContext(nw);hr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=fw("useViewTransitionState"),s=eu(e,{relative:t.relative});if(!r.isTransitioning)return!1;let l=xs(r.currentLocation.pathname,n)||r.currentLocation.pathname,u=xs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Kd(s.pathname,u)!=null||Kd(s.pathname,l)!=null}new TextEncoder;[...O_];function hw(e,t){return function(){return e.apply(t,arguments)}}const{toString:K_}=Object.prototype,{getPrototypeOf:Ap}=Object,{iterator:jf,toStringTag:mw}=Symbol,Df=(e=>t=>{const r=K_.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ka=e=>(e=e.toLowerCase(),t=>Df(t)===e),kf=e=>t=>typeof t===e,{isArray:il}=Array,Fc=kf("undefined");function Q_(e){return e!==null&&!Fc(e)&&e.constructor!==null&&!Fc(e.constructor)&&Rn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const pw=ka("ArrayBuffer");function Z_(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&pw(e.buffer),t}const J_=kf("string"),Rn=kf("function"),xw=kf("number"),Of=e=>e!==null&&typeof e=="object",eC=e=>e===!0||e===!1,zd=e=>{if(Df(e)!=="object")return!1;const t=Ap(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(mw in e)&&!(jf in e)},tC=ka("Date"),rC=ka("File"),nC=ka("Blob"),aC=ka("FileList"),sC=e=>Of(e)&&Rn(e.pipe),iC=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Rn(e.append)&&((t=Df(e))==="formdata"||t==="object"&&Rn(e.toString)&&e.toString()==="[object FormData]"))},oC=ka("URLSearchParams"),[lC,cC,uC,dC]=["ReadableStream","Request","Response","Headers"].map(ka),fC=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function tu(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),il(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{const l=r?Object.getOwnPropertyNames(e):Object.keys(e),u=l.length;let h;for(n=0;n<u;n++)h=l[n],t.call(null,e[h],h,e)}}function gw(e,t){t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Li=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,yw=e=>!Fc(e)&&e!==Li;function Lm(){const{caseless:e}=yw(this)&&this||{},t={},r=(n,s)=>{const l=e&&gw(t,s)||s;zd(t[l])&&zd(n)?t[l]=Lm(t[l],n):zd(n)?t[l]=Lm({},n):il(n)?t[l]=n.slice():t[l]=n};for(let n=0,s=arguments.length;n<s;n++)arguments[n]&&tu(arguments[n],r);return t}const hC=(e,t,r,{allOwnKeys:n}={})=>(tu(t,(s,l)=>{r&&Rn(s)?e[l]=hw(s,r):e[l]=s},{allOwnKeys:n}),e),mC=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),pC=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},xC=(e,t,r,n)=>{let s,l,u;const h={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),l=s.length;l-- >0;)u=s[l],(!n||n(u,e,t))&&!h[u]&&(t[u]=e[u],h[u]=!0);e=r!==!1&&Ap(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},gC=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},yC=e=>{if(!e)return null;if(il(e))return e;let t=e.length;if(!xw(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},vC=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Ap(Uint8Array)),bC=(e,t)=>{const n=(e&&e[jf]).call(e);let s;for(;(s=n.next())&&!s.done;){const l=s.value;t.call(e,l[0],l[1])}},wC=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},SC=ka("HTMLFormElement"),NC=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),yv=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),TC=ka("RegExp"),vw=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};tu(r,(s,l)=>{let u;(u=t(s,l,e))!==!1&&(n[l]=u||s)}),Object.defineProperties(e,n)},EC=e=>{vw(e,(t,r)=>{if(Rn(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Rn(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},_C=(e,t)=>{const r={},n=s=>{s.forEach(l=>{r[l]=!0})};return il(e)?n(e):n(String(e).split(t)),r},CC=()=>{},AC=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function jC(e){return!!(e&&Rn(e.append)&&e[mw]==="FormData"&&e[jf])}const DC=e=>{const t=new Array(10),r=(n,s)=>{if(Of(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[s]=n;const l=il(n)?[]:{};return tu(n,(u,h)=>{const m=r(u,s+1);!Fc(m)&&(l[h]=m)}),t[s]=void 0,l}}return n};return r(e,0)},kC=ka("AsyncFunction"),OC=e=>e&&(Of(e)||Rn(e))&&Rn(e.then)&&Rn(e.catch),bw=((e,t)=>e?setImmediate:t?((r,n)=>(Li.addEventListener("message",({source:s,data:l})=>{s===Li&&l===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Li.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Rn(Li.postMessage)),RC=typeof queueMicrotask<"u"?queueMicrotask.bind(Li):typeof process<"u"&&process.nextTick||bw,MC=e=>e!=null&&Rn(e[jf]),Ae={isArray:il,isArrayBuffer:pw,isBuffer:Q_,isFormData:iC,isArrayBufferView:Z_,isString:J_,isNumber:xw,isBoolean:eC,isObject:Of,isPlainObject:zd,isReadableStream:lC,isRequest:cC,isResponse:uC,isHeaders:dC,isUndefined:Fc,isDate:tC,isFile:rC,isBlob:nC,isRegExp:TC,isFunction:Rn,isStream:sC,isURLSearchParams:oC,isTypedArray:vC,isFileList:aC,forEach:tu,merge:Lm,extend:hC,trim:fC,stripBOM:mC,inherits:pC,toFlatObject:xC,kindOf:Df,kindOfTest:ka,endsWith:gC,toArray:yC,forEachEntry:bC,matchAll:wC,isHTMLForm:SC,hasOwnProperty:yv,hasOwnProp:yv,reduceDescriptors:vw,freezeMethods:EC,toObjectSet:_C,toCamelCase:NC,noop:CC,toFiniteNumber:AC,findKey:gw,global:Li,isContextDefined:yw,isSpecCompliantForm:jC,toJSONObject:DC,isAsyncFn:kC,isThenable:OC,setImmediate:bw,asap:RC,isIterable:MC};function bt(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Ae.inherits(bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ae.toJSONObject(this.config),code:this.code,status:this.status}}});const ww=bt.prototype,Sw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Sw[e]={value:e}});Object.defineProperties(bt,Sw);Object.defineProperty(ww,"isAxiosError",{value:!0});bt.from=(e,t,r,n,s,l)=>{const u=Object.create(ww);return Ae.toFlatObject(e,u,function(m){return m!==Error.prototype},h=>h!=="isAxiosError"),bt.call(u,e.message,t,r,n,s),u.cause=e,u.name=e.name,l&&Object.assign(u,l),u};const FC=null;function Pm(e){return Ae.isPlainObject(e)||Ae.isArray(e)}function Nw(e){return Ae.endsWith(e,"[]")?e.slice(0,-2):e}function vv(e,t,r){return e?e.concat(t).map(function(s,l){return s=Nw(s),!r&&l?"["+s+"]":s}).join(r?".":""):t}function LC(e){return Ae.isArray(e)&&!e.some(Pm)}const PC=Ae.toFlatObject(Ae,{},null,function(t){return/^is[A-Z]/.test(t)});function Rf(e,t,r){if(!Ae.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ae.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(N,w){return!Ae.isUndefined(w[N])});const n=r.metaTokens,s=r.visitor||p,l=r.dots,u=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&Ae.isSpecCompliantForm(t);if(!Ae.isFunction(s))throw new TypeError("visitor must be a function");function f(S){if(S===null)return"";if(Ae.isDate(S))return S.toISOString();if(!m&&Ae.isBlob(S))throw new bt("Blob is not supported. Use a Buffer instead.");return Ae.isArrayBuffer(S)||Ae.isTypedArray(S)?m&&typeof Blob=="function"?new Blob([S]):Buffer.from(S):S}function p(S,N,w){let E=S;if(S&&!w&&typeof S=="object"){if(Ae.endsWith(N,"{}"))N=n?N:N.slice(0,-2),S=JSON.stringify(S);else if(Ae.isArray(S)&&LC(S)||(Ae.isFileList(S)||Ae.endsWith(N,"[]"))&&(E=Ae.toArray(S)))return N=Nw(N),E.forEach(function(T,O){!(Ae.isUndefined(T)||T===null)&&t.append(u===!0?vv([N],O,l):u===null?N:N+"[]",f(T))}),!1}return Pm(S)?!0:(t.append(vv(w,N,l),f(S)),!1)}const g=[],y=Object.assign(PC,{defaultVisitor:p,convertValue:f,isVisitable:Pm});function v(S,N){if(!Ae.isUndefined(S)){if(g.indexOf(S)!==-1)throw Error("Circular reference detected in "+N.join("."));g.push(S),Ae.forEach(S,function(E,C){(!(Ae.isUndefined(E)||E===null)&&s.call(t,E,Ae.isString(C)?C.trim():C,N,y))===!0&&v(E,N?N.concat(C):[C])}),g.pop()}}if(!Ae.isObject(e))throw new TypeError("data must be an object");return v(e),t}function bv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function jp(e,t){this._pairs=[],e&&Rf(e,this,t)}const Tw=jp.prototype;Tw.append=function(t,r){this._pairs.push([t,r])};Tw.toString=function(t){const r=t?function(n){return t.call(this,n,bv)}:bv;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function BC(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ew(e,t,r){if(!t)return e;const n=r&&r.encode||BC;Ae.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let l;if(s?l=s(t,r):l=Ae.isURLSearchParams(t)?t.toString():new jp(t,r).toString(n),l){const u=e.indexOf("#");u!==-1&&(e=e.slice(0,u)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class wv{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ae.forEach(this.handlers,function(n){n!==null&&t(n)})}}const _w={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},UC=typeof URLSearchParams<"u"?URLSearchParams:jp,IC=typeof FormData<"u"?FormData:null,zC=typeof Blob<"u"?Blob:null,VC={isBrowser:!0,classes:{URLSearchParams:UC,FormData:IC,Blob:zC},protocols:["http","https","file","blob","url","data"]},Dp=typeof window<"u"&&typeof document<"u",Bm=typeof navigator=="object"&&navigator||void 0,HC=Dp&&(!Bm||["ReactNative","NativeScript","NS"].indexOf(Bm.product)<0),YC=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",GC=Dp&&window.location.href||"http://localhost",qC=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Dp,hasStandardBrowserEnv:HC,hasStandardBrowserWebWorkerEnv:YC,navigator:Bm,origin:GC},Symbol.toStringTag,{value:"Module"})),xn={...qC,...VC};function $C(e,t){return Rf(e,new xn.classes.URLSearchParams,Object.assign({visitor:function(r,n,s,l){return xn.isNode&&Ae.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},t))}function WC(e){return Ae.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function XC(e){const t={},r=Object.keys(e);let n;const s=r.length;let l;for(n=0;n<s;n++)l=r[n],t[l]=e[l];return t}function Cw(e){function t(r,n,s,l){let u=r[l++];if(u==="__proto__")return!0;const h=Number.isFinite(+u),m=l>=r.length;return u=!u&&Ae.isArray(s)?s.length:u,m?(Ae.hasOwnProp(s,u)?s[u]=[s[u],n]:s[u]=n,!h):((!s[u]||!Ae.isObject(s[u]))&&(s[u]=[]),t(r,n,s[u],l)&&Ae.isArray(s[u])&&(s[u]=XC(s[u])),!h)}if(Ae.isFormData(e)&&Ae.isFunction(e.entries)){const r={};return Ae.forEachEntry(e,(n,s)=>{t(WC(n),s,r,0)}),r}return null}function KC(e,t,r){if(Ae.isString(e))try{return(t||JSON.parse)(e),Ae.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const ru={transitional:_w,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,l=Ae.isObject(t);if(l&&Ae.isHTMLForm(t)&&(t=new FormData(t)),Ae.isFormData(t))return s?JSON.stringify(Cw(t)):t;if(Ae.isArrayBuffer(t)||Ae.isBuffer(t)||Ae.isStream(t)||Ae.isFile(t)||Ae.isBlob(t)||Ae.isReadableStream(t))return t;if(Ae.isArrayBufferView(t))return t.buffer;if(Ae.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let h;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return $C(t,this.formSerializer).toString();if((h=Ae.isFileList(t))||n.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return Rf(h?{"files[]":t}:t,m&&new m,this.formSerializer)}}return l||s?(r.setContentType("application/json",!1),KC(t)):t}],transformResponse:[function(t){const r=this.transitional||ru.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Ae.isResponse(t)||Ae.isReadableStream(t))return t;if(t&&Ae.isString(t)&&(n&&!this.responseType||s)){const u=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(h){if(u)throw h.name==="SyntaxError"?bt.from(h,bt.ERR_BAD_RESPONSE,this,null,this.response):h}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:xn.classes.FormData,Blob:xn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ae.forEach(["delete","get","head","post","put","patch"],e=>{ru.headers[e]={}});const QC=Ae.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ZC=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(u){s=u.indexOf(":"),r=u.substring(0,s).trim().toLowerCase(),n=u.substring(s+1).trim(),!(!r||t[r]&&QC[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},Sv=Symbol("internals");function fc(e){return e&&String(e).trim().toLowerCase()}function Vd(e){return e===!1||e==null?e:Ae.isArray(e)?e.map(Vd):String(e)}function JC(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const eA=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function am(e,t,r,n,s){if(Ae.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Ae.isString(t)){if(Ae.isString(n))return t.indexOf(n)!==-1;if(Ae.isRegExp(n))return n.test(t)}}function tA(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function rA(e,t){const r=Ae.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,l,u){return this[n].call(this,t,s,l,u)},configurable:!0})})}let Mn=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function l(h,m,f){const p=fc(m);if(!p)throw new Error("header name must be a non-empty string");const g=Ae.findKey(s,p);(!g||s[g]===void 0||f===!0||f===void 0&&s[g]!==!1)&&(s[g||m]=Vd(h))}const u=(h,m)=>Ae.forEach(h,(f,p)=>l(f,p,m));if(Ae.isPlainObject(t)||t instanceof this.constructor)u(t,r);else if(Ae.isString(t)&&(t=t.trim())&&!eA(t))u(ZC(t),r);else if(Ae.isObject(t)&&Ae.isIterable(t)){let h={},m,f;for(const p of t){if(!Ae.isArray(p))throw TypeError("Object iterator must return a key-value pair");h[f=p[0]]=(m=h[f])?Ae.isArray(m)?[...m,p[1]]:[m,p[1]]:p[1]}u(h,r)}else t!=null&&l(r,t,n);return this}get(t,r){if(t=fc(t),t){const n=Ae.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return JC(s);if(Ae.isFunction(r))return r.call(this,s,n);if(Ae.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=fc(t),t){const n=Ae.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||am(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function l(u){if(u=fc(u),u){const h=Ae.findKey(n,u);h&&(!r||am(n,n[h],h,r))&&(delete n[h],s=!0)}}return Ae.isArray(t)?t.forEach(l):l(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const l=r[n];(!t||am(this,this[l],l,t,!0))&&(delete this[l],s=!0)}return s}normalize(t){const r=this,n={};return Ae.forEach(this,(s,l)=>{const u=Ae.findKey(n,l);if(u){r[u]=Vd(s),delete r[l];return}const h=t?tA(l):String(l).trim();h!==l&&delete r[l],r[h]=Vd(s),n[h]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ae.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Ae.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[Sv]=this[Sv]={accessors:{}}).accessors,s=this.prototype;function l(u){const h=fc(u);n[h]||(rA(s,u),n[h]=!0)}return Ae.isArray(t)?t.forEach(l):l(t),this}};Mn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ae.reduceDescriptors(Mn.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Ae.freezeMethods(Mn);function sm(e,t){const r=this||ru,n=t||r,s=Mn.from(n.headers);let l=n.data;return Ae.forEach(e,function(h){l=h.call(r,l,s.normalize(),t?t.status:void 0)}),s.normalize(),l}function Aw(e){return!!(e&&e.__CANCEL__)}function ol(e,t,r){bt.call(this,e??"canceled",bt.ERR_CANCELED,t,r),this.name="CanceledError"}Ae.inherits(ol,bt,{__CANCEL__:!0});function jw(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new bt("Request failed with status code "+r.status,[bt.ERR_BAD_REQUEST,bt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function nA(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function aA(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,l=0,u;return t=t!==void 0?t:1e3,function(m){const f=Date.now(),p=n[l];u||(u=f),r[s]=m,n[s]=f;let g=l,y=0;for(;g!==s;)y+=r[g++],g=g%e;if(s=(s+1)%e,s===l&&(l=(l+1)%e),f-u<t)return;const v=p&&f-p;return v?Math.round(y*1e3/v):void 0}}function sA(e,t){let r=0,n=1e3/t,s,l;const u=(f,p=Date.now())=>{r=p,s=null,l&&(clearTimeout(l),l=null),e.apply(null,f)};return[(...f)=>{const p=Date.now(),g=p-r;g>=n?u(f,p):(s=f,l||(l=setTimeout(()=>{l=null,u(s)},n-g)))},()=>s&&u(s)]}const Qd=(e,t,r=3)=>{let n=0;const s=aA(50,250);return sA(l=>{const u=l.loaded,h=l.lengthComputable?l.total:void 0,m=u-n,f=s(m),p=u<=h;n=u;const g={loaded:u,total:h,progress:h?u/h:void 0,bytes:m,rate:f||void 0,estimated:f&&h&&p?(h-u)/f:void 0,event:l,lengthComputable:h!=null,[t?"download":"upload"]:!0};e(g)},r)},Nv=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},Tv=e=>(...t)=>Ae.asap(()=>e(...t)),iA=xn.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,xn.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(xn.origin),xn.navigator&&/(msie|trident)/i.test(xn.navigator.userAgent)):()=>!0,oA=xn.hasStandardBrowserEnv?{write(e,t,r,n,s,l){const u=[e+"="+encodeURIComponent(t)];Ae.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),Ae.isString(n)&&u.push("path="+n),Ae.isString(s)&&u.push("domain="+s),l===!0&&u.push("secure"),document.cookie=u.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function lA(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function cA(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Dw(e,t,r){let n=!lA(t);return e&&(n||r==!1)?cA(e,t):t}const Ev=e=>e instanceof Mn?{...e}:e;function Yi(e,t){t=t||{};const r={};function n(f,p,g,y){return Ae.isPlainObject(f)&&Ae.isPlainObject(p)?Ae.merge.call({caseless:y},f,p):Ae.isPlainObject(p)?Ae.merge({},p):Ae.isArray(p)?p.slice():p}function s(f,p,g,y){if(Ae.isUndefined(p)){if(!Ae.isUndefined(f))return n(void 0,f,g,y)}else return n(f,p,g,y)}function l(f,p){if(!Ae.isUndefined(p))return n(void 0,p)}function u(f,p){if(Ae.isUndefined(p)){if(!Ae.isUndefined(f))return n(void 0,f)}else return n(void 0,p)}function h(f,p,g){if(g in t)return n(f,p);if(g in e)return n(void 0,f)}const m={url:l,method:l,data:l,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,withXSRFToken:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,beforeRedirect:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:h,headers:(f,p,g)=>s(Ev(f),Ev(p),g,!0)};return Ae.forEach(Object.keys(Object.assign({},e,t)),function(p){const g=m[p]||s,y=g(e[p],t[p],p);Ae.isUndefined(y)&&g!==h||(r[p]=y)}),r}const kw=e=>{const t=Yi({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:l,headers:u,auth:h}=t;t.headers=u=Mn.from(u),t.url=Ew(Dw(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),h&&u.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):"")));let m;if(Ae.isFormData(r)){if(xn.hasStandardBrowserEnv||xn.hasStandardBrowserWebWorkerEnv)u.setContentType(void 0);else if((m=u.getContentType())!==!1){const[f,...p]=m?m.split(";").map(g=>g.trim()).filter(Boolean):[];u.setContentType([f||"multipart/form-data",...p].join("; "))}}if(xn.hasStandardBrowserEnv&&(n&&Ae.isFunction(n)&&(n=n(t)),n||n!==!1&&iA(t.url))){const f=s&&l&&oA.read(l);f&&u.set(s,f)}return t},uA=typeof XMLHttpRequest<"u",dA=uA&&function(e){return new Promise(function(r,n){const s=kw(e);let l=s.data;const u=Mn.from(s.headers).normalize();let{responseType:h,onUploadProgress:m,onDownloadProgress:f}=s,p,g,y,v,S;function N(){v&&v(),S&&S(),s.cancelToken&&s.cancelToken.unsubscribe(p),s.signal&&s.signal.removeEventListener("abort",p)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function E(){if(!w)return;const T=Mn.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),j={data:!h||h==="text"||h==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:T,config:e,request:w};jw(function(D){r(D),N()},function(D){n(D),N()},j),w=null}"onloadend"in w?w.onloadend=E:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(E)},w.onabort=function(){w&&(n(new bt("Request aborted",bt.ECONNABORTED,e,w)),w=null)},w.onerror=function(){n(new bt("Network Error",bt.ERR_NETWORK,e,w)),w=null},w.ontimeout=function(){let O=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const j=s.transitional||_w;s.timeoutErrorMessage&&(O=s.timeoutErrorMessage),n(new bt(O,j.clarifyTimeoutError?bt.ETIMEDOUT:bt.ECONNABORTED,e,w)),w=null},l===void 0&&u.setContentType(null),"setRequestHeader"in w&&Ae.forEach(u.toJSON(),function(O,j){w.setRequestHeader(j,O)}),Ae.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),h&&h!=="json"&&(w.responseType=s.responseType),f&&([y,S]=Qd(f,!0),w.addEventListener("progress",y)),m&&w.upload&&([g,v]=Qd(m),w.upload.addEventListener("progress",g),w.upload.addEventListener("loadend",v)),(s.cancelToken||s.signal)&&(p=T=>{w&&(n(!T||T.type?new ol(null,e,w):T),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(p),s.signal&&(s.signal.aborted?p():s.signal.addEventListener("abort",p)));const C=nA(s.url);if(C&&xn.protocols.indexOf(C)===-1){n(new bt("Unsupported protocol "+C+":",bt.ERR_BAD_REQUEST,e));return}w.send(l||null)})},fA=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const l=function(f){if(!s){s=!0,h();const p=f instanceof Error?f:this.reason;n.abort(p instanceof bt?p:new ol(p instanceof Error?p.message:p))}};let u=t&&setTimeout(()=>{u=null,l(new bt(`timeout ${t} of ms exceeded`,bt.ETIMEDOUT))},t);const h=()=>{e&&(u&&clearTimeout(u),u=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),e=null)};e.forEach(f=>f.addEventListener("abort",l));const{signal:m}=n;return m.unsubscribe=()=>Ae.asap(h),m}},hA=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},mA=async function*(e,t){for await(const r of pA(e))yield*hA(r,t)},pA=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},_v=(e,t,r,n)=>{const s=mA(e,t);let l=0,u,h=m=>{u||(u=!0,n&&n(m))};return new ReadableStream({async pull(m){try{const{done:f,value:p}=await s.next();if(f){h(),m.close();return}let g=p.byteLength;if(r){let y=l+=g;r(y)}m.enqueue(new Uint8Array(p))}catch(f){throw h(f),f}},cancel(m){return h(m),s.return()}},{highWaterMark:2})},Mf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ow=Mf&&typeof ReadableStream=="function",xA=Mf&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Rw=(e,...t)=>{try{return!!e(...t)}catch{return!1}},gA=Ow&&Rw(()=>{let e=!1;const t=new Request(xn.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Cv=64*1024,Um=Ow&&Rw(()=>Ae.isReadableStream(new Response("").body)),Zd={stream:Um&&(e=>e.body)};Mf&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Zd[t]&&(Zd[t]=Ae.isFunction(e[t])?r=>r[t]():(r,n)=>{throw new bt(`Response type '${t}' is not supported`,bt.ERR_NOT_SUPPORT,n)})})})(new Response);const yA=async e=>{if(e==null)return 0;if(Ae.isBlob(e))return e.size;if(Ae.isSpecCompliantForm(e))return(await new Request(xn.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Ae.isArrayBufferView(e)||Ae.isArrayBuffer(e))return e.byteLength;if(Ae.isURLSearchParams(e)&&(e=e+""),Ae.isString(e))return(await xA(e)).byteLength},vA=async(e,t)=>{const r=Ae.toFiniteNumber(e.getContentLength());return r??yA(t)},bA=Mf&&(async e=>{let{url:t,method:r,data:n,signal:s,cancelToken:l,timeout:u,onDownloadProgress:h,onUploadProgress:m,responseType:f,headers:p,withCredentials:g="same-origin",fetchOptions:y}=kw(e);f=f?(f+"").toLowerCase():"text";let v=fA([s,l&&l.toAbortSignal()],u),S;const N=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let w;try{if(m&&gA&&r!=="get"&&r!=="head"&&(w=await vA(p,n))!==0){let j=new Request(t,{method:"POST",body:n,duplex:"half"}),q;if(Ae.isFormData(n)&&(q=j.headers.get("content-type"))&&p.setContentType(q),j.body){const[D,U]=Nv(w,Qd(Tv(m)));n=_v(j.body,Cv,D,U)}}Ae.isString(g)||(g=g?"include":"omit");const E="credentials"in Request.prototype;S=new Request(t,{...y,signal:v,method:r.toUpperCase(),headers:p.normalize().toJSON(),body:n,duplex:"half",credentials:E?g:void 0});let C=await fetch(S);const T=Um&&(f==="stream"||f==="response");if(Um&&(h||T&&N)){const j={};["status","statusText","headers"].forEach(K=>{j[K]=C[K]});const q=Ae.toFiniteNumber(C.headers.get("content-length")),[D,U]=h&&Nv(q,Qd(Tv(h),!0))||[];C=new Response(_v(C.body,Cv,D,()=>{U&&U(),N&&N()}),j)}f=f||"text";let O=await Zd[Ae.findKey(Zd,f)||"text"](C,e);return!T&&N&&N(),await new Promise((j,q)=>{jw(j,q,{data:O,headers:Mn.from(C.headers),status:C.status,statusText:C.statusText,config:e,request:S})})}catch(E){throw N&&N(),E&&E.name==="TypeError"&&/Load failed|fetch/i.test(E.message)?Object.assign(new bt("Network Error",bt.ERR_NETWORK,e,S),{cause:E.cause||E}):bt.from(E,E&&E.code,e,S)}}),Im={http:FC,xhr:dA,fetch:bA};Ae.forEach(Im,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Av=e=>`- ${e}`,wA=e=>Ae.isFunction(e)||e===null||e===!1,Mw={getAdapter:e=>{e=Ae.isArray(e)?e:[e];const{length:t}=e;let r,n;const s={};for(let l=0;l<t;l++){r=e[l];let u;if(n=r,!wA(r)&&(n=Im[(u=String(r)).toLowerCase()],n===void 0))throw new bt(`Unknown adapter '${u}'`);if(n)break;s[u||"#"+l]=n}if(!n){const l=Object.entries(s).map(([h,m])=>`adapter ${h} `+(m===!1?"is not supported by the environment":"is not available in the build"));let u=t?l.length>1?`since :
`+l.map(Av).join(`
`):" "+Av(l[0]):"as no adapter specified";throw new bt("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return n},adapters:Im};function im(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ol(null,e)}function jv(e){return im(e),e.headers=Mn.from(e.headers),e.data=sm.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Mw.getAdapter(e.adapter||ru.adapter)(e).then(function(n){return im(e),n.data=sm.call(e,e.transformResponse,n),n.headers=Mn.from(n.headers),n},function(n){return Aw(n)||(im(e),n&&n.response&&(n.response.data=sm.call(e,e.transformResponse,n.response),n.response.headers=Mn.from(n.response.headers))),Promise.reject(n)})}const Fw="1.9.0",Ff={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ff[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Dv={};Ff.transitional=function(t,r,n){function s(l,u){return"[Axios v"+Fw+"] Transitional option '"+l+"'"+u+(n?". "+n:"")}return(l,u,h)=>{if(t===!1)throw new bt(s(u," has been removed"+(r?" in "+r:"")),bt.ERR_DEPRECATED);return r&&!Dv[u]&&(Dv[u]=!0,console.warn(s(u," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(l,u,h):!0}};Ff.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function SA(e,t,r){if(typeof e!="object")throw new bt("options must be an object",bt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const l=n[s],u=t[l];if(u){const h=e[l],m=h===void 0||u(h,l,e);if(m!==!0)throw new bt("option "+l+" must be "+m,bt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new bt("Unknown option "+l,bt.ERR_BAD_OPTION)}}const Hd={assertOptions:SA,validators:Ff},Ia=Hd.validators;let Ii=class{constructor(t){this.defaults=t||{},this.interceptors={request:new wv,response:new wv}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const l=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Yi(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:l}=r;n!==void 0&&Hd.assertOptions(n,{silentJSONParsing:Ia.transitional(Ia.boolean),forcedJSONParsing:Ia.transitional(Ia.boolean),clarifyTimeoutError:Ia.transitional(Ia.boolean)},!1),s!=null&&(Ae.isFunction(s)?r.paramsSerializer={serialize:s}:Hd.assertOptions(s,{encode:Ia.function,serialize:Ia.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Hd.assertOptions(r,{baseUrl:Ia.spelling("baseURL"),withXsrfToken:Ia.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let u=l&&Ae.merge(l.common,l[r.method]);l&&Ae.forEach(["delete","get","head","post","put","patch","common"],S=>{delete l[S]}),r.headers=Mn.concat(u,l);const h=[];let m=!0;this.interceptors.request.forEach(function(N){typeof N.runWhen=="function"&&N.runWhen(r)===!1||(m=m&&N.synchronous,h.unshift(N.fulfilled,N.rejected))});const f=[];this.interceptors.response.forEach(function(N){f.push(N.fulfilled,N.rejected)});let p,g=0,y;if(!m){const S=[jv.bind(this),void 0];for(S.unshift.apply(S,h),S.push.apply(S,f),y=S.length,p=Promise.resolve(r);g<y;)p=p.then(S[g++],S[g++]);return p}y=h.length;let v=r;for(g=0;g<y;){const S=h[g++],N=h[g++];try{v=S(v)}catch(w){N.call(this,w);break}}try{p=jv.call(this,v)}catch(S){return Promise.reject(S)}for(g=0,y=f.length;g<y;)p=p.then(f[g++],f[g++]);return p}getUri(t){t=Yi(this.defaults,t);const r=Dw(t.baseURL,t.url,t.allowAbsoluteUrls);return Ew(r,t.params,t.paramsSerializer)}};Ae.forEach(["delete","get","head","options"],function(t){Ii.prototype[t]=function(r,n){return this.request(Yi(n||{},{method:t,url:r,data:(n||{}).data}))}});Ae.forEach(["post","put","patch"],function(t){function r(n){return function(l,u,h){return this.request(Yi(h||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:u}))}}Ii.prototype[t]=r(),Ii.prototype[t+"Form"]=r(!0)});let NA=class Lw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(s=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](s);n._listeners=null}),this.promise.then=s=>{let l;const u=new Promise(h=>{n.subscribe(h),l=h}).then(s);return u.cancel=function(){n.unsubscribe(l)},u},t(function(l,u,h){n.reason||(n.reason=new ol(l,u,h),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Lw(function(s){t=s}),cancel:t}}};function TA(e){return function(r){return e.apply(null,r)}}function EA(e){return Ae.isObject(e)&&e.isAxiosError===!0}const zm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zm).forEach(([e,t])=>{zm[t]=e});function Pw(e){const t=new Ii(e),r=hw(Ii.prototype.request,t);return Ae.extend(r,Ii.prototype,t,{allOwnKeys:!0}),Ae.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return Pw(Yi(e,s))},r}const gr=Pw(ru);gr.Axios=Ii;gr.CanceledError=ol;gr.CancelToken=NA;gr.isCancel=Aw;gr.VERSION=Fw;gr.toFormData=Rf;gr.AxiosError=bt;gr.Cancel=gr.CanceledError;gr.all=function(t){return Promise.all(t)};gr.spread=TA;gr.isAxiosError=EA;gr.mergeConfig=Yi;gr.AxiosHeaders=Mn;gr.formToJSON=e=>Cw(Ae.isHTMLForm(e)?new FormData(e):e);gr.getAdapter=Mw.getAdapter;gr.HttpStatusCode=zm;gr.default=gr;const{Axios:ZU,AxiosError:JU,CanceledError:eI,isCancel:tI,CancelToken:rI,VERSION:nI,all:aI,Cancel:sI,isAxiosError:iI,spread:oI,toFormData:lI,AxiosHeaders:cI,HttpStatusCode:uI,formToJSON:dI,getAdapter:fI,mergeConfig:hI}=gr,Bw="https://crm-backend-o36v.onrender.com";console.log("API Service Configuration:");console.log("- Environment: Production");console.log(`- API URL: ${Bw}`);console.log("- import.meta.env.DEV: false");const ht=gr.create({baseURL:Bw,headers:{"Content-Type":"application/json"}});ht.interceptors.request.use(e=>{const t=localStorage.getItem("token");t?(e.headers.Authorization=`Bearer ${t}`,console.log("Setting auth header:",`Bearer ${t.substring(0,15)}...`)):console.log("No token found in localStorage");const r=e.baseURL+e.url;return console.log(`API Request: ${e.method.toUpperCase()} ${r}`),e.data&&console.log("Request payload:",e.data),e},e=>(console.error("Request interceptor error:",e),Promise.reject(e)));ht.interceptors.response.use(e=>e,e=>(e.response&&(console.error("API Error:",{status:e.response.status,data:e.response.data,url:e.config.url,method:e.config.method}),e.response.status===401&&(console.log("Unauthorized response detected - checking token"),localStorage.getItem("token")&&console.log("Token exists but rejected - might be expired or invalid"))),Promise.reject(e)));const fr={register:e=>ht.post("/api/auth/register",e),login:e=>ht.post("/api/auth/login",e),getCurrentUser:()=>ht.get("/api/auth/me"),getUsers:e=>ht.get(`/api/auth/users${e?`?role=${e}`:""}`),updateUser:(e,t)=>ht.put(`/api/auth/users/${e}`,t),deleteUser:e=>ht.delete(`/api/auth/users/${e}`),updateProfilePicture:e=>ht.put("/api/auth/profile-picture",{profilePicture:e}),sendOTP:e=>ht.post("/api/auth/sendOTPToEmail",{email:e}),verifyOTP:e=>ht.post("/api/auth/verifyOtp",e),resetPassword:e=>ht.post("/api/auth/reset_password",e)},Fn={getAll:()=>(console.log("Calling leadsAPI.getAll()"),ht.get("/api/leads")),getById:e=>(console.log(`Calling leadsAPI.getById(${e})`),ht.get(`/api/leads/${e}`)),create:e=>{console.log("Calling leadsAPI.create() with data:",e);const r=["NAME","COURSE","CODE","NUMBER","COUNTRY","SALE PERSON"].filter(n=>!e[n]);return r.length>0&&(console.error("API Service - Missing required fields:",r),console.error("Lead data received:",e)),ht.post("/api/leads",e)},update:(e,t)=>(console.log(`Calling leadsAPI.update(${e}) with data:`,t),ht.put(`/api/leads/${e}`,t)),delete:e=>ht.delete(`/api/leads/${e}`),getAssigned:()=>ht.get("/api/leads/assigned"),getAllCustomers:()=>ht.get("/api/leads/customers"),updateFeedback:(e,t)=>ht.put(`/api/leads/${e}/feedback`,{feedback:t}),importLeads:e=>ht.post("/api/leads/import",e),getRepeatCustomers:()=>(console.log("Calling leadsAPI.getRepeatCustomers()"),ht.get("/api/leads/repeat-customers"))},Wn={getAll:()=>ht.get("/api/sales"),getById:e=>ht.get(`/api/sales/${e}`),create:e=>(e.leadPerson&&!e.hasOwnProperty("isLeadPersonSale")&&(console.log("Setting isLeadPersonSale to true because leadPerson is specified"),e.isLeadPersonSale=!0),ht.post("/api/sales",e)),createReferenceSale:e=>ht.post("/api/sales",{...e,source:"Reference",isLeadPersonSale:!!e.leadPerson}),createLeadPersonSale:e=>ht.post("/api/sales",{...e,isLeadPersonSale:!0}),update:(e,t)=>ht.put(`/api/sales/${e}`,t),delete:e=>ht.delete(`/api/sales/${e}`),updateToken:(e,t)=>ht.put(`/api/sales/${e}/token`,{token:t}),updatePending:(e,t)=>ht.put(`/api/sales/${e}/pending`,{pending:t}),importSales:e=>ht.post("/api/sales/import",e),getLeadSheet:(e={})=>(console.log("Using new lead-sales endpoint with filters:",e),ht.get("/api/lead-sales",{params:e})),createSaleWithLeadPerson:(e,t)=>(console.log(`Creating sale assigned to lead person: ${t}`),ht.post("/api/sales",{...e,leadPerson:t,isLeadPersonSale:!0}))},om={getAll:()=>ht.get("/api/lead-person-sales"),getById:e=>ht.get(`/api/lead-person-sales/${e}`),create:e=>ht.post("/api/lead-person-sales",e),update:(e,t)=>ht.put(`/api/lead-person-sales/${e}`,t),delete:e=>ht.delete(`/api/lead-person-sales/${e}`)},Uw={getRates:()=>ht.get("/api/currency/rates")},hc={getAll:()=>ht.get("/api/tasks"),getById:e=>ht.get(`/api/tasks/${e}`),create:e=>ht.post("/api/tasks",e),update:(e,t)=>ht.put(`/api/tasks/${e}`,t),delete:e=>ht.delete(`/api/tasks/${e}`),updateStatus:(e,t)=>ht.put(`/api/tasks/${e}`,{completed:t})},Iw=k.createContext(),_A=({children:e})=>{const[t,r]=k.useState(null),[n,s]=k.useState(!0),[l,u]=k.useState(null);k.useEffect(()=>{localStorage.getItem("token")?h():s(!1)},[]);const h=async()=>{try{s(!0);const g=localStorage.getItem("token");console.log("Loading user data with token:",g?"Present":"Not present");const y=await fr.getCurrentUser();console.log("User data loaded from API:",y.data),console.log("User object structure:",y.data.data),r(y.data.data),console.log("User set in state:",y.data.data),u(null)}catch(g){console.error("Failed to load user",g),localStorage.removeItem("token"),r(null),u("Authentication failed. Please login again.")}finally{s(!1)}},m=async g=>{var y,v,S,N;try{s(!0),console.log("Attempting registration with data:",{...g,password:"[REDACTED]"});const w=await fr.register(g);return console.log("Registration successful:",w.data),u(null),w.data}catch(w){console.error("Registration failed:",{message:w.message,response:(y=w.response)==null?void 0:y.data,status:(v=w.response)==null?void 0:v.status});const E=((N=(S=w.response)==null?void 0:S.data)==null?void 0:N.message)||"Registration failed. Please try again.";throw u(E),new Error(E)}finally{s(!1)}},f=async g=>{var y,v;try{s(!0);const S=await fr.login(g);return console.log("Login response:",S.data),console.log("Login user object:",S.data.user),localStorage.setItem("token",S.data.token),r(S.data.user),u(null),{...S.data,tokenStatus:S.data.token?"Valid":"Missing"}}catch(S){throw console.error("Login failed",S),u(((v=(y=S.response)==null?void 0:y.data)==null?void 0:v.message)||"Invalid credentials"),S}finally{s(!1)}},p=()=>{localStorage.removeItem("token"),r(null)};return o.jsx(Iw.Provider,{value:{user:t,loading:n,error:l,register:m,login:f,logout:p,setUser:r,loadUser:h},children:e})},Tr=()=>k.useContext(Iw);let Vm={currency:"USD",locale:"en-US",rate:1,exchangeRates:{USD:1,INR:84.62,EUR:.92,GBP:.79}};const kv=e=>{if(e==null)return"N/A";const t=Yd();try{return new Intl.NumberFormat(t.locale,{style:"currency",currency:t.currency,minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}catch(r){return console.error("Error formatting currency:",r),`${t.symbol}${e.toFixed(2)}`}},mc=e=>{Vm={...Vm,...e}},Yd=()=>({...Vm}),Po={USD:{locale:"en-US",label:"USD ($)",symbol:"$"},INR:{locale:"en-IN",label:"INR ()",symbol:""},EUR:{locale:"en-EU",label:"EUR ()",symbol:""},GBP:{locale:"en-GB",label:"GBP ()",symbol:""},JPY:{locale:"ja-JP",label:"JPY ()",symbol:""},CAD:{locale:"en-CA",label:"CAD ($)",symbol:"C$"},AUD:{locale:"en-AU",label:"AUD ($)",symbol:"A$"},CNY:{locale:"zh-CN",label:"CNY ()",symbol:""},SGD:{locale:"en-SG",label:"SGD ($)",symbol:"S$"},CHF:{locale:"de-CH",label:"CHF (Fr)",symbol:"Fr"},AED:{locale:"ar-AE",label:"AED (.)",symbol:"."}},Ed={USD:1,INR:84.62,EUR:.92,GBP:.79,JPY:151.15,CAD:1.37,AUD:1.52,CNY:7.24,SGD:1.35,CHF:.9,AED:3.67},CA=()=>{const[e,t]=k.useState(()=>Yd().currency),[r,n]=k.useState(Ed),[s,l]=k.useState([]),[u,h]=k.useState(null),[m,f]=k.useState(null);k.useEffect(()=>{p();const v=setInterval(p,60*60*1e3);return()=>clearInterval(v)},[]);const p=async()=>{try{const v=await Uw.getRates();if(v.data&&v.data.rates){const S=v.data.rates;n(S);const N=Object.keys(S).filter(w=>Po[w]).map(w=>({code:w,...Po[w],rate:S[w]})).sort((w,E)=>w.code==="USD"?-1:E.code==="USD"?1:w.code.localeCompare(E.code));l(N),f(new Date(v.data.date||new Date)),h(v.data.source==="fallback"?"Using backup rates":null),mc({...Yd(),exchangeRates:S,lastUpdated:v.data.date||new Date().toISOString()}),console.log("Updated exchange rates:",S),localStorage.setItem("exchange_rates",JSON.stringify(S)),localStorage.setItem("rates_last_updated",v.data.date||new Date().toISOString()),v.data.source==="fallback"&&console.warn("Using fallback exchange rates - all APIs failed")}else throw new Error("Invalid response format from currency API")}catch(v){console.error("Failed to fetch exchange rates:",v),h("Using last known rates");const S=localStorage.getItem("exchange_rates"),N=localStorage.getItem("rates_last_updated");if(S)try{const w=JSON.parse(S);n(w);const E=Object.keys(w).filter(C=>Po[C]).map(C=>({code:C,...Po[C],rate:w[C]})).sort((C,T)=>C.code==="USD"?-1:T.code==="USD"?1:C.code.localeCompare(T.code));l(E),f(new Date(N)),mc({...Yd(),exchangeRates:w,lastUpdated:N})}catch{n(Ed);const E=Object.keys(Ed).filter(C=>Po[C]).map(C=>({code:C,...Po[C],rate:Ed[C]})).sort((C,T)=>C.code==="USD"?-1:T.code==="USD"?1:C.code.localeCompare(T.code));l(E)}}};k.useEffect(()=>{if(s.length===0)return;const v=localStorage.getItem("preferred_currency");if(v){const S=s.find(N=>N.code===v);S&&(mc({currency:S.code,locale:S.locale,rate:r[S.code]||S.rate,exchangeRates:r}),t(S.code))}else{const S=s.find(N=>N.code==="USD")||s[0];mc({currency:S.code,locale:S.locale,rate:r[S.code]||S.rate,exchangeRates:r})}},[s,r]);const g=v=>{const S=v.target.value,N=s.find(w=>w.code===S);N&&(mc({currency:N.code,locale:N.locale,rate:r[N.code]||N.rate,exchangeRates:r}),t(N.code),localStorage.setItem("preferred_currency",N.code),window.location.reload())},y=v=>{if(!v)return"";const N=new Date-v,w=Math.floor(N/(1e3*60));if(w<1)return"just now";if(w<60)return`${w} mins ago`;const E=Math.floor(w/60);return E<24?`${E} hours ago`:`${Math.floor(E/24)} days ago`};return s.length===0?o.jsxs("div",{className:"flex items-center text-white text-sm",children:[o.jsx("span",{className:"mr-2",children:"Loading currencies..."}),o.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white rounded-full border-t-transparent"})]}):o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("label",{htmlFor:"currency-selector",className:"text-sm text-white mr-2",children:"Currency:"}),o.jsx("select",{id:"currency-selector",value:e,onChange:g,className:"text-sm border border-gray-300 rounded p-1 focus:outline-none focus:ring-blue-500 focus:border-blue-500 bg-blue-700 text-white font-medium",style:{WebkitAppearance:"menulist",MozAppearance:"menulist",appearance:"menulist"},children:s.map(v=>o.jsxs("option",{value:v.code,style:{backgroundColor:"#fff",color:"#333",padding:"6px"},children:[v.label," ",v.code!=="USD"&&`(1 USD = ${v.rate.toFixed(2)})`]},v.code))})]}),o.jsxs("div",{className:"text-xs text-blue-200 mt-1",children:[u&&o.jsx("span",{className:"text-yellow-200 mr-2",children:u}),m&&`Rates updated: ${y(m)}`]})]})},AA=()=>{const{user:e,logout:t}=Tr(),r=ui(),[n,s]=k.useState(!1),l=()=>{t(),r("/login")},u=()=>{s(!n)};return o.jsx("header",{className:"bg-blue-600 text-white py-4 shadow-md",children:o.jsxs("nav",{className:"container mx-auto flex justify-between items-center",children:[o.jsxs("a",{href:"/",children:[" ",o.jsx("h1",{className:"text-xl font-bold",children:"My CRM"})]}),o.jsx("button",{className:"text-white md:hidden",onClick:u,children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16m-7 6h7"})})}),o.jsxs("ul",{className:`flex-col md:flex-row md:flex space-x-4 ${n?"flex":"hidden"} md:flex`,children:[o.jsx("li",{children:o.jsx(Nt,{to:"/",className:"hover:text-blue-300",children:"Home"})}),e&&(e.role==="Lead Person"||e.role==="Manager"||e.role==="Admin")&&o.jsx("li",{children:o.jsx(Nt,{to:"/leads",className:"hover:text-blue-300",children:"Leads"})}),e&&(e.role==="Lead Person"||e.role==="Manager"||e.role==="Admin")&&o.jsx(o.Fragment,{children:o.jsx("li",{children:o.jsx(Nt,{to:"/lead-sales-sheet",className:"hover:text-blue-300",children:"Lead Sales Sheet"})})}),e&&e.role==="Sales Person"&&o.jsx("li",{children:o.jsx(Nt,{to:"/sales",className:"hover:text-blue-300",children:"My Leads"})}),e&&(e.role==="Sales Person"||e.role==="Manager"||e.role==="Admin")&&o.jsx("li",{children:o.jsx(Nt,{to:"/sales-tracking",className:"hover:text-blue-300",children:"Sales Tracking"})}),e&&e.role==="Admin"&&o.jsxs(o.Fragment,{children:[o.jsx("li",{children:o.jsx(Nt,{to:"/admin",className:"hover:text-blue-300",children:"Admin Dashboard"})}),o.jsx("li",{children:o.jsx(Nt,{to:"/admin/users",className:"hover:text-blue-300",children:"Manage Users"})}),o.jsx("li",{children:o.jsx(Nt,{to:"/admin/leads",className:"hover:text-blue-300",children:"Manage Leads"})}),o.jsx("li",{children:o.jsx(Nt,{to:"/admin/import",className:"hover:text-blue-300",children:"Import Data"})})]}),o.jsx("li",{className:"ml-4",children:o.jsx(CA,{})}),e?o.jsxs(o.Fragment,{children:[o.jsx("li",{children:o.jsx(Nt,{to:"/profile",className:"hover:text-blue-300",children:"Profile"})}),o.jsx("li",{children:o.jsx("button",{onClick:l,className:"bg-blue-700 hover:bg-blue-800 px-3 py-1 rounded-md transition duration-300",children:"Logout"})})]}):o.jsx("li",{children:o.jsx(Nt,{to:"/login",className:"hover:text-blue-300",children:"Login"})})]})]})})},jA=()=>o.jsx("footer",{className:"bg-gray-800 text-white py-6",children:o.jsxs("div",{className:"container mx-auto px-4",children:[o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[o.jsxs("div",{className:"mb-4 md:mb-0",children:[o.jsx("h3",{className:"text-xl font-bold",children:"CRM Platform"}),o.jsx("p",{className:"text-gray-400 mt-1",children:"Streamlining your business relationships"})]}),o.jsxs("div",{className:"flex space-x-8",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-2",children:"Resources"}),o.jsxs("ul",{className:"space-y-1",children:[o.jsx("li",{children:o.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition",children:"Documentation"})}),o.jsx("li",{children:o.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition",children:"Help Center"})}),o.jsx("li",{children:o.jsx("a",{href:"#tutorials",className:"text-gray-400 hover:text-white transition",children:"Tutorials"})}),o.jsx("li",{children:o.jsx("a",{href:"#countries",className:"text-gray-400 hover:text-white transition",children:"Countries"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-2",children:"Company"}),o.jsxs("ul",{className:"space-y-1",children:[o.jsx("li",{children:o.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition",children:"About Us"})}),o.jsx("li",{children:o.jsx("a",{href:"#",className:"text-gray-400 hover:text-white transition",children:"Careers"})}),o.jsx("li",{children:o.jsx("a",{href:"#management-contacts",className:"text-gray-400 hover:text-white transition",children:"Contact"})})]})]})]})]}),o.jsx("div",{className:"border-t border-gray-700 mt-6 pt-6 text-center md:text-left",children:o.jsxs("p",{children:[" ",new Date().getFullYear()," CRM Platform. All Rights Reserved."]})})]})}),jr=({children:e})=>o.jsxs("div",{className:"min-h-screen flex flex-col",children:[o.jsx(AA,{}),o.jsx("main",{className:"flex-grow",children:e}),o.jsx(jA,{})]}),Ov=()=>{const{user:e}=Tr();return o.jsxs(jr,{children:[o.jsx("div",{className:"bg-gradient-to-br from-blue-700 to-indigo-800 text-white py-12 md:py-20 flex items-center",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-3xl mx-auto",children:[o.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-bold mb-4 text-center sm:text-left",children:"TrainCape CRM"}),o.jsx("p",{className:"text-lg sm:text-xl mb-6 text-center sm:text-left",children:"Manage leads and track sales in one centralized platform."}),e?o.jsxs("div",{className:"flex flex-wrap gap-4 justify-center sm:justify-start",children:[e.role==="Sales Person"&&o.jsx(Nt,{to:"/sales",className:"w-full sm:w-auto px-6 py-3 bg-white text-blue-700 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition text-center",children:"My Leads"}),(e.role==="Lead Person"||e.role==="Manager"||e.role==="Admin")&&o.jsx(Nt,{to:"/leads",className:"w-full sm:w-auto px-6 py-3 bg-white text-blue-700 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition text-center",children:"Manage Leads"}),o.jsx(Nt,{to:"/profile",className:"w-full sm:w-auto px-6 py-3 bg-transparent border-2 border-white text-white font-semibold rounded-lg hover:bg-white hover:text-blue-700 transition text-center",children:"My Profile"})]}):o.jsx("div",{className:"flex flex-wrap gap-4 justify-center sm:justify-start",children:o.jsx(Nt,{to:"/login",className:"w-full sm:w-auto px-6 py-3 bg-white text-blue-700 font-semibold rounded-lg shadow-md hover:bg-gray-100 transition text-center",children:"Sign In"})})]})})}),o.jsx("div",{className:"bg-gray-50 py-6",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 -mt-6 sm:-mt-8 md:-mt-10 relative z-10",children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[o.jsx("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow hover:shadow-md transition",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start",children:[o.jsx("div",{className:"bg-blue-100 text-blue-700 p-3 rounded-lg mb-3 sm:mb-0 sm:mr-4",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),o.jsxs("div",{className:"text-center sm:text-left",children:[o.jsx("h3",{className:"text-lg font-bold mb-1",children:"Contact Management"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Organize client data with powerful filters and segments."}),o.jsx(Nt,{to:"/management-contacts",className:"text-blue-700 font-medium text-sm mt-2 inline-block",children:"Access Contacts "})]})]})}),o.jsx("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow hover:shadow-md transition",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start",children:[o.jsx("div",{className:"bg-green-100 text-green-700 p-3 rounded-lg mb-3 sm:mb-0 sm:mr-4",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsxs("div",{className:"text-center sm:text-left",children:[o.jsx("h3",{className:"text-lg font-bold mb-1",children:"Sales Pipeline"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Track deals from lead to close with customizable processes."}),o.jsx(Nt,{to:"/sales",className:"text-green-700 font-medium text-sm mt-2 inline-block",children:"View Pipeline "})]})]})}),o.jsx("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow hover:shadow-md transition",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start",children:[o.jsx("div",{className:"bg-purple-100 text-purple-700 p-3 rounded-lg mb-3 sm:mb-0 sm:mr-4",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),o.jsxs("div",{className:"text-center sm:text-left",children:[o.jsx("h3",{className:"text-lg font-bold mb-1",children:"Task Management"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Schedule exams and get automated reminders."}),o.jsx(Nt,{to:"/tasks",className:"text-purple-700 font-medium text-sm mt-2 inline-block",children:"Manage Tasks "})]})]})}),e&&(e.role==="Manager"||e.role==="Admin")&&o.jsx("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow hover:shadow-md transition",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start",children:[o.jsx("div",{className:"bg-indigo-100 text-indigo-700 p-3 rounded-lg mb-3 sm:mb-0 sm:mr-4",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),o.jsxs("div",{className:"text-center sm:text-left",children:[o.jsx("h3",{className:"text-lg font-bold mb-1",children:"Manager Dashboard"}),o.jsx("p",{className:"text-gray-600 text-sm",children:"Manage users, roles and system access."}),o.jsx(Nt,{to:"/manager",className:"text-indigo-700 font-medium text-sm mt-2 inline-block",children:"Access Dashboard "})]})]})})]})})}),o.jsx("div",{className:"bg-white py-8 sm:py-10",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[{label:"Leads",value:"Today",icon:""},{label:"Tasks",value:"Pending",icon:""},{label:"Sales",value:"This Month",icon:""},{label:"Team",value:"Members",icon:""}].map((t,r)=>o.jsxs(Nt,{to:r===0?"sales":r===1?"/tasks":r===2?"sales-tracking":"/profile",className:"bg-gray-50 rounded-lg p-3 sm:p-4 text-center hover:bg-gray-100 transition",children:[o.jsx("div",{className:"text-xl sm:text-2xl mb-1",children:t.icon}),o.jsx("div",{className:"text-base sm:text-lg font-bold",children:t.label}),o.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:t.value})]},r))})})}),o.jsx("div",{className:"bg-gray-50 py-8 sm:py-10",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("h2",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-center",children:["Your Role: ",(e==null?void 0:e.role)||"Not Logged In"]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow",children:[o.jsx("h3",{className:"font-bold text-blue-700 mb-2 text-center sm:text-left",children:"Lead Person"}),o.jsxs("ul",{className:"space-y-2",children:[o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Create and manage leads"})]}),o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Assign leads to team members"})]}),o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Track lead progress"})]})]})]}),o.jsxs("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow",children:[o.jsx("h3",{className:"font-bold text-green-700 mb-2 text-center sm:text-left",children:"Sales Person"}),o.jsxs("ul",{className:"space-y-2",children:[o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Access assigned leads"})]}),o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Update lead status"})]}),o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Schedule and track exams"})]})]})]}),o.jsxs("div",{className:"bg-white p-4 sm:p-5 rounded-lg shadow",children:[o.jsx("h3",{className:"font-bold text-purple-700 mb-2 text-center sm:text-left",children:"Manager/Admin"}),o.jsxs("ul",{className:"space-y-2",children:[o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Full system access"})]}),o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"View all leads and sales"})]}),o.jsxs("li",{className:"flex items-start text-sm",children:[o.jsx("svg",{className:"h-4 w-4 text-green-500 mr-2 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),o.jsx("span",{children:"Manage team and generate reports"})]}),e&&(e.role==="Manager"||e.role==="Admin")&&o.jsx("li",{className:"mt-4",children:o.jsx(Nt,{to:"/manager",className:"inline-block w-full bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-4 rounded text-center transition",children:"Access Manager Dashboard"})})]})]})]})]})}),o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white py-8 sm:py-10",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 text-center",children:e?o.jsxs("div",{children:[o.jsxs("h2",{className:"text-xl sm:text-2xl font-bold mb-3",children:["Welcome, ",e.fullName]}),o.jsx("p",{className:"mb-4 text-sm sm:text-base",children:"Access your dashboard to manage your tasks."}),o.jsx(Nt,{to:e.role==="Sales Person"?"/sales":"/leads",className:"px-6 py-3 bg-white text-blue-700 font-semibold rounded-lg shadow hover:bg-gray-100 transition inline-block w-full sm:w-auto",children:"Go to Dashboard"})]}):o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-4",children:"Sign in to access your dashboard"}),o.jsx(Nt,{to:"/login",className:"px-6 py-3 bg-white text-blue-700 font-semibold rounded-lg shadow hover:bg-gray-100 transition inline-block w-full sm:w-auto",children:"Login"})]})})})]})},DA=()=>{const e=ui(),t=Ns(),{login:r,error:n}=Tr(),[s,l]=k.useState({email:"",password:""}),[u,h]=k.useState(""),[m,f]=k.useState(""),[p,g]=k.useState(!1),[y,v]=k.useState(!1);k.useEffect(()=>{var E;(E=t.state)!=null&&E.message&&(f(t.state.message),t.state.email&&l(C=>({...C,email:t.state.email})))},[t]);const S=E=>{l({...s,[E.target.name]:E.target.value})},N=()=>{v(!y)},w=async E=>{var C,T;E.preventDefault(),h(""),f("");try{g(!0);const O={email:s.email,password:s.password},j=await r(O);switch(console.log("Login successful. Token:",j.token?"Present":"Not present"),setTimeout(()=>{const q=localStorage.getItem("token");console.log("Stored token check:",q?"Present":"Not present")},500),j.user.role){case"Lead Person":case"Manager":case"Admin":e("/leads");break;case"Sales Person":e("/sales");break;default:e("/")}}catch(O){h(((T=(C=O.response)==null?void 0:C.data)==null?void 0:T.message)||"Invalid credentials. Please try again.")}finally{g(!1)}};return o.jsx(jr,{children:o.jsx("div",{className:"flex-grow flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gray-50",children:o.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),o.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",o.jsx(Nt,{to:"/signup",className:"font-medium text-blue-600 hover:text-blue-500",children:"create a new account"})]})]}),m&&o.jsx("div",{className:"p-3 bg-green-50 text-green-700 border border-green-200 rounded-md",children:m}),(u||n)&&o.jsx("div",{className:"p-3 bg-red-50 text-red-700 border border-red-200 rounded-md",children:u||n}),o.jsxs("form",{className:"mt-8 space-y-6",onSubmit:w,children:[o.jsxs("div",{className:"rounded-md -space-y-px",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email address"}),o.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:s.email,onChange:S})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"password",name:"password",type:y?"text":"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm pr-10",placeholder:"Password",value:s.password,onChange:S}),o.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-sm text-gray-500 hover:text-gray-800",onClick:N,children:y?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),o.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),o.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),o.jsx("div",{className:"text-sm",children:o.jsx(Nt,{to:"/forgot-password",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",disabled:p,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent rounded-md text-white ${p?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition`,children:p?"Signing in...":"Sign in"})})]})]})})})},kA=()=>{const e=ui(),{register:t,error:r}=Tr(),[n,s]=k.useState({fullName:"",email:"",password:"",confirmPassword:"",role:"Sales Person"}),[l,u]=k.useState(""),[h,m]=k.useState(!1),f=g=>{s({...n,[g.target.name]:g.target.value})},p=async g=>{var y,v;if(g.preventDefault(),u(""),n.password!==n.confirmPassword){u("Passwords do not match");return}if(n.password.length<6){u("Password must be at least 6 characters");return}try{m(!0);const S={fullName:n.fullName,email:n.email,password:n.password,role:n.role};await t(S),e("/login",{state:{message:"Registration successful! Please login with your credentials.",email:n.email}})}catch(S){u(((v=(y=S.response)==null?void 0:y.data)==null?void 0:v.message)||"Registration failed. Please try again.")}finally{m(!1)}};return o.jsx(jr,{children:o.jsx("div",{className:"flex-grow flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8 bg-gray-50",children:o.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create a new account"}),o.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",o.jsx(Nt,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"sign in to your existing account"})]})]}),(l||r)&&o.jsx("div",{className:"p-3 bg-red-50 text-red-700 border border-red-200 rounded-md",children:l||r}),o.jsxs("form",{className:"mt-8 space-y-6",onSubmit:p,children:[o.jsxs("div",{className:"rounded-md -space-y-px",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),o.jsx("input",{id:"fullName",name:"fullName",type:"text",autoComplete:"name",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Full Name",value:n.fullName,onChange:f})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email address"}),o.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:n.email,onChange:f})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),o.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:n.password,onChange:f})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),o.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:n.confirmPassword,onChange:f})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),o.jsxs("select",{id:"role",name:"role",className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",value:n.role,onChange:f,children:[o.jsx("option",{value:"Lead Person",children:"Lead Person"}),o.jsx("option",{value:"Sales Person",children:"Sales Person"}),o.jsx("option",{value:"Manager",children:"Manager"}),o.jsx("option",{value:"Admin",children:"Admin"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"For initial setup, you can create an Admin account. This option will be removed in production."})]})]}),o.jsx("div",{children:o.jsx("button",{type:"submit",disabled:h,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent rounded-md text-white ${h?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition`,children:h?"Creating Account...":"Create Account"})})]})]})})})},OA=({lead:e=null,onSuccess:t})=>{ui();const{user:r}=Tr(),[n,s]=k.useState([]),[l,u]=k.useState([]),[h,m]=k.useState(!1),[f,p]=k.useState(null),[g,y]=k.useState({name:"",email:"",course:"",countryCode:"",phone:"",country:"",pseudoId:"",company:"",client:"",status:"Introduction",source:"",sourceLink:"",assignedTo:"",leadPerson:"",remarks:"",feedback:"",customCreatedAt:new Date().toISOString().split("T")[0]});k.useEffect(()=>{(async()=>{try{console.log("Fetching users for dropdowns");const w=await fr.getUsers("Sales Person");console.log("Sales persons fetched:",w.data.data),s(w.data.data||[]);const E=await fr.getUsers("Lead Person");console.log("Lead persons fetched:",E.data.data),u(E.data.data||[])}catch(w){console.error("Failed to fetch users",w)}})()},[]),k.useEffect(()=>{var N,w,E,C;if(console.log("========= FORM DATA INITIALIZATION ========="),console.log("Current user:",r),console.log("User ID formats:",{_id:r==null?void 0:r._id,id:r==null?void 0:r.id}),console.log("Lead data:",e),e){console.log("Editing existing lead, populating form with lead data");const T=e.createdAt?new Date(e.createdAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0];let O=e.countryCode||e.CODE||"";O=O.replace(/^\+/,"");const j={name:e.name||e.NAME||"",email:e.email||e["E-MAIL"]||"",course:e.course||e.COURSE||"",countryCode:O,phone:e.phone||e.NUMBER||"",country:e.country||e.COUNTRY||"",pseudoId:e.pseudoId||e["PSUDO ID"]||"",company:e.company||e.COMPANY||"",client:e.client||e["CLIENT REMARK"]||"",status:e.status||"Introduction",source:e.source||e.SOURSE||"",sourceLink:e.sourceLink||e["SOURCE LINK"]||"",assignedTo:((N=e.assignedTo)==null?void 0:N._id)||((w=e["SALE PERSON"])==null?void 0:w._id)||e["SALE PERSON"]||"",leadPerson:((E=e.leadPerson)==null?void 0:E._id)||((C=e["LEAD PERSON"])==null?void 0:C._id)||e["LEAD PERSON"]||"",remarks:e.remarks||"",feedback:e.feedback||e.FEEDBACK||"",customCreatedAt:T};y(j),console.log("Populated form data:",j)}else{console.log("Creating new lead, setting default values");const T=((r==null?void 0:r._id)||(r==null?void 0:r.id)||"").toString();console.log("Using user ID for defaults:",T);const O=new Date().toISOString().split("T")[0],j={name:"",email:"",course:"",countryCode:"1",phone:"",country:"",pseudoId:"",company:"",client:"",status:"Introduction",source:"",sourceLink:"",assignedTo:T,leadPerson:(r==null?void 0:r.role)==="Lead Person"?T:"",remarks:"",feedback:"",customCreatedAt:O};y(j),console.log("Default form data:",j)}console.log("==========================================")},[e,r]);const v=N=>{const{name:w,value:E}=N.target;console.log(`Field changed: ${w}, value: ${E}`),y(C=>({...C,[w]:E}))},S=async N=>{var E,C,T;if(N.preventDefault(),m(!0),p(null),console.log("========= FORM SUBMISSION ========="),console.log("Form data being submitted:",g),console.log("assignedTo value:",g.assignedTo),console.log("Custom creation date:",g.customCreatedAt),!g.assignedTo){console.error("assignedTo is required but not set"),p("Please select a sales person to assign this lead to"),m(!1);return}let w=g.countryCode||"";w=w.replace(/^\+/,"");try{let O;const j={name:g.name,NAME:g.name,email:g.email,"E-MAIL":g.email,course:g.course,COURSE:g.course,countryCode:w,CODE:w,phone:g.phone,NUMBER:g.phone,country:g.country,COUNTRY:g.country,pseudoId:g.pseudoId||"","PSUDO ID":g.pseudoId||"",client:g.client||"","CLIENT REMARK":g.client||"",status:g.status||"Introduction",source:g.source||"",SOURSE:g.source||"",sourceLink:g.sourceLink||"","SOURCE LINK":g.sourceLink||"",assignedTo:g.assignedTo,"SALE PERSON":g.assignedTo,leadPerson:g.leadPerson||"","LEAD PERSON":g.leadPerson||"",feedback:g.feedback||"",FEEDBACK:g.feedback||"",DATE:g.customCreatedAt?new Date(g.customCreatedAt).toISOString():new Date().toISOString(),createdAt:g.customCreatedAt?new Date(g.customCreatedAt).toISOString():new Date().toISOString()},D=["name","course","phone","country","assignedTo"].filter(U=>!g[U]||g[U].trim()==="");if(D.length>0){console.error("Missing required fields:",D),p(`Missing required fields: ${D.join(", ")}`),m(!1);return}if(g.email&&g.email.trim()!==""){if(!g.email.includes("@")){console.error("Invalid email format:",g.email),p("Please enter a valid email address or leave it blank"),m(!1);return}}else j.email="",j["E-MAIL"]="",console.log("Email field is blank, setting to empty string");console.log("Final data being sent:",j),e?(console.log("Updating existing lead:",e._id),O=await Fn.update(e._id,j)):(console.log("Creating new lead"),O=await Fn.create(j)),console.log("API response:",O.data),O.data&&O.data.success?(console.log("Lead saved successfully"),t(O.data.data)):(console.error("API returned success: false",O),p("Failed to save lead. Please check your input and try again."))}catch(O){console.error("Error saving lead:",O),console.error("Error response:",(E=O.response)==null?void 0:E.data),p(((T=(C=O.response)==null?void 0:C.data)==null?void 0:T.message)||"Failed to save lead. Please try again later.")}finally{m(!1)}};return o.jsxs("form",{onSubmit:S,className:"space-y-8",children:[f&&o.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:f}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Contact Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:["Full Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"name",id:"name",value:g.name,onChange:v,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),o.jsx("input",{type:"email",name:"email",id:"email",value:g.email,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:["Phone ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("div",{className:"mt-1 flex rounded-md shadow-sm",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("input",{type:"text",name:"countryCode",id:"countryCode",value:g.countryCode,onChange:v,placeholder:"Code",className:"block w-16 border border-gray-300 rounded-md rounded-r-none shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})}),o.jsx("input",{type:"text",name:"phone",id:"phone",value:g.phone,onChange:v,required:!0,className:"flex-1 block w-full border border-gray-300 rounded-md rounded-l-none shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700",children:["Country ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"country",id:"country",value:g.country,onChange:v,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Course Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"course",className:"block text-sm font-medium text-gray-700",children:["Course ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",name:"course",id:"course",value:g.course,onChange:v,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-gray-700",children:"Source"}),o.jsx("input",{type:"text",name:"source",id:"source",value:g.source,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"sourceLink",className:"block text-sm font-medium text-gray-700",children:"Source Link"}),o.jsx("input",{type:"text",name:"sourceLink",id:"sourceLink",value:g.sourceLink,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"pseudoId",className:"block text-sm font-medium text-gray-700",children:"Pseudo ID"}),o.jsx("input",{type:"text",name:"pseudoId",id:"pseudoId",value:g.pseudoId,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Assignment & Status"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"assignedTo",className:"block text-sm font-medium text-gray-700",children:["Assigned Sales Person ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{id:"assignedTo",name:"assignedTo",value:g.assignedTo,onChange:v,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select Sales Person"}),n.map(N=>o.jsx("option",{value:N._id,children:N.fullName||N.email},N._id))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"leadPerson",className:"block text-sm font-medium text-gray-700",children:"Lead Person"}),o.jsxs("select",{id:"leadPerson",name:"leadPerson",value:g.leadPerson,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select Lead Person"}),l.map(N=>o.jsx("option",{value:N._id,children:N.fullName||N.email},N._id))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),o.jsxs("select",{id:"status",name:"status",value:g.status,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"Introduction",children:"Introduction"}),o.jsx("option",{value:"Acknowledgement",children:"Acknowledgement"}),o.jsx("option",{value:"Question",children:"Question"}),o.jsx("option",{value:"Future Promise",children:"Future Promise"}),o.jsx("option",{value:"Payment",children:"Payment"}),o.jsx("option",{value:"Analysis",children:"Analysis"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"feedback",className:"block text-sm font-medium text-gray-700",children:"Feedback"}),o.jsxs("select",{id:"feedback",name:"feedback",value:g.feedback,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select Feedback"}),o.jsx("option",{value:"Pending",children:"Pending"}),o.jsx("option",{value:"Converted",children:"Converted"}),o.jsx("option",{value:"Not Interested",children:"Not Interested"}),o.jsx("option",{value:"Follow Up",children:"Follow Up"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Additional Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{htmlFor:"client",className:"block text-sm font-medium text-gray-700",children:"Client Remarks"}),o.jsx("textarea",{id:"client",name:"client",rows:"3",value:g.client,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"customCreatedAt",className:"block text-sm font-medium text-gray-700",children:"Date Added"}),o.jsx("input",{type:"date",name:"customCreatedAt",id:"customCreatedAt",value:g.customCreatedAt,onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})]})]}),o.jsx("div",{className:"pt-5 flex justify-end",children:o.jsx("button",{type:"submit",disabled:h,className:"ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:h?"Saving...":e?"Update Lead":"Add Lead"})})]})};var Gd={exports:{}},RA=Gd.exports,Rv;function MA(){return Rv||(Rv=1,function(e,t){(function(r,n){e.exports=n()})(RA,function(){return function(r){function n(l){if(s[l])return s[l].exports;var u=s[l]={exports:{},id:l,loaded:!1};return r[l].call(u.exports,u,u.exports,n),u.loaded=!0,u.exports}var s={};return n.m=r,n.c=s,n.p="dist/",n(0)}([function(r,n,s){function l(J){return J&&J.__esModule?J:{default:J}}var u=Object.assign||function(J){for(var W=1;W<arguments.length;W++){var F=arguments[W];for(var Z in F)Object.prototype.hasOwnProperty.call(F,Z)&&(J[Z]=F[Z])}return J},h=s(1),m=(l(h),s(6)),f=l(m),p=s(7),g=l(p),y=s(8),v=l(y),S=s(9),N=l(S),w=s(10),E=l(w),C=s(11),T=l(C),O=s(14),j=l(O),q=[],D=!1,U={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},K=function(){var J=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(J&&(D=!0),D)return q=(0,T.default)(q,U),(0,E.default)(q,U.once),q},ie=function(){q=(0,j.default)(),K()},te=function(){q.forEach(function(J,W){J.node.removeAttribute("data-aos"),J.node.removeAttribute("data-aos-easing"),J.node.removeAttribute("data-aos-duration"),J.node.removeAttribute("data-aos-delay")})},G=function(J){return J===!0||J==="mobile"&&N.default.mobile()||J==="phone"&&N.default.phone()||J==="tablet"&&N.default.tablet()||typeof J=="function"&&J()===!0},de=function(J){U=u(U,J),q=(0,j.default)();var W=document.all&&!window.atob;return G(U.disable)||W?te():(U.disableMutationObserver||v.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),U.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",U.easing),document.querySelector("body").setAttribute("data-aos-duration",U.duration),document.querySelector("body").setAttribute("data-aos-delay",U.delay),U.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?K(!0):U.startEvent==="load"?window.addEventListener(U.startEvent,function(){K(!0)}):document.addEventListener(U.startEvent,function(){K(!0)}),window.addEventListener("resize",(0,g.default)(K,U.debounceDelay,!0)),window.addEventListener("orientationchange",(0,g.default)(K,U.debounceDelay,!0)),window.addEventListener("scroll",(0,f.default)(function(){(0,E.default)(q,U.once)},U.throttleDelay)),U.disableMutationObserver||v.default.ready("[data-aos]",ie),q)};r.exports={init:de,refresh:K,refreshHard:ie}},function(r,n){},,,,,function(r,n){(function(s){function l(G,de,J){function W(He){var ge=z,Ce=_;return z=_=void 0,Re=He,re=G.apply(Ce,ge)}function F(He){return Re=He,me=setTimeout(le,de),We?W(He):re}function Z(He){var ge=He-je,Ce=He-Re,_e=de-ge;return Ge?ie(_e,ce-Ce):_e}function oe(He){var ge=He-je,Ce=He-Re;return je===void 0||ge>=de||ge<0||Ge&&Ce>=ce}function le(){var He=te();return oe(He)?R(He):void(me=setTimeout(le,Z(He)))}function R(He){return me=void 0,Ve&&z?W(He):(z=_=void 0,re)}function ne(){me!==void 0&&clearTimeout(me),Re=0,z=je=_=me=void 0}function P(){return me===void 0?re:R(te())}function H(){var He=te(),ge=oe(He);if(z=arguments,_=this,je=He,ge){if(me===void 0)return F(je);if(Ge)return me=setTimeout(le,de),W(je)}return me===void 0&&(me=setTimeout(le,de)),re}var z,_,ce,re,me,je,Re=0,We=!1,Ge=!1,Ve=!0;if(typeof G!="function")throw new TypeError(y);return de=p(de)||0,h(J)&&(We=!!J.leading,Ge="maxWait"in J,ce=Ge?K(p(J.maxWait)||0,de):ce,Ve="trailing"in J?!!J.trailing:Ve),H.cancel=ne,H.flush=P,H}function u(G,de,J){var W=!0,F=!0;if(typeof G!="function")throw new TypeError(y);return h(J)&&(W="leading"in J?!!J.leading:W,F="trailing"in J?!!J.trailing:F),l(G,de,{leading:W,maxWait:de,trailing:F})}function h(G){var de=typeof G>"u"?"undefined":g(G);return!!G&&(de=="object"||de=="function")}function m(G){return!!G&&(typeof G>"u"?"undefined":g(G))=="object"}function f(G){return(typeof G>"u"?"undefined":g(G))=="symbol"||m(G)&&U.call(G)==S}function p(G){if(typeof G=="number")return G;if(f(G))return v;if(h(G)){var de=typeof G.valueOf=="function"?G.valueOf():G;G=h(de)?de+"":de}if(typeof G!="string")return G===0?G:+G;G=G.replace(N,"");var J=E.test(G);return J||C.test(G)?T(G.slice(2),J?2:8):w.test(G)?v:+G}var g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},y="Expected a function",v=NaN,S="[object Symbol]",N=/^\s+|\s+$/g,w=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,C=/^0o[0-7]+$/i,T=parseInt,O=(typeof s>"u"?"undefined":g(s))=="object"&&s&&s.Object===Object&&s,j=(typeof self>"u"?"undefined":g(self))=="object"&&self&&self.Object===Object&&self,q=O||j||Function("return this")(),D=Object.prototype,U=D.toString,K=Math.max,ie=Math.min,te=function(){return q.Date.now()};r.exports=u}).call(n,function(){return this}())},function(r,n){(function(s){function l(te,G,de){function J(Ve){var He=H,ge=z;return H=z=void 0,je=Ve,ce=te.apply(ge,He)}function W(Ve){return je=Ve,re=setTimeout(oe,G),Re?J(Ve):ce}function F(Ve){var He=Ve-me,ge=Ve-je,Ce=G-He;return We?K(Ce,_-ge):Ce}function Z(Ve){var He=Ve-me,ge=Ve-je;return me===void 0||He>=G||He<0||We&&ge>=_}function oe(){var Ve=ie();return Z(Ve)?le(Ve):void(re=setTimeout(oe,F(Ve)))}function le(Ve){return re=void 0,Ge&&H?J(Ve):(H=z=void 0,ce)}function R(){re!==void 0&&clearTimeout(re),je=0,H=me=z=re=void 0}function ne(){return re===void 0?ce:le(ie())}function P(){var Ve=ie(),He=Z(Ve);if(H=arguments,z=this,me=Ve,He){if(re===void 0)return W(me);if(We)return re=setTimeout(oe,G),J(me)}return re===void 0&&(re=setTimeout(oe,G)),ce}var H,z,_,ce,re,me,je=0,Re=!1,We=!1,Ge=!0;if(typeof te!="function")throw new TypeError(g);return G=f(G)||0,u(de)&&(Re=!!de.leading,We="maxWait"in de,_=We?U(f(de.maxWait)||0,G):_,Ge="trailing"in de?!!de.trailing:Ge),P.cancel=R,P.flush=ne,P}function u(te){var G=typeof te>"u"?"undefined":p(te);return!!te&&(G=="object"||G=="function")}function h(te){return!!te&&(typeof te>"u"?"undefined":p(te))=="object"}function m(te){return(typeof te>"u"?"undefined":p(te))=="symbol"||h(te)&&D.call(te)==v}function f(te){if(typeof te=="number")return te;if(m(te))return y;if(u(te)){var G=typeof te.valueOf=="function"?te.valueOf():te;te=u(G)?G+"":G}if(typeof te!="string")return te===0?te:+te;te=te.replace(S,"");var de=w.test(te);return de||E.test(te)?C(te.slice(2),de?2:8):N.test(te)?y:+te}var p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(te){return typeof te}:function(te){return te&&typeof Symbol=="function"&&te.constructor===Symbol&&te!==Symbol.prototype?"symbol":typeof te},g="Expected a function",y=NaN,v="[object Symbol]",S=/^\s+|\s+$/g,N=/^[-+]0x[0-9a-f]+$/i,w=/^0b[01]+$/i,E=/^0o[0-7]+$/i,C=parseInt,T=(typeof s>"u"?"undefined":p(s))=="object"&&s&&s.Object===Object&&s,O=(typeof self>"u"?"undefined":p(self))=="object"&&self&&self.Object===Object&&self,j=T||O||Function("return this")(),q=Object.prototype,D=q.toString,U=Math.max,K=Math.min,ie=function(){return j.Date.now()};r.exports=l}).call(n,function(){return this}())},function(r,n){function s(p){var g=void 0,y=void 0;for(g=0;g<p.length;g+=1)if(y=p[g],y.dataset&&y.dataset.aos||y.children&&s(y.children))return!0;return!1}function l(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function u(){return!!l()}function h(p,g){var y=window.document,v=l(),S=new v(m);f=g,S.observe(y.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function m(p){p&&p.forEach(function(g){var y=Array.prototype.slice.call(g.addedNodes),v=Array.prototype.slice.call(g.removedNodes),S=y.concat(v);if(s(S))return f()})}Object.defineProperty(n,"__esModule",{value:!0});var f=function(){};n.default={isSupported:u,ready:h}},function(r,n){function s(y,v){if(!(y instanceof v))throw new TypeError("Cannot call a class as a function")}function l(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function y(v,S){for(var N=0;N<S.length;N++){var w=S[N];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}}return function(v,S,N){return S&&y(v.prototype,S),N&&y(v,N),v}}(),h=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,m=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,f=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,p=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,g=function(){function y(){s(this,y)}return u(y,[{key:"phone",value:function(){var v=l();return!(!h.test(v)&&!m.test(v.substr(0,4)))}},{key:"mobile",value:function(){var v=l();return!(!f.test(v)&&!p.test(v.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),y}();n.default=new g},function(r,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(u,h,m){var f=u.node.getAttribute("data-aos-once");h>u.position?u.node.classList.add("aos-animate"):typeof f<"u"&&(f==="false"||!m&&f!=="true")&&u.node.classList.remove("aos-animate")},l=function(u,h){var m=window.pageYOffset,f=window.innerHeight;u.forEach(function(p,g){s(p,f+m,h)})};n.default=l},function(r,n,s){function l(f){return f&&f.__esModule?f:{default:f}}Object.defineProperty(n,"__esModule",{value:!0});var u=s(12),h=l(u),m=function(f,p){return f.forEach(function(g,y){g.node.classList.add("aos-init"),g.position=(0,h.default)(g.node,p.offset)}),f};n.default=m},function(r,n,s){function l(f){return f&&f.__esModule?f:{default:f}}Object.defineProperty(n,"__esModule",{value:!0});var u=s(13),h=l(u),m=function(f,p){var g=0,y=0,v=window.innerHeight,S={offset:f.getAttribute("data-aos-offset"),anchor:f.getAttribute("data-aos-anchor"),anchorPlacement:f.getAttribute("data-aos-anchor-placement")};switch(S.offset&&!isNaN(S.offset)&&(y=parseInt(S.offset)),S.anchor&&document.querySelectorAll(S.anchor)&&(f=document.querySelectorAll(S.anchor)[0]),g=(0,h.default)(f).top,S.anchorPlacement){case"top-bottom":break;case"center-bottom":g+=f.offsetHeight/2;break;case"bottom-bottom":g+=f.offsetHeight;break;case"top-center":g+=v/2;break;case"bottom-center":g+=v/2+f.offsetHeight;break;case"center-center":g+=v/2+f.offsetHeight/2;break;case"top-top":g+=v;break;case"bottom-top":g+=f.offsetHeight+v;break;case"center-top":g+=f.offsetHeight/2+v}return S.anchorPlacement||S.offset||isNaN(p)||(y=p),g+y};n.default=m},function(r,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(l){for(var u=0,h=0;l&&!isNaN(l.offsetLeft)&&!isNaN(l.offsetTop);)u+=l.offsetLeft-(l.tagName!="BODY"?l.scrollLeft:0),h+=l.offsetTop-(l.tagName!="BODY"?l.scrollTop:0),l=l.offsetParent;return{top:h,left:u}};n.default=s},function(r,n){Object.defineProperty(n,"__esModule",{value:!0});var s=function(l){return l=l||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(l,function(u){return{node:u}})};n.default=s}])})}(Gd)),Gd.exports}var FA=MA();const LA=bp(FA);var zw={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Mv=at.createContext&&at.createContext(zw),PA=["attr","size","title"];function BA(e,t){if(e==null)return{};var r=UA(e,t),n,s;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)n=l[s],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function UA(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Jd(){return Jd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jd.apply(this,arguments)}function Fv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ef(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fv(Object(r),!0).forEach(function(n){IA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IA(e,t,r){return t=zA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zA(e){var t=VA(e,"string");return typeof t=="symbol"?t:t+""}function VA(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vw(e){return e&&e.map((t,r)=>at.createElement(t.tag,ef({key:r},t.attr),Vw(t.child)))}function yr(e){return t=>at.createElement(HA,Jd({attr:ef({},e.attr)},t),Vw(e.child))}function HA(e){var t=r=>{var{attr:n,size:s,title:l}=e,u=BA(e,PA),h=s||r.size||"1em",m;return r.className&&(m=r.className),e.className&&(m=(m?m+" ":"")+e.className),at.createElement("svg",Jd({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,n,u,{className:m,style:ef(ef({color:e.color||r.color},r.style),e.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),l&&at.createElement("title",null,l),e.children)};return Mv!==void 0?at.createElement(Mv.Consumer,null,r=>t(r)):t(zw)}function YA(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(e)}function Hm(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M380.9 97.1C339 55.1 283.2 32 223.9 32c-122.4 0-222 99.6-222 222 0 39.1 10.2 77.3 29.6 111L0 480l117.7-30.9c32.4 17.7 68.9 27 106.1 27h.1c122.3 0 224.1-99.6 224.1-222 0-59.3-25.2-115-67.1-157zm-157 341.6c-33.2 0-65.7-8.9-94-25.7l-6.7-4-69.8 18.3L72 359.2l-4.4-7c-18.5-29.4-28.2-63.3-28.2-98.2 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 56.2 81.2 56.1 130.5 0 101.8-84.9 184.6-186.6 184.6zm101.2-138.2c-5.5-2.8-32.8-16.2-37.9-18-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.6-14.3 18-17.6 21.8-3.2 3.7-6.5 4.2-12 1.4-32.6-16.3-54-29.1-75.5-66-5.7-9.8 5.7-9.1 16.3-30.3 1.8-3.7.9-6.9-.5-9.7-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.8-9.1-9.3-12.5-9.5-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.7 1.4-14.8 6.9-5.1 5.6-19.4 19-19.4 46.3 0 27.3 19.9 53.7 22.6 57.4 2.8 3.7 39.1 59.7 94.8 83.8 35.2 15.2 49 16.5 66.6 13.9 10.7-1.6 32.8-13.4 37.4-26.4 4.6-13 4.6-24.1 3.2-26.4-1.3-2.5-5-3.9-10.5-6.6z"},child:[]}]})(e)}function Lv(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(e)}function GA(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"},child:[]}]})(e)}function qA(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(e)}function Ym(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(e)}function $A(e){return yr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"},child:[]}]})(e)}function WA(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M488 352h-40V109.25l59.31-59.31c6.25-6.25 6.25-16.38 0-22.63L484.69 4.69c-6.25-6.25-16.38-6.25-22.63 0L402.75 64H192v96h114.75L160 306.75V24c0-13.26-10.75-24-24-24H88C74.75 0 64 10.74 64 24v40H24C10.75 64 0 74.74 0 88v48c0 13.25 10.75 24 24 24h40v264c0 13.25 10.75 24 24 24h232v-96H205.25L352 205.25V488c0 13.25 10.75 24 24 24h48c13.25 0 24-10.75 24-24v-40h40c13.25 0 24-10.75 24-24v-48c0-13.26-10.75-24-24-24z"},child:[]}]})(e)}function XA(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z"},child:[]}]})(e)}function nu(e){return yr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function tf(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function kp(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(e)}function KA(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(e)}function QA(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497.39 361.8l-112-48a24 24 0 0 0-28 6.9l-49.6 60.6A370.66 370.66 0 0 1 130.6 204.11l60.6-49.6a23.94 23.94 0 0 0 6.9-28l-48-112A24.16 24.16 0 0 0 122.6.61l-104 24A24 24 0 0 0 0 48c0 256.5 207.9 464 464 464a24 24 0 0 0 23.4-18.6l24-104a24.29 24.29 0 0 0-14.01-27.6z"},child:[]}]})(e)}function Op(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Hw(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(e)}function ZA(e){return yr({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"},child:[]}]})(e)}function rf(e){return yr({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}function Rp(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}function JA(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(e)}function Pv(e){return yr({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}const e6=()=>{var J,W;const{user:e}=Tr(),[t,r]=k.useState([]),[n,s]=k.useState([]),[l,u]=k.useState(!0),[h,m]=k.useState(null),[f,p]=k.useState(!1),[g,y]=k.useState(null),[v,S]=k.useState(new Date().getMonth()+1),[N,w]=k.useState(new Date().getFullYear()),[E,C]=k.useState(!0),T=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],O=new Date().getFullYear(),j=Array.from({length:6},(F,Z)=>O-Z);k.useEffect(()=>{D()},[]),k.useEffect(()=>{t.length>0&&q()},[t,v,N,E]);const q=()=>{if(E){const F=new Date().getMonth()+1,Z=new Date().getFullYear(),oe=t.filter(le=>{const R=new Date(le.createdAt);return R.getMonth()+1===F&&R.getFullYear()===Z});s(oe)}else{const F=t.filter(Z=>{const oe=new Date(Z.createdAt);return oe.getMonth()+1===parseInt(v)&&oe.getFullYear()===parseInt(N)});s(F)}},D=async()=>{try{u(!0),console.log("Current user:",e);const F=await Fn.getAll();if(console.log("API Response:",F.data),F.data&&F.data.data&&F.data.data.length>0){const Z=F.data.data[0];console.log("First lead object structure:",Z),console.log("All field names:",Object.keys(Z)),console.log("Name value:",Z.name),console.log("NAME value:",Z.NAME)}r(F.data.data),q(F.data.data),console.log("Leads set in state:",F.data.data),m(null)}catch(F){console.error("Error fetching leads:",F),m("Failed to load leads. Please try again.")}finally{u(!1)}},U=F=>{if(g){const Z=t.map(oe=>oe._id===F._id?F:oe);r(Z),y(null)}else{const Z=[...t,F];r(Z),p(!1)}D()},K=F=>{const Z=parseInt(F.target.value);console.log("Changing month to:",Z),S(Z),C(!1)},ie=F=>{const Z=parseInt(F.target.value);console.log("Changing year to:",Z),w(Z),C(!1)},te=()=>{S(new Date().getMonth()+1),w(new Date().getFullYear()),C(!0)},G=F=>new Date(F).toLocaleDateString();k.useEffect(()=>{LA.init({duration:600,easing:"ease-in-out",once:!0})},[]);const de=F=>{console.log("Edit clicked for lead:",F),y(F)};return o.jsx(jr,{children:o.jsxs("div",{className:"bg-gray-50 min-h-screen pb-12",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 p-6 mb-8",children:o.jsx("div",{className:"container mx-auto",children:o.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center","data-aos":"fade-down",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Leads Management"}),o.jsxs("p",{className:"text-blue-100 text-sm md:text-base",children:[n.length," leads  ",E?"Current Month":`${(J=T.find(F=>F.value===parseInt(v)))==null?void 0:J.label} ${N}`]})]}),o.jsxs("button",{onClick:()=>p(!0),className:"mt-4 md:mt-0 bg-white hover:bg-blue-50 text-blue-600 py-2 px-6 rounded-lg shadow-md transition duration-300 flex items-center font-medium",children:[o.jsx(Op,{className:"h-4 w-4 mr-2"}),"Add New Lead"]})]})})}),o.jsxs("div",{className:"container mx-auto px-4",children:[h&&o.jsx("div",{className:"mb-6 p-4 bg-red-50 text-red-700 border border-red-200 rounded-lg shadow-sm","data-aos":"fade-up",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),h]})}),(f||g)&&o.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-8","data-aos":"fade-up",children:[o.jsx("div",{className:"px-6 py-4 bg-blue-50 border-b border-blue-100",children:o.jsx("h2",{className:"text-xl font-bold text-gray-800",children:g?"Edit Lead":"Add New Lead"})}),o.jsxs("div",{className:"p-6",children:[o.jsx(OA,{lead:g,onSuccess:U}),o.jsxs("button",{onClick:()=>{p(!1),y(null)},className:"mt-6 text-blue-600 hover:text-blue-800 font-medium flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to Leads List"]})]})]}),!f&&!g&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-8","data-aos":"fade-up",children:[o.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-100 flex justify-between items-center",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Filter Leads"}),o.jsx(kp,{className:"text-gray-500"})]}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-700 mb-1",children:"Month"}),o.jsx("select",{id:"month",value:v,onChange:K,className:"w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:T.map(F=>o.jsx("option",{value:F.value,children:F.label},F.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),o.jsx("select",{id:"year",value:N,onChange:ie,className:"w-full border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:j.map(F=>o.jsx("option",{value:F,children:F},F))})]}),o.jsx("div",{className:"flex items-end",children:o.jsx("button",{onClick:te,className:"w-full py-2 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Show Current Month"})})]}),o.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg text-sm text-blue-800 flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),o.jsxs("span",{children:["Showing ",n.length," leads for ",E?"current month":`${(W=T.find(F=>F.value===parseInt(v)))==null?void 0:W.label} ${N}`]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden","data-aos":"fade-up","data-aos-delay":"100",children:[o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-100",children:o.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Leads Overview"})}),l?o.jsx("div",{className:"p-12 flex justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):n.length===0?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-16 w-16 mx-auto text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("h3",{className:"text-xl font-medium text-gray-700 mb-2",children:"No leads found"}),o.jsx("p",{className:"text-gray-500 mb-6",children:"No leads were found for the selected time period"}),o.jsxs("button",{onClick:()=>p(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"Add Your First Lead"]})]}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(F=>(console.log(`Lead ${F._id}:`,F),o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:G(F.createdAt)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:F.name||F.NAME||""})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.course||F.COURSE||""}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm text-gray-900",children:F.phone||F.NUMBER||""}),o.jsx("div",{className:"text-sm text-gray-500",children:F.email||F["E-MAIL"]||""})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:F.country||F.COUNTRY||""}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${(F.feedback||F.FEEDBACK)==="Converted"?"bg-green-100 text-green-800":(F.feedback||F.FEEDBACK)==="Not Interested"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:F.feedback||F.FEEDBACK||"Pending"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsx("button",{onClick:()=>de(F),className:"text-indigo-600 hover:text-indigo-900 mr-4",title:"Edit Lead",children:o.jsx(nu,{className:"h-5 w-5"})})})]},F._id)))})]})})]})]})]})]})})},t6=()=>{var ce;const{user:e}=Tr(),[t,r]=k.useState([]),[n,s]=k.useState([]),[l,u]=k.useState(!0),[h,m]=k.useState(null),[f,p]=k.useState({}),[g,y]=k.useState({}),[v,S]=k.useState(null),[N,w]=k.useState(0),[E,C]=k.useState(new Date().getMonth()+1),[T,O]=k.useState(new Date().getFullYear()),[j,q]=k.useState(!0),[D,U]=k.useState({}),K=["New","Contacted","Qualified","Lost","Converted","Introduction","Acknowledgement","Question","Future Promise","Payment","Analysis"],ie=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],te=new Date().getFullYear(),G=Array.from({length:6},(re,me)=>te-me);k.useEffect(()=>{J()},[e,N]),k.useEffect(()=>{t.length>0&&de()},[t,E,T,j]);const de=()=>{if(j){const re=new Date().getMonth()+1,me=new Date().getFullYear(),je=t.filter(Re=>{const We=new Date(Re.createdAt);return We.getMonth()+1===re&&We.getFullYear()===me});s(je)}else{const re=t.filter(me=>{const je=new Date(me.createdAt);return je.getMonth()+1===E&&je.getFullYear()===T});s(re)}},J=async()=>{try{u(!0),console.log("Fetching leads for sales person:",e==null?void 0:e.fullName);const re=await Fn.getAssigned();if(console.log("Leads response:",re.data),re.data.success){r(re.data.data);const me={};re.data.data.forEach(je=>{me[je._id]=je.feedback||""}),p(me)}else m("Failed to load leads")}catch(re){console.error("Error fetching leads:",re),m("Failed to load leads. Please try again.")}finally{u(!1)}},W=(re,me)=>{p(je=>({...je,[re]:me}))},F=async re=>{if(!(!re||!f[re]))try{y(je=>({...je,[re]:!0}));const me=await Fn.updateFeedback(re,f[re]);me.data.success?(r(t.map(je=>je._id===re?me.data.data:je)),alert("Feedback updated successfully!")):m("Failed to update feedback")}catch(me){console.error("Error updating feedback:",me),m("Failed to update feedback. Please try again.")}finally{y(me=>({...me,[re]:!1}))}},Z=async(re,me)=>{try{if(U(Ge=>({...Ge,[re]:!0})),m(null),!t.find(Ge=>Ge._id===re))return;const Re={status:me};console.log("Updating lead status:",re,me);const We=await Fn.update(re,Re);We.data.success?(r(t.map(Ge=>Ge._id===re?We.data.data:Ge)),s(n.map(Ge=>Ge._id===re?We.data.data:Ge)),console.log("Lead status updated successfully"),p({...f,statusSuccess:`Status updated to "${me}" successfully!`,leadId:re}),setTimeout(()=>{p(Ge=>({...Ge,statusSuccess:null,leadId:null}))},3e3),w(Ge=>Ge+1)):(console.error("Failed to update lead status:",We.data),m("Failed to update lead status. Please try again."))}catch(je){console.error("Error updating lead status:",je),je.response&&je.response.status===403?m("You don't have permission to update this lead status. Contact your manager."):m("Failed to update lead status. Please try again.")}finally{U(je=>({...je,[re]:!1}))}},oe=re=>{C(parseInt(re.target.value)),q(!1)},le=re=>{O(parseInt(re.target.value)),q(!1)},R=()=>{C(new Date().getMonth()+1),O(new Date().getFullYear()),q(!0)},ne=re=>new Date(re).toLocaleDateString(),P=re=>{S(re)},H=()=>{S(null)},z=(re,me)=>{if(!re)return;const Re=`https://wa.me/${`${me||"+91"}${re.replace(/\D/g,"")}`.replace(/\+/g,"")}`;window.open(Re,"_blank")},_=re=>{re&&(window.location.href=`mailto:${re}`)};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsx("h2",{className:"text-3xl font-bold mb-6",children:"My Assigned Leads"}),h&&o.jsxs("div",{className:"mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded-md flex justify-between items-center",children:[o.jsx("div",{className:"flex-1",children:h}),o.jsx("button",{onClick:()=>m(null),className:"text-red-700 hover:text-red-900",children:""})]}),l?o.jsxs("div",{className:"text-center py-10",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"}),o.jsx("p",{className:"mt-2 text-gray-600",children:"Loading your assigned leads..."})]}):t.length===0?o.jsx("div",{className:"text-center py-10 bg-gray-50 rounded-lg",children:o.jsx("p",{className:"text-gray-600",children:"No leads assigned to you yet."})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-6 p-4 bg-white rounded-lg shadow-md",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[o.jsx(kp,{className:"mr-2 text-blue-500"}),"Filter Leads by Date"]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(Lv,{className:"text-blue-500 mr-2"}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-600 mb-1",children:"Month"}),o.jsx("select",{id:"month",value:E,onChange:oe,className:"border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:j,children:ie.map(re=>o.jsx("option",{value:re.value,children:re.label},re.value))})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-600 mb-1",children:"Year"}),o.jsx("select",{id:"year",value:T,onChange:le,className:"border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:j,children:G.map(re=>o.jsx("option",{value:re,children:re},re))})]}),o.jsxs("div",{className:"flex items-center ml-4",children:[o.jsx("input",{id:"currentMonth",type:"checkbox",checked:j,onChange:()=>q(!j),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"currentMonth",className:"ml-2 text-sm text-gray-600",children:"Show current month only"})]}),o.jsxs("button",{onClick:R,className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 ml-auto flex items-center",children:[o.jsx(Lv,{className:"mr-2"}),"Reset to Current Month"]})]}),o.jsxs("div",{className:"mt-3 text-sm text-gray-600",children:["Showing ",n.length," lead",n.length!==1?"s":"",j?" for the current month":` for ${(ce=ie.find(re=>re.value===E))==null?void 0:ce.label} ${T}`]})]}),o.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Feedback"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(re=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm font-medium text-gray-900",children:re.name})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[re.phone&&o.jsx("div",{className:"flex items-center",children:o.jsxs("button",{onClick:()=>z(re.phone,re.countryCode),className:"text-sm text-gray-900 flex items-center hover:text-green-600",title:"Open in WhatsApp",children:[o.jsx(Hm,{className:"mr-1 text-green-500"}),re.countryCode||"+91"," ",re.phone]})}),re.email&&o.jsx("div",{className:"flex items-center",children:o.jsxs("button",{onClick:()=>_(re.email),className:"text-sm text-gray-500 flex items-center hover:text-blue-600",title:"Send email",children:[o.jsx(tf,{className:"mr-1 text-blue-500"}),re.email]})})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:re.course})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:re.status,onChange:me=>Z(re._id,me.target.value),disabled:D[re._id],className:`text-sm px-2 py-1 rounded ${re.status==="New"?"bg-blue-100 text-blue-800":re.status==="Contacted"?"bg-teal-100 text-teal-800":re.status==="Qualified"?"bg-indigo-100 text-indigo-800":re.status==="Lost"?"bg-red-100 text-red-800":re.status==="Converted"?"bg-green-100 text-green-800":re.status==="Introduction"?"bg-purple-100 text-purple-800":re.status==="Acknowledgement"?"bg-yellow-100 text-yellow-800":re.status==="Question"?"bg-indigo-100 text-indigo-800":re.status==="Future Promise"?"bg-cyan-100 text-cyan-800":re.status==="Payment"?"bg-green-100 text-green-800":re.status==="Analysis"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"} border border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none cursor-pointer w-full pr-8`,children:K.map(me=>o.jsx("option",{value:me,children:me},me))}),o.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:o.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})}),D[re._id]&&o.jsx("div",{className:"absolute top-1/2 right-8 transform -translate-y-1/2",children:o.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 rounded-full border-t-transparent"})}),f.statusSuccess&&f.leadId===re._id&&o.jsx("div",{className:"absolute top-full left-0 mt-1 bg-green-100 text-green-800 text-xs px-2 py-1 rounded whitespace-normal w-48 z-10",children:f.statusSuccess})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-500",children:ne(re.createdAt)})}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"relative",children:[o.jsx("textarea",{value:f[re._id]||"",onChange:me=>W(re._id,me.target.value),placeholder:"Add feedback...",className:"text-sm w-full h-20 p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("button",{onClick:()=>F(re._id),disabled:g[re._id]||!f[re._id],className:`mt-1 px-3 py-1 text-xs rounded ${g[re._id]||!f[re._id]?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:g[re._id]?"Saving...":"Save Feedback"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:o.jsx("button",{onClick:()=>P(re),className:"text-blue-600 hover:text-blue-900",children:"View Details"})})]},re._id))})]})})})]}),v&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Lead Details"}),o.jsx("button",{onClick:H,className:"text-gray-400 hover:text-gray-500",children:""})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Name"}),o.jsx("p",{className:"text-base",children:v.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),o.jsx("p",{className:"text-base",children:o.jsxs("button",{onClick:()=>_(v.email),className:"text-blue-600 hover:text-blue-800 flex items-center",children:[o.jsx(tf,{className:"mr-1"})," ",v.email]})})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Phone"}),o.jsx("p",{className:"text-base",children:o.jsxs("button",{onClick:()=>z(v.phone,v.countryCode),className:"text-green-600 hover:text-green-800 flex items-center",children:[o.jsx(Hm,{className:"mr-1"})," ",v.countryCode||"+91"," ",v.phone]})})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Course"}),o.jsx("p",{className:"text-base",children:v.course})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:v.status,onChange:re=>{Z(v._id,re.target.value),S({...v,status:re.target.value})},className:`px-2 py-1 rounded ${v.status==="New"?"bg-blue-100 text-blue-800":v.status==="Contacted"?"bg-teal-100 text-teal-800":v.status==="Qualified"?"bg-indigo-100 text-indigo-800":v.status==="Lost"?"bg-red-100 text-red-800":v.status==="Converted"?"bg-green-100 text-green-800":v.status==="Introduction"?"bg-purple-100 text-purple-800":v.status==="Acknowledgement"?"bg-yellow-100 text-yellow-800":v.status==="Question"?"bg-indigo-100 text-indigo-800":v.status==="Future Promise"?"bg-cyan-100 text-cyan-800":v.status==="Payment"?"bg-green-100 text-green-800":v.status==="Analysis"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"} border border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none cursor-pointer pr-8 relative`,children:K.map(re=>o.jsx("option",{value:re,children:re},re))}),o.jsx("div",{className:"pointer-events-none absolute right-0 top-1/2 transform -translate-y-1/2 flex items-center px-2 text-gray-700",children:o.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})}),D[v._id]&&o.jsx("div",{className:"absolute -right-6 top-1/2 transform -translate-y-1/2",children:o.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 rounded-full border-t-transparent"})}),f.statusSuccess&&f.leadId===v._id&&o.jsx("div",{className:"absolute top-full left-0 mt-1 bg-green-100 text-green-800 text-xs px-2 py-1 rounded whitespace-normal w-48 z-10",children:f.statusSuccess})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Created At"}),o.jsx("p",{className:"text-base",children:ne(v.createdAt)})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Country"}),o.jsx("p",{className:"text-base",children:v.country||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Company"}),o.jsx("p",{className:"text-base",children:v.company||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Client"}),o.jsx("p",{className:"text-base",children:v.client||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Pseudo ID"}),o.jsx("p",{className:"text-base",children:v.pseudoId||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Source"}),o.jsx("p",{className:"text-base",children:v.source||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"LinkedIn"}),o.jsx("p",{className:"text-base",children:v.sourceLink?o.jsx("a",{href:v.sourceLink.startsWith("http")?v.sourceLink:`https://${v.sourceLink}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:v.sourceLink}):"N/A"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"Remarks"}),o.jsx("p",{className:"text-base p-2 bg-gray-50 rounded min-h-[40px]",children:v.remarks||"No remarks available"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"Feedback"}),o.jsx("textarea",{value:f[v._id]||"",onChange:re=>W(v._id,re.target.value),placeholder:"Add feedback...",className:"w-full h-24 p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),o.jsx("button",{onClick:()=>F(v._id),disabled:g[v._id]||!f[v._id],className:`mt-2 px-4 py-2 rounded ${g[v._id]||!f[v._id]?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:g[v._id]?"Saving...":"Save Feedback"})]}),o.jsx("div",{className:"flex justify-end",children:o.jsx("button",{onClick:H,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-100",children:"Close"})})]})})]})})};function Yw(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=Yw(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function zi(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=Yw(e))&&(n&&(n+=" "),n+=t);return n}function r6(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}r6(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var au=e=>typeof e=="number"&&!isNaN(e),Gi=e=>typeof e=="string",gs=e=>typeof e=="function",n6=e=>Gi(e)||au(e),Gm=e=>Gi(e)||gs(e)?e:null,a6=(e,t)=>e===!1||au(e)&&e>0?e:t,qm=e=>k.isValidElement(e)||Gi(e)||gs(e)||au(e);function s6(e,t,r=300){let{scrollHeight:n,style:s}=e;requestAnimationFrame(()=>{s.minHeight="initial",s.height=n+"px",s.transition=`all ${r}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(t,r)})})}function i6({enter:e,exit:t,appendPosition:r=!1,collapse:n=!0,collapseDuration:s=300}){return function({children:l,position:u,preventExitTransition:h,done:m,nodeRef:f,isIn:p,playToast:g}){let y=r?`${e}--${u}`:e,v=r?`${t}--${u}`:t,S=k.useRef(0);return k.useLayoutEffect(()=>{let N=f.current,w=y.split(" "),E=C=>{C.target===f.current&&(g(),N.removeEventListener("animationend",E),N.removeEventListener("animationcancel",E),S.current===0&&C.type!=="animationcancel"&&N.classList.remove(...w))};N.classList.add(...w),N.addEventListener("animationend",E),N.addEventListener("animationcancel",E)},[]),k.useEffect(()=>{let N=f.current,w=()=>{N.removeEventListener("animationend",w),n?s6(N,m,s):m()};p||(h?w():(S.current=1,N.className+=` ${v}`,N.addEventListener("animationend",w)))},[p]),at.createElement(at.Fragment,null,l)}}function Bv(e,t){return{content:Gw(e.content,e.props),containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,reason:e.removalReason,status:t}}function Gw(e,t,r=!1){return k.isValidElement(e)&&!Gi(e.type)?k.cloneElement(e,{closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):gs(e)?e({closeToast:t.closeToast,toastProps:t,data:t.data,isPaused:r}):e}function o6({closeToast:e,theme:t,ariaLabel:r="close"}){return at.createElement("button",{className:`Toastify__close-button Toastify__close-button--${t}`,type:"button",onClick:n=>{n.stopPropagation(),e(!0)},"aria-label":r},at.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},at.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function l6({delay:e,isRunning:t,closeToast:r,type:n="default",hide:s,className:l,controlledProgress:u,progress:h,rtl:m,isIn:f,theme:p}){let g=s||u&&h===0,y={animationDuration:`${e}ms`,animationPlayState:t?"running":"paused"};u&&(y.transform=`scaleX(${h})`);let v=zi("Toastify__progress-bar",u?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${p}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":m}),S=gs(l)?l({rtl:m,type:n,defaultClassName:v}):zi(v,l),N={[u&&h>=1?"onTransitionEnd":"onAnimationEnd"]:u&&h<1?null:()=>{f&&r()}};return at.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":g},at.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${p} Toastify__progress-bar--${n}`}),at.createElement("div",{role:"progressbar","aria-hidden":g?"true":"false","aria-label":"notification timer",className:S,style:y,...N}))}var c6=1,qw=()=>`${c6++}`;function u6(e,t,r){let n=1,s=0,l=[],u=[],h=t,m=new Map,f=new Set,p=C=>(f.add(C),()=>f.delete(C)),g=()=>{u=Array.from(m.values()),f.forEach(C=>C())},y=({containerId:C,toastId:T,updateId:O})=>{let j=C?C!==e:e!==1,q=m.has(T)&&O==null;return j||q},v=(C,T)=>{m.forEach(O=>{var j;(T==null||T===O.props.toastId)&&((j=O.toggle)==null||j.call(O,C))})},S=C=>{var T,O;(O=(T=C.props)==null?void 0:T.onClose)==null||O.call(T,C.removalReason),C.isActive=!1},N=C=>{if(C==null)m.forEach(S);else{let T=m.get(C);T&&S(T)}g()},w=()=>{s-=l.length,l=[]},E=C=>{var T,O;let{toastId:j,updateId:q}=C.props,D=q==null;C.staleId&&m.delete(C.staleId),C.isActive=!0,m.set(j,C),g(),r(Bv(C,D?"added":"updated")),D&&((O=(T=C.props).onOpen)==null||O.call(T))};return{id:e,props:h,observe:p,toggle:v,removeToast:N,toasts:m,clearQueue:w,buildToast:(C,T)=>{if(y(T))return;let{toastId:O,updateId:j,data:q,staleId:D,delay:U}=T,K=j==null;K&&s++;let ie={...h,style:h.toastStyle,key:n++,...Object.fromEntries(Object.entries(T).filter(([G,de])=>de!=null)),toastId:O,updateId:j,data:q,isIn:!1,className:Gm(T.className||h.toastClassName),progressClassName:Gm(T.progressClassName||h.progressClassName),autoClose:T.isLoading?!1:a6(T.autoClose,h.autoClose),closeToast(G){m.get(O).removalReason=G,N(O)},deleteToast(){let G=m.get(O);if(G!=null){if(r(Bv(G,"removed")),m.delete(O),s--,s<0&&(s=0),l.length>0){E(l.shift());return}g()}}};ie.closeButton=h.closeButton,T.closeButton===!1||qm(T.closeButton)?ie.closeButton=T.closeButton:T.closeButton===!0&&(ie.closeButton=qm(h.closeButton)?h.closeButton:!0);let te={content:C,props:ie,staleId:D};h.limit&&h.limit>0&&s>h.limit&&K?l.push(te):au(U)?setTimeout(()=>{E(te)},U):E(te)},setProps(C){h=C},setToggle:(C,T)=>{let O=m.get(C);O&&(O.toggle=T)},isToastActive:C=>{var T;return(T=m.get(C))==null?void 0:T.isActive},getSnapshot:()=>u}}var Nn=new Map,Lc=[],$m=new Set,d6=e=>$m.forEach(t=>t(e)),$w=()=>Nn.size>0;function f6(){Lc.forEach(e=>Xw(e.content,e.options)),Lc=[]}var h6=(e,{containerId:t})=>{var r;return(r=Nn.get(t||1))==null?void 0:r.toasts.get(e)};function Ww(e,t){var r;if(t)return!!((r=Nn.get(t))!=null&&r.isToastActive(e));let n=!1;return Nn.forEach(s=>{s.isToastActive(e)&&(n=!0)}),n}function m6(e){if(!$w()){Lc=Lc.filter(t=>e!=null&&t.options.toastId!==e);return}if(e==null||n6(e))Nn.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Nn.get(e.containerId);t?t.removeToast(e.id):Nn.forEach(r=>{r.removeToast(e.id)})}}var p6=(e={})=>{Nn.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})};function Xw(e,t){qm(e)&&($w()||Lc.push({content:e,options:t}),Nn.forEach(r=>{r.buildToast(e,t)}))}function x6(e){var t;(t=Nn.get(e.containerId||1))==null||t.setToggle(e.id,e.fn)}function Kw(e,t){Nn.forEach(r=>{(t==null||!(t!=null&&t.containerId)||(t==null?void 0:t.containerId)===r.id)&&r.toggle(e,t==null?void 0:t.id)})}function g6(e){let t=e.containerId||1;return{subscribe(r){let n=u6(t,e,d6);Nn.set(t,n);let s=n.observe(r);return f6(),()=>{s(),Nn.delete(t)}},setProps(r){var n;(n=Nn.get(t))==null||n.setProps(r)},getSnapshot(){var r;return(r=Nn.get(t))==null?void 0:r.getSnapshot()}}}function y6(e){return $m.add(e),()=>{$m.delete(e)}}function v6(e){return e&&(Gi(e.toastId)||au(e.toastId))?e.toastId:qw()}function su(e,t){return Xw(e,t),t.toastId}function Lf(e,t){return{...t,type:t&&t.type||e,toastId:v6(t)}}function Pf(e){return(t,r)=>su(t,Lf(e,r))}function ze(e,t){return su(e,Lf("default",t))}ze.loading=(e,t)=>su(e,Lf("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...t}));function b6(e,{pending:t,error:r,success:n},s){let l;t&&(l=Gi(t)?ze.loading(t,s):ze.loading(t.render,{...s,...t}));let u={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},h=(f,p,g)=>{if(p==null){ze.dismiss(l);return}let y={type:f,...u,...s,data:g},v=Gi(p)?{render:p}:p;return l?ze.update(l,{...y,...v}):ze(v.render,{...y,...v}),g},m=gs(e)?e():e;return m.then(f=>h("success",n,f)).catch(f=>h("error",r,f)),m}ze.promise=b6;ze.success=Pf("success");ze.info=Pf("info");ze.error=Pf("error");ze.warning=Pf("warning");ze.warn=ze.warning;ze.dark=(e,t)=>su(e,Lf("default",{theme:"dark",...t}));function w6(e){m6(e)}ze.dismiss=w6;ze.clearWaitingQueue=p6;ze.isActive=Ww;ze.update=(e,t={})=>{let r=h6(e,t);if(r){let{props:n,content:s}=r,l={delay:100,...n,...t,toastId:t.toastId||e,updateId:qw()};l.toastId!==e&&(l.staleId=e);let u=l.render||s;delete l.render,su(u,l)}};ze.done=e=>{ze.update(e,{progress:1})};ze.onChange=y6;ze.play=e=>Kw(!0,e);ze.pause=e=>Kw(!1,e);function S6(e){var t;let{subscribe:r,getSnapshot:n,setProps:s}=k.useRef(g6(e)).current;s(e);let l=(t=k.useSyncExternalStore(r,n,n))==null?void 0:t.slice();function u(h){if(!l)return[];let m=new Map;return e.newestOnTop&&l.reverse(),l.forEach(f=>{let{position:p}=f.props;m.has(p)||m.set(p,[]),m.get(p).push(f)}),Array.from(m,f=>h(f[0],f[1]))}return{getToastToRender:u,isToastActive:Ww,count:l==null?void 0:l.length}}function N6(e){let[t,r]=k.useState(!1),[n,s]=k.useState(!1),l=k.useRef(null),u=k.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:h,pauseOnHover:m,closeToast:f,onClick:p,closeOnClick:g}=e;x6({id:e.toastId,containerId:e.containerId,fn:r}),k.useEffect(()=>{if(e.pauseOnFocusLoss)return y(),()=>{v()}},[e.pauseOnFocusLoss]);function y(){document.hasFocus()||E(),window.addEventListener("focus",w),window.addEventListener("blur",E)}function v(){window.removeEventListener("focus",w),window.removeEventListener("blur",E)}function S(D){if(e.draggable===!0||e.draggable===D.pointerType){C();let U=l.current;u.canCloseOnClick=!0,u.canDrag=!0,U.style.transition="none",e.draggableDirection==="x"?(u.start=D.clientX,u.removalDistance=U.offsetWidth*(e.draggablePercent/100)):(u.start=D.clientY,u.removalDistance=U.offsetHeight*(e.draggablePercent===80?e.draggablePercent*1.5:e.draggablePercent)/100)}}function N(D){let{top:U,bottom:K,left:ie,right:te}=l.current.getBoundingClientRect();D.nativeEvent.type!=="touchend"&&e.pauseOnHover&&D.clientX>=ie&&D.clientX<=te&&D.clientY>=U&&D.clientY<=K?E():w()}function w(){r(!0)}function E(){r(!1)}function C(){u.didMove=!1,document.addEventListener("pointermove",O),document.addEventListener("pointerup",j)}function T(){document.removeEventListener("pointermove",O),document.removeEventListener("pointerup",j)}function O(D){let U=l.current;if(u.canDrag&&U){u.didMove=!0,t&&E(),e.draggableDirection==="x"?u.delta=D.clientX-u.start:u.delta=D.clientY-u.start,u.start!==D.clientX&&(u.canCloseOnClick=!1);let K=e.draggableDirection==="x"?`${u.delta}px, var(--y)`:`0, calc(${u.delta}px + var(--y))`;U.style.transform=`translate3d(${K},0)`,U.style.opacity=`${1-Math.abs(u.delta/u.removalDistance)}`}}function j(){T();let D=l.current;if(u.canDrag&&u.didMove&&D){if(u.canDrag=!1,Math.abs(u.delta)>u.removalDistance){s(!0),e.closeToast(!0),e.collapseAll();return}D.style.transition="transform 0.2s, opacity 0.2s",D.style.removeProperty("transform"),D.style.removeProperty("opacity")}}let q={onPointerDown:S,onPointerUp:N};return h&&m&&(q.onMouseEnter=E,e.stacked||(q.onMouseLeave=w)),g&&(q.onClick=D=>{p&&p(D),u.canCloseOnClick&&f(!0)}),{playToast:w,pauseToast:E,isRunning:t,preventExitTransition:n,toastRef:l,eventHandlers:q}}var T6=typeof window<"u"?k.useLayoutEffect:k.useEffect,Bf=({theme:e,type:t,isLoading:r,...n})=>at.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${t})`,...n});function E6(e){return at.createElement(Bf,{...e},at.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function _6(e){return at.createElement(Bf,{...e},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function C6(e){return at.createElement(Bf,{...e},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function A6(e){return at.createElement(Bf,{...e},at.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function j6(){return at.createElement("div",{className:"Toastify__spinner"})}var Wm={info:_6,warning:E6,success:C6,error:A6,spinner:j6},D6=e=>e in Wm;function k6({theme:e,type:t,isLoading:r,icon:n}){let s=null,l={theme:e,type:t};return n===!1||(gs(n)?s=n({...l,isLoading:r}):k.isValidElement(n)?s=k.cloneElement(n,l):r?s=Wm.spinner():D6(t)&&(s=Wm[t](l))),s}var O6=e=>{let{isRunning:t,preventExitTransition:r,toastRef:n,eventHandlers:s,playToast:l}=N6(e),{closeButton:u,children:h,autoClose:m,onClick:f,type:p,hideProgressBar:g,closeToast:y,transition:v,position:S,className:N,style:w,progressClassName:E,updateId:C,role:T,progress:O,rtl:j,toastId:q,deleteToast:D,isIn:U,isLoading:K,closeOnClick:ie,theme:te,ariaLabel:G}=e,de=zi("Toastify__toast",`Toastify__toast-theme--${te}`,`Toastify__toast--${p}`,{"Toastify__toast--rtl":j},{"Toastify__toast--close-on-click":ie}),J=gs(N)?N({rtl:j,position:S,type:p,defaultClassName:de}):zi(de,N),W=k6(e),F=!!O||!m,Z={closeToast:y,type:p,theme:te},oe=null;return u===!1||(gs(u)?oe=u(Z):k.isValidElement(u)?oe=k.cloneElement(u,Z):oe=o6(Z)),at.createElement(v,{isIn:U,done:D,position:S,preventExitTransition:r,nodeRef:n,playToast:l},at.createElement("div",{id:q,tabIndex:0,onClick:f,"data-in":U,className:J,...s,style:w,ref:n,...U&&{role:T,"aria-label":G}},W!=null&&at.createElement("div",{className:zi("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!K})},W),Gw(h,e,!t),oe,!e.customProgressBar&&at.createElement(l6,{...C&&!F?{key:`p-${C}`}:{},rtl:j,theme:te,delay:m,isRunning:t,isIn:U,closeToast:y,hide:g,type:p,className:E,controlledProgress:F,progress:O||0})))},R6=(e,t=!1)=>({enter:`Toastify--animate Toastify__${e}-enter`,exit:`Toastify--animate Toastify__${e}-exit`,appendPosition:t}),M6=i6(R6("bounce",!0)),F6={position:"top-right",transition:M6,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:e=>e.altKey&&e.code==="KeyT"};function L6(e){let t={...F6,...e},r=e.stacked,[n,s]=k.useState(!0),l=k.useRef(null),{getToastToRender:u,isToastActive:h,count:m}=S6(t),{className:f,style:p,rtl:g,containerId:y,hotKeys:v}=t;function S(w){let E=zi("Toastify__toast-container",`Toastify__toast-container--${w}`,{"Toastify__toast-container--rtl":g});return gs(f)?f({position:w,rtl:g,defaultClassName:E}):zi(E,Gm(f))}function N(){r&&(s(!0),ze.play())}return T6(()=>{var w;if(r){let E=l.current.querySelectorAll('[data-in="true"]'),C=12,T=(w=t.position)==null?void 0:w.includes("top"),O=0,j=0;Array.from(E).reverse().forEach((q,D)=>{let U=q;U.classList.add("Toastify__toast--stacked"),D>0&&(U.dataset.collapsed=`${n}`),U.dataset.pos||(U.dataset.pos=T?"top":"bot");let K=O*(n?.2:1)+(n?0:C*D);U.style.setProperty("--y",`${T?K:K*-1}px`),U.style.setProperty("--g",`${C}`),U.style.setProperty("--s",`${1-(n?j:0)}`),O+=U.offsetHeight,j+=.025})}},[n,m,r]),k.useEffect(()=>{function w(E){var C;let T=l.current;v(E)&&((C=T.querySelector('[tabIndex="0"]'))==null||C.focus(),s(!1),ze.pause()),E.key==="Escape"&&(document.activeElement===T||T!=null&&T.contains(document.activeElement))&&(s(!0),ze.play())}return document.addEventListener("keydown",w),()=>{document.removeEventListener("keydown",w)}},[v]),at.createElement("section",{ref:l,className:"Toastify",id:y,onMouseEnter:()=>{r&&(s(!1),ze.pause())},onMouseLeave:N,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":t["aria-label"]},u((w,E)=>{let C=E.length?{...p}:{...p,pointerEvents:"none"};return at.createElement("div",{tabIndex:-1,className:S(w),"data-stacked":r,style:C,key:`c-${w}`},E.map(({content:T,props:O})=>at.createElement(O6,{...O,stacked:r,collapseAll:N,isIn:h(O.toastId,O.containerId),key:`t-${O.key}`},T)))}))}var lm,Uv;function P6(){return Uv||(Uv=1,lm=function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(n,s,l){r.o(n,s)||Object.defineProperty(n,s,{enumerable:!0,get:l})},r.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},r.t=function(n,s){if(1&s&&(n=r(n)),8&s||4&s&&typeof n=="object"&&n&&n.__esModule)return n;var l=Object.create(null);if(r.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:n}),2&s&&typeof n!="string")for(var u in n)r.d(l,u,(function(h){return n[h]}).bind(null,u));return l},r.n=function(n){var s=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(s,"a",s),s},r.o=function(n,s){return Object.prototype.hasOwnProperty.call(n,s)},r.p="",r(r.s=9)}([function(e,t){e.exports=_f()},function(e,t,r){var n;/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){var s={}.hasOwnProperty;function l(){for(var u=[],h=0;h<arguments.length;h++){var m=arguments[h];if(m){var f=typeof m;if(f==="string"||f==="number")u.push(m);else if(Array.isArray(m)&&m.length){var p=l.apply(null,m);p&&u.push(p)}else if(f==="object")for(var g in m)s.call(m,g)&&m[g]&&u.push(g)}}return u.join(" ")}e.exports?(l.default=l,e.exports=l):(n=(function(){return l}).apply(t,[]))===void 0||(e.exports=n)})()},function(e,t,r){(function(n){var s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,h=/^0o[0-7]+$/i,m=parseInt,f=typeof n=="object"&&n&&n.Object===Object&&n,p=typeof self=="object"&&self&&self.Object===Object&&self,g=f||p||Function("return this")(),y=Object.prototype.toString,v=g.Symbol,S=v?v.prototype:void 0,N=S?S.toString:void 0;function w(O){if(typeof O=="string")return O;if(C(O))return N?N.call(O):"";var j=O+"";return j=="0"&&1/O==-1/0?"-0":j}function E(O){var j=typeof O;return!!O&&(j=="object"||j=="function")}function C(O){return typeof O=="symbol"||function(j){return!!j&&typeof j=="object"}(O)&&y.call(O)=="[object Symbol]"}function T(O){return O?(O=function(j){if(typeof j=="number")return j;if(C(j))return NaN;if(E(j)){var q=typeof j.valueOf=="function"?j.valueOf():j;j=E(q)?q+"":q}if(typeof j!="string")return j===0?j:+j;j=j.replace(s,"");var D=u.test(j);return D||h.test(j)?m(j.slice(2),D?2:8):l.test(j)?NaN:+j}(O))===1/0||O===-1/0?17976931348623157e292*(O<0?-1:1):O==O?O:0:O===0?O:0}e.exports=function(O,j,q){var D,U,K,ie;return O=(D=O)==null?"":w(D),U=function(te){var G=T(te),de=G%1;return G==G?de?G-de:G:0}(q),K=0,ie=O.length,U==U&&(ie!==void 0&&(U=U<=ie?U:ie),K!==void 0&&(U=U>=K?U:K)),q=U,j=w(j),O.slice(q,q+j.length)==j}}).call(this,r(3))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch{typeof window=="object"&&(r=window)}e.exports=r},function(e,t,r){(function(n){var s=/^\[object .+?Constructor\]$/,l=typeof n=="object"&&n&&n.Object===Object&&n,u=typeof self=="object"&&self&&self.Object===Object&&self,h=l||u||Function("return this")(),m,f=Array.prototype,p=Function.prototype,g=Object.prototype,y=h["__core-js_shared__"],v=(m=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",S=p.toString,N=g.hasOwnProperty,w=g.toString,E=RegExp("^"+S.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=f.splice,T=te(h,"Map"),O=te(Object,"create");function j(J){var W=-1,F=J?J.length:0;for(this.clear();++W<F;){var Z=J[W];this.set(Z[0],Z[1])}}function q(J){var W=-1,F=J?J.length:0;for(this.clear();++W<F;){var Z=J[W];this.set(Z[0],Z[1])}}function D(J){var W=-1,F=J?J.length:0;for(this.clear();++W<F;){var Z=J[W];this.set(Z[0],Z[1])}}function U(J,W){for(var F,Z,oe=J.length;oe--;)if((F=J[oe][0])===(Z=W)||F!=F&&Z!=Z)return oe;return-1}function K(J){return!(!de(J)||(W=J,v&&v in W))&&(function(F){var Z=de(F)?w.call(F):"";return Z=="[object Function]"||Z=="[object GeneratorFunction]"}(J)||function(F){var Z=!1;if(F!=null&&typeof F.toString!="function")try{Z=!!(F+"")}catch{}return Z}(J)?E:s).test(function(F){if(F!=null){try{return S.call(F)}catch{}try{return F+""}catch{}}return""}(J));var W}function ie(J,W){var F,Z,oe=J.__data__;return((Z=typeof(F=W))=="string"||Z=="number"||Z=="symbol"||Z=="boolean"?F!=="__proto__":F===null)?oe[typeof W=="string"?"string":"hash"]:oe.map}function te(J,W){var F=function(Z,oe){return Z==null?void 0:Z[oe]}(J,W);return K(F)?F:void 0}function G(J,W){if(typeof J!="function"||W&&typeof W!="function")throw new TypeError("Expected a function");var F=function(){var Z=arguments,oe=W?W.apply(this,Z):Z[0],le=F.cache;if(le.has(oe))return le.get(oe);var R=J.apply(this,Z);return F.cache=le.set(oe,R),R};return F.cache=new(G.Cache||D),F}function de(J){var W=typeof J;return!!J&&(W=="object"||W=="function")}j.prototype.clear=function(){this.__data__=O?O(null):{}},j.prototype.delete=function(J){return this.has(J)&&delete this.__data__[J]},j.prototype.get=function(J){var W=this.__data__;if(O){var F=W[J];return F==="__lodash_hash_undefined__"?void 0:F}return N.call(W,J)?W[J]:void 0},j.prototype.has=function(J){var W=this.__data__;return O?W[J]!==void 0:N.call(W,J)},j.prototype.set=function(J,W){return this.__data__[J]=O&&W===void 0?"__lodash_hash_undefined__":W,this},q.prototype.clear=function(){this.__data__=[]},q.prototype.delete=function(J){var W=this.__data__,F=U(W,J);return!(F<0)&&(F==W.length-1?W.pop():C.call(W,F,1),!0)},q.prototype.get=function(J){var W=this.__data__,F=U(W,J);return F<0?void 0:W[F][1]},q.prototype.has=function(J){return U(this.__data__,J)>-1},q.prototype.set=function(J,W){var F=this.__data__,Z=U(F,J);return Z<0?F.push([J,W]):F[Z][1]=W,this},D.prototype.clear=function(){this.__data__={hash:new j,map:new(T||q),string:new j}},D.prototype.delete=function(J){return ie(this,J).delete(J)},D.prototype.get=function(J){return ie(this,J).get(J)},D.prototype.has=function(J){return ie(this,J).has(J)},D.prototype.set=function(J,W){return ie(this,J).set(J,W),this},G.Cache=D,e.exports=G}).call(this,r(3))},function(e,t,r){(function(n){var s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,h=/^0o[0-7]+$/i,m=parseInt,f=typeof n=="object"&&n&&n.Object===Object&&n,p=typeof self=="object"&&self&&self.Object===Object&&self,g=f||p||Function("return this")(),y=Object.prototype.toString,v=Math.max,S=Math.min,N=function(){return g.Date.now()};function w(C){var T=typeof C;return!!C&&(T=="object"||T=="function")}function E(C){if(typeof C=="number")return C;if(function(j){return typeof j=="symbol"||function(q){return!!q&&typeof q=="object"}(j)&&y.call(j)=="[object Symbol]"}(C))return NaN;if(w(C)){var T=typeof C.valueOf=="function"?C.valueOf():C;C=w(T)?T+"":T}if(typeof C!="string")return C===0?C:+C;C=C.replace(s,"");var O=u.test(C);return O||h.test(C)?m(C.slice(2),O?2:8):l.test(C)?NaN:+C}e.exports=function(C,T,O){var j,q,D,U,K,ie,te=0,G=!1,de=!1,J=!0;if(typeof C!="function")throw new TypeError("Expected a function");function W(ne){var P=j,H=q;return j=q=void 0,te=ne,U=C.apply(H,P)}function F(ne){return te=ne,K=setTimeout(oe,T),G?W(ne):U}function Z(ne){var P=ne-ie;return ie===void 0||P>=T||P<0||de&&ne-te>=D}function oe(){var ne=N();if(Z(ne))return le(ne);K=setTimeout(oe,function(P){var H=T-(P-ie);return de?S(H,D-(P-te)):H}(ne))}function le(ne){return K=void 0,J&&j?W(ne):(j=q=void 0,U)}function R(){var ne=N(),P=Z(ne);if(j=arguments,q=this,ie=ne,P){if(K===void 0)return F(ie);if(de)return K=setTimeout(oe,T),W(ie)}return K===void 0&&(K=setTimeout(oe,T)),U}return T=E(T)||0,w(O)&&(G=!!O.leading,D=(de="maxWait"in O)?v(E(O.maxWait)||0,T):D,J="trailing"in O?!!O.trailing:J),R.cancel=function(){K!==void 0&&clearTimeout(K),te=0,j=ie=q=K=void 0},R.flush=function(){return K===void 0?U:le(N())},R}}).call(this,r(3))},function(e,t,r){(function(n,s){var l="[object Arguments]",u="[object Map]",h="[object Object]",m="[object Set]",f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,p=/^\w*$/,g=/^\./,y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,v=/\\(\\)?/g,S=/^\[object .+?Constructor\]$/,N=/^(?:0|[1-9]\d*)$/,w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w[l]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w["[object Error]"]=w["[object Function]"]=w[u]=w["[object Number]"]=w[h]=w["[object RegExp]"]=w[m]=w["[object String]"]=w["[object WeakMap]"]=!1;var E=typeof n=="object"&&n&&n.Object===Object&&n,C=typeof self=="object"&&self&&self.Object===Object&&self,T=E||C||Function("return this")(),O=t&&!t.nodeType&&t,j=O&&typeof s=="object"&&s&&!s.nodeType&&s,q=j&&j.exports===O&&E.process,D=function(){try{return q&&q.binding("util")}catch{}}(),U=D&&D.isTypedArray;function K(L,se,xe,fe){var ke=-1,Be=L?L.length:0;for(fe&&Be&&(xe=L[++ke]);++ke<Be;)xe=se(xe,L[ke],ke,L);return xe}function ie(L,se){for(var xe=-1,fe=L?L.length:0;++xe<fe;)if(se(L[xe],xe,L))return!0;return!1}function te(L,se,xe,fe,ke){return ke(L,function(Be,Je,ct){xe=fe?(fe=!1,Be):se(xe,Be,Je,ct)}),xe}function G(L){var se=!1;if(L!=null&&typeof L.toString!="function")try{se=!!(L+"")}catch{}return se}function de(L){var se=-1,xe=Array(L.size);return L.forEach(function(fe,ke){xe[++se]=[ke,fe]}),xe}function J(L){var se=-1,xe=Array(L.size);return L.forEach(function(fe){xe[++se]=fe}),xe}var W,F,Z,oe=Array.prototype,le=Function.prototype,R=Object.prototype,ne=T["__core-js_shared__"],P=(W=/[^.]+$/.exec(ne&&ne.keys&&ne.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"",H=le.toString,z=R.hasOwnProperty,_=R.toString,ce=RegExp("^"+H.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),re=T.Symbol,me=T.Uint8Array,je=R.propertyIsEnumerable,Re=oe.splice,We=(F=Object.keys,Z=Object,function(L){return F(Z(L))}),Ge=yt(T,"DataView"),Ve=yt(T,"Map"),He=yt(T,"Promise"),ge=yt(T,"Set"),Ce=yt(T,"WeakMap"),_e=yt(Object,"create"),nt=Br(Ge),Ke=Br(Ve),rt=Br(He),ot=Br(ge),At=Br(Ce),Ze=re?re.prototype:void 0,et=Ze?Ze.valueOf:void 0,xt=Ze?Ze.toString:void 0;function Qe(L){var se=-1,xe=L?L.length:0;for(this.clear();++se<xe;){var fe=L[se];this.set(fe[0],fe[1])}}function Xe(L){var se=-1,xe=L?L.length:0;for(this.clear();++se<xe;){var fe=L[se];this.set(fe[0],fe[1])}}function gt(L){var se=-1,xe=L?L.length:0;for(this.clear();++se<xe;){var fe=L[se];this.set(fe[0],fe[1])}}function Ft(L){var se=-1,xe=L?L.length:0;for(this.__data__=new gt;++se<xe;)this.add(L[se])}function tr(L){this.__data__=new Xe(L)}function Ut(L,se){var xe=X(L)||M(L)?function(Je,ct){for(var ut=-1,_t=Array(Je);++ut<Je;)_t[ut]=ct(ut);return _t}(L.length,String):[],fe=xe.length,ke=!!fe;for(var Be in L)!z.call(L,Be)||ke&&(Be=="length"||Yr(Be,fe))||xe.push(Be);return xe}function Qr(L,se){for(var xe=L.length;xe--;)if(Es(L[xe][0],se))return xe;return-1}Qe.prototype.clear=function(){this.__data__=_e?_e(null):{}},Qe.prototype.delete=function(L){return this.has(L)&&delete this.__data__[L]},Qe.prototype.get=function(L){var se=this.__data__;if(_e){var xe=se[L];return xe==="__lodash_hash_undefined__"?void 0:xe}return z.call(se,L)?se[L]:void 0},Qe.prototype.has=function(L){var se=this.__data__;return _e?se[L]!==void 0:z.call(se,L)},Qe.prototype.set=function(L,se){return this.__data__[L]=_e&&se===void 0?"__lodash_hash_undefined__":se,this},Xe.prototype.clear=function(){this.__data__=[]},Xe.prototype.delete=function(L){var se=this.__data__,xe=Qr(se,L);return!(xe<0)&&(xe==se.length-1?se.pop():Re.call(se,xe,1),!0)},Xe.prototype.get=function(L){var se=this.__data__,xe=Qr(se,L);return xe<0?void 0:se[xe][1]},Xe.prototype.has=function(L){return Qr(this.__data__,L)>-1},Xe.prototype.set=function(L,se){var xe=this.__data__,fe=Qr(xe,L);return fe<0?xe.push([L,se]):xe[fe][1]=se,this},gt.prototype.clear=function(){this.__data__={hash:new Qe,map:new(Ve||Xe),string:new Qe}},gt.prototype.delete=function(L){return lt(this,L).delete(L)},gt.prototype.get=function(L){return lt(this,L).get(L)},gt.prototype.has=function(L){return lt(this,L).has(L)},gt.prototype.set=function(L,se){return lt(this,L).set(L,se),this},Ft.prototype.add=Ft.prototype.push=function(L){return this.__data__.set(L,"__lodash_hash_undefined__"),this},Ft.prototype.has=function(L){return this.__data__.has(L)},tr.prototype.clear=function(){this.__data__=new Xe},tr.prototype.delete=function(L){return this.__data__.delete(L)},tr.prototype.get=function(L){return this.__data__.get(L)},tr.prototype.has=function(L){return this.__data__.has(L)},tr.prototype.set=function(L,se){var xe=this.__data__;if(xe instanceof Xe){var fe=xe.__data__;if(!Ve||fe.length<199)return fe.push([L,se]),this;xe=this.__data__=new gt(fe)}return xe.set(L,se),this};var Zr,It=(Zr=function(L,se){return L&&Lr(L,se,we)},function(L,se){if(L==null)return L;if(!V(L))return Zr(L,se);for(var xe=L.length,fe=-1,ke=Object(L);++fe<xe&&se(ke[fe],fe,ke)!==!1;);return L}),Lr=function(L){return function(se,xe,fe){for(var ke=-1,Be=Object(se),Je=fe(se),ct=Je.length;ct--;){var ut=Je[++ke];if(xe(Be[ut],ut,Be)===!1)break}return se}}();function dn(L,se){for(var xe=0,fe=(se=Jr(se,L)?[se]:Ie(se)).length;L!=null&&xe<fe;)L=L[Lt(se[xe++])];return xe&&xe==fe?L:void 0}function Er(L,se){return L!=null&&se in Object(L)}function Un(L,se,xe,fe,ke){return L===se||(L==null||se==null||!ee(L)&&!ve(se)?L!=L&&se!=se:function(Be,Je,ct,ut,_t,wt){var ir=X(Be),Vt=X(Je),rr="[object Array]",zt="[object Array]";ir||(rr=(rr=Ye(Be))==l?h:rr),Vt||(zt=(zt=Ye(Je))==l?h:zt);var _n=rr==h&&!G(Be),Ur=zt==h&&!G(Je),pa=rr==zt;if(pa&&!_n)return wt||(wt=new tr),ir||pe(Be)?st(Be,Je,ct,ut,_t,wt):function(Ht,vt,pi,Ma,_s,Dr,Jn){switch(pi){case"[object DataView]":if(Ht.byteLength!=vt.byteLength||Ht.byteOffset!=vt.byteOffset)return!1;Ht=Ht.buffer,vt=vt.buffer;case"[object ArrayBuffer]":return!(Ht.byteLength!=vt.byteLength||!Ma(new me(Ht),new me(vt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Es(+Ht,+vt);case"[object Error]":return Ht.name==vt.name&&Ht.message==vt.message;case"[object RegExp]":case"[object String]":return Ht==vt+"";case u:var xa=de;case m:var ea=2&Dr;if(xa||(xa=J),Ht.size!=vt.size&&!ea)return!1;var no=Jn.get(Ht);if(no)return no==vt;Dr|=1,Jn.set(Ht,vt);var Xa=st(xa(Ht),xa(vt),Ma,_s,Dr,Jn);return Jn.delete(Ht),Xa;case"[object Symbol]":if(et)return et.call(Ht)==et.call(vt)}return!1}(Be,Je,rr,ct,ut,_t,wt);if(!(2&_t)){var gu=_n&&z.call(Be,"__wrapped__"),mi=Ur&&z.call(Je,"__wrapped__");if(gu||mi){var yu=gu?Be.value():Be,ro=mi?Je.value():Je;return wt||(wt=new tr),ct(yu,ro,ut,_t,wt)}}return pa?(wt||(wt=new tr),function(Ht,vt,pi,Ma,_s,Dr){var Jn=2&_s,xa=we(Ht),ea=xa.length,no=we(vt).length;if(ea!=no&&!Jn)return!1;for(var Xa=ea;Xa--;){var ga=xa[Xa];if(!(Jn?ga in vt:z.call(vt,ga)))return!1}var ao=Dr.get(Ht);if(ao&&Dr.get(vt))return ao==vt;var so=!0;Dr.set(Ht,vt),Dr.set(vt,Ht);for(var pl=Jn;++Xa<ea;){ga=xa[Xa];var Ka=Ht[ga],Cs=vt[ga];if(Ma)var io=Jn?Ma(Cs,Ka,ga,vt,Ht,Dr):Ma(Ka,Cs,ga,Ht,vt,Dr);if(!(io===void 0?Ka===Cs||pi(Ka,Cs,Ma,_s,Dr):io)){so=!1;break}pl||(pl=ga=="constructor")}if(so&&!pl){var ya=Ht.constructor,va=vt.constructor;ya==va||!("constructor"in Ht)||!("constructor"in vt)||typeof ya=="function"&&ya instanceof ya&&typeof va=="function"&&va instanceof va||(so=!1)}return Dr.delete(Ht),Dr.delete(vt),so}(Be,Je,ct,ut,_t,wt)):!1}(L,se,Un,xe,fe,ke))}function I(L){return!(!ee(L)||function(se){return!!P&&P in se}(L))&&(Y(L)||G(L)?ce:S).test(Br(L))}function Se(L){return typeof L=="function"?L:L==null?Te:typeof L=="object"?X(L)?function(fe,ke){return Jr(fe)&&Pr(ke)?fn(Lt(fe),ke):function(Be){var Je=function(ct,ut,_t){var wt=ct==null?void 0:dn(ct,ut);return wt===void 0?_t:wt}(Be,fe);return Je===void 0&&Je===ke?function(ct,ut){return ct!=null&&function(_t,wt,ir){wt=Jr(wt,_t)?[wt]:Ie(wt);for(var Vt,rr=-1,zt=wt.length;++rr<zt;){var _n=Lt(wt[rr]);if(!(Vt=_t!=null&&ir(_t,_n)))break;_t=_t[_n]}return Vt||!!(zt=_t?_t.length:0)&&Q(zt)&&Yr(_n,zt)&&(X(_t)||M(_t))}(ct,ut,Er)}(Be,fe):Un(ke,Je,void 0,3)}}(L[0],L[1]):function(fe){var ke=function(Be){for(var Je=we(Be),ct=Je.length;ct--;){var ut=Je[ct],_t=Be[ut];Je[ct]=[ut,_t,Pr(_t)]}return Je}(fe);return ke.length==1&&ke[0][2]?fn(ke[0][0],ke[0][1]):function(Be){return Be===fe||function(Je,ct,ut,_t){var wt=ut.length,ir=wt;if(Je==null)return!ir;for(Je=Object(Je);wt--;){var Vt=ut[wt];if(Vt[2]?Vt[1]!==Je[Vt[0]]:!(Vt[0]in Je))return!1}for(;++wt<ir;){var rr=(Vt=ut[wt])[0],zt=Je[rr],_n=Vt[1];if(Vt[2]){if(zt===void 0&&!(rr in Je))return!1}else{var Ur=new tr,pa;if(!(pa===void 0?Un(_n,zt,_t,3,Ur):pa))return!1}}return!0}(Be,fe,ke)}}(L):Jr(se=L)?(xe=Lt(se),function(fe){return fe==null?void 0:fe[xe]}):function(fe){return function(ke){return dn(ke,fe)}}(se);var se,xe}function Ue(L){if(xe=(se=L)&&se.constructor,fe=typeof xe=="function"&&xe.prototype||R,se!==fe)return We(L);var se,xe,fe,ke=[];for(var Be in Object(L))z.call(L,Be)&&Be!="constructor"&&ke.push(Be);return ke}function Ie(L){return X(L)?L:ar(L)}function st(L,se,xe,fe,ke,Be){var Je=2&ke,ct=L.length,ut=se.length;if(ct!=ut&&!(Je&&ut>ct))return!1;var _t=Be.get(L);if(_t&&Be.get(se))return _t==se;var wt=-1,ir=!0,Vt=1&ke?new Ft:void 0;for(Be.set(L,se),Be.set(se,L);++wt<ct;){var rr=L[wt],zt=se[wt];if(fe)var _n=Je?fe(zt,rr,wt,se,L,Be):fe(rr,zt,wt,L,se,Be);if(_n!==void 0){if(_n)continue;ir=!1;break}if(Vt){if(!ie(se,function(Ur,pa){if(!Vt.has(pa)&&(rr===Ur||xe(rr,Ur,fe,ke,Be)))return Vt.add(pa)})){ir=!1;break}}else if(rr!==zt&&!xe(rr,zt,fe,ke,Be)){ir=!1;break}}return Be.delete(L),Be.delete(se),ir}function lt(L,se){var xe,fe,ke=L.__data__;return((fe=typeof(xe=se))=="string"||fe=="number"||fe=="symbol"||fe=="boolean"?xe!=="__proto__":xe===null)?ke[typeof se=="string"?"string":"hash"]:ke.map}function yt(L,se){var xe=function(fe,ke){return fe==null?void 0:fe[ke]}(L,se);return I(xe)?xe:void 0}var Ye=function(L){return _.call(L)};function Yr(L,se){return!!(se=se??9007199254740991)&&(typeof L=="number"||N.test(L))&&L>-1&&L%1==0&&L<se}function Jr(L,se){if(X(L))return!1;var xe=typeof L;return!(xe!="number"&&xe!="symbol"&&xe!="boolean"&&L!=null&&!De(L))||p.test(L)||!f.test(L)||se!=null&&L in Object(se)}function Pr(L){return L==L&&!ee(L)}function fn(L,se){return function(xe){return xe!=null&&xe[L]===se&&(se!==void 0||L in Object(xe))}}(Ge&&Ye(new Ge(new ArrayBuffer(1)))!="[object DataView]"||Ve&&Ye(new Ve)!=u||He&&Ye(He.resolve())!="[object Promise]"||ge&&Ye(new ge)!=m||Ce&&Ye(new Ce)!="[object WeakMap]")&&(Ye=function(L){var se=_.call(L),xe=se==h?L.constructor:void 0,fe=xe?Br(xe):void 0;if(fe)switch(fe){case nt:return"[object DataView]";case Ke:return u;case rt:return"[object Promise]";case ot:return m;case At:return"[object WeakMap]"}return se});var ar=Ra(function(L){var se;L=(se=L)==null?"":function(fe){if(typeof fe=="string")return fe;if(De(fe))return xt?xt.call(fe):"";var ke=fe+"";return ke=="0"&&1/fe==-1/0?"-0":ke}(se);var xe=[];return g.test(L)&&xe.push(""),L.replace(y,function(fe,ke,Be,Je){xe.push(Be?Je.replace(v,"$1"):ke||fe)}),xe});function Lt(L){if(typeof L=="string"||De(L))return L;var se=L+"";return se=="0"&&1/L==-1/0?"-0":se}function Br(L){if(L!=null){try{return H.call(L)}catch{}try{return L+""}catch{}}return""}function Ra(L,se){if(typeof L!="function"||se&&typeof se!="function")throw new TypeError("Expected a function");var xe=function(){var fe=arguments,ke=se?se.apply(this,fe):fe[0],Be=xe.cache;if(Be.has(ke))return Be.get(ke);var Je=L.apply(this,fe);return xe.cache=Be.set(ke,Je),Je};return xe.cache=new(Ra.Cache||gt),xe}function Es(L,se){return L===se||L!=L&&se!=se}function M(L){return function(se){return ve(se)&&V(se)}(L)&&z.call(L,"callee")&&(!je.call(L,"callee")||_.call(L)==l)}Ra.Cache=gt;var X=Array.isArray;function V(L){return L!=null&&Q(L.length)&&!Y(L)}function Y(L){var se=ee(L)?_.call(L):"";return se=="[object Function]"||se=="[object GeneratorFunction]"}function Q(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=9007199254740991}function ee(L){var se=typeof L;return!!L&&(se=="object"||se=="function")}function ve(L){return!!L&&typeof L=="object"}function De(L){return typeof L=="symbol"||ve(L)&&_.call(L)=="[object Symbol]"}var pe=U?function(L){return function(se){return L(se)}}(U):function(L){return ve(L)&&Q(L.length)&&!!w[_.call(L)]};function we(L){return V(L)?Ut(L):Ue(L)}function Te(L){return L}s.exports=function(L,se,xe){var fe=X(L)?K:te,ke=arguments.length<3;return fe(L,Se(se),xe,ke,It)}}).call(this,r(3),r(7)(e))},function(e,t){e.exports=function(r){return r.webpackPolyfill||(r.deprecate=function(){},r.paths=[],r.children||(r.children=[]),Object.defineProperty(r,"loaded",{enumerable:!0,get:function(){return r.l}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return r.i}}),r.webpackPolyfill=1),r}},function(e,t){String.prototype.padEnd||(String.prototype.padEnd=function(r,n){return r>>=0,n=String(n!==void 0?n:" "),this.length>r?String(this):((r-=this.length)>n.length&&(n+=n.repeat(r/n.length)),String(this)+n.slice(0,r))})},function(e,t,r){function n(R,ne,P){return ne in R?Object.defineProperty(R,ne,{value:P,enumerable:!0,configurable:!0,writable:!0}):R[ne]=P,R}function s(R){if(Symbol.iterator in Object(R)||Object.prototype.toString.call(R)==="[object Arguments]")return Array.from(R)}function l(R){return function(ne){if(Array.isArray(ne)){for(var P=0,H=new Array(ne.length);P<ne.length;P++)H[P]=ne[P];return H}}(R)||s(R)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(R){if(Array.isArray(R))return R}function h(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function m(R,ne){if(!(R instanceof ne))throw new TypeError("Cannot call a class as a function")}function f(R,ne){for(var P=0;P<ne.length;P++){var H=ne[P];H.enumerable=H.enumerable||!1,H.configurable=!0,"value"in H&&(H.writable=!0),Object.defineProperty(R,H.key,H)}}function p(R){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne})(R)}function g(R){return(g=typeof Symbol=="function"&&p(Symbol.iterator)==="symbol"?function(ne){return p(ne)}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":p(ne)})(R)}function y(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}function v(R){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(ne){return ne.__proto__||Object.getPrototypeOf(ne)})(R)}function S(R,ne){return(S=Object.setPrototypeOf||function(P,H){return P.__proto__=H,P})(R,ne)}r.r(t);var N=r(0),w=r.n(N),E=r(5),C=r.n(E),T=r(4),O=r.n(T),j=r(6),q=r.n(j),D=r(2),U=r.n(D),K=r(1),ie=r.n(K);r(8);function te(R,ne){return u(R)||function(P,H){var z=[],_=!0,ce=!1,re=void 0;try{for(var me,je=P[Symbol.iterator]();!(_=(me=je.next()).done)&&(z.push(me.value),!H||z.length!==H);_=!0);}catch(Re){ce=!0,re=Re}finally{try{_||je.return==null||je.return()}finally{if(ce)throw re}}return z}(R,ne)||h()}var G=[["Afghanistan",["asia"],"af","93"],["Albania",["europe"],"al","355"],["Algeria",["africa","north-africa"],"dz","213"],["Andorra",["europe"],"ad","376"],["Angola",["africa"],"ao","244"],["Antigua and Barbuda",["america","carribean"],"ag","1268"],["Argentina",["america","south-america"],"ar","54","(..) ........",0,["11","221","223","261","264","2652","280","2905","291","2920","2966","299","341","342","343","351","376","379","381","3833","385","387","388"]],["Armenia",["asia","ex-ussr"],"am","374",".. ......"],["Aruba",["america","carribean"],"aw","297"],["Australia",["oceania"],"au","61","(..) .... ....",0,["2","3","4","7","8","02","03","04","07","08"]],["Austria",["europe","eu-union"],"at","43"],["Azerbaijan",["asia","ex-ussr"],"az","994","(..) ... .. .."],["Bahamas",["america","carribean"],"bs","1242"],["Bahrain",["middle-east"],"bh","973"],["Bangladesh",["asia"],"bd","880"],["Barbados",["america","carribean"],"bb","1246"],["Belarus",["europe","ex-ussr"],"by","375","(..) ... .. .."],["Belgium",["europe","eu-union"],"be","32","... .. .. .."],["Belize",["america","central-america"],"bz","501"],["Benin",["africa"],"bj","229"],["Bhutan",["asia"],"bt","975"],["Bolivia",["america","south-america"],"bo","591"],["Bosnia and Herzegovina",["europe","ex-yugos"],"ba","387"],["Botswana",["africa"],"bw","267"],["Brazil",["america","south-america"],"br","55","(..) ........."],["British Indian Ocean Territory",["asia"],"io","246"],["Brunei",["asia"],"bn","673"],["Bulgaria",["europe","eu-union"],"bg","359"],["Burkina Faso",["africa"],"bf","226"],["Burundi",["africa"],"bi","257"],["Cambodia",["asia"],"kh","855"],["Cameroon",["africa"],"cm","237"],["Canada",["america","north-america"],"ca","1","(...) ...-....",1,["204","226","236","249","250","289","306","343","365","387","403","416","418","431","437","438","450","506","514","519","548","579","581","587","604","613","639","647","672","705","709","742","778","780","782","807","819","825","867","873","902","905"]],["Cape Verde",["africa"],"cv","238"],["Caribbean Netherlands",["america","carribean"],"bq","599","",1],["Central African Republic",["africa"],"cf","236"],["Chad",["africa"],"td","235"],["Chile",["america","south-america"],"cl","56"],["China",["asia"],"cn","86","..-........."],["Colombia",["america","south-america"],"co","57","... ... ...."],["Comoros",["africa"],"km","269"],["Congo",["africa"],"cd","243"],["Congo",["africa"],"cg","242"],["Costa Rica",["america","central-america"],"cr","506","....-...."],["Cte dIvoire",["africa"],"ci","225",".. .. .. .."],["Croatia",["europe","eu-union","ex-yugos"],"hr","385"],["Cuba",["america","carribean"],"cu","53"],["Curaao",["america","carribean"],"cw","599","",0],["Cyprus",["europe","eu-union"],"cy","357",".. ......"],["Czech Republic",["europe","eu-union"],"cz","420","... ... ..."],["Denmark",["europe","eu-union","baltic"],"dk","45",".. .. .. .."],["Djibouti",["africa"],"dj","253"],["Dominica",["america","carribean"],"dm","1767"],["Dominican Republic",["america","carribean"],"do","1","",2,["809","829","849"]],["Ecuador",["america","south-america"],"ec","593"],["Egypt",["africa","north-africa"],"eg","20"],["El Salvador",["america","central-america"],"sv","503","....-...."],["Equatorial Guinea",["africa"],"gq","240"],["Eritrea",["africa"],"er","291"],["Estonia",["europe","eu-union","ex-ussr","baltic"],"ee","372",".... ......"],["Ethiopia",["africa"],"et","251"],["Fiji",["oceania"],"fj","679"],["Finland",["europe","eu-union","baltic"],"fi","358",".. ... .. .."],["France",["europe","eu-union"],"fr","33",". .. .. .. .."],["French Guiana",["america","south-america"],"gf","594"],["French Polynesia",["oceania"],"pf","689"],["Gabon",["africa"],"ga","241"],["Gambia",["africa"],"gm","220"],["Georgia",["asia","ex-ussr"],"ge","995"],["Germany",["europe","eu-union","baltic"],"de","49",".... ........"],["Ghana",["africa"],"gh","233"],["Greece",["europe","eu-union"],"gr","30"],["Grenada",["america","carribean"],"gd","1473"],["Guadeloupe",["america","carribean"],"gp","590","",0],["Guam",["oceania"],"gu","1671"],["Guatemala",["america","central-america"],"gt","502","....-...."],["Guinea",["africa"],"gn","224"],["Guinea-Bissau",["africa"],"gw","245"],["Guyana",["america","south-america"],"gy","592"],["Haiti",["america","carribean"],"ht","509","....-...."],["Honduras",["america","central-america"],"hn","504"],["Hong Kong",["asia"],"hk","852",".... ...."],["Hungary",["europe","eu-union"],"hu","36"],["Iceland",["europe"],"is","354","... ...."],["India",["asia"],"in","91",".....-....."],["Indonesia",["asia"],"id","62"],["Iran",["middle-east"],"ir","98","... ... ...."],["Iraq",["middle-east"],"iq","964"],["Ireland",["europe","eu-union"],"ie","353",".. ......."],["Israel",["middle-east"],"il","972","... ... ...."],["Italy",["europe","eu-union"],"it","39","... .......",0],["Jamaica",["america","carribean"],"jm","1876"],["Japan",["asia"],"jp","81",".. .... ...."],["Jordan",["middle-east"],"jo","962"],["Kazakhstan",["asia","ex-ussr"],"kz","7","... ...-..-..",1,["310","311","312","313","315","318","321","324","325","326","327","336","7172","73622"]],["Kenya",["africa"],"ke","254"],["Kiribati",["oceania"],"ki","686"],["Kosovo",["europe","ex-yugos"],"xk","383"],["Kuwait",["middle-east"],"kw","965"],["Kyrgyzstan",["asia","ex-ussr"],"kg","996","... ... ..."],["Laos",["asia"],"la","856"],["Latvia",["europe","eu-union","ex-ussr","baltic"],"lv","371",".. ... ..."],["Lebanon",["middle-east"],"lb","961"],["Lesotho",["africa"],"ls","266"],["Liberia",["africa"],"lr","231"],["Libya",["africa","north-africa"],"ly","218"],["Liechtenstein",["europe"],"li","423"],["Lithuania",["europe","eu-union","ex-ussr","baltic"],"lt","370"],["Luxembourg",["europe","eu-union"],"lu","352"],["Macau",["asia"],"mo","853"],["Macedonia",["europe","ex-yugos"],"mk","389"],["Madagascar",["africa"],"mg","261"],["Malawi",["africa"],"mw","265"],["Malaysia",["asia"],"my","60","..-....-...."],["Maldives",["asia"],"mv","960"],["Mali",["africa"],"ml","223"],["Malta",["europe","eu-union"],"mt","356"],["Marshall Islands",["oceania"],"mh","692"],["Martinique",["america","carribean"],"mq","596"],["Mauritania",["africa"],"mr","222"],["Mauritius",["africa"],"mu","230"],["Mexico",["america","central-america"],"mx","52","... ... ....",0,["55","81","33","656","664","998","774","229"]],["Micronesia",["oceania"],"fm","691"],["Moldova",["europe"],"md","373","(..) ..-..-.."],["Monaco",["europe"],"mc","377"],["Mongolia",["asia"],"mn","976"],["Montenegro",["europe","ex-yugos"],"me","382"],["Morocco",["africa","north-africa"],"ma","212"],["Mozambique",["africa"],"mz","258"],["Myanmar",["asia"],"mm","95"],["Namibia",["africa"],"na","264"],["Nauru",["africa"],"nr","674"],["Nepal",["asia"],"np","977"],["Netherlands",["europe","eu-union"],"nl","31",".. ........"],["New Caledonia",["oceania"],"nc","687"],["New Zealand",["oceania"],"nz","64","...-...-...."],["Nicaragua",["america","central-america"],"ni","505"],["Niger",["africa"],"ne","227"],["Nigeria",["africa"],"ng","234"],["North Korea",["asia"],"kp","850"],["Norway",["europe","baltic"],"no","47","... .. ..."],["Oman",["middle-east"],"om","968"],["Pakistan",["asia"],"pk","92","...-......."],["Palau",["oceania"],"pw","680"],["Palestine",["middle-east"],"ps","970"],["Panama",["america","central-america"],"pa","507"],["Papua New Guinea",["oceania"],"pg","675"],["Paraguay",["america","south-america"],"py","595"],["Peru",["america","south-america"],"pe","51"],["Philippines",["asia"],"ph","63",".... ......."],["Poland",["europe","eu-union","baltic"],"pl","48","...-...-..."],["Portugal",["europe","eu-union"],"pt","351"],["Puerto Rico",["america","carribean"],"pr","1","",3,["787","939"]],["Qatar",["middle-east"],"qa","974"],["Runion",["africa"],"re","262"],["Romania",["europe","eu-union"],"ro","40"],["Russia",["europe","asia","ex-ussr","baltic"],"ru","7","(...) ...-..-..",0],["Rwanda",["africa"],"rw","250"],["Saint Kitts and Nevis",["america","carribean"],"kn","1869"],["Saint Lucia",["america","carribean"],"lc","1758"],["Saint Vincent and the Grenadines",["america","carribean"],"vc","1784"],["Samoa",["oceania"],"ws","685"],["San Marino",["europe"],"sm","378"],["So Tom and Prncipe",["africa"],"st","239"],["Saudi Arabia",["middle-east"],"sa","966"],["Senegal",["africa"],"sn","221"],["Serbia",["europe","ex-yugos"],"rs","381"],["Seychelles",["africa"],"sc","248"],["Sierra Leone",["africa"],"sl","232"],["Singapore",["asia"],"sg","65","....-...."],["Slovakia",["europe","eu-union"],"sk","421"],["Slovenia",["europe","eu-union","ex-yugos"],"si","386"],["Solomon Islands",["oceania"],"sb","677"],["Somalia",["africa"],"so","252"],["South Africa",["africa"],"za","27"],["South Korea",["asia"],"kr","82","... .... ...."],["South Sudan",["africa","north-africa"],"ss","211"],["Spain",["europe","eu-union"],"es","34","... ... ..."],["Sri Lanka",["asia"],"lk","94"],["Sudan",["africa"],"sd","249"],["Suriname",["america","south-america"],"sr","597"],["Swaziland",["africa"],"sz","268"],["Sweden",["europe","eu-union","baltic"],"se","46","(...) ...-..."],["Switzerland",["europe"],"ch","41",".. ... .. .."],["Syria",["middle-east"],"sy","963"],["Taiwan",["asia"],"tw","886"],["Tajikistan",["asia","ex-ussr"],"tj","992"],["Tanzania",["africa"],"tz","255"],["Thailand",["asia"],"th","66"],["Timor-Leste",["asia"],"tl","670"],["Togo",["africa"],"tg","228"],["Tonga",["oceania"],"to","676"],["Trinidad and Tobago",["america","carribean"],"tt","1868"],["Tunisia",["africa","north-africa"],"tn","216"],["Turkey",["europe"],"tr","90","... ... .. .."],["Turkmenistan",["asia","ex-ussr"],"tm","993"],["Tuvalu",["asia"],"tv","688"],["Uganda",["africa"],"ug","256"],["Ukraine",["europe","ex-ussr"],"ua","380","(..) ... .. .."],["United Arab Emirates",["middle-east"],"ae","971"],["United Kingdom",["europe","eu-union"],"gb","44",".... ......"],["United States",["america","north-america"],"us","1","(...) ...-....",0,["907","205","251","256","334","479","501","870","480","520","602","623","928","209","213","310","323","408","415","510","530","559","562","619","626","650","661","707","714","760","805","818","831","858","909","916","925","949","951","303","719","970","203","860","202","302","239","305","321","352","386","407","561","727","772","813","850","863","904","941","954","229","404","478","706","770","912","808","319","515","563","641","712","208","217","309","312","618","630","708","773","815","847","219","260","317","574","765","812","316","620","785","913","270","502","606","859","225","318","337","504","985","413","508","617","781","978","301","410","207","231","248","269","313","517","586","616","734","810","906","989","218","320","507","612","651","763","952","314","417","573","636","660","816","228","601","662","406","252","336","704","828","910","919","701","308","402","603","201","609","732","856","908","973","505","575","702","775","212","315","516","518","585","607","631","716","718","845","914","216","330","419","440","513","614","740","937","405","580","918","503","541","215","412","570","610","717","724","814","401","803","843","864","605","423","615","731","865","901","931","210","214","254","281","325","361","409","432","512","713","806","817","830","903","915","936","940","956","972","979","435","801","276","434","540","703","757","804","802","206","253","360","425","509","262","414","608","715","920","304","307"]],["Uruguay",["america","south-america"],"uy","598"],["Uzbekistan",["asia","ex-ussr"],"uz","998",".. ... .. .."],["Vanuatu",["oceania"],"vu","678"],["Vatican City",["europe"],"va","39",".. .... ....",1],["Venezuela",["america","south-america"],"ve","58"],["Vietnam",["asia"],"vn","84"],["Yemen",["middle-east"],"ye","967"],["Zambia",["africa"],"zm","260"],["Zimbabwe",["africa"],"zw","263"]],de=[["American Samoa",["oceania"],"as","1684"],["Anguilla",["america","carribean"],"ai","1264"],["Bermuda",["america","north-america"],"bm","1441"],["British Virgin Islands",["america","carribean"],"vg","1284"],["Cayman Islands",["america","carribean"],"ky","1345"],["Cook Islands",["oceania"],"ck","682"],["Falkland Islands",["america","south-america"],"fk","500"],["Faroe Islands",["europe"],"fo","298"],["Gibraltar",["europe"],"gi","350"],["Greenland",["america"],"gl","299"],["Jersey",["europe","eu-union"],"je","44",".... ......"],["Montserrat",["america","carribean"],"ms","1664"],["Niue",["asia"],"nu","683"],["Norfolk Island",["oceania"],"nf","672"],["Northern Mariana Islands",["oceania"],"mp","1670"],["Saint Barthlemy",["america","carribean"],"bl","590","",1],["Saint Helena",["africa"],"sh","290"],["Saint Martin",["america","carribean"],"mf","590","",2],["Saint Pierre and Miquelon",["america","north-america"],"pm","508"],["Sint Maarten",["america","carribean"],"sx","1721"],["Tokelau",["oceania"],"tk","690"],["Turks and Caicos Islands",["america","carribean"],"tc","1649"],["U.S. Virgin Islands",["america","carribean"],"vi","1340"],["Wallis and Futuna",["oceania"],"wf","681"]];function J(R,ne,P,H,z){return!P||z?R+"".padEnd(ne.length,".")+" "+H:R+"".padEnd(ne.length,".")+" "+P}function W(R,ne,P,H,z){var _,ce,re=[];return ce=ne===!0,[(_=[]).concat.apply(_,l(R.map(function(me){var je={name:me[0],regions:me[1],iso2:me[2],countryCode:me[3],dialCode:me[3],format:J(P,me[3],me[4],H,z),priority:me[5]||0},Re=[];return me[6]&&me[6].map(function(We){var Ge=function(Ve){for(var He=1;He<arguments.length;He++){var ge=arguments[He]!=null?arguments[He]:{},Ce=Object.keys(ge);typeof Object.getOwnPropertySymbols=="function"&&(Ce=Ce.concat(Object.getOwnPropertySymbols(ge).filter(function(_e){return Object.getOwnPropertyDescriptor(ge,_e).enumerable}))),Ce.forEach(function(_e){n(Ve,_e,ge[_e])})}return Ve}({},je);Ge.dialCode=me[3]+We,Ge.isAreaCode=!0,Ge.areaCodeLength=We.length,Re.push(Ge)}),Re.length>0?(je.mainCode=!0,ce||ne.constructor.name==="Array"&&ne.includes(me[2])?(je.hasAreaCodes=!0,[je].concat(Re)):(re=re.concat(Re),[je])):[je]}))),re]}function F(R,ne,P,H){if(P!==null){var z=Object.keys(P),_=Object.values(P);z.forEach(function(ce,re){if(H)return R.push([ce,_[re]]);var me=R.findIndex(function(Re){return Re[0]===ce});if(me===-1){var je=[ce];je[ne]=_[re],R.push(je)}else R[me][ne]=_[re]})}}function Z(R,ne){return ne.length===0?R:R.map(function(P){var H=ne.findIndex(function(_){return _[0]===P[2]});if(H===-1)return P;var z=ne[H];return z[1]&&(P[4]=z[1]),z[3]&&(P[5]=z[3]),z[2]&&(P[6]=z[2]),P})}var oe=function R(ne,P,H,z,_,ce,re,me,je,Re,We,Ge,Ve,He){m(this,R),this.filterRegions=function(Ze,et){if(typeof Ze=="string"){var xt=Ze;return et.filter(function(Qe){return Qe.regions.some(function(Xe){return Xe===xt})})}return et.filter(function(Qe){return Ze.map(function(Xe){return Qe.regions.some(function(gt){return gt===Xe})}).some(function(Xe){return Xe})})},this.sortTerritories=function(Ze,et){var xt=[].concat(l(Ze),l(et));return xt.sort(function(Qe,Xe){return Qe.name<Xe.name?-1:Qe.name>Xe.name?1:0}),xt},this.getFilteredCountryList=function(Ze,et,xt){return Ze.length===0?et:xt?Ze.map(function(Qe){var Xe=et.find(function(gt){return gt.iso2===Qe});if(Xe)return Xe}).filter(function(Qe){return Qe}):et.filter(function(Qe){return Ze.some(function(Xe){return Xe===Qe.iso2})})},this.localizeCountries=function(Ze,et,xt){for(var Qe=0;Qe<Ze.length;Qe++)et[Ze[Qe].iso2]!==void 0?Ze[Qe].localName=et[Ze[Qe].iso2]:et[Ze[Qe].name]!==void 0&&(Ze[Qe].localName=et[Ze[Qe].name]);return xt||Ze.sort(function(Xe,gt){return Xe.localName<gt.localName?-1:Xe.localName>gt.localName?1:0}),Ze},this.getCustomAreas=function(Ze,et){for(var xt=[],Qe=0;Qe<et.length;Qe++){var Xe=JSON.parse(JSON.stringify(Ze));Xe.dialCode+=et[Qe],xt.push(Xe)}return xt},this.excludeCountries=function(Ze,et){return et.length===0?Ze:Ze.filter(function(xt){return!et.includes(xt.iso2)})};var ge=function(Ze,et,xt){var Qe=[];return F(Qe,1,Ze,!0),F(Qe,3,et),F(Qe,2,xt),Qe}(me,je,Re),Ce=Z(JSON.parse(JSON.stringify(G)),ge),_e=Z(JSON.parse(JSON.stringify(de)),ge),nt=te(W(Ce,ne,Ge,Ve,He),2),Ke=nt[0],rt=nt[1];if(P){var ot=te(W(_e,ne,Ge,Ve,He),2),At=ot[0];ot[1],Ke=this.sortTerritories(At,Ke)}H&&(Ke=this.filterRegions(H,Ke)),this.onlyCountries=this.localizeCountries(this.excludeCountries(this.getFilteredCountryList(z,Ke,re.includes("onlyCountries")),ce),We,re.includes("onlyCountries")),this.preferredCountries=_.length===0?[]:this.localizeCountries(this.getFilteredCountryList(_,Ke,re.includes("preferredCountries")),We,re.includes("preferredCountries")),this.hiddenAreaCodes=this.excludeCountries(this.getFilteredCountryList(z,rt),ce)},le=function(R){function ne(z){var _;m(this,ne),(_=function(ge,Ce){return!Ce||g(Ce)!=="object"&&typeof Ce!="function"?y(ge):Ce}(this,v(ne).call(this,z))).getProbableCandidate=O()(function(ge){return ge&&ge.length!==0?_.state.onlyCountries.filter(function(Ce){return U()(Ce.name.toLowerCase(),ge.toLowerCase())},y(y(_)))[0]:null}),_.guessSelectedCountry=O()(function(ge,Ce,_e,nt){var Ke;if(_.props.enableAreaCodes===!1&&(nt.some(function(At){if(U()(ge,At.dialCode))return _e.some(function(Ze){if(At.iso2===Ze.iso2&&Ze.mainCode)return Ke=Ze,!0}),!0}),Ke))return Ke;var rt=_e.find(function(At){return At.iso2==Ce});if(ge.trim()==="")return rt;var ot=_e.reduce(function(At,Ze){return U()(ge,Ze.dialCode)&&(Ze.dialCode.length>At.dialCode.length||Ze.dialCode.length===At.dialCode.length&&Ze.priority<At.priority)?Ze:At},{dialCode:"",priority:10001},y(y(_)));return ot.name?ot:rt}),_.updateCountry=function(ge){var Ce,_e=_.state.onlyCountries;(Ce=ge.indexOf(0)>="0"&&ge.indexOf(0)<="9"?_e.find(function(nt){return nt.dialCode==+ge}):_e.find(function(nt){return nt.iso2==ge}))&&Ce.dialCode&&_.setState({selectedCountry:Ce,formattedNumber:_.props.disableCountryCode?"":_.formatNumber(Ce.dialCode,Ce)})},_.scrollTo=function(ge,Ce){if(ge){var _e=_.dropdownRef;if(_e&&document.body){var nt=_e.offsetHeight,Ke=_e.getBoundingClientRect().top+document.body.scrollTop,rt=Ke+nt,ot=ge,At=ot.getBoundingClientRect(),Ze=ot.offsetHeight,et=At.top+document.body.scrollTop,xt=et+Ze,Qe=et-Ke+_e.scrollTop,Xe=nt/2-Ze/2;if(_.props.enableSearch?et<Ke+32:et<Ke)Ce&&(Qe-=Xe),_e.scrollTop=Qe;else if(xt>rt){Ce&&(Qe+=Xe);var gt=nt-Ze;_e.scrollTop=Qe-gt}}}},_.scrollToTop=function(){var ge=_.dropdownRef;ge&&document.body&&(ge.scrollTop=0)},_.formatNumber=function(ge,Ce){if(!Ce)return ge;var _e,nt=Ce.format,Ke=_.props,rt=Ke.disableCountryCode,ot=Ke.enableAreaCodeStretch,At=Ke.enableLongNumbers,Ze=Ke.autoFormat;if(rt?((_e=nt.split(" ")).shift(),_e=_e.join(" ")):ot&&Ce.isAreaCode?((_e=nt.split(" "))[1]=_e[1].replace(/\.+/,"".padEnd(Ce.areaCodeLength,".")),_e=_e.join(" ")):_e=nt,!ge||ge.length===0)return rt?"":_.props.prefix;if(ge&&ge.length<2||!_e||!Ze)return rt?ge:_.props.prefix+ge;var et,xt=q()(_e,function(Qe,Xe){if(Qe.remainingText.length===0)return Qe;if(Xe!==".")return{formattedText:Qe.formattedText+Xe,remainingText:Qe.remainingText};var gt,Ft=u(gt=Qe.remainingText)||s(gt)||h(),tr=Ft[0],Ut=Ft.slice(1);return{formattedText:Qe.formattedText+tr,remainingText:Ut}},{formattedText:"",remainingText:ge.split("")});return(et=At?xt.formattedText+xt.remainingText.join(""):xt.formattedText).includes("(")&&!et.includes(")")&&(et+=")"),et},_.cursorToEnd=function(){var ge=_.numberInputRef;if(document.activeElement===ge){ge.focus();var Ce=ge.value.length;ge.value.charAt(Ce-1)===")"&&(Ce-=1),ge.setSelectionRange(Ce,Ce)}},_.getElement=function(ge){return _["flag_no_".concat(ge)]},_.getCountryData=function(){return _.state.selectedCountry?{name:_.state.selectedCountry.name||"",dialCode:_.state.selectedCountry.dialCode||"",countryCode:_.state.selectedCountry.iso2||"",format:_.state.selectedCountry.format||""}:{}},_.handleFlagDropdownClick=function(ge){if(ge.preventDefault(),_.state.showDropdown||!_.props.disabled){var Ce=_.state,_e=Ce.preferredCountries,nt=Ce.onlyCountries,Ke=Ce.selectedCountry,rt=_.concatPreferredCountries(_e,nt).findIndex(function(ot){return ot.dialCode===Ke.dialCode&&ot.iso2===Ke.iso2});_.setState({showDropdown:!_.state.showDropdown,highlightCountryIndex:rt},function(){_.state.showDropdown&&_.scrollTo(_.getElement(_.state.highlightCountryIndex))})}},_.handleInput=function(ge){var Ce=ge.target.value,_e=_.props,nt=_e.prefix,Ke=_e.onChange,rt=_.props.disableCountryCode?"":nt,ot=_.state.selectedCountry,At=_.state.freezeSelection;if(!_.props.countryCodeEditable){var Ze=nt+(ot.hasAreaCodes?_.state.onlyCountries.find(function(It){return It.iso2===ot.iso2&&It.mainCode}).dialCode:ot.dialCode);if(Ce.slice(0,Ze.length)!==Ze)return}if(Ce===nt)return Ke&&Ke("",_.getCountryData(),ge,""),_.setState({formattedNumber:""});if(!(Ce.replace(/\D/g,"").length>15&&(_.props.enableLongNumbers===!1||typeof _.props.enableLongNumbers=="number"&&Ce.replace(/\D/g,"").length>_.props.enableLongNumbers))&&Ce!==_.state.formattedNumber){ge.preventDefault?ge.preventDefault():ge.returnValue=!1;var et=_.props.country,xt=_.state,Qe=xt.onlyCountries,Xe=xt.selectedCountry,gt=xt.hiddenAreaCodes;if(Ke&&ge.persist(),Ce.length>0){var Ft=Ce.replace(/\D/g,"");(!_.state.freezeSelection||Xe&&Xe.dialCode.length>Ft.length)&&(ot=_.props.disableCountryGuess?Xe:_.guessSelectedCountry(Ft.substring(0,6),et,Qe,gt)||Xe,At=!1),rt=_.formatNumber(Ft,ot),ot=ot.dialCode?ot:Xe}var tr=ge.target.selectionStart,Ut=ge.target.selectionStart,Qr=_.state.formattedNumber,Zr=rt.length-Qr.length;_.setState({formattedNumber:rt,freezeSelection:At,selectedCountry:ot},function(){Zr>0&&(Ut-=Zr),rt.charAt(rt.length-1)==")"?_.numberInputRef.setSelectionRange(rt.length-1,rt.length-1):Ut>0&&Qr.length>=rt.length?_.numberInputRef.setSelectionRange(Ut,Ut):tr<Qr.length&&_.numberInputRef.setSelectionRange(tr,tr),Ke&&Ke(rt.replace(/[^0-9]+/g,""),_.getCountryData(),ge,rt)})}},_.handleInputClick=function(ge){_.setState({showDropdown:!1}),_.props.onClick&&_.props.onClick(ge,_.getCountryData())},_.handleDoubleClick=function(ge){var Ce=ge.target.value.length;ge.target.setSelectionRange(0,Ce)},_.handleFlagItemClick=function(ge,Ce){var _e=_.state.selectedCountry,nt=_.state.onlyCountries.find(function(At){return At==ge});if(nt){var Ke=_.state.formattedNumber.replace(" ","").replace("(","").replace(")","").replace("-",""),rt=Ke.length>1?Ke.replace(_e.dialCode,nt.dialCode):nt.dialCode,ot=_.formatNumber(rt.replace(/\D/g,""),nt);_.setState({showDropdown:!1,selectedCountry:nt,freezeSelection:!0,formattedNumber:ot,searchValue:""},function(){_.cursorToEnd(),_.props.onChange&&_.props.onChange(ot.replace(/[^0-9]+/g,""),_.getCountryData(),Ce,ot)})}},_.handleInputFocus=function(ge){_.numberInputRef&&_.numberInputRef.value===_.props.prefix&&_.state.selectedCountry&&!_.props.disableCountryCode&&_.setState({formattedNumber:_.props.prefix+_.state.selectedCountry.dialCode},function(){_.props.jumpCursorToEnd&&setTimeout(_.cursorToEnd,0)}),_.setState({placeholder:""}),_.props.onFocus&&_.props.onFocus(ge,_.getCountryData()),_.props.jumpCursorToEnd&&setTimeout(_.cursorToEnd,0)},_.handleInputBlur=function(ge){ge.target.value||_.setState({placeholder:_.props.placeholder}),_.props.onBlur&&_.props.onBlur(ge,_.getCountryData())},_.handleInputCopy=function(ge){if(_.props.copyNumbersOnly){var Ce=window.getSelection().toString().replace(/[^0-9]+/g,"");ge.clipboardData.setData("text/plain",Ce),ge.preventDefault()}},_.getHighlightCountryIndex=function(ge){var Ce=_.state.highlightCountryIndex+ge;return Ce<0||Ce>=_.state.onlyCountries.length+_.state.preferredCountries.length?Ce-ge:_.props.enableSearch&&Ce>_.getSearchFilteredCountries().length?0:Ce},_.searchCountry=function(){var ge=_.getProbableCandidate(_.state.queryString)||_.state.onlyCountries[0],Ce=_.state.onlyCountries.findIndex(function(_e){return _e==ge})+_.state.preferredCountries.length;_.scrollTo(_.getElement(Ce),!0),_.setState({queryString:"",highlightCountryIndex:Ce})},_.handleKeydown=function(ge){var Ce=_.props.keys,_e=ge.target.className;if(_e.includes("selected-flag")&&ge.which===Ce.ENTER&&!_.state.showDropdown)return _.handleFlagDropdownClick(ge);if(_e.includes("form-control")&&(ge.which===Ce.ENTER||ge.which===Ce.ESC))return ge.target.blur();if(_.state.showDropdown&&!_.props.disabled&&(!_e.includes("search-box")||ge.which===Ce.UP||ge.which===Ce.DOWN||ge.which===Ce.ENTER||ge.which===Ce.ESC&&ge.target.value==="")){ge.preventDefault?ge.preventDefault():ge.returnValue=!1;var nt=function(Ke){_.setState({highlightCountryIndex:_.getHighlightCountryIndex(Ke)},function(){_.scrollTo(_.getElement(_.state.highlightCountryIndex),!0)})};switch(ge.which){case Ce.DOWN:nt(1);break;case Ce.UP:nt(-1);break;case Ce.ENTER:_.props.enableSearch?_.handleFlagItemClick(_.getSearchFilteredCountries()[_.state.highlightCountryIndex]||_.getSearchFilteredCountries()[0],ge):_.handleFlagItemClick([].concat(l(_.state.preferredCountries),l(_.state.onlyCountries))[_.state.highlightCountryIndex],ge);break;case Ce.ESC:case Ce.TAB:_.setState({showDropdown:!1},_.cursorToEnd);break;default:(ge.which>=Ce.A&&ge.which<=Ce.Z||ge.which===Ce.SPACE)&&_.setState({queryString:_.state.queryString+String.fromCharCode(ge.which)},_.state.debouncedQueryStingSearcher)}}},_.handleInputKeyDown=function(ge){var Ce=_.props,_e=Ce.keys,nt=Ce.onEnterKeyPress,Ke=Ce.onKeyDown;ge.which===_e.ENTER&&nt&&nt(ge),Ke&&Ke(ge)},_.handleClickOutside=function(ge){_.dropdownRef&&!_.dropdownContainerRef.contains(ge.target)&&_.state.showDropdown&&_.setState({showDropdown:!1})},_.handleSearchChange=function(ge){var Ce=ge.currentTarget.value,_e=_.state,nt=_e.preferredCountries,Ke=_e.selectedCountry,rt=0;if(Ce===""&&Ke){var ot=_.state.onlyCountries;rt=_.concatPreferredCountries(nt,ot).findIndex(function(At){return At==Ke}),setTimeout(function(){return _.scrollTo(_.getElement(rt))},100)}_.setState({searchValue:Ce,highlightCountryIndex:rt})},_.concatPreferredCountries=function(ge,Ce){return ge.length>0?l(new Set(ge.concat(Ce))):Ce},_.getDropdownCountryName=function(ge){return ge.localName||ge.name},_.getSearchFilteredCountries=function(){var ge=_.state,Ce=ge.preferredCountries,_e=ge.onlyCountries,nt=ge.searchValue,Ke=_.props.enableSearch,rt=_.concatPreferredCountries(Ce,_e),ot=nt.trim().toLowerCase().replace("+","");if(Ke&&ot){if(/^\d+$/.test(ot))return rt.filter(function(et){var xt=et.dialCode;return["".concat(xt)].some(function(Qe){return Qe.toLowerCase().includes(ot)})});var At=rt.filter(function(et){var xt=et.iso2;return["".concat(xt)].some(function(Qe){return Qe.toLowerCase().includes(ot)})}),Ze=rt.filter(function(et){var xt=et.name,Qe=et.localName;return et.iso2,["".concat(xt),"".concat(Qe||"")].some(function(Xe){return Xe.toLowerCase().includes(ot)})});return _.scrollToTop(),l(new Set([].concat(At,Ze)))}return rt},_.getCountryDropdownList=function(){var ge=_.state,Ce=ge.preferredCountries,_e=ge.highlightCountryIndex,nt=ge.showDropdown,Ke=ge.searchValue,rt=_.props,ot=rt.disableDropdown,At=rt.prefix,Ze=_.props,et=Ze.enableSearch,xt=Ze.searchNotFound,Qe=Ze.disableSearchIcon,Xe=Ze.searchClass,gt=Ze.searchStyle,Ft=Ze.searchPlaceholder,tr=Ze.autocompleteSearch,Ut=_.getSearchFilteredCountries().map(function(It,Lr){var dn=_e===Lr,Er=ie()({country:!0,preferred:It.iso2==="us"||It.iso2==="gb",active:It.iso2==="us",highlight:dn}),Un="flag ".concat(It.iso2);return w.a.createElement("li",Object.assign({ref:function(I){return _["flag_no_".concat(Lr)]=I},key:"flag_no_".concat(Lr),"data-flag-key":"flag_no_".concat(Lr),className:Er,"data-dial-code":"1",tabIndex:ot?"-1":"0","data-country-code":It.iso2,onClick:function(I){return _.handleFlagItemClick(It,I)},role:"option"},dn?{"aria-selected":!0}:{}),w.a.createElement("div",{className:Un}),w.a.createElement("span",{className:"country-name"},_.getDropdownCountryName(It)),w.a.createElement("span",{className:"dial-code"},It.format?_.formatNumber(It.dialCode,It):At+It.dialCode))}),Qr=w.a.createElement("li",{key:"dashes",className:"divider"});Ce.length>0&&(!et||et&&!Ke.trim())&&Ut.splice(Ce.length,0,Qr);var Zr=ie()(n({"country-list":!0,hide:!nt},_.props.dropdownClass,!0));return w.a.createElement("ul",{ref:function(It){return!et&&It&&It.focus(),_.dropdownRef=It},className:Zr,style:_.props.dropdownStyle,role:"listbox",tabIndex:"0"},et&&w.a.createElement("li",{className:ie()(n({search:!0},Xe,Xe))},!Qe&&w.a.createElement("span",{className:ie()(n({"search-emoji":!0},"".concat(Xe,"-emoji"),Xe)),role:"img","aria-label":"Magnifying glass"},""),w.a.createElement("input",{className:ie()(n({"search-box":!0},"".concat(Xe,"-box"),Xe)),style:gt,type:"search",placeholder:Ft,autoFocus:!0,autoComplete:tr?"on":"off",value:Ke,onChange:_.handleSearchChange})),Ut.length>0?Ut:w.a.createElement("li",{className:"no-entries-message"},w.a.createElement("span",null,xt)))};var ce,re=new oe(z.enableAreaCodes,z.enableTerritories,z.regions,z.onlyCountries,z.preferredCountries,z.excludeCountries,z.preserveOrder,z.masks,z.priority,z.areaCodes,z.localization,z.prefix,z.defaultMask,z.alwaysDefaultMask),me=re.onlyCountries,je=re.preferredCountries,Re=re.hiddenAreaCodes,We=z.value?z.value.replace(/\D/g,""):"";ce=z.disableInitialCountryGuess?0:We.length>1?_.guessSelectedCountry(We.substring(0,6),z.country,me,Re)||0:z.country&&me.find(function(ge){return ge.iso2==z.country})||0;var Ge,Ve=We.length<2&&ce&&!U()(We,ce.dialCode)?ce.dialCode:"";Ge=We===""&&ce===0?"":_.formatNumber((z.disableCountryCode?"":Ve)+We,ce.name?ce:void 0);var He=me.findIndex(function(ge){return ge==ce});return _.state={showDropdown:z.showDropdown,formattedNumber:Ge,onlyCountries:me,preferredCountries:je,hiddenAreaCodes:Re,selectedCountry:ce,highlightCountryIndex:He,queryString:"",freezeSelection:!1,debouncedQueryStingSearcher:C()(_.searchCountry,250),searchValue:""},_}var P,H;return function(z,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function");z.prototype=Object.create(_&&_.prototype,{constructor:{value:z,writable:!0,configurable:!0}}),_&&S(z,_)}(ne,R),P=ne,(H=[{key:"componentDidMount",value:function(){document.addEventListener&&this.props.enableClickOutside&&document.addEventListener("mousedown",this.handleClickOutside),this.props.onMount&&this.props.onMount(this.state.formattedNumber.replace(/[^0-9]+/g,""),this.getCountryData(),this.state.formattedNumber)}},{key:"componentWillUnmount",value:function(){document.removeEventListener&&this.props.enableClickOutside&&document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"componentDidUpdate",value:function(z,_,ce){z.country!==this.props.country?this.updateCountry(this.props.country):z.value!==this.props.value&&this.updateFormattedNumber(this.props.value)}},{key:"updateFormattedNumber",value:function(z){if(z===null)return this.setState({selectedCountry:0,formattedNumber:""});var _=this.state,ce=_.onlyCountries,re=_.selectedCountry,me=_.hiddenAreaCodes,je=this.props,Re=je.country,We=je.prefix;if(z==="")return this.setState({selectedCountry:re,formattedNumber:""});var Ge,Ve,He=z.replace(/\D/g,"");if(re&&U()(z,We+re.dialCode))Ve=this.formatNumber(He,re),this.setState({formattedNumber:Ve});else{var ge=(Ge=this.props.disableCountryGuess?re:this.guessSelectedCountry(He.substring(0,6),Re,ce,me)||re)&&U()(He,We+Ge.dialCode)?Ge.dialCode:"";Ve=this.formatNumber((this.props.disableCountryCode?"":ge)+He,Ge||void 0),this.setState({selectedCountry:Ge,formattedNumber:Ve})}}},{key:"render",value:function(){var z,_,ce,re=this,me=this.state,je=me.onlyCountries,Re=me.selectedCountry,We=me.showDropdown,Ge=me.formattedNumber,Ve=me.hiddenAreaCodes,He=this.props,ge=He.disableDropdown,Ce=He.renderStringAsFlag,_e=He.isValid,nt=He.defaultErrorMessage,Ke=He.specialLabel;if(typeof _e=="boolean")_=_e;else{var rt=_e(Ge.replace(/\D/g,""),Re,je,Ve);typeof rt=="boolean"?(_=rt)===!1&&(ce=nt):(_=!1,ce=rt)}var ot=ie()((n(z={},this.props.containerClass,!0),n(z,"react-tel-input",!0),z)),At=ie()({arrow:!0,up:We}),Ze=ie()(n({"form-control":!0,"invalid-number":!_,open:We},this.props.inputClass,!0)),et=ie()({"selected-flag":!0,open:We}),xt=ie()(n({"flag-dropdown":!0,"invalid-number":!_,open:We},this.props.buttonClass,!0)),Qe="flag ".concat(Re&&Re.iso2);return w.a.createElement("div",{className:"".concat(ot," ").concat(this.props.className),style:this.props.style||this.props.containerStyle,onKeyDown:this.handleKeydown},Ke&&w.a.createElement("div",{className:"special-label"},Ke),ce&&w.a.createElement("div",{className:"invalid-number-message"},ce),w.a.createElement("input",Object.assign({className:Ze,style:this.props.inputStyle,onChange:this.handleInput,onClick:this.handleInputClick,onDoubleClick:this.handleDoubleClick,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,onCopy:this.handleInputCopy,value:Ge,onKeyDown:this.handleInputKeyDown,placeholder:this.props.placeholder,disabled:this.props.disabled,type:"tel"},this.props.inputProps,{ref:function(Xe){re.numberInputRef=Xe,typeof re.props.inputProps.ref=="function"?re.props.inputProps.ref(Xe):typeof re.props.inputProps.ref=="object"&&(re.props.inputProps.ref.current=Xe)}})),w.a.createElement("div",{className:xt,style:this.props.buttonStyle,ref:function(Xe){return re.dropdownContainerRef=Xe}},Ce?w.a.createElement("div",{className:et},Ce):w.a.createElement("div",{onClick:ge?void 0:this.handleFlagDropdownClick,className:et,title:Re?"".concat(Re.localName||Re.name,": + ").concat(Re.dialCode):"",tabIndex:ge?"-1":"0",role:"button","aria-haspopup":"listbox","aria-expanded":!!We||void 0},w.a.createElement("div",{className:Qe},!ge&&w.a.createElement("div",{className:At}))),We&&this.getCountryDropdownList()))}}])&&f(P.prototype,H),ne}(w.a.Component);le.defaultProps={country:"",value:"",onlyCountries:[],preferredCountries:[],excludeCountries:[],placeholder:"1 (702) 123-4567",searchPlaceholder:"search",searchNotFound:"No entries to show",flagsImagePath:"./flags.png",disabled:!1,containerStyle:{},inputStyle:{},buttonStyle:{},dropdownStyle:{},searchStyle:{},containerClass:"",inputClass:"",buttonClass:"",dropdownClass:"",searchClass:"",className:"",autoFormat:!0,enableAreaCodes:!1,enableTerritories:!1,disableCountryCode:!1,disableDropdown:!1,enableLongNumbers:!1,countryCodeEditable:!0,enableSearch:!1,disableSearchIcon:!1,disableInitialCountryGuess:!1,disableCountryGuess:!1,regions:"",inputProps:{},localization:{},masks:null,priority:null,areaCodes:null,preserveOrder:[],defaultMask:"... ... ... ... ..",alwaysDefaultMask:!1,prefix:"+",copyNumbersOnly:!0,renderStringAsFlag:"",autocompleteSearch:!1,jumpCursorToEnd:!0,enableAreaCodeStretch:!1,enableClickOutside:!0,showDropdown:!1,isValid:!0,defaultErrorMessage:"",specialLabel:"Phone",onEnterKeyPress:null,keys:{UP:38,DOWN:40,RIGHT:39,LEFT:37,ENTER:13,ESC:27,PLUS:43,A:65,Z:90,SPACE:32,TAB:9}},t.default=le}])),lm}var B6=P6();const U6=bp(B6),I6=()=>{var Un;const e={container:{width:"100%"},inputStyle:{width:"100%",height:"42px",padding:"8px 8px 8px 50px",borderRadius:"0.375rem",fontSize:"0.875rem",borderColor:"#D1D5DB"},buttonStyle:{borderTopLeftRadius:"0.375rem",borderBottomLeftRadius:"0.375rem",borderColor:"#D1D5DB"},dropdownStyle:{width:"300px"}},{user:t}=Tr(),[r,n]=k.useState([]),[s,l]=k.useState([]),[u,h]=k.useState(!0),[m,f]=k.useState(null),[p,g]=k.useState(null),[y,v]=k.useState({}),[S,N]=k.useState(!1),[w,E]=k.useState({leadId:"",amount:0,token:0,pending:0,product:"",status:"Pending",isReference:!1,customerName:"",email:"",contactNumber:"",country:"",leadPerson:"",countryCode:"+1",loginId:"",password:"",leadBy:"",saleDate:new Date,currency:"USD"}),[C,T]=k.useState([]),[O,j]=k.useState([]),[q,D]=k.useState(!1),[U,K]=k.useState([]),[ie,te]=k.useState(!1),[G,de]=k.useState(new Date().getMonth()+1),[J,W]=k.useState(new Date().getFullYear()),[F,Z]=k.useState(!0),oe=[{value:"USD",label:"USD ($)",symbol:"$"},{value:"EUR",label:"EUR ()",symbol:""},{value:"GBP",label:"GBP ()",symbol:""},{value:"INR",label:"INR ()",symbol:""},{value:"CAD",label:"CAD ($)",symbol:"$"},{value:"AUD",label:"AUD ($)",symbol:"$"},{value:"JPY",label:"JPY ()",symbol:""},{value:"CNY",label:"CNY ()",symbol:""}],le=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],R=new Date().getFullYear(),ne=Array.from({length:6},(I,Se)=>R-Se),P=["Pending","Completed","Cancelled"],[H,z]=k.useState(null),[_,ce]=k.useState(!1);k.useEffect(()=>{me()},[t]),k.useEffect(()=>{r.length>0&&re()},[r,G,J,F]),k.useEffect(()=>{w.isReference&&U.length===0&&Re()},[w.isReference]);const re=()=>{if(F){const I=new Date().getMonth()+1,Se=new Date().getFullYear(),Ue=r.filter(Ie=>{if(!Ie.date&&!Ie.createdAt)return console.log("Sale has no date:",Ie),!1;const st=new Date(Ie.date||Ie.createdAt),lt=st.getMonth()+1,yt=st.getFullYear();return lt===I&&yt===Se});console.log(`Filtered to current month: ${I}/${Se}. Found ${Ue.length} sales.`),l(Ue)}else{const I=r.filter(Se=>{if(!Se.date&&!Se.createdAt)return console.log("Sale has no date:",Se),!1;const Ue=new Date(Se.date||Se.createdAt),Ie=Ue.getMonth()+1,st=Ue.getFullYear();return console.log(`Sale date: ${Ue.toISOString()}, Month: ${Ie}, Year: ${st}, Filter: ${G}/${J}`),Ie===G&&st===J});console.log(`Filtered to ${G}/${J}. Found ${I.length} sales.`),l(I)}},me=async()=>{var I,Se;try{h(!0),console.log("Fetching sales for user:",t==null?void 0:t.fullName,t==null?void 0:t.role),localStorage.getItem("token")||console.warn("No token found when fetching sales");const Ie=await Wn.getAll();if(Ie.data&&Ie.data.success){console.log("Sales data fetched:",Ie.data.data.length,"sales");const st=Ie.data.data.map(lt=>({...lt,_id:lt._id,salesPerson:typeof lt.salesPerson=="object"&&lt.salesPerson._id||lt.salesPerson,amount:parseFloat(lt.totalCost||0),token:parseFloat(lt.tokenAmount||0),pending:lt.status==="Completed"?0:parseFloat(lt.totalCost||0)-parseFloat(lt.tokenAmount||0),product:lt.course||lt.product||"Unknown",status:lt.status||"Pending",loginId:lt.loginId||"",password:lt.password||"",leadBy:lt.leadBy||"",currency:lt.currency||"USD"}));st.length>0&&console.log("Sample sale data:",st[0]),n(st),setTimeout(()=>{re()},0)}else console.error("Failed to load sales data:",((I=Ie.data)==null?void 0:I.message)||"Unknown error"),f("Failed to load sales data: "+(((Se=Ie.data)==null?void 0:Se.message)||"Unknown error"))}catch(Ue){console.error("Error fetching sales:",Ue),Ue.response&&(console.error("Error details:",Ue.response.data),console.error("Error status:",Ue.response.status)),f("Failed to load sales data. Please try again.")}finally{h(!1)}},je=async()=>{try{D(!0);let I=[];if(t.role==="Sales Person"){const Ue=await Fn.getAssigned();Ue.data.success&&(I=Ue.data.data.filter(Ie=>Ie.status!=="Converted"))}else{const Ue=await Fn.getAll();Ue.data.success&&(I=Ue.data.data.filter(Ie=>Ie.status!=="Converted"))}T(I);const Se=I.map(Ue=>({value:Ue._id,label:`${Ue.name} - ${Ue.course} (${Ue.status})`,data:Ue}));j(Se)}catch(I){console.error("Error fetching leads:",I),f("Failed to load leads. Please try again.")}finally{D(!1)}},Re=async()=>{try{te(!0);const I=await fr.getUsers("Lead Person");if(I.data.success){const Se=I.data.data.map(Ue=>({value:Ue._id,label:Ue.fullName||Ue.email}));K(Se)}}catch(I){console.error("Error fetching lead persons:",I)}finally{te(!1)}},We=()=>{je(),Re(),N(!0),E({leadId:"",amount:0,token:0,pending:0,product:"",status:"Pending",isReference:!1,customerName:"",email:"",contactNumber:"",country:"",leadPerson:"",countryCode:"+1",loginId:"",password:"",leadBy:"",saleDate:new Date,currency:"USD"})},Ge=I=>{const Se=I.target.value,Ue=C.find(Ie=>Ie._id===Se);Ue&&(console.log("Selected lead:",Ue),E(Ie=>({...Ie,leadId:Se,product:Ue.course||Ue.COURSE||"",_selectedLead:Ue})))},Ve=(I,Se)=>{E(Ue=>{const Ie={...Ue,[I]:Se};if(I==="amount"||I==="token"){const st=parseFloat(I==="amount"?Se:Ue.amount),lt=parseFloat(I==="token"?Se:Ue.token);Ie.pending=st-lt}return I==="status"&&Se==="Completed"&&(Ie.pending=0),Ie})},He=I=>{E(Se=>({...Se,isReference:I,leadId:I?"":Se.leadId})),I&&U.length===0&&Re()},ge=async I=>{var Se,Ue,Ie;I.preventDefault();try{if(w.isReference){if(!w.customerName){f("Please enter customer name");return}if(!w.contactNumber){f("Please enter contact number");return}if(!w.product){f("Please enter a product/course name");return}if(!w.country){f("Please enter country");return}if(!w.leadPerson){f("Please select a lead person who will see this sale");return}}else{if(!w.leadId){f("Please select a lead");return}if(!w.product){f("Please enter a product/course name");return}if(!w.leadPerson){f("Please select a lead person who will see this sale");return}}if(!localStorage.getItem("token")){f("Authentication required. Please log in again.");return}let lt;if(w.isReference)lt={customerName:w.customerName,country:w.country,course:w.product,countryCode:w.countryCode||"+1",contactNumber:w.contactNumber,email:w.email||"",salesPerson:t._id,leadPerson:w.leadPerson,loginId:w.loginId||"",password:w.password||"",leadBy:w.leadBy||"",source:"Reference",isReference:!0,totalCost:parseFloat(w.amount)||0,tokenAmount:parseFloat(w.token)||0,currency:w.currency||"USD",pending:w.status==="Completed"?!1:parseFloat(w.pending)>0,status:w.status||"Pending",createdBy:t._id,date:w.saleDate||new Date,isLeadPersonSale:!0};else{const Ye=w._selectedLead||C.find(Yr=>Yr._id===w.leadId);if(!Ye){f("Lead information not found. Please select a lead again.");return}console.log("Using lead data for sale:",Ye),lt={customerName:Ye.name||Ye.NAME||Ye.customerName||"Unknown",country:Ye.country||Ye.COUNTRY||"Unknown",course:w.product,countryCode:Ye.countryCode||Ye.CODE||"+1",contactNumber:Ye.phone||Ye.contactNumber||Ye.NUMBER||Ye.MOBILE||"0000000000",email:Ye.email||Ye["E-MAIL"]||Ye.EMAIL||"",salesPerson:t._id,leadPerson:w.leadPerson,loginId:w.loginId||"",password:w.password||"",leadBy:w.leadBy||"",source:Ye.source||Ye.SOURSE||"",clientRemark:Ye.client||Ye["CLIENT REMARK"]||"",totalCost:parseFloat(w.amount)||0,tokenAmount:parseFloat(w.token)||0,currency:w.currency||"USD",pending:w.status==="Completed"?!1:parseFloat(w.pending)>0,status:w.status||"Pending",createdBy:t._id,date:w.saleDate||new Date,isLeadPersonSale:!0}}console.log("Submitting new sale with matching schema:",lt);const yt=await Wn.create({...lt,isLeadPersonSale:!0});yt.data&&yt.data.success?(console.log("Sale created successfully:",yt.data.data),n(Ye=>[yt.data.data,...Ye]),N(!1),E({leadId:"",amount:0,token:0,pending:0,product:"",status:"Pending",isReference:!1,customerName:"",email:"",contactNumber:"",country:"",leadPerson:"",countryCode:"+1",loginId:"",password:"",leadBy:"",saleDate:new Date,currency:"USD"}),ze.success("Sale added successfully!"),tr()):f(((Se=yt.data)==null?void 0:Se.message)||"Failed to add sale")}catch(st){if(console.error("Error adding sale:",st),st.response)if(console.error("Sale creation error details:",st.response.data),st.response.status===400){const lt=((Ue=st.response.data)==null?void 0:Ue.message)||"Invalid data";lt.includes("enum value for path `status`")?ze.error(`Invalid status value. Allowed values are: ${P.join(", ")}`):ze.error(`Bad request: ${lt}`)}else st.response.status===401?f("Authentication failed. Please log in again."):f(`Failed to add sale: ${((Ie=st.response.data)==null?void 0:Ie.message)||st.message}`);else f("Network error while adding sale")}},Ce=(I,Se)=>I?(console.log(`Extracting ID for field ${Se}:`,I[Se]),typeof I[Se]=="string"?I[Se]:I[Se]&&I[Se]._id?typeof I[Se]._id=="object"&&I[Se]._id.toString?I[Se]._id.toString():I[Se]._id:I[Se]&&typeof I[Se].id=="string"?I[Se].id:I[Se]&&typeof I[Se]=="object"&&I[Se].toString?I[Se].toString():null):null,_e=I=>{if(!I){console.error("Attempted to edit undefined sale");return}g(I._id);const Se=parseFloat(I.amount||I.totalCost||0),Ue=parseFloat(I.token||I.tokenAmount||0),Ie=parseFloat(I.pending||Se-Ue||0);v({amount:Se,token:Ue,pending:Ie,status:I.status||"Pending",product:I.product||I.course||"",saleDate:I.date||new Date,loginId:I.loginId||"",password:I.password||"",leadBy:I.leadBy||"",currency:I.currency||"USD"}),console.log("Edit values initialized:",{amount:Se,token:Ue,pending:Ie,status:I.status||"Pending",saleDate:I.date||new Date,currency:I.currency||"USD"})},nt=async I=>{var Se,Ue,Ie,st,lt,yt;try{const Ye=r.find(Lt=>Lt._id===I);if(!Ye){f("Sale not found");return}if(!localStorage.getItem("token")){f("Authentication required. Please log in again.");return}if(t.role==="Sales Person"){const Lt=Ce(Ye,"salesPerson"),Br=t._id;if(Lt&&Br&&Lt.toString()===Br.toString()){console.log("Sales Person updating their own sale");const Es=Ce(Ye,"salesPerson")||t._id,M=Ce(Ye,"leadPerson"),X={customerName:Ye.customerName,country:Ye.country,course:Ye.course||y.product||"Unknown Course",countryCode:Ye.countryCode,contactNumber:Ye.contactNumber,email:Ye.email,date:y.saleDate||Ye.date||new Date,salesPerson:Es,leadPerson:M,leadBy:y.leadBy||Ye.leadBy||"",loginId:y.loginId||Ye.loginId||"",password:y.password||Ye.password||"",source:Ye.source,clientRemark:Ye.clientRemark,totalCost:parseFloat(y.amount)||0,tokenAmount:parseFloat(y.token)||0,currency:y.currency||Ye.currency||"USD",pending:y.status==="Completed"?!1:parseFloat(y.pending)>0,status:y.status||Ye.status||"Pending",isReference:Ye.isReference||!1,updatedBy:t._id,updatedAt:new Date};console.log("Updating sale with full data:",X);const V=await Wn.update(I,X);V.data&&V.data.success?(n(r.map(Y=>Y._id===I?V.data.data:Y)),ze.success("Sale updated successfully"),g(null),tr()):f("Failed to update sale: "+(((Se=V.data)==null?void 0:Se.message)||"Server error"));return}else{f("You don't have permission to update this sale");return}}const Jr=Ce(Ye,"salesPerson")||t._id,Pr=Ce(Ye,"leadPerson");if(!Pr){f("Lead person ID is missing, cannot update sale");return}const fn={customerName:Ye.customerName,country:Ye.country,course:Ye.course||y.product||"Unknown Course",countryCode:Ye.countryCode,contactNumber:Ye.contactNumber,email:Ye.email,date:y.saleDate||Ye.date||new Date,salesPerson:Jr,leadPerson:Pr,leadBy:y.leadBy||Ye.leadBy||"",loginId:y.loginId||Ye.loginId||"",password:y.password||Ye.password||"",source:Ye.source,clientRemark:Ye.clientRemark,totalCost:parseFloat(y.amount)||0,tokenAmount:parseFloat(y.token)||0,currency:y.currency||Ye.currency||"USD",pending:y.status==="Completed"?!1:parseFloat(y.pending)>0,status:y.status||Ye.status||"Pending",isReference:Ye.isReference||!1,updatedBy:t._id,updatedAt:new Date};console.log("Updating sale with schema data:",fn);const ar=await Wn.update(I,fn);console.log("Update response:",ar),ar.data&&ar.data.success?(n(r.map(Lt=>Lt._id===I?ar.data.data:Lt)),ze.success("Sale updated successfully"),g(null),tr()):f("Failed to update sale: "+(((Ue=ar.data)==null?void 0:Ue.message)||"Server error"))}catch(Ye){if(console.error("Error updating sale:",Ye),Ye.response)if(console.error("Error details:",Ye.response.data),Ye.response.status===403)t.role==="Sales Person"&&((st=(Ie=Ye.response.data)==null?void 0:Ie.message)!=null&&st.includes("can only update the status field"))?f("As a Sales Person, you can only update the status field"):f("You don't have permission to update this sale. Only the creator or an admin can update it.");else if(Ye.response.status===401)f("Your session has expired. Please log in again.");else if(Ye.response.status===400){const Yr=((lt=Ye.response.data)==null?void 0:lt.message)||"Invalid data";Yr.includes("enum value for path `status`")?ze.error(`Invalid status value. Allowed values are: ${P.join(", ")}`):ze.error(`Bad request: ${Yr}`)}else f(`Failed to update sale: ${((yt=Ye.response.data)==null?void 0:yt.message)||Ye.message}`);else f("Network error while updating sale")}},Ke=(I,Se)=>{v(Ue=>{const Ie={...Ue,[I]:Se};if(I==="amount"||I==="token"){const st=parseFloat(I==="amount"?Se:Ue.amount)||0,lt=parseFloat(I==="token"?Se:Ue.token)||0;Ie.pending=st-lt}return I==="status"&&Se==="Completed"&&(Ie.pending=0),Ie})},rt=I=>{if(!I||!t)return!1;const Se=Ce(I,"salesPerson"),Ue=t._id;if(console.log("Checking edit permission:",{salesPersonId:Se,userId:Ue,role:t.role,userIdType:typeof Ue,salesPersonIdType:typeof Se,compareResult:Se&&Ue&&Se.toString()===Ue.toString()}),t.role==="Sales Person")return Se&&Ue&&Se.toString()===Ue.toString();if(t.role==="Lead Person"){const Ie=Ce(I,"leadPerson");return Ie&&Ue&&Ie.toString()===Ue.toString()}return["Admin","Manager"].includes(t.role)},ot=I=>{if(!I||!t)return!1;const Se=Ce(I,"salesPerson"),Ue=t._id;return console.log("Checking delete permission:",{salesPersonId:Se,userId:Ue,role:t.role,userIdType:typeof Ue,salesPersonIdType:typeof Se,compareResult:Se&&Ue&&Se.toString()===Ue.toString()}),t.role==="Sales Person"?Se&&Ue&&Se.toString()===Ue.toString():["Admin","Manager"].includes(t.role)},At=async I=>{var Se,Ue;try{z(I);const Ie=r.find(lt=>lt._id===I);if(!Ie){ze.error("Sale not found");return}console.log("Sale being deleted:",Ie);const st=await Wn.delete(I);console.log("Delete response:",st),st.data&&st.data.success?(n(lt=>lt.filter(yt=>yt._id!==I)),ze.success("Sale deleted successfully!"),me()):ze.error(((Se=st.data)==null?void 0:Se.message)||"Failed to delete sale")}catch(Ie){console.error("Error deleting sale:",Ie),Ie.response?(console.error("Delete error details:",Ie.response.data),Ie.response.status===403?ze.error("You don't have permission to delete this sale. Only the creator or an admin can delete it."):Ie.response.status===401?ze.error("Your session has expired. Please log in again."):ze.error(((Ue=Ie.response.data)==null?void 0:Ue.message)||"Server error while deleting sale")):ze.error("Network error while deleting sale")}finally{z(null),ce(!1)}},Ze=I=>new Date(I).toLocaleDateString(),et=I=>{de(parseInt(I.target.value)),Z(!1)},xt=I=>{W(parseInt(I.target.value)),Z(!1)},Qe=()=>{const I=new Date;de(I.getMonth()+1),W(I.getFullYear()),Z(!0)},Xe=async(I,Se)=>{var Ue,Ie,st,lt;try{const yt=r.find(Jr=>Jr._id===I);if(!yt)return;if(console.log("Trying to update status:",{saleId:I,newStatus:Se,userRole:t.role,userId:t._id,canEdit:rt(yt)}),!rt(yt)){ze.error("You don't have permission to update this sale");return}g(I);const Ye={status:Se,loginId:yt.loginId||"",password:yt.password||"",leadBy:yt.leadBy||"",pending:Se==="Completed"?!1:yt.pending};console.log("Updating status to:",Se);const Yr=await Wn.update(I,Ye);Yr.data&&Yr.data.success?(n(Jr=>Jr.map(Pr=>Pr._id===I?{...Pr,status:Se,pending:Se==="Completed"?!1:Pr.pending}:Pr)),l(Jr=>Jr.map(Pr=>Pr._id===I?{...Pr,status:Se,pending:Se==="Completed"?!1:Pr.pending}:Pr)),ze.success("Sale status updated successfully!")):ze.error(((Ue=Yr.data)==null?void 0:Ue.message)||"Failed to update sale status")}catch(yt){if(console.error("Error updating sale status:",yt),yt.response)if(console.error("Error details:",yt.response.data),yt.response.status===403)t.role==="Sales Person"&&((st=(Ie=yt.response.data)==null?void 0:Ie.message)!=null&&st.includes("can only update the status field"))?f("As a Sales Person, you can only update the status field"):f("You don't have permission to update this sale. Only the creator or an admin can update it.");else if(yt.response.status===401)f("Your session has expired. Please log in again.");else if(yt.response.status===400){const Ye=((lt=yt.response.data)==null?void 0:lt.message)||"Invalid data";Ye.includes("enum value for path `status`")?ze.error(`Invalid status value. Allowed values are: ${P.join(", ")}`):ze.error(`Bad request: ${Ye}`)}else ze.error("Failed to update sale status. Please try again.");else ze.error("Network error while updating sale status")}finally{g(null)}},gt=(I,Se)=>{if(I)try{const Ue=I.toString().replace(/\D/g,""),st=`https://wa.me/${Se?Se.toString().replace(/^\+/,""):"1"}${Ue}`;console.log("Opening WhatsApp URL:",st),window.open(st,"_blank","noopener,noreferrer")}catch(Ue){console.error("Error opening WhatsApp:",Ue),ze.error("Could not open WhatsApp. Please check the phone number format.")}},Ft=I=>{I&&(window.location.href=`mailto:${I}`)},tr=async()=>{var I;try{n([]),l([]),h(!0);const Se=await Wn.getAll();if(Se.data&&Se.data.success){console.log("Refreshed sales data:",Se.data.data);const Ue=Se.data.data.map(Ie=>({...Ie,_id:Ie._id,salesPerson:typeof Ie.salesPerson=="object"&&Ie.salesPerson._id||Ie.salesPerson,amount:parseFloat(Ie.totalCost||0),token:parseFloat(Ie.tokenAmount||0),pending:Ie.status==="Completed"?0:parseFloat(Ie.totalCost||0)-parseFloat(Ie.tokenAmount||0),product:Ie.course||Ie.product||"Unknown",status:Ie.status||"Pending",loginId:Ie.loginId||"",password:Ie.password||"",leadBy:Ie.leadBy||"",currency:Ie.currency||"USD",date:Ie.date||Ie.createdAt}));n(Ue),setTimeout(()=>{re()},0),ze.success("Data refreshed successfully")}else console.error("Failed to refresh sales data:",((I=Se.data)==null?void 0:I.message)||"Unknown error"),ze.error("Failed to refresh sales data. Please try again.")}catch(Se){console.error("Error refreshing data:",Se),ze.error("Failed to refresh data. Please reload the page.")}finally{h(!1),S&&je()}};k.useEffect(()=>{p&&console.log("Current editValues:",y)},[y,p]),k.useEffect(()=>{r.length>0&&t&&console.log("Current user permissions summary:",{userId:t._id,role:t.role,canEditCount:r.filter(I=>rt(I)).length,canDeleteCount:r.filter(I=>ot(I)).length,totalSales:r.length})},[r,t]);const Ut=(I,Se,Ue="N/A")=>{if(!I)return Ue;const Ie=Se.split(".");let st=I;for(const lt of Ie){if(st==null||typeof st!="object")return Ue;st=st[lt]}return st??Ue},Qr=I=>I?I.customerName||Ut(I,"leadId.name")||Ut(I,"leadId.NAME")||"Unknown Customer":"N/A",Zr=({role:I})=>{let Se="";return I==="Sales Person"?Se="As a Sales Person, you can only update the status of your own sales.":I==="Lead Person"&&(Se="As a Lead Person, you can only edit your own leads."),Se?o.jsx("div",{className:"relative inline-block ml-1 text-gray-400",children:o.jsxs("span",{className:"cursor-help text-sm",children:[o.jsx("i",{className:"fas fa-info-circle"}),o.jsx("span",{className:"tooltip absolute invisible group-hover:visible bg-gray-800 text-white p-2 rounded text-xs w-48 -mt-16 -ml-24 z-10",children:Se})]})}):null},It=(I,Se)=>{if(!I)return"Invalid sale data";if(Se==="Sales Person"){const Ue=Ce(I,"salesPerson"),Ie=t==null?void 0:t._id;return Ue&&Ie&&Ue.toString()===Ie.toString()?"As a Sales Person, you can edit and delete your own sales":"You can only edit and delete sales you created as a Sales Person"}return"You don't have permission to update this sale. Only the creator or an admin can update it."},Lr=I=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p===I._id?o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsx("input",{type:"date",value:y.saleDate?new Date(y.saleDate).toISOString().split("T")[0]:new Date(I.date||I.createdAt).toISOString().split("T")[0],onChange:Se=>Ke("saleDate",new Date(Se.target.value)),className:"w-full px-2 border border-gray-300 rounded"}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:()=>nt(I._id),className:"text-green-600 hover:text-green-900 flex items-center text-xs px-2 py-1 bg-green-50 rounded",children:[o.jsx(Ym,{className:"mr-1"})," Save"]}),o.jsxs("button",{onClick:()=>g(null),className:"text-red-600 hover:text-red-900 flex items-center text-xs px-2 py-1 bg-red-50 rounded",children:[o.jsx(rf,{className:"mr-1"})," Cancel"]})]})]}):o.jsxs("div",{className:"flex flex-col space-y-2",children:[o.jsx("div",{className:"text-sm text-gray-900",children:Ze(I.date||I.createdAt||new Date)}),rt(I)&&o.jsxs("button",{onClick:()=>_e(I),className:"text-blue-600 hover:text-blue-900 flex items-center text-xs px-2 py-1 bg-blue-50 rounded w-16",children:[o.jsx(nu,{className:"mr-1"})," Edit"]})]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:Qr(I)}),o.jsx("div",{className:"text-xs text-gray-500",children:I.product||Ut(I,"leadId.course")||"No product"}),p===I._id&&o.jsxs("div",{className:"mt-2",children:[o.jsx("input",{type:"text",placeholder:"Lead By (Optional)",value:y.leadBy||"",onChange:Se=>Ke("leadBy",Se.target.value),className:"w-full text-xs px-2 py-1 border border-gray-300 rounded"}),o.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 text-gray-400 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{children:"Name of person who led this sale"})]})]}),p!==I._id&&I.leadBy&&o.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Lead By: ",I.leadBy]})]}),o.jsx("td",{className:"px-6 py-4",children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[(I.contactNumber||Ut(I,"leadId.phone"))&&o.jsx("div",{className:"flex items-center",children:o.jsxs("button",{onClick:()=>gt(I.contactNumber||Ut(I,"leadId.phone"),I.countryCode||Ut(I,"leadId.countryCode","+91")),className:"text-sm text-gray-900 flex items-center hover:text-green-600",title:"Open in WhatsApp",children:[o.jsx(Hm,{className:"mr-1 text-green-500"}),I.countryCode||Ut(I,"leadId.countryCode","+91")," ",I.contactNumber||Ut(I,"leadId.phone")]})}),(I.email||Ut(I,"leadId.email"))&&o.jsx("div",{className:"flex items-center",children:o.jsxs("button",{onClick:()=>Ft(I.email||Ut(I,"leadId.email")),className:"text-sm text-gray-500 flex items-center hover:text-blue-600",title:"Send email",children:[o.jsx(tf,{className:"mr-1 text-blue-500"}),I.email||Ut(I,"leadId.email")]})}),p===I._id&&o.jsxs("div",{className:"mt-2 flex flex-col space-y-2",children:[o.jsx("input",{type:"text",placeholder:"Login ID (Optional)",value:y.loginId||"",onChange:Se=>Ke("loginId",Se.target.value),className:"w-full text-xs px-2 py-1 border border-gray-300 rounded"}),o.jsx("input",{type:"text",placeholder:"Password (Optional)",value:y.password||"",onChange:Se=>Ke("password",Se.target.value),className:"w-full text-xs px-2 py-1 border border-gray-300 rounded"})]}),p!==I._id&&(I.loginId||I.password)&&o.jsxs("div",{className:"mt-2 text-xs",children:[I.loginId&&o.jsxs("div",{children:["Login ID: ",I.loginId]}),I.password&&o.jsxs("div",{children:["Password: ",I.password]})]})]})}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[p===I._id?o.jsxs("div",{children:[o.jsx("input",{type:"text",value:y.product||"",onChange:Se=>Ke("product",Se.target.value),className:"w-full px-2 border border-gray-300 rounded",placeholder:"Product or course name"}),I.leadPerson&&typeof I.leadPerson=="object"&&I.leadPerson.fullName&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Lead Person: ",I.leadPerson.fullName]})]}):o.jsx("div",{className:"text-sm text-gray-900",children:I.product||Ut(I,"course")||"N/A"}),!p===I._id&&I.leadPerson&&typeof I.leadPerson=="object"&&I.leadPerson.fullName&&o.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Lead Person: ",I.leadPerson.fullName]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p===I._id?o.jsx("div",{className:"flex flex-col space-y-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(y.currency)}),o.jsx("input",{id:"amount",type:"number",value:y.amount!==void 0?y.amount.toString():"0",onChange:Se=>Ke("amount",Se.target.value),className:"w-24 px-2 pl-7 border border-gray-300 rounded"})]}),o.jsx("select",{value:y.currency||"USD",onChange:Se=>Ke("currency",Se.target.value),className:"border border-gray-300 rounded p-1 text-xs",children:oe.map(Se=>o.jsx("option",{value:Se.value,children:Se.label},Se.value))})]})}):o.jsx("div",{className:"text-sm font-medium text-gray-900",children:dn(I.amount||I.totalCost||0,I.currency||"USD")})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p===I._id?o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(y.currency)}),o.jsx("input",{id:"token",type:"number",value:y.token!==void 0?y.token.toString():"0",onChange:Se=>Ke("token",Se.target.value),className:"w-24 px-2 pl-7 border border-gray-300 rounded"})]}):o.jsx("div",{className:"text-sm font-medium text-gray-900",children:dn(I.token||I.tokenAmount||0,I.currency||"USD")})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p===I._id?o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(y.currency)}),o.jsx("input",{id:"pending",type:"number",value:y.pending!==void 0?y.pending.toString():"0",onChange:Se=>Ke("pending",Se.target.value),className:"w-24 px-2 pl-7 border border-gray-300 rounded",disabled:y.status==="Completed"})]}):o.jsx("div",{className:"text-sm font-medium text-gray-900",children:dn(I.status==="Completed"?0:I.pending!==void 0?I.pending:(I.amount||I.totalCost||0)-(I.token||I.tokenAmount||0),I.currency||"USD")})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:p===I._id?o.jsx("select",{value:y.status||I.status,onChange:Se=>Ke("status",Se.target.value),className:`text-sm px-2 py-1 rounded cursor-pointer ${I.status==="Pending"?"bg-yellow-100 text-yellow-800":I.status==="Completed"?"bg-green-100 text-green-800":I.status==="Cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"} border border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,disabled:!rt(I),children:P.map(Se=>o.jsx("option",{value:Se,children:Se},Se))}):o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:I.status||"Pending",onChange:Se=>Xe(I._id,Se.target.value),className:`text-sm px-2 py-1 rounded cursor-pointer appearance-none w-auto pr-8 ${I.status==="Pending"?"bg-yellow-100 text-yellow-800":I.status==="Completed"?"bg-green-100 text-green-800":I.status==="Cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"} border border-transparent focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500`,disabled:!rt(I),children:P.map(Se=>o.jsx("option",{value:Se,children:Se},Se))}),o.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:o.jsx("svg",{className:"fill-current h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"})})}),!rt(I)&&o.jsx("div",{className:"absolute left-0 -bottom-5 w-full",children:o.jsx("div",{className:"text-xs text-gray-500 italic",children:(t==null?void 0:t.role)==="Sales Person"?"Can only update your own sales":"No edit permission"})}),p===I._id&&o.jsx("div",{className:"absolute top-1/2 right-8 transform -translate-y-1/2",children:o.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 rounded-full border-t-transparent"})}),!rt(I)&&p===I._id&&o.jsx("div",{className:"text-red-500 text-xs mt-1",children:It(I,t==null?void 0:t.role)})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:p!==I._id&&o.jsx("div",{className:"flex justify-end",children:ot(I)?_&&H===I._id?o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs("button",{onClick:()=>At(I._id),className:"text-red-600 hover:text-red-900 flex items-center",children:[o.jsx(Ym,{className:"mr-1"})," Confirm"]}),o.jsxs("button",{onClick:()=>{z(null),ce(!1)},className:"text-gray-600 hover:text-gray-900 flex items-center",children:[o.jsx(rf,{className:"mr-1"})," Cancel"]})]}):o.jsxs("button",{onClick:()=>{z(I._id),ce(!0)},className:"text-red-600 hover:text-red-900 flex items-center",children:[o.jsx(Rp,{className:"mr-1"})," Delete"]}):o.jsxs("div",{className:"flex items-center text-gray-400 text-xs",children:[o.jsx("span",{className:"italic",children:"Not Deletable"}),o.jsx(Zr,{role:t==null?void 0:t.role})]})})})]},I._id),dn=(I,Se="USD")=>(console.log(`Formatting currency: value=${I}, currencyCode=${Se}`),`${(oe.find(st=>st.value===Se)||oe[0]).symbol}${parseFloat(I||0).toFixed(2)}`),Er=(I="USD")=>(oe.find(Ue=>Ue.value===I)||oe[0]).symbol;return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h2",{className:"text-3xl font-bold",children:"Sales Tracking"}),o.jsx("button",{onClick:We,className:"bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-md transition duration-300",children:"Add New Sale"})]}),m&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded-md",children:m}),u?o.jsxs("div",{className:"text-center py-10",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"}),o.jsx("p",{className:"mt-2 text-gray-600",children:"Loading sales data..."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-6 p-4 bg-white rounded-lg shadow-md",children:[o.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Filter Sales by Date"}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-600 mb-1",children:"Month"}),o.jsx("select",{id:"month",value:G,onChange:et,className:"border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:F,children:le.map(I=>o.jsx("option",{value:I.value,children:I.label},I.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-600 mb-1",children:"Year"}),o.jsx("select",{id:"year",value:J,onChange:xt,className:"border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:F,children:ne.map(I=>o.jsx("option",{value:I,children:I},I))})]}),o.jsxs("div",{className:"flex items-center ml-4",children:[o.jsx("input",{id:"currentMonth",type:"checkbox",checked:F,onChange:()=>Z(!F),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"currentMonth",className:"ml-2 block text-sm text-gray-700",children:"Show Current Month Only"})]}),o.jsx("button",{onClick:Qe,className:"bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-4 rounded-md ml-auto transition duration-300",children:"Reset to Current Month"})]}),o.jsxs("div",{className:"mt-3 text-sm text-gray-500",children:[F?o.jsxs("p",{children:["Showing sales for current month: ",le[new Date().getMonth()].label," ",new Date().getFullYear()]}):o.jsxs("p",{children:["Showing sales for: ",le[G-1].label," ",J]}),o.jsxs("p",{children:["Total: ",s.length," sales"]})]})]}),o.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow-md",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lead"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact/Login"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Token"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pending"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.length>0?s.map(I=>Lr(I)):o.jsx("tr",{children:o.jsx("td",{colSpan:"9",className:"px-6 py-4 text-center text-gray-500",children:"No sales found for the selected period. Try another date range or add a new sale."})})})]})}),t&&t.role==="Admin"&&o.jsxs("div",{className:"mt-8 p-4 bg-gray-800 text-white rounded-lg shadow-md",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),"Debug Panel"]}),o.jsxs("div",{className:"space-y-2 text-sm font-mono",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"User ID:"})," ",t._id]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"User Role:"})," ",t.role]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"Auth Token:"})," ",localStorage.getItem("token")?"Present":"Missing"]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"Token Length:"})," ",((Un=localStorage.getItem("token"))==null?void 0:Un.length)||0," characters"]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"API URL:"})," ",ht.defaults.baseURL||"Not set (using default)"]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"Total Sales:"})," ",r.length]}),o.jsxs("div",{children:[o.jsx("span",{className:"text-gray-400",children:"Filtered Sales:"})," ",s.length]}),o.jsx("div",{children:o.jsxs("details",{children:[o.jsx("summary",{className:"cursor-pointer text-blue-400 hover:text-blue-300",children:"Show First Sale Data"}),o.jsx("pre",{className:"mt-2 p-2 bg-gray-900 rounded text-xs overflow-auto max-h-40",children:r.length>0?JSON.stringify(r[0],null,2):"No sales data"})]})}),o.jsx("div",{className:"pt-2",children:o.jsx("button",{onClick:tr,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 rounded text-white text-xs",children:"Refresh Data"})})]})]})]}),S&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[o.jsxs("div",{className:"bg-green-600 text-white p-4 flex justify-between items-center",children:[o.jsx("h3",{className:"text-xl font-bold",children:"Add New Sale"}),o.jsx("button",{onClick:()=>N(!1),className:"text-white hover:text-gray-200 text-2xl",children:""})]}),o.jsxs("form",{onSubmit:ge,className:"p-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsx("div",{className:"col-span-2 mb-4",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sale Type:"}),o.jsxs("div",{className:"flex border border-gray-300 rounded-md overflow-hidden",children:[o.jsx("button",{type:"button",className:`px-4 py-2 text-sm font-medium ${w.isReference?"bg-gray-100 text-gray-700":"bg-blue-600 text-white"}`,onClick:()=>He(!1),children:"From Lead"}),o.jsx("button",{type:"button",className:`px-4 py-2 text-sm font-medium ${w.isReference?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>He(!0),children:"From Reference"})]})]})}),!w.isReference&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{htmlFor:"leadId",className:"block text-sm font-medium text-gray-700",children:"Lead"}),o.jsxs("select",{id:"leadId",value:w.leadId,onChange:Ge,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select a lead"}),C.map(I=>o.jsxs("option",{value:I._id,children:[I.name," - ",I.course]},I._id))]})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsxs("label",{htmlFor:"leadPerson",className:"block text-sm font-medium text-gray-700",children:["Lead Person",o.jsx("span",{className:"ml-1 text-xs text-blue-600 font-normal",children:"(Who should see this sale on their dashboard)"})]}),o.jsxs("select",{id:"leadPerson",value:w.leadPerson,onChange:I=>Ve("leadPerson",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select a lead person"}),U.map(I=>o.jsx("option",{value:I.value,children:I.label},I.value))]}),ie&&o.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"Loading lead persons..."}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The selected lead person will see this sale on their dashboard"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"saleDate",className:"block text-sm font-medium text-gray-700",children:"Sale Date"}),o.jsx("input",{id:"saleDate",type:"date",value:w.saleDate?new Date(w.saleDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:I=>Ve("saleDate",new Date(I.target.value)),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsxs("label",{htmlFor:"leadBy",className:"block text-sm font-medium text-gray-700",children:["Lead By (Optional)",o.jsxs("span",{className:"ml-1 inline-block relative group",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 cursor-help",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 w-48 bg-gray-800 text-white text-xs rounded py-1 px-2 hidden group-hover:block",children:"Name of the person who led this sale (can be different from the Lead Person assigned in the system)"})]})]}),o.jsx("input",{id:"leadBy",type:"text",value:w.leadBy,onChange:I=>Ve("leadBy",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Who led this sale?"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{htmlFor:"product",className:"block text-sm font-medium text-gray-700",children:"Product"}),o.jsx("input",{id:"product",type:"text",value:w.product,onChange:I=>Ve("product",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Product or course name"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"loginId",className:"block text-sm font-medium text-gray-700",children:"Login ID (Optional)"}),o.jsx("input",{id:"loginId",type:"text",value:w.loginId,onChange:I=>Ve("loginId",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer login ID"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password (Optional)"}),o.jsx("input",{id:"password",type:"text",value:w.password,onChange:I=>Ve("password",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer password"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Currency"}),o.jsx("select",{id:"currency",value:w.currency,onChange:I=>Ve("currency",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:oe.map(I=>o.jsx("option",{value:I.value,children:I.label},I.value))})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(w.currency)}),o.jsx("input",{id:"amount",type:"number",value:w.amount,onChange:I=>Ve("amount",I.target.value),className:"block w-full pl-7 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-700",children:"Token"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(w.currency)}),o.jsx("input",{id:"token",type:"number",value:w.token,onChange:I=>Ve("token",I.target.value),className:"block w-full pl-7 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"pending",className:"block text-sm font-medium text-gray-700",children:"Pending"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(w.currency)}),o.jsx("input",{id:"pending",type:"number",value:w.pending,onChange:I=>Ve("pending",I.target.value),className:"block w-full pl-7 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",disabled:w.status==="Completed"})]})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),o.jsx("select",{id:"status",value:w.status,onChange:I=>Ve("status",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:P.map(I=>o.jsx("option",{value:I,children:I},I))})]})]}),w.isReference&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"customerName",className:"block text-sm font-medium text-gray-700",children:"Customer Name"}),o.jsx("input",{id:"customerName",type:"text",value:w.customerName,onChange:I=>Ve("customerName",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter customer name"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"saleDate",className:"block text-sm font-medium text-gray-700",children:"Sale Date"}),o.jsx("input",{id:"saleDate",type:"date",value:w.saleDate?new Date(w.saleDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],onChange:I=>Ve("saleDate",new Date(I.target.value)),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{htmlFor:"contactNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Number"}),o.jsx(U6,{country:"us",value:w.contactNumber,onChange:(I,Se)=>{Ve("contactNumber",I),Ve("countryCode",`+${Se.dialCode}`)},inputProps:{id:"contactNumber",name:"contactNumber",required:!0},containerStyle:e.container,inputStyle:e.inputStyle,buttonStyle:e.buttonStyle,dropdownStyle:e.dropdownStyle,enableSearch:!0,searchPlaceholder:"Search country..."})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),o.jsx("input",{id:"email",type:"email",value:w.email,onChange:I=>Ve("email",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"customer@example.com"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700",children:"Country"}),o.jsx("input",{id:"country",type:"text",value:w.country,onChange:I=>Ve("country",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter country"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsxs("label",{htmlFor:"leadBy",className:"block text-sm font-medium text-gray-700",children:["Lead By (Optional)",o.jsxs("span",{className:"ml-1 inline-block relative group",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 cursor-help",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 w-48 bg-gray-800 text-white text-xs rounded py-1 px-2 hidden group-hover:block",children:"Name of the person who led this sale (can be different from the Lead Person assigned in the system)"})]})]}),o.jsx("input",{id:"leadBy",type:"text",value:w.leadBy,onChange:I=>Ve("leadBy",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Who led this sale?"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700",children:"Currency"}),o.jsx("select",{id:"currency",value:w.currency,onChange:I=>Ve("currency",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:oe.map(I=>o.jsx("option",{value:I.value,children:I.label},I.value))})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"product",className:"block text-sm font-medium text-gray-700",children:"Product"}),o.jsx("input",{id:"product",type:"text",value:w.product,onChange:I=>Ve("product",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Product or course name"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"loginId",className:"block text-sm font-medium text-gray-700",children:"Login ID (Optional)"}),o.jsx("input",{id:"loginId",type:"text",value:w.loginId,onChange:I=>Ve("loginId",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer login ID"})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password (Optional)"}),o.jsx("input",{id:"password",type:"text",value:w.password,onChange:I=>Ve("password",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Customer password"})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{htmlFor:"leadPerson",className:"block text-sm font-medium text-gray-700",children:"Lead Person"}),o.jsxs("select",{id:"leadPerson",value:w.leadPerson,onChange:I=>Ve("leadPerson",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"Select a lead person"}),U.map(I=>o.jsx("option",{value:I.value,children:I.label},I.value))]}),ie&&o.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"Loading lead persons..."})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700",children:"Amount"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(w.currency)}),o.jsx("input",{id:"amount",type:"number",value:w.amount,onChange:I=>Ve("amount",I.target.value),className:"block w-full pl-7 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-700",children:"Token"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(w.currency)}),o.jsx("input",{id:"token",type:"number",value:w.token,onChange:I=>Ve("token",I.target.value),className:"block w-full pl-7 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"pending",className:"block text-sm font-medium text-gray-700",children:"Pending"}),o.jsxs("div",{className:"relative mt-1",children:[o.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:Er(w.currency)}),o.jsx("input",{id:"pending",type:"number",value:w.pending,onChange:I=>Ve("pending",I.target.value),className:"block w-full pl-7 border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00",disabled:w.status==="Completed"})]})]}),o.jsxs("div",{className:"col-span-2 md:col-span-1",children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),o.jsx("select",{id:"status",value:w.status,onChange:I=>Ve("status",I.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:P.map(I=>o.jsx("option",{value:I,children:I},I))})]})]})]}),o.jsx("div",{className:"mt-6",children:o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md",children:"Add Sale"})})]})]})})]})})};let z6={data:""},V6=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||z6,H6=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Y6=/\/\*[^]*?\*\/|  +/g,Iv=/\n+/g,ti=(e,t)=>{let r="",n="",s="";for(let l in e){let u=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+u+";":n+=l[1]=="f"?ti(u,l):l+"{"+ti(u,l[1]=="k"?"":t)+"}":typeof u=="object"?n+=ti(u,t?t.replace(/([^,])+/g,h=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,m=>/&/.test(m)?m.replace(/&/g,h):h?h+" "+m:m)):l):u!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=ti.p?ti.p(l,u):l+":"+u+";")}return r+(t&&s?t+"{"+s+"}":s)+n},ds={},Qw=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Qw(e[r]);return t}return e},G6=(e,t,r,n,s)=>{let l=Qw(e),u=ds[l]||(ds[l]=(m=>{let f=0,p=11;for(;f<m.length;)p=101*p+m.charCodeAt(f++)>>>0;return"go"+p})(l));if(!ds[u]){let m=l!==e?e:(f=>{let p,g,y=[{}];for(;p=H6.exec(f.replace(Y6,""));)p[4]?y.shift():p[3]?(g=p[3].replace(Iv," ").trim(),y.unshift(y[0][g]=y[0][g]||{})):y[0][p[1]]=p[2].replace(Iv," ").trim();return y[0]})(e);ds[u]=ti(s?{["@keyframes "+u]:m}:m,r?"":"."+u)}let h=r&&ds.g?ds.g:null;return r&&(ds.g=ds[u]),((m,f,p,g)=>{g?f.data=f.data.replace(g,m):f.data.indexOf(m)===-1&&(f.data=p?m+f.data:f.data+m)})(ds[u],t,n,h),u},q6=(e,t,r)=>e.reduce((n,s,l)=>{let u=t[l];if(u&&u.call){let h=u(r),m=h&&h.props&&h.props.className||/^go/.test(h)&&h;u=m?"."+m:h&&typeof h=="object"?h.props?"":ti(h,""):h===!1?"":h}return n+s+(u??"")},"");function Uf(e){let t=this||{},r=e.call?e(t.p):e;return G6(r.unshift?r.raw?q6(r,[].slice.call(arguments,1),t.p):r.reduce((n,s)=>Object.assign(n,s&&s.call?s(t.p):s),{}):r,V6(t.target),t.g,t.o,t.k)}let Zw,Xm,Km;Uf.bind({g:1});let ys=Uf.bind({k:1});function $6(e,t,r,n){ti.p=t,Zw=e,Xm=r,Km=n}function di(e,t){let r=this||{};return function(){let n=arguments;function s(l,u){let h=Object.assign({},l),m=h.className||s.className;r.p=Object.assign({theme:Xm&&Xm()},h),r.o=/ *go\d+/.test(m),h.className=Uf.apply(r,n)+(m?" "+m:"");let f=e;return e[0]&&(f=h.as||e,delete h.as),Km&&f[0]&&Km(h),Zw(f,h)}return s}}var W6=e=>typeof e=="function",nf=(e,t)=>W6(e)?e(t):e,X6=(()=>{let e=0;return()=>(++e).toString()})(),Jw=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),K6=20,e4=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,K6)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:r}=t;return e4(e,{type:e.toasts.find(l=>l.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(l=>l.id===n||n===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+s}))}}},qd=[],Pi={toasts:[],pausedAt:void 0},Ki=e=>{Pi=e4(Pi,e),qd.forEach(t=>{t(Pi)})},Q6={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Z6=(e={})=>{let[t,r]=k.useState(Pi),n=k.useRef(Pi);k.useEffect(()=>(n.current!==Pi&&r(Pi),qd.push(r),()=>{let l=qd.indexOf(r);l>-1&&qd.splice(l,1)}),[]);let s=t.toasts.map(l=>{var u,h,m;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((u=e[l.type])==null?void 0:u.removeDelay)||(e==null?void 0:e.removeDelay),duration:l.duration||((h=e[l.type])==null?void 0:h.duration)||(e==null?void 0:e.duration)||Q6[l.type],style:{...e.style,...(m=e[l.type])==null?void 0:m.style,...l.style}}});return{...t,toasts:s}},J6=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||X6()}),iu=e=>(t,r)=>{let n=J6(t,e,r);return Ki({type:2,toast:n}),n.id},Ot=(e,t)=>iu("blank")(e,t);Ot.error=iu("error");Ot.success=iu("success");Ot.loading=iu("loading");Ot.custom=iu("custom");Ot.dismiss=e=>{Ki({type:3,toastId:e})};Ot.remove=e=>Ki({type:4,toastId:e});Ot.promise=(e,t,r)=>{let n=Ot.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let l=t.success?nf(t.success,s):void 0;return l?Ot.success(l,{id:n,...r,...r==null?void 0:r.success}):Ot.dismiss(n),s}).catch(s=>{let l=t.error?nf(t.error,s):void 0;l?Ot.error(l,{id:n,...r,...r==null?void 0:r.error}):Ot.dismiss(n)}),e};var e5=(e,t)=>{Ki({type:1,toast:{id:e,height:t}})},t5=()=>{Ki({type:5,time:Date.now()})},Sc=new Map,r5=1e3,n5=(e,t=r5)=>{if(Sc.has(e))return;let r=setTimeout(()=>{Sc.delete(e),Ki({type:4,toastId:e})},t);Sc.set(e,r)},a5=e=>{let{toasts:t,pausedAt:r}=Z6(e);k.useEffect(()=>{if(r)return;let l=Date.now(),u=t.map(h=>{if(h.duration===1/0)return;let m=(h.duration||0)+h.pauseDuration-(l-h.createdAt);if(m<0){h.visible&&Ot.dismiss(h.id);return}return setTimeout(()=>Ot.dismiss(h.id),m)});return()=>{u.forEach(h=>h&&clearTimeout(h))}},[t,r]);let n=k.useCallback(()=>{r&&Ki({type:6,time:Date.now()})},[r]),s=k.useCallback((l,u)=>{let{reverseOrder:h=!1,gutter:m=8,defaultPosition:f}=u||{},p=t.filter(v=>(v.position||f)===(l.position||f)&&v.height),g=p.findIndex(v=>v.id===l.id),y=p.filter((v,S)=>S<g&&v.visible).length;return p.filter(v=>v.visible).slice(...h?[y+1]:[0,y]).reduce((v,S)=>v+(S.height||0)+m,0)},[t]);return k.useEffect(()=>{t.forEach(l=>{if(l.dismissed)n5(l.id,l.removeDelay);else{let u=Sc.get(l.id);u&&(clearTimeout(u),Sc.delete(l.id))}})},[t]),{toasts:t,handlers:{updateHeight:e5,startPause:t5,endPause:n,calculateOffset:s}}},s5=ys`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,i5=ys`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,o5=ys`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,l5=di("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${s5} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${i5} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${o5} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,c5=ys`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,u5=di("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${c5} 1s linear infinite;
`,d5=ys`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,f5=ys`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,h5=di("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${d5} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${f5} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,m5=di("div")`
  position: absolute;
`,p5=di("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,x5=ys`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,g5=di("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${x5} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,y5=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?k.createElement(g5,null,t):t:r==="blank"?null:k.createElement(p5,null,k.createElement(u5,{...n}),r!=="loading"&&k.createElement(m5,null,r==="error"?k.createElement(l5,{...n}):k.createElement(h5,{...n})))},v5=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,b5=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,w5="0%{opacity:0;} 100%{opacity:1;}",S5="0%{opacity:1;} 100%{opacity:0;}",N5=di("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,T5=di("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,E5=(e,t)=>{let r=e.includes("top")?1:-1,[n,s]=Jw()?[w5,S5]:[v5(r),b5(r)];return{animation:t?`${ys(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ys(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},_5=k.memo(({toast:e,position:t,style:r,children:n})=>{let s=e.height?E5(e.position||t||"top-center",e.visible):{opacity:0},l=k.createElement(y5,{toast:e}),u=k.createElement(T5,{...e.ariaProps},nf(e.message,e));return k.createElement(N5,{className:e.className,style:{...s,...r,...e.style}},typeof n=="function"?n({icon:l,message:u}):k.createElement(k.Fragment,null,l,u))});$6(k.createElement);var C5=({id:e,className:t,style:r,onHeightUpdate:n,children:s})=>{let l=k.useCallback(u=>{if(u){let h=()=>{let m=u.getBoundingClientRect().height;n(e,m)};h(),new MutationObserver(h).observe(u,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return k.createElement("div",{ref:l,className:t,style:r},s)},A5=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Jw()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...s}},j5=Uf`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,_d=16,D5=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:s,containerStyle:l,containerClassName:u})=>{let{toasts:h,handlers:m}=a5(r);return k.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:_d,left:_d,right:_d,bottom:_d,pointerEvents:"none",...l},className:u,onMouseEnter:m.startPause,onMouseLeave:m.endPause},h.map(f=>{let p=f.position||t,g=m.calculateOffset(f,{reverseOrder:e,gutter:n,defaultPosition:t}),y=A5(p,g);return k.createElement(C5,{id:f.id,key:f.id,onHeightUpdate:m.updateHeight,className:f.visible?j5:"",style:y},f.type==="custom"?nf(f.message,f):s?s(f):k.createElement(_5,{toast:f,position:p}))}))},Hr=Ot;const k5=()=>{const[e,t]=k.useState(!1),[r,n]=k.useState(null),[s,l]=k.useState([]),[u,h]=k.useState({}),[m,f]=k.useState({date:new Date().toISOString().split("T")[0],customerName:"",country:"",course:"",countryCode:"",contactNumber:"",email:"",pseudoId:"",leadPerson:"",source:"",clientRemark:"",feedback:"",totalCost:0,totalCostCurrency:"USD",tokenAmount:0,tokenAmountCurrency:"USD"}),{user:p}=Tr();k.useEffect(()=>{g(),y()},[]);const g=async()=>{try{const w=await fr.getUsers("Lead Person");w.data.success?l(w.data.data||[]):Hr.error("Failed to load lead persons")}catch(w){console.error("Error loading lead persons:",w),Hr.error("Failed to load lead persons")}},y=async()=>{try{const w=await Uw.getRates();w.data.success&&h(w.data.rates||{})}catch(w){console.error("Error loading currency rates:",w)}},v=w=>{const{name:E,value:C}=w.target;f(T=>({...T,[E]:C}))},S=(w,E)=>{f(C=>({...C,[`${w}Currency`]:E}))},N=async w=>{var E,C,T,O;w.preventDefault(),t(!0),n(null);try{if(!m.leadPerson)throw new Error("Please select a Lead Person");if(!p)throw new Error("User information not available. Please log in again.");const j={date:m.date,customerName:m.customerName,country:m.country,course:m.course,countryCode:m.countryCode,contactNumber:m.contactNumber,email:m.email,pseudoId:m.pseudoId,totalCost:parseFloat(m.totalCost),totalCostCurrency:m.totalCostCurrency,tokenAmount:parseFloat(m.tokenAmount),tokenAmountCurrency:m.tokenAmountCurrency,source:m.source,clientRemark:m.clientRemark,feedback:m.feedback};(await Wn.createSaleWithLeadPerson(j,m.leadPerson)).data.success&&(Hr.success("Sale created successfully! This sale will appear on the lead person's dashboard."),f({date:new Date().toISOString().split("T")[0],customerName:"",country:"",course:"",countryCode:"",contactNumber:"",email:"",pseudoId:"",leadPerson:"",source:"",clientRemark:"",feedback:"",totalCost:0,totalCostCurrency:"USD",tokenAmount:0,tokenAmountCurrency:"USD"}))}catch(j){console.error("Error creating sale:",j),n(((C=(E=j.response)==null?void 0:E.data)==null?void 0:C.message)||j.message||"Failed to create sale"),Hr.error(((O=(T=j.response)==null?void 0:T.data)==null?void 0:O.message)||j.message||"Failed to create sale")}finally{t(!1)}};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-4",children:[o.jsx("div",{className:"flex justify-between items-center mb-6",children:o.jsx("h1",{className:"text-2xl font-bold",children:"Create Sale for Lead Person"})}),r&&o.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:r}),o.jsx("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:o.jsxs("form",{onSubmit:N,children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),o.jsx("input",{type:"date",name:"date",value:m.date,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),o.jsx("input",{type:"text",name:"customerName",value:m.customerName,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),o.jsx("input",{type:"text",name:"country",value:m.country,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course"}),o.jsx("input",{type:"text",name:"course",value:m.course,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country Code"}),o.jsx("input",{type:"text",name:"countryCode",value:m.countryCode,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",placeholder:"e.g. +1, +91"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),o.jsx("input",{type:"text",name:"contactNumber",value:m.contactNumber,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx("input",{type:"email",name:"email",value:m.email,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pseudo ID"}),o.jsx("input",{type:"text",name:"pseudoId",value:m.pseudoId,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Person"}),o.jsxs("select",{name:"leadPerson",value:m.leadPerson,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md",required:!0,children:[o.jsx("option",{value:"",children:"Select Lead Person"}),s.map(w=>o.jsx("option",{value:w._id,children:w.fullName},w._id))]}),o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"The lead person will see this sale on their dashboard"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source"}),o.jsx("input",{type:"text",name:"source",value:m.source,onChange:v,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Cost"}),o.jsxs("div",{className:"flex",children:[o.jsx("input",{type:"number",name:"totalCost",value:m.totalCost,onChange:v,className:"w-2/3 p-2 border border-gray-300 rounded-l-md",required:!0}),o.jsxs("select",{name:"totalCostCurrency",value:m.totalCostCurrency,onChange:w=>S("totalCost",w.target.value),className:"w-1/3 p-2 border border-gray-300 rounded-r-md",children:[o.jsx("option",{value:"USD",children:"USD"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"GBP",children:"GBP"}),o.jsx("option",{value:"INR",children:"INR"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Token Amount"}),o.jsxs("div",{className:"flex",children:[o.jsx("input",{type:"number",name:"tokenAmount",value:m.tokenAmount,onChange:v,className:"w-2/3 p-2 border border-gray-300 rounded-l-md",required:!0}),o.jsxs("select",{name:"tokenAmountCurrency",value:m.tokenAmountCurrency,onChange:w=>S("tokenAmount",w.target.value),className:"w-1/3 p-2 border border-gray-300 rounded-r-md",children:[o.jsx("option",{value:"USD",children:"USD"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"GBP",children:"GBP"}),o.jsx("option",{value:"INR",children:"INR"})]})]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Remark"}),o.jsx("textarea",{name:"clientRemark",value:m.clientRemark,onChange:v,rows:"2",className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Feedback"}),o.jsx("textarea",{name:"feedback",value:m.feedback,onChange:v,rows:"2",className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsx("div",{className:"mt-6 flex justify-end",children:o.jsx("button",{type:"submit",disabled:e,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300 flex items-center",children:e?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white rounded-full border-t-transparent"}),"Processing..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Hw,{className:"mr-2"})," Create Sale for Lead Person"]})})})]})}),o.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-700 p-4 rounded-md mb-6",children:[o.jsx("h2",{className:"text-lg font-semibold mb-2",children:"How This Works"}),o.jsx("p",{className:"mb-2",children:"When you create a sale using this form and select a Lead Person, the sale will:"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Be credited to you as the Sales Person"}),o.jsx("li",{children:"Appear on the Lead Person's dashboard"}),o.jsx("li",{children:"Allow the Lead Person to track your sales progress"}),o.jsx("li",{children:"Create transparency and collaboration between Sales and Lead teams"})]})]})]})})};var O5=Object.defineProperty,R5=(e,t,r)=>t in e?O5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dr=(e,t,r)=>R5(e,typeof t!="symbol"?t+"":t,r);const af={x:0,y:0,width:0,height:0,unit:"px"},Bo=(e,t,r)=>Math.min(Math.max(e,t),r),M5=(...e)=>e.filter(t=>t&&typeof t=="string").join(" "),zv=(e,t)=>e===t||e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y&&e.unit===t.unit;function F5(e,t,r,n){const s=Ha(e,r,n);return e.width&&(s.height=s.width/t),e.height&&(s.width=s.height*t),s.y+s.height>n&&(s.height=n-s.y,s.width=s.height*t),s.x+s.width>r&&(s.width=r-s.x,s.height=s.width/t),e.unit==="%"?ei(s,r,n):s}function L5(e,t,r){const n=Ha(e,t,r);return n.x=(t-n.width)/2,n.y=(r-n.height)/2,e.unit==="%"?ei(n,t,r):n}function ei(e,t,r){return e.unit==="%"?{...af,...e,unit:"%"}:{unit:"%",x:e.x?e.x/t*100:0,y:e.y?e.y/r*100:0,width:e.width?e.width/t*100:0,height:e.height?e.height/r*100:0}}function Ha(e,t,r){return e.unit?e.unit==="px"?{...af,...e,unit:"px"}:{unit:"px",x:e.x?e.x*t/100:0,y:e.y?e.y*r/100:0,width:e.width?e.width*t/100:0,height:e.height?e.height*r/100:0}:{...af,...e,unit:"px"}}function Vv(e,t,r,n,s,l=0,u=0,h=n,m=s){const f={...e};let p=Math.min(l,n),g=Math.min(u,s),y=Math.min(h,n),v=Math.min(m,s);t&&(t>1?(p=u?u*t:p,g=p/t,y=h*t):(g=l?l/t:g,p=g*t,v=m/t)),f.y<0&&(f.height=Math.max(f.height+f.y,g),f.y=0),f.x<0&&(f.width=Math.max(f.width+f.x,p),f.x=0);const S=n-(f.x+f.width);S<0&&(f.x=Math.min(f.x,n-p),f.width+=S);const N=s-(f.y+f.height);if(N<0&&(f.y=Math.min(f.y,s-g),f.height+=N),f.width<p&&((r==="sw"||r=="nw")&&(f.x-=p-f.width),f.width=p),f.height<g&&((r==="nw"||r=="ne")&&(f.y-=g-f.height),f.height=g),f.width>y&&((r==="sw"||r=="nw")&&(f.x-=y-f.width),f.width=y),f.height>v&&((r==="nw"||r=="ne")&&(f.y-=v-f.height),f.height=v),t){const w=f.width/f.height;if(w<t){const E=Math.max(f.width/t,g);(r==="nw"||r=="ne")&&(f.y-=E-f.height),f.height=E}else if(w>t){const E=Math.max(f.height*t,p);(r==="sw"||r=="nw")&&(f.x-=E-f.width),f.width=E}}return f}function P5(e,t,r,n){const s={...e};return t==="ArrowLeft"?n==="nw"?(s.x-=r,s.y-=r,s.width+=r,s.height+=r):n==="w"?(s.x-=r,s.width+=r):n==="sw"?(s.x-=r,s.width+=r,s.height+=r):n==="ne"?(s.y+=r,s.width-=r,s.height-=r):n==="e"?s.width-=r:n==="se"&&(s.width-=r,s.height-=r):t==="ArrowRight"&&(n==="nw"?(s.x+=r,s.y+=r,s.width-=r,s.height-=r):n==="w"?(s.x+=r,s.width-=r):n==="sw"?(s.x+=r,s.width-=r,s.height-=r):n==="ne"?(s.y-=r,s.width+=r,s.height+=r):n==="e"?s.width+=r:n==="se"&&(s.width+=r,s.height+=r)),t==="ArrowUp"?n==="nw"?(s.x-=r,s.y-=r,s.width+=r,s.height+=r):n==="n"?(s.y-=r,s.height+=r):n==="ne"?(s.y-=r,s.width+=r,s.height+=r):n==="sw"?(s.x+=r,s.width-=r,s.height-=r):n==="s"?s.height-=r:n==="se"&&(s.width-=r,s.height-=r):t==="ArrowDown"&&(n==="nw"?(s.x+=r,s.y+=r,s.width-=r,s.height-=r):n==="n"?(s.y+=r,s.height-=r):n==="ne"?(s.y+=r,s.width-=r,s.height-=r):n==="sw"?(s.x-=r,s.width+=r,s.height+=r):n==="s"?s.height+=r:n==="se"&&(s.width+=r,s.height+=r)),s}const Uo={capture:!0,passive:!1};let B5=0;const Zs=class Ea extends k.PureComponent{constructor(){super(...arguments),dr(this,"docMoveBound",!1),dr(this,"mouseDownOnCrop",!1),dr(this,"dragStarted",!1),dr(this,"evData",{startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0}),dr(this,"componentRef",k.createRef()),dr(this,"mediaRef",k.createRef()),dr(this,"resizeObserver"),dr(this,"initChangeCalled",!1),dr(this,"instanceId",`rc-${B5++}`),dr(this,"state",{cropIsActive:!1,newCropIsBeingDrawn:!1}),dr(this,"onCropPointerDown",t=>{const{crop:r,disabled:n}=this.props,s=this.getBox();if(!r)return;const l=Ha(r,s.width,s.height);if(n)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const u=t.target.dataset.ord,h=!!u;let m=t.clientX,f=t.clientY,p=l.x,g=l.y;if(u){const y=t.clientX-s.x,v=t.clientY-s.y;let S=0,N=0;u==="ne"||u=="e"?(S=y-(l.x+l.width),N=v-l.y,p=l.x,g=l.y+l.height):u==="se"||u==="s"?(S=y-(l.x+l.width),N=v-(l.y+l.height),p=l.x,g=l.y):u==="sw"||u=="w"?(S=y-l.x,N=v-(l.y+l.height),p=l.x+l.width,g=l.y):(u==="nw"||u=="n")&&(S=y-l.x,N=v-l.y,p=l.x+l.width,g=l.y+l.height),m=p+s.x+S,f=g+s.y+N}this.evData={startClientX:m,startClientY:f,startCropX:p,startCropY:g,clientX:t.clientX,clientY:t.clientY,isResize:h,ord:u},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})}),dr(this,"onComponentPointerDown",t=>{const{crop:r,disabled:n,locked:s,keepSelection:l,onChange:u}=this.props,h=this.getBox();if(n||s||l&&r)return;t.cancelable&&t.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const m=t.clientX-h.x,f=t.clientY-h.y,p={unit:"px",x:m,y:f,width:0,height:0};this.evData={startClientX:t.clientX,startClientY:t.clientY,startCropX:m,startCropY:f,clientX:t.clientX,clientY:t.clientY,isResize:!0},this.mouseDownOnCrop=!0,u(Ha(p,h.width,h.height),ei(p,h.width,h.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})}),dr(this,"onDocPointerMove",t=>{const{crop:r,disabled:n,onChange:s,onDragStart:l}=this.props,u=this.getBox();if(n||!r||!this.mouseDownOnCrop)return;t.cancelable&&t.preventDefault(),this.dragStarted||(this.dragStarted=!0,l&&l(t));const{evData:h}=this;h.clientX=t.clientX,h.clientY=t.clientY;let m;h.isResize?m=this.resizeCrop():m=this.dragCrop(),zv(r,m)||s(Ha(m,u.width,u.height),ei(m,u.width,u.height))}),dr(this,"onComponentKeyDown",t=>{const{crop:r,disabled:n,onChange:s,onComplete:l}=this.props;if(n)return;const u=t.key;let h=!1;if(!r)return;const m=this.getBox(),f=this.makePixelCrop(m),p=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?Ea.nudgeStepLarge:t.shiftKey?Ea.nudgeStepMedium:Ea.nudgeStep;if(u==="ArrowLeft"?(f.x-=p,h=!0):u==="ArrowRight"?(f.x+=p,h=!0):u==="ArrowUp"?(f.y-=p,h=!0):u==="ArrowDown"&&(f.y+=p,h=!0),h){t.cancelable&&t.preventDefault(),f.x=Bo(f.x,0,m.width-f.width),f.y=Bo(f.y,0,m.height-f.height);const g=Ha(f,m.width,m.height),y=ei(f,m.width,m.height);s(g,y),l&&l(g,y)}}),dr(this,"onHandlerKeyDown",(t,r)=>{const{aspect:n=0,crop:s,disabled:l,minWidth:u=0,minHeight:h=0,maxWidth:m,maxHeight:f,onChange:p,onComplete:g}=this.props,y=this.getBox();if(l||!s)return;if(t.key==="ArrowUp"||t.key==="ArrowDown"||t.key==="ArrowLeft"||t.key==="ArrowRight")t.stopPropagation(),t.preventDefault();else return;const v=(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)?Ea.nudgeStepLarge:t.shiftKey?Ea.nudgeStepMedium:Ea.nudgeStep,S=Ha(s,y.width,y.height),N=P5(S,t.key,v,r),w=Vv(N,n,r,y.width,y.height,u,h,m,f);if(!zv(s,w)){const E=ei(w,y.width,y.height);p(w,E),g&&g(w,E)}}),dr(this,"onDocPointerDone",t=>{const{crop:r,disabled:n,onComplete:s,onDragEnd:l}=this.props,u=this.getBox();this.unbindDocMove(),!(n||!r)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,l&&l(t),s&&s(Ha(r,u.width,u.height),ei(r,u.width,u.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))}),dr(this,"onDragFocus",()=>{var t;(t=this.componentRef.current)==null||t.scrollTo(0,0)})}get document(){return document}getBox(){const t=this.mediaRef.current;if(!t)return{x:0,y:0,width:0,height:0};const{x:r,y:n,width:s,height:l}=t.getBoundingClientRect();return{x:r,y:n,width:s,height:l}}componentDidUpdate(t){const{crop:r,onComplete:n}=this.props;if(n&&!t.crop&&r){const{width:s,height:l}=this.getBox();s&&l&&n(Ha(r,s,l),ei(r,s,l))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,Uo),this.document.addEventListener("pointerup",this.onDocPointerDone,Uo),this.document.addEventListener("pointercancel",this.onDocPointerDone,Uo),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,Uo),this.document.removeEventListener("pointerup",this.onDocPointerDone,Uo),this.document.removeEventListener("pointercancel",this.onDocPointerDone,Uo),this.docMoveBound=!1)}getCropStyle(){const{crop:t}=this.props;if(t)return{top:`${t.y}${t.unit}`,left:`${t.x}${t.unit}`,width:`${t.width}${t.unit}`,height:`${t.height}${t.unit}`}}dragCrop(){const{evData:t}=this,r=this.getBox(),n=this.makePixelCrop(r),s=t.clientX-t.startClientX,l=t.clientY-t.startClientY;return n.x=Bo(t.startCropX+s,0,r.width-n.width),n.y=Bo(t.startCropY+l,0,r.height-n.height),n}getPointRegion(t,r,n,s){const{evData:l}=this,u=l.clientX-t.x,h=l.clientY-t.y;let m;s&&r?m=r==="nw"||r==="n"||r==="ne":m=h<l.startCropY;let f;return n&&r?f=r==="nw"||r==="w"||r==="sw":f=u<l.startCropX,f?m?"nw":"sw":m?"ne":"se"}resolveMinDimensions(t,r,n=0,s=0){const l=Math.min(n,t.width),u=Math.min(s,t.height);return!r||!l&&!u?[l,u]:r>1?l?[l,l/r]:[u*r,u]:u?[u*r,u]:[l,l/r]}resizeCrop(){const{evData:t}=this,{aspect:r=0,maxWidth:n,maxHeight:s}=this.props,l=this.getBox(),[u,h]=this.resolveMinDimensions(l,r,this.props.minWidth,this.props.minHeight);let m=this.makePixelCrop(l);const f=this.getPointRegion(l,t.ord,u,h),p=t.ord||f;let g=t.clientX-t.startClientX,y=t.clientY-t.startClientY;(u&&p==="nw"||p==="w"||p==="sw")&&(g=Math.min(g,-u)),(h&&p==="nw"||p==="n"||p==="ne")&&(y=Math.min(y,-h));const v={unit:"px",x:0,y:0,width:0,height:0};f==="ne"?(v.x=t.startCropX,v.width=g,r?(v.height=v.width/r,v.y=t.startCropY-v.height):(v.height=Math.abs(y),v.y=t.startCropY-v.height)):f==="se"?(v.x=t.startCropX,v.y=t.startCropY,v.width=g,r?v.height=v.width/r:v.height=y):f==="sw"?(v.x=t.startCropX+g,v.y=t.startCropY,v.width=Math.abs(g),r?v.height=v.width/r:v.height=y):f==="nw"&&(v.x=t.startCropX+g,v.width=Math.abs(g),r?(v.height=v.width/r,v.y=t.startCropY-v.height):(v.height=Math.abs(y),v.y=t.startCropY+y));const S=Vv(v,r,f,l.width,l.height,u,h,n,s);return r||Ea.xyOrds.indexOf(p)>-1?m=S:Ea.xOrds.indexOf(p)>-1?(m.x=S.x,m.width=S.width):Ea.yOrds.indexOf(p)>-1&&(m.y=S.y,m.height=S.height),m.x=Bo(m.x,0,l.width-m.width),m.y=Bo(m.y,0,l.height-m.height),m}renderCropSelection(){const{ariaLabels:t=Ea.defaultProps.ariaLabels,disabled:r,locked:n,renderSelectionAddon:s,ruleOfThirds:l,crop:u}=this.props,h=this.getCropStyle();if(u)return at.createElement("div",{style:h,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":t.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!r&&!n&&at.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},at.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),at.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),at.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),at.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":t.nwDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"nw"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":t.nDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"n"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":t.neDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"ne"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":t.eDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"e"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":t.seDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"se"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":t.sDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"s"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":t.swDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"sw"),role:"button"}),at.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":t.wDragHandle,onKeyDown:m=>this.onHandlerKeyDown(m,"w"),role:"button"})),s&&at.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:m=>m.stopPropagation()},s(this.state)),l&&at.createElement(at.Fragment,null,at.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),at.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(t){const r={...af,...this.props.crop||{}};return Ha(r,t.width,t.height)}render(){const{aspect:t,children:r,circularCrop:n,className:s,crop:l,disabled:u,locked:h,style:m,ruleOfThirds:f}=this.props,{cropIsActive:p,newCropIsBeingDrawn:g}=this.state,y=l?this.renderCropSelection():null,v=M5("ReactCrop",s,p&&"ReactCrop--active",u&&"ReactCrop--disabled",h&&"ReactCrop--locked",g&&"ReactCrop--new-crop",l&&t&&"ReactCrop--fixed-aspect",l&&n&&"ReactCrop--circular-crop",l&&f&&"ReactCrop--rule-of-thirds",!this.dragStarted&&l&&!l.width&&!l.height&&"ReactCrop--invisible-crop",n&&"ReactCrop--no-animate");return at.createElement("div",{ref:this.componentRef,className:v,style:m},at.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},r),l?at.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},at.createElement("defs",null,at.createElement("mask",{id:`hole-${this.instanceId}`},at.createElement("rect",{width:"100%",height:"100%",fill:"white"}),n?at.createElement("ellipse",{cx:`${l.x+l.width/2}${l.unit}`,cy:`${l.y+l.height/2}${l.unit}`,rx:`${l.width/2}${l.unit}`,ry:`${l.height/2}${l.unit}`,fill:"black"}):at.createElement("rect",{x:`${l.x}${l.unit}`,y:`${l.y}${l.unit}`,width:`${l.width}${l.unit}`,height:`${l.height}${l.unit}`,fill:"black"}))),at.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,y)}};dr(Zs,"xOrds",["e","w"]),dr(Zs,"yOrds",["n","s"]),dr(Zs,"xyOrds",["nw","ne","se","sw"]),dr(Zs,"nudgeStep",1),dr(Zs,"nudgeStepMedium",10),dr(Zs,"nudgeStepLarge",100),dr(Zs,"defaultProps",{ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}});let U5=Zs;const I5=()=>{const{user:e,loading:t,setUser:r}=Tr(),[n,s]=k.useState(!1),[l,u]=k.useState(null),[h,m]=k.useState(null),[f,p]=k.useState(null),[g,y]=k.useState(),[v,S]=k.useState(null),[N,w]=k.useState(!1),E=k.useRef(null),C=k.useRef(null);if(t)return o.jsx("div",{className:"flex justify-center items-center min-h-screen",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(!e)return o.jsx(Mm,{to:"/login"});const T=G=>{const de=new Date(G);return de.toLocaleDateString()+" "+de.toLocaleTimeString()},O=(G,de,J)=>L5(F5({unit:"%",width:90},J,G,de),G,de),j=k.useCallback(G=>{const{width:de,height:J}=G.currentTarget;y(O(de,J,1))},[]),q=G=>{const de=G.target.files[0];if(!de)return;if(!de.type.match("image.*")){u("Please select an image file");return}if(de.size>5*1024*1024){u("Image size should be less than 5MB");return}u(null);const J=new FileReader;J.onloadend=()=>{p(J.result),w(!0)},J.readAsDataURL(de)},D=(G,de)=>{if(!de||!G)return null;const J=document.createElement("canvas"),W=G.naturalWidth/G.width,F=G.naturalHeight/G.height;return J.width=de.width,J.height=de.height,J.getContext("2d").drawImage(G,de.x*W,de.y*F,de.width*W,de.height*F,0,0,de.width,de.height),J.toDataURL("image/jpeg")},U=G=>{S(G)},K=()=>{if(!v||!C.current)return;const G=D(C.current,v);m(G),w(!1)},ie=async()=>{if(h)try{s(!0),u(null),console.log("Attempting to upload profile picture to:","/api/auth/profile-picture");try{const de=await gr.get("/api/auth/profile-picture-test");console.log("Test endpoint response:",de.data)}catch(de){console.error("Test endpoint failed:",de)}const G=await fr.updateProfilePicture(h);console.log("Profile picture update response:",G.data),G.data.success?(r({...e,profilePicture:h}),m(null),p(null)):u("Failed to update profile picture")}catch(G){console.error("Error uploading profile picture:",G),G.response?(console.error("Response data:",G.response.data),console.error("Response status:",G.response.status),console.error("Response headers:",G.response.headers),u(`Error ${G.response.status}: ${G.response.data.message||"Unknown error"}`)):G.request?(console.error("Request was made but no response received:",G.request),u("No response received from server. Check network connection.")):(console.error("Error setting up request:",G.message),u(`Error: ${G.message}`))}finally{s(!1)}},te=()=>{m(null),p(null),w(!1),u(null),y(void 0),S(null),E.current&&(E.current.value="")};return o.jsx(jr,{children:o.jsx("div",{className:"container mx-auto p-6",children:o.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-md overflow-hidden",children:[o.jsx("div",{className:"bg-blue-600 text-white p-4",children:o.jsx("h2",{className:"text-2xl font-bold",children:"User Profile"})}),o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-8 text-center",children:[N&&f&&o.jsxs("div",{className:"mb-6",children:[o.jsx("h4",{className:"text-lg font-medium mb-2",children:"Adjust Your Profile Picture"}),o.jsxs("div",{className:"max-w-md mx-auto",children:[o.jsx(U5,{crop:g,onChange:(G,de)=>y(de),onComplete:U,aspect:1,circularCrop:!0,children:o.jsx("img",{ref:C,src:f,alt:"Crop Preview",onLoad:j,className:"max-w-full max-h-96"})}),o.jsxs("div",{className:"flex justify-center mt-4 space-x-3",children:[o.jsxs("button",{type:"button",onClick:K,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center",children:[o.jsx(WA,{className:"mr-2"})," Apply Crop"]}),o.jsx("button",{type:"button",onClick:te,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cancel"})]})]})]}),!N&&o.jsxs("div",{className:"relative h-24 w-24 rounded-full mx-auto mb-4",children:[h?o.jsx("img",{src:h,alt:"Profile Preview",className:"h-24 w-24 rounded-full object-cover border-2 border-blue-300"}):e.profilePicture?o.jsx("img",{src:e.profilePicture,alt:e.fullName,className:"h-24 w-24 rounded-full object-cover"}):o.jsx("div",{className:"h-24 w-24 rounded-full bg-blue-100 flex items-center justify-center",children:o.jsx("span",{className:"text-3xl font-bold text-blue-600",children:e.fullName?e.fullName.charAt(0).toUpperCase():"U"})}),o.jsx("label",{htmlFor:"profile-upload",className:"absolute bottom-0 right-0 bg-blue-600 text-white rounded-full p-2 cursor-pointer hover:bg-blue-700 transition-colors",children:o.jsx(qA,{size:12})}),o.jsx("input",{type:"file",id:"profile-upload",className:"hidden",accept:"image/*",onChange:q,ref:E})]}),h&&!N&&o.jsxs("div",{className:"flex justify-center space-x-3 mb-4",children:[o.jsx("button",{onClick:ie,disabled:n,className:`p-2 rounded-full ${n?"bg-gray-300":"bg-green-500 hover:bg-green-600"} text-white`,children:o.jsx(Ym,{size:12})}),o.jsx("button",{onClick:te,disabled:n,className:"p-2 rounded-full bg-red-500 hover:bg-red-600 text-white",children:o.jsx(rf,{size:12})})]}),l&&o.jsx("div",{className:"text-red-500 text-sm mb-2",children:l}),o.jsx("h3",{className:"text-xl font-bold mt-2",children:e.fullName}),o.jsx("p",{className:"text-gray-600",children:e.email}),o.jsx("span",{className:"inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold mt-2",children:e.role})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[o.jsx("h4",{className:"text-lg font-bold mb-2",children:"Account Details"}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"User ID"}),o.jsx("p",{className:"font-medium",children:e._id})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Created"}),o.jsx("p",{className:"font-medium",children:T(e.createdAt)})]})]})]}),e.role==="Sales Person"&&o.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[o.jsx("h4",{className:"text-lg font-bold mb-2",children:"Sales Information"}),o.jsx("p",{className:"text-gray-600",children:"You have access to view and manage leads assigned to you."})]}),e.role==="Lead Person"&&o.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[o.jsx("h4",{className:"text-lg font-bold mb-2",children:"Lead Management"}),o.jsx("p",{className:"text-gray-600",children:"You have access to create leads and view leads assigned to you."})]}),(e.role==="Admin"||e.role==="Manager")&&o.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[o.jsx("h4",{className:"text-lg font-bold mb-2",children:"Administrative Access"}),o.jsx("p",{className:"text-gray-600",children:"You have access to all leads and administrative functions."})]})]})]})]})})})},z5=()=>{const{user:e}=Tr(),[t,r]=k.useState(""),[n,s]=k.useState(""),[l,u]=k.useState(!1);k.useEffect(()=>{const m=localStorage.getItem("token");r(m||"No token found")},[]);const h=async()=>{var m;u(!0);try{const f=await gr.get("https://crm-backend-o36v.onrender.com/api/auth/debug",{headers:{Authorization:`Bearer ${t}`}});s(JSON.stringify(f.data,null,2))}catch(f){s(JSON.stringify(((m=f.response)==null?void 0:m.data)||f.message,null,2))}u(!1)};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Authentication Debug"}),o.jsxs("div",{className:"bg-white p-6 rounded shadow-md mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Current User"}),o.jsx("pre",{className:"bg-gray-100 p-4 rounded overflow-auto",children:JSON.stringify(e,null,2)||"Not logged in"})]}),o.jsxs("div",{className:"bg-white p-6 rounded shadow-md mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Stored Token"}),o.jsx("pre",{className:"bg-gray-100 p-4 rounded overflow-auto mb-4",children:t}),o.jsx("button",{onClick:h,disabled:l,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:l?"Testing...":"Test Token"})]}),n&&o.jsxs("div",{className:"bg-white p-6 rounded shadow-md",children:[o.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Result"}),o.jsx("pre",{className:"bg-gray-100 p-4 rounded overflow-auto",children:n})]})]})})},V5=()=>{const{user:e}=Tr(),[t,r]=k.useState({totalLeads:0,totalSales:0,totalRevenue:0,totalUsers:0,recentLeads:[],recentSales:[],userCounts:{salesPerson:0,leadPerson:0,manager:0,admin:0}}),[n,s]=k.useState(!0),[l,u]=k.useState(null);k.useEffect(()=>{h()},[]);const h=async()=>{try{s(!0);const f=await Fn.getAll(),p=f.data.success?f.data.data:[],g=await Wn.getAll(),y=g.data.success?g.data.data:[],v=await fr.getUsers(),S=v.data.success?v.data.data:[],N=y.reduce((T,O)=>T+(O.amount||0),0),w=[...p].sort((T,O)=>new Date(O.createdAt)-new Date(T.createdAt)).slice(0,5),E=[...y].sort((T,O)=>new Date(O.createdAt)-new Date(T.createdAt)).slice(0,5),C={salesPerson:S.filter(T=>T.role==="Sales Person").length,leadPerson:S.filter(T=>T.role==="Lead Person").length,manager:S.filter(T=>T.role==="Manager").length,admin:S.filter(T=>T.role==="Admin").length};r({totalLeads:p.length,totalSales:y.length,totalRevenue:N,totalUsers:S.length,recentLeads:w,recentSales:E,userCounts:C}),u(null)}catch(f){console.error("Error fetching dashboard data:",f),u("Failed to load dashboard data. Please try again.")}finally{s(!1)}},m=f=>new Date(f).toLocaleDateString();return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),o.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",new Date().toLocaleString()]})]}),l&&o.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg mb-6",children:l}),n?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Total Leads"}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:t.totalLeads})]}),o.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})})]}),o.jsx("div",{className:"mt-4",children:o.jsx(Nt,{to:"/leads",className:"text-sm text-blue-600 hover:underline",children:"View all leads"})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Total Sales"}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:t.totalSales})]}),o.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})})]}),o.jsx("div",{className:"mt-4",children:o.jsx(Nt,{to:"/sales-tracking",className:"text-sm text-blue-600 hover:underline",children:"View all sales"})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Total Revenue"}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:kv(t.totalRevenue)})]}),o.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),o.jsx("div",{className:"mt-4",children:o.jsx(Nt,{to:"/admin/reports",className:"text-sm text-blue-600 hover:underline",children:"View reports"})})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-gray-500 text-sm font-medium",children:"Team Members"}),o.jsx("p",{className:"text-3xl font-bold mt-1",children:t.totalUsers})]}),o.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})})]}),o.jsx("div",{className:"mt-4",children:o.jsx(Nt,{to:"/admin/users",className:"text-sm text-blue-600 hover:underline",children:"Manage users"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow mb-8",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-lg font-medium",children:"Team Overview"})}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"border rounded-lg p-4 text-center",children:[o.jsx("h3",{className:"text-sm text-gray-500",children:"Sales Team"}),o.jsx("p",{className:"text-2xl font-bold mt-1",children:t.userCounts.salesPerson})]}),o.jsxs("div",{className:"border rounded-lg p-4 text-center",children:[o.jsx("h3",{className:"text-sm text-gray-500",children:"Lead Team"}),o.jsx("p",{className:"text-2xl font-bold mt-1",children:t.userCounts.leadPerson})]}),o.jsxs("div",{className:"border rounded-lg p-4 text-center",children:[o.jsx("h3",{className:"text-sm text-gray-500",children:"Managers"}),o.jsx("p",{className:"text-2xl font-bold mt-1",children:t.userCounts.manager})]}),o.jsxs("div",{className:"border rounded-lg p-4 text-center",children:[o.jsx("h3",{className:"text-sm text-gray-500",children:"Admins"}),o.jsx("p",{className:"text-2xl font-bold mt-1",children:t.userCounts.admin})]})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-lg font-medium",children:"Recent Leads"})}),o.jsxs("div",{className:"p-6",children:[t.recentLeads.length===0?o.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent leads found"}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200",children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),o.jsx("tbody",{children:t.recentLeads.map(f=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:f.name}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:f.course}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:m(f.createdAt)})]},f._id))})]})}),o.jsx("div",{className:"mt-4 text-right",children:o.jsx(Nt,{to:"/leads",className:"text-sm text-blue-600 hover:underline",children:"View all leads"})})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-lg font-medium",children:"Recent Sales"})}),o.jsxs("div",{className:"p-6",children:[t.recentSales.length===0?o.jsx("p",{className:"text-gray-500 text-center py-4",children:"No recent sales found"}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-gray-200",children:[o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),o.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"})]})}),o.jsx("tbody",{children:t.recentSales.map(f=>{var p;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:((p=f.leadId)==null?void 0:p.name)||"N/A"}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:f.product}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:kv(f.amount)})]},f._id)})})]})}),o.jsx("div",{className:"mt-4 text-right",children:o.jsx(Nt,{to:"/sales-tracking",className:"text-sm text-blue-600 hover:underline",children:"View all sales"})})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow",children:[o.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:o.jsx("h2",{className:"text-lg font-medium",children:"Quick Actions"})}),o.jsx("div",{className:"p-6",children:o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[o.jsx(Nt,{to:"/admin/users",className:"bg-blue-50 hover:bg-blue-100 transition p-4 rounded-lg text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-600 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"Manage Users"})]})}),o.jsx(Nt,{to:"/admin/leads",className:"bg-green-50 hover:bg-green-100 transition p-4 rounded-lg text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-green-600 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"Manage Leads"})]})}),o.jsx(Nt,{to:"/admin/reports",className:"bg-purple-50 hover:bg-purple-100 transition p-4 rounded-lg text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-purple-600 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"View Reports"})]})}),o.jsx(Nt,{to:"/sales-tracking",className:"bg-yellow-50 hover:bg-yellow-100 transition p-4 rounded-lg text-center",children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-yellow-600 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"text-gray-800 font-medium",children:"Sales Tracking"})]})})]})})]})]})]})})},H5=()=>{const{user:e}=Tr(),[t,r]=k.useState([]),[n,s]=k.useState(!0),[l,u]=k.useState(null),[h,m]=k.useState(""),[f,p]=k.useState(""),[g,y]=k.useState(!1),[v,S]=k.useState(!1),[N,w]=k.useState(null),[E,C]=k.useState(null),[T,O]=k.useState({fullName:"",email:"",password:"",role:"Sales Person"});k.useEffect(()=>{j()},[]);const j=async()=>{try{s(!0);const J=await fr.getUsers();J.data.success?r(J.data.data):u("Failed to load users")}catch(J){console.error("Error fetching users:",J),u("Failed to load users. Please try again.")}finally{s(!1)}},q=J=>{O({...T,[J.target.name]:J.target.value})},D=J=>{C({...E,[J.target.name]:J.target.value})},U=async J=>{var W,F;J.preventDefault();try{if(T.password.length<6){u("Password must be at least 6 characters");return}const Z=await fr.register(T);Z.success?(O({fullName:"",email:"",password:"",role:"Sales Person"}),y(!1),j()):u(Z.message||"Failed to create user")}catch(Z){console.error("Error creating user:",Z),u(((F=(W=Z.response)==null?void 0:W.data)==null?void 0:F.message)||"Failed to create user")}},K=async J=>{var W,F;J.preventDefault();try{if(E.password&&E.password.length>0&&E.password.length<6){u("Password must be at least 6 characters");return}s(!0);const Z=await fr.updateUser(E._id,E);Z.data&&Z.data.success?(S(!1),j(),u(null)):u(Z.data&&Z.data.message||"Failed to update user")}catch(Z){console.error("Error updating user:",Z),u(((F=(W=Z.response)==null?void 0:W.data)==null?void 0:F.message)||"Failed to update user. Please check your connection and try again.")}finally{s(!1)}},ie=async J=>{var W,F;try{s(!0);const Z=await fr.deleteUser(J);Z.data&&Z.data.success?(j(),w(null),u(null)):u(Z.data&&Z.data.message||"Failed to delete user")}catch(Z){console.error("Error deleting user:",Z),u(((F=(W=Z.response)==null?void 0:W.data)==null?void 0:F.message)||"Failed to delete user. Please check your connection and try again."),w(null)}finally{s(!1)}},te=J=>{C({_id:J._id,fullName:J.fullName,email:J.email,role:J.role,password:""}),S(!0)},G=J=>new Date(J).toLocaleDateString(),de=t.filter(J=>{const W=J.fullName.toLowerCase().includes(h.toLowerCase())||J.email.toLowerCase().includes(h.toLowerCase()),F=f===""||J.role===f;return W&&F});return o.jsxs(jr,{children:[o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold",children:"User Management"}),o.jsx("button",{onClick:()=>y(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:"Add New User"})]}),l&&o.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg mb-6",children:l}),o.jsx("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Users"}),o.jsx("input",{type:"text",id:"search",placeholder:"Search by name or email",value:h,onChange:J=>m(J.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"roleFilter",className:"block text-sm font-medium text-gray-700 mb-1",children:"Filter by Role"}),o.jsxs("select",{id:"roleFilter",value:f,onChange:J=>p(J.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Roles"}),o.jsx("option",{value:"Sales Person",children:"Sales Person"}),o.jsx("option",{value:"Lead Person",children:"Lead Person"}),o.jsx("option",{value:"Manager",children:"Manager"}),o.jsx("option",{value:"Admin",children:"Admin"})]})]}),o.jsx("div",{className:"flex items-end",children:o.jsx("button",{onClick:()=>{m(""),p("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",children:"Clear Filters"})})]})}),n?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):o.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:de.length===0?o.jsx("div",{className:"p-6 text-center text-gray-500",children:"No users found. Try adjusting your filters."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:de.map(J=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"h-10 w-10 flex-shrink-0 bg-gray-200 rounded-full flex items-center justify-center text-gray-500",children:J.fullName.charAt(0).toUpperCase()}),o.jsxs("div",{className:"ml-4",children:[o.jsx("div",{className:"text-sm font-medium text-gray-900",children:J.fullName}),o.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",J._id]})]})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:J.email})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${J.role==="Admin"?"bg-purple-100 text-purple-800":J.role==="Manager"?"bg-blue-100 text-blue-800":J.role==="Lead Person"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:J.role})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:G(J.createdAt)}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[J._id!==e.id&&o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>te(J),className:"text-blue-600 hover:text-blue-900 px-2 py-1",children:"Edit"}),o.jsx("button",{onClick:()=>w(J),className:"text-red-600 hover:text-red-900 px-2 py-1",children:"Delete"})]}),J._id===e.id&&o.jsx("span",{className:"text-gray-500",children:"Current User"})]})]},J._id))})]})})})]}),g&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full",children:[o.jsxs("div",{className:"flex justify-between items-center bg-blue-600 text-white px-6 py-4 rounded-t-lg",children:[o.jsx("h3",{className:"text-lg font-medium",children:"Add New User"}),o.jsx("button",{onClick:()=>y(!1),className:"text-white hover:text-gray-200 focus:outline-none",children:""})]}),o.jsxs("form",{onSubmit:U,className:"px-6 py-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),o.jsx("input",{type:"text",id:"fullName",name:"fullName",value:T.fullName,onChange:q,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx("input",{type:"email",id:"email",name:"email",value:T.email,onChange:q,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),o.jsx("input",{type:"password",id:"password",name:"password",value:T.password,onChange:q,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,minLength:6}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Password must be at least 6 characters"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),o.jsxs("select",{id:"role",name:"role",value:T.role,onChange:q,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:[o.jsx("option",{value:"Sales Person",children:"Sales Person"}),o.jsx("option",{value:"Lead Person",children:"Lead Person"}),o.jsx("option",{value:"Manager",children:"Manager"}),o.jsx("option",{value:"Admin",children:"Admin"})]}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Note: Only admins can create admin users. New admin accounts will require approval."})]}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>y(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:"Create User"})]})]})]})}),v&&E&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full",children:[o.jsxs("div",{className:"flex justify-between items-center bg-blue-600 text-white px-6 py-4 rounded-t-lg",children:[o.jsx("h3",{className:"text-lg font-medium",children:"Edit User"}),o.jsx("button",{onClick:()=>S(!1),className:"text-white hover:text-gray-200 focus:outline-none",children:""})]}),o.jsxs("form",{onSubmit:K,className:"px-6 py-4",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"editFullName",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),o.jsx("input",{type:"text",id:"editFullName",name:"fullName",value:E.fullName,onChange:D,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"editEmail",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx("input",{type:"email",id:"editEmail",name:"email",value:E.email,onChange:D,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"editPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),o.jsx("input",{type:"password",id:"editPassword",name:"password",value:E.password,onChange:D,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Leave blank to keep current password",minLength:E.password?6:0}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep current password. New password must be at least 6 characters."})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"editRole",className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),o.jsxs("select",{id:"editRole",name:"role",value:E.role,onChange:D,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,children:[o.jsx("option",{value:"Sales Person",children:"Sales Person"}),o.jsx("option",{value:"Lead Person",children:"Lead Person"}),o.jsx("option",{value:"Manager",children:"Manager"}),o.jsx("option",{value:"Admin",children:"Admin"})]})]}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-2",children:[o.jsx("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),o.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:"Update User"})]})]})]})}),N&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[o.jsx("h3",{className:"text-lg font-medium mb-4",children:"Confirm Delete"}),o.jsxs("p",{className:"mb-4",children:["Are you sure you want to delete user ",o.jsx("span",{className:"font-semibold",children:N.fullName}),"? This action cannot be undone."]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx("button",{onClick:()=>w(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition",children:"Cancel"}),o.jsx("button",{onClick:()=>ie(N._id),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition",children:"Delete"})]})]})})]})},Y5=()=>{const{user:e}=Tr(),[t,r]=k.useState([]),[n,s]=k.useState([]),[l,u]=k.useState(!0),[h,m]=k.useState(null),[f,p]=k.useState({search:"",status:"",country:"",course:"",source:"",dateFrom:"",dateTo:"",assignedTo:"",leadPerson:""}),[g,y]=k.useState({countries:[],courses:[],sources:[],salesPersons:[],leadPersons:[]}),v=["New","Contacted","Qualified","Lost","Converted","Introduction","Acknowledgement","Question","Future Promise","Payment","Analysis"];k.useEffect(()=>{S(),N()},[]),k.useEffect(()=>{t.length>0&&(T(),w())},[t,f]);const S=async()=>{try{u(!0);const j=await Fn.getAll();j.data.success?(r(j.data.data),s(j.data.data),m(null)):m("Failed to load leads")}catch(j){console.error("Error fetching leads:",j),m("Failed to load leads. Please try again.")}finally{u(!1)}},N=async()=>{try{const j=await fr.getUsers("Sales Person"),q=await fr.getUsers("Lead Person");y(D=>({...D,salesPersons:j.data.data||[],leadPersons:q.data.data||[]}))}catch(j){console.error("Error fetching user options:",j)}},w=()=>{const j=[...new Set(t.map(U=>U.country).filter(Boolean))],q=[...new Set(t.map(U=>U.course).filter(Boolean))],D=[...new Set(t.map(U=>U.source).filter(Boolean))];y(U=>({...U,countries:j,courses:q,sources:D}))},E=j=>{const{name:q,value:D}=j.target;p(U=>({...U,[q]:D}))},C=()=>{p({search:"",status:"",country:"",course:"",source:"",dateFrom:"",dateTo:"",assignedTo:"",leadPerson:""})},T=()=>{let j=[...t];if(f.search){const q=f.search.toLowerCase();j=j.filter(D=>D.name&&D.name.toLowerCase().includes(q)||D.email&&D.email.toLowerCase().includes(q)||D.phone&&D.phone.includes(q)||D.pseudoId&&D.pseudoId.toLowerCase().includes(q))}if(f.status&&(j=j.filter(q=>q.status===f.status)),f.country&&(j=j.filter(q=>q.country===f.country)),f.course&&(j=j.filter(q=>q.course===f.course)),f.source&&(j=j.filter(q=>q.source===f.source)),f.dateFrom){const q=new Date(f.dateFrom);j=j.filter(D=>new Date(D.createdAt)>=q)}if(f.dateTo){const q=new Date(f.dateTo);q.setHours(23,59,59,999),j=j.filter(D=>new Date(D.createdAt)<=q)}f.assignedTo&&(j=j.filter(q=>q.assignedTo&&q.assignedTo._id===f.assignedTo)),f.leadPerson&&(j=j.filter(q=>q.leadPerson&&q.leadPerson._id===f.leadPerson)),s(j)},O=j=>new Date(j).toLocaleDateString();return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Admin Leads Management"}),o.jsx(Nt,{to:"/leads",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:"Standard Leads View"})]}),h&&o.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg mb-6",children:h}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-lg font-medium",children:"Advanced Filters"}),o.jsx("button",{onClick:C,className:"text-sm text-blue-600 hover:underline",children:"Reset Filters"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),o.jsx("input",{type:"text",id:"search",name:"search",placeholder:"Search name, email, phone...",value:f.search,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),o.jsxs("select",{id:"status",name:"status",value:f.status,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Statuses"}),v.map(j=>o.jsx("option",{value:j,children:j},j))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),o.jsxs("select",{id:"country",name:"country",value:f.country,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Countries"}),g.countries.map(j=>o.jsx("option",{value:j,children:j},j))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"course",className:"block text-sm font-medium text-gray-700 mb-1",children:"Course"}),o.jsxs("select",{id:"course",name:"course",value:f.course,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Courses"}),g.courses.map(j=>o.jsx("option",{value:j,children:j},j))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"source",className:"block text-sm font-medium text-gray-700 mb-1",children:"Source"}),o.jsxs("select",{id:"source",name:"source",value:f.source,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Sources"}),g.sources.map(j=>o.jsx("option",{value:j,children:j},j))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"dateFrom",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),o.jsx("input",{type:"date",id:"dateFrom",name:"dateFrom",value:f.dateFrom,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"dateTo",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),o.jsx("input",{type:"date",id:"dateTo",name:"dateTo",value:f.dateTo,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"assignedTo",className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),o.jsxs("select",{id:"assignedTo",name:"assignedTo",value:f.assignedTo,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Sales Persons"}),g.salesPersons.map(j=>o.jsx("option",{value:j._id,children:j.fullName},j._id))]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"leadPerson",className:"block text-sm font-medium text-gray-700 mb-1",children:"Lead Person"}),o.jsxs("select",{id:"leadPerson",name:"leadPerson",value:f.leadPerson,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[o.jsx("option",{value:"",children:"All Lead Persons"}),g.leadPersons.map(j=>o.jsx("option",{value:j._id,children:j.fullName},j._id))]})]})]})]}),l?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[o.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[o.jsxs("h3",{className:"text-lg font-medium",children:[n.length," Leads Found"]}),o.jsxs("div",{className:"text-sm text-gray-500",children:["Showing filtered results from a total of ",t.length," leads"]})]}),n.length===0?o.jsx("div",{className:"p-6 text-center text-gray-500",children:"No leads found matching your filters. Try adjusting your criteria."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Country"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Assigned To"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lead By"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(j=>{var q;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[j.name,j.isRepeatCustomer&&o.jsx("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",title:`Repeat customer! Previous courses: ${((q=j.previousCourses)==null?void 0:q.join(", "))||"None"}`,children:"Repeat"})]}),o.jsx("div",{className:"text-sm text-gray-500",children:j.pseudoId})]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[o.jsx("div",{className:"text-sm text-gray-900",children:j.email}),o.jsxs("div",{className:"text-sm text-gray-500",children:[j.countryCode," ",j.phone]})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("div",{className:"text-sm text-gray-900",children:j.course})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${j.status==="Introduction"?"bg-blue-100 text-blue-800":j.status==="Acknowledgement"?"bg-yellow-100 text-yellow-800":j.status==="Question"?"bg-purple-100 text-purple-800":j.status==="Future Promise"?"bg-red-100 text-red-800":j.status==="Payment"?"bg-green-100 text-green-800":(j.status==="Analysis","bg-gray-100 text-gray-800")}
                          `,children:j.status})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.country}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.assignedTo?j.assignedTo.fullName:"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.leadPerson?j.leadPerson.fullName:"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O(j.createdAt)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.jsx(Nt,{to:`/leads#${j._id}`,className:"text-blue-600 hover:text-blue-900 mr-3",children:"View"})})]},j._id)})})]})})]})]})})},G5=()=>{const{user:e}=Tr(),[t,r]=k.useState("leads"),[n,s]=k.useState(!1),[l,u]=k.useState(0),[h,m]=k.useState(null),[f,p]=k.useState(null),[g,y]=k.useState(null),[v,S]=k.useState(null);if((e==null?void 0:e.role)!=="Admin")return o.jsx(jr,{children:o.jsx("div",{className:"container mx-auto p-6",children:o.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg mb-6",children:"Access denied. Only administrators can access this page."})})});const N=q=>{const D=q.target.files[0];D&&D.type==="text/csv"?p(D):(Ot.error("Please upload a valid CSV file"),q.target.value=null)},w=q=>{const D=q.target.files[0];D&&D.type==="text/csv"?y(D):(Ot.error("Please upload a valid CSV file"),q.target.value=null)},E=q=>{const D=q.target.files[0];D&&D.type==="text/csv"?S(D):(Ot.error("Please upload a valid CSV file"),q.target.value=null)},C=async q=>new Promise((D,U)=>{const K=new FileReader;K.onload=ie=>{try{const G=ie.target.result.split(`
`),de=G[0].split(",").map(W=>W.trim()),J=[];for(let W=1;W<G.length;W++){if(G[W].trim()==="")continue;const F=[];let Z="",oe=!1;for(let R of G[W])R==='"'?oe=!oe:R===","&&!oe?(F.push(Z),Z=""):Z+=R;F.push(Z);const le={};de.forEach((R,ne)=>{ne<F.length&&(le[R]=F[ne].replace(/^"|"$/g,"").trim())}),J.push(le)}D(J)}catch(te){U(te)}},K.onerror=ie=>U(ie),K.readAsText(q)}),T=async()=>{var q,D;if(!f){Ot.error("Please select a CSV file to import");return}s(!0),u(10),m(null);try{const U=await C(f);if(u(50),U.length===0){Ot.error("No data found in the CSV file"),s(!1),u(0);return}const K=await Fn.importLeads({leads:U});u(100),m({total:U.length,imported:K.data.count,errors:U.length-K.data.count}),Ot.success(`Successfully imported ${K.data.count} leads`)}catch(U){console.error("Import error:",U),Ot.error(((D=(q=U.response)==null?void 0:q.data)==null?void 0:D.message)||"Failed to import leads")}finally{s(!1)}},O=async()=>{var q,D;if(!g){Ot.error("Please select a CSV file to import");return}s(!0),u(10),m(null);try{const U=await C(g);if(u(50),U.length===0){Ot.error("No data found in the CSV file"),s(!1),u(0);return}const K=await Wn.importSales({sales:U});u(100),m({total:U.length,imported:K.data.count,errors:K.data.errorCount||0,errorDetails:K.data.errors}),Ot.success(`Successfully imported ${K.data.count} sales`)}catch(U){console.error("Import error:",U),Ot.error(((D=(q=U.response)==null?void 0:q.data)==null?void 0:D.message)||"Failed to import sales")}finally{s(!1)}},j=async()=>{var q,D;if(!v){Ot.error("Please select a CSV file to import");return}s(!0),u(10),m(null);try{const U=await C(v);if(u(50),U.length===0){Ot.error("No data found in the CSV file"),s(!1),u(0);return}const K=U.map(te=>({name:te.Name||te["Full Name"]||te["Your name"],email:te.Email||te["Email Address"]||te["Your email"],phone:te.Phone||te["Phone Number"]||te.Mobile,countryCode:te["Country Code"]||"+1",country:te.Country||"Unknown",course:te.Course||te.Program||te.Interest||"General Inquiry",source:"Google Forms",sourceLink:te["Form URL"]||"",remarks:te.Comments||te.Message||""})),ie=await Fn.importLeads({leads:K});u(100),m({total:K.length,imported:ie.data.count,errors:K.length-ie.data.count}),Ot.success(`Successfully imported ${ie.data.count} leads from Google Forms`)}catch(U){console.error("Import error:",U),Ot.error(((D=(q=U.response)==null?void 0:q.data)==null?void 0:D.message)||"Failed to import Google Forms data")}finally{s(!1)}};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-6",children:[o.jsx("div",{className:"flex justify-between items-center mb-6",children:o.jsx("h1",{className:"text-3xl font-bold",children:"Data Import"})}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[o.jsx("div",{className:"border-b border-gray-200",children:o.jsxs("nav",{className:"flex -mb-px",children:[o.jsx("button",{onClick:()=>r("leads"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${t==="leads"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Import Leads"}),o.jsx("button",{onClick:()=>r("sales"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${t==="sales"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Import Sales"}),o.jsx("button",{onClick:()=>r("google-forms"),className:`py-4 px-6 text-center border-b-2 font-medium text-sm ${t==="google-forms"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Import Google Forms"})]})}),o.jsxs("div",{className:"p-6",children:[t==="leads"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-medium mb-4",children:"Import Leads from CSV"}),o.jsx("p",{className:"mb-4 text-gray-600",children:"Upload a CSV file exported from Google Sheets containing lead information. Make sure your file has headers for: Name, Email, Phone, Country, Course, and other lead properties."}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload CSV File"}),o.jsx("input",{type:"file",accept:".csv",onChange:N,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:n}),f&&o.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Selected file: ",f.name]})]}),o.jsx("button",{onClick:T,disabled:n||!f,className:`px-4 py-2 rounded-md text-white ${n||!f?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} transition`,children:n?"Importing...":"Import Leads"})]}),t==="sales"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-medium mb-4",children:"Import Sales from CSV"}),o.jsx("p",{className:"mb-4 text-gray-600",children:"Upload a CSV file exported from Google Sheets containing sales information. Make sure your file has headers for: Email or Phone (to identify the lead), Amount, Product, Status, and other sales properties."}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload CSV File"}),o.jsx("input",{type:"file",accept:".csv",onChange:w,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:n}),g&&o.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Selected file: ",g.name]})]}),o.jsx("button",{onClick:O,disabled:n||!g,className:`px-4 py-2 rounded-md text-white ${n||!g?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} transition`,children:n?"Importing...":"Import Sales"})]}),t==="google-forms"&&o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-medium mb-4",children:"Import Google Forms Responses"}),o.jsx("p",{className:"mb-4 text-gray-600",children:"Upload a CSV file exported from Google Forms containing lead information. The system will try to map common Google Forms fields to the appropriate lead properties."}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload CSV File"}),o.jsx("input",{type:"file",accept:".csv",onChange:E,className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:n}),v&&o.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Selected file: ",v.name]})]}),o.jsx("button",{onClick:j,disabled:n||!v,className:`px-4 py-2 rounded-md text-white ${n||!v?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} transition`,children:n?"Importing...":"Import Google Forms Data"})]}),n&&o.jsx("div",{className:"mt-6",children:o.jsxs("div",{className:"relative pt-1",children:[o.jsxs("div",{className:"flex mb-2 items-center justify-between",children:[o.jsx("div",{children:o.jsx("span",{className:"text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200",children:"Progress"})}),o.jsx("div",{className:"text-right",children:o.jsxs("span",{className:"text-xs font-semibold inline-block text-blue-600",children:[l,"%"]})})]}),o.jsx("div",{className:"overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200",children:o.jsx("div",{style:{width:`${l}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500 transition-all duration-500"})})]})}),h&&o.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[o.jsx("h3",{className:"text-lg font-medium mb-2",children:"Import Summary"}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[o.jsxs("div",{className:"bg-blue-50 p-3 rounded-md",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Total Records"}),o.jsx("p",{className:"text-xl font-bold",children:h.total})]}),o.jsxs("div",{className:"bg-green-50 p-3 rounded-md",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Successfully Imported"}),o.jsx("p",{className:"text-xl font-bold text-green-600",children:h.imported})]}),o.jsxs("div",{className:"bg-red-50 p-3 rounded-md",children:[o.jsx("p",{className:"text-sm text-gray-600",children:"Failed Records"}),o.jsx("p",{className:"text-xl font-bold text-red-600",children:h.errors})]})]}),h.errorDetails&&h.errorDetails.length>0&&o.jsxs("div",{className:"mt-4",children:[o.jsx("h4",{className:"text-md font-medium mb-2",children:"Error Details"}),o.jsx("div",{className:"max-h-40 overflow-y-auto bg-white p-2 rounded border border-gray-300",children:o.jsxs("ul",{className:"text-sm text-gray-700",children:[h.errorDetails.slice(0,10).map((q,D)=>o.jsx("li",{className:"mb-1 pb-1 border-b border-gray-200",children:q.message},D)),h.errorDetails.length>10&&o.jsxs("li",{className:"text-gray-500 italic",children:["...and ",h.errorDetails.length-10," more errors"]})]})})]})]})]})]}),o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden p-6",children:[o.jsx("h2",{className:"text-lg font-medium mb-4",children:"Import Instructions"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"text-md font-semibold mb-2",children:"Required Fields"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"font-medium text-blue-600",children:"Leads Sheet:"}),o.jsxs("ul",{className:"list-disc ml-5 text-sm text-gray-600",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Name"})," - Lead's full name"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Email"})," - Lead's email address"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Phone"})," - Lead's phone number"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"CountryCode"})," - Phone country code (e.g., +1, +91)"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Country"})," - Lead's country"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Course"})," - Course/product of interest"]}),o.jsx("li",{children:"Optional: PseudoId, Company, Client, Status, Source, SourceLink, Remarks, Feedback"})]})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"font-medium text-blue-600",children:"Sales Sheet:"}),o.jsxs("ul",{className:"list-disc ml-5 text-sm text-gray-600",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Email"})," or ",o.jsx("strong",{children:"Phone"})," - To identify the associated lead"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Amount"})," - Sale amount"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Product"})," - Product/service sold"]}),o.jsx("li",{children:"Optional: Token, Status (Pending/Closed), Notes"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-blue-600",children:"Google Forms:"}),o.jsxs("ul",{className:"list-disc ml-5 text-sm text-gray-600",children:[o.jsx("li",{children:"The system automatically maps common Google Forms field names"}),o.jsx("li",{children:"Ensure your form includes name, email, phone, and course interest fields"})]})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-md font-semibold mb-2",children:"Export Instructions"}),o.jsxs("ol",{className:"list-decimal ml-5 text-sm text-gray-600",children:[o.jsx("li",{children:"Open your Google Sheet"}),o.jsxs("li",{children:["Go to ",o.jsx("strong",{children:"File"})," > ",o.jsx("strong",{children:"Download"})," > ",o.jsx("strong",{children:"Comma-separated values (.csv)"})]}),o.jsx("li",{children:"Save the file to your computer"}),o.jsx("li",{children:"Upload the CSV file using the form above"})]})]})]})]})})},kn=({children:e,allowedRoles:t})=>{const{user:r,loading:n}=Tr();return n?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r?t.includes(r.role)?e:o.jsx(Mm,{to:"/",replace:!0}):o.jsx(Mm,{to:"/login",replace:!0})},Hv="/assets/ForgotPassword-CiiIXMXF.jpg",t4=k.createContext({});function q5(e){const t=k.useRef(null);return t.current===null&&(t.current=e()),t.current}const Mp=typeof window<"u",$5=Mp?k.useLayoutEffect:k.useEffect,Fp=k.createContext(null),r4=k.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function W5(e=!0){const t=k.useContext(Fp);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,l=k.useId();k.useEffect(()=>{if(e)return s(l)},[e]);const u=k.useCallback(()=>e&&n&&n(l),[l,n,e]);return!r&&n?[!1,u]:[!0]}function Lp(e,t){e.indexOf(t)===-1&&e.push(t)}function Pp(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const vs=(e,t,r)=>r>t?t:r<e?e:r;let Bp=()=>{};const bs={},n4=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),a4=e=>/^0[^.\s]+$/u.test(e);function Up(e){let t;return()=>(t===void 0&&(t=e()),t)}const fa=e=>e,X5=(e,t)=>r=>t(e(r)),ou=(...e)=>e.reduce(X5),Pc=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class Ip{constructor(){this.subscriptions=[]}add(t){return Lp(this.subscriptions,t),()=>Pp(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let l=0;l<s;l++){const u=this.subscriptions[l];u&&u(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ya=e=>e*1e3,Ga=e=>e/1e3;function s4(e,t){return t?e*(1e3/t):0}const i4=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,K5=1e-7,Q5=12;function Z5(e,t,r,n,s){let l,u,h=0;do u=t+(r-t)/2,l=i4(u,n,s)-e,l>0?r=u:t=u;while(Math.abs(l)>K5&&++h<Q5);return u}function lu(e,t,r,n){if(e===t&&r===n)return fa;const s=l=>Z5(l,0,1,e,r);return l=>l===0||l===1?l:i4(s(l),t,n)}const o4=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,l4=e=>t=>1-e(1-t),c4=lu(.33,1.53,.69,.99),zp=l4(c4),u4=o4(zp),d4=e=>(e*=2)<1?.5*zp(e):.5*(2-Math.pow(2,-10*(e-1))),Vp=e=>1-Math.sin(Math.acos(e)),f4=l4(Vp),h4=o4(Vp),J5=lu(.42,0,1,1),ej=lu(0,0,.58,1),m4=lu(.42,0,.58,1),tj=e=>Array.isArray(e)&&typeof e[0]!="number",p4=e=>Array.isArray(e)&&typeof e[0]=="number",rj={linear:fa,easeIn:J5,easeInOut:m4,easeOut:ej,circIn:Vp,circInOut:h4,circOut:f4,backIn:zp,backInOut:u4,backOut:c4,anticipate:d4},nj=e=>typeof e=="string",Yv=e=>{if(p4(e)){Bp(e.length===4);const[t,r,n,s]=e;return lu(t,r,n,s)}else if(nj(e))return rj[e];return e},Cd=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Gv={value:null};function aj(e,t){let r=new Set,n=new Set,s=!1,l=!1;const u=new WeakSet;let h={delta:0,timestamp:0,isProcessing:!1},m=0;function f(g){u.has(g)&&(p.schedule(g),e()),m++,g(h)}const p={schedule:(g,y=!1,v=!1)=>{const N=v&&s?r:n;return y&&u.add(g),N.has(g)||N.add(g),g},cancel:g=>{n.delete(g),u.delete(g)},process:g=>{if(h=g,s){l=!0;return}s=!0,[r,n]=[n,r],r.forEach(f),t&&Gv.value&&Gv.value.frameloop[t].push(m),m=0,r.clear(),s=!1,l&&(l=!1,p.process(g))}};return p}const sj=40;function x4(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},l=()=>r=!0,u=Cd.reduce((T,O)=>(T[O]=aj(l,t?O:void 0),T),{}),{setup:h,read:m,resolveKeyframes:f,preUpdate:p,update:g,preRender:y,render:v,postRender:S}=u,N=()=>{const T=bs.useManualTiming?s.timestamp:performance.now();r=!1,bs.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(T-s.timestamp,sj),1)),s.timestamp=T,s.isProcessing=!0,h.process(s),m.process(s),f.process(s),p.process(s),g.process(s),y.process(s),v.process(s),S.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(N))},w=()=>{r=!0,n=!0,s.isProcessing||e(N)};return{schedule:Cd.reduce((T,O)=>{const j=u[O];return T[O]=(q,D=!1,U=!1)=>(r||w(),j.schedule(q,D,U)),T},{}),cancel:T=>{for(let O=0;O<Cd.length;O++)u[Cd[O]].cancel(T)},state:s,steps:u}}const{schedule:xr,cancel:ai,state:an,steps:cm}=x4(typeof requestAnimationFrame<"u"?requestAnimationFrame:fa,!0);let $d;function ij(){$d=void 0}const On={now:()=>($d===void 0&&On.set(an.isProcessing||bs.useManualTiming?an.timestamp:performance.now()),$d),set:e=>{$d=e,queueMicrotask(ij)}},g4=e=>t=>typeof t=="string"&&t.startsWith(e),Hp=g4("--"),oj=g4("var(--"),Yp=e=>oj(e)?lj.test(e.split("/*")[0].trim()):!1,lj=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ll={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Bc={...ll,transform:e=>vs(0,1,e)},Ad={...ll,default:1},Nc=e=>Math.round(e*1e5)/1e5,Gp=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function cj(e){return e==null}const uj=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,qp=(e,t)=>r=>!!(typeof r=="string"&&uj.test(r)&&r.startsWith(e)||t&&!cj(r)&&Object.prototype.hasOwnProperty.call(r,t)),y4=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,l,u,h]=n.match(Gp);return{[e]:parseFloat(s),[t]:parseFloat(l),[r]:parseFloat(u),alpha:h!==void 0?parseFloat(h):1}},dj=e=>vs(0,255,e),um={...ll,transform:e=>Math.round(dj(e))},Bi={test:qp("rgb","red"),parse:y4("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+um.transform(e)+", "+um.transform(t)+", "+um.transform(r)+", "+Nc(Bc.transform(n))+")"};function fj(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Qm={test:qp("#"),parse:fj,transform:Bi.transform},cu=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Js=cu("deg"),qa=cu("%"),pt=cu("px"),hj=cu("vh"),mj=cu("vw"),qv={...qa,parse:e=>qa.parse(e)/100,transform:e=>qa.transform(e*100)},Go={test:qp("hsl","hue"),parse:y4("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+qa.transform(Nc(t))+", "+qa.transform(Nc(r))+", "+Nc(Bc.transform(n))+")"},pn={test:e=>Bi.test(e)||Qm.test(e)||Go.test(e),parse:e=>Bi.test(e)?Bi.parse(e):Go.test(e)?Go.parse(e):Qm.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Bi.transform(e):Go.transform(e)},pj=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function xj(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Gp))==null?void 0:t.length)||0)+(((r=e.match(pj))==null?void 0:r.length)||0)>0}const v4="number",b4="color",gj="var",yj="var(",$v="${}",vj=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Uc(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let l=0;const h=t.replace(vj,m=>(pn.test(m)?(n.color.push(l),s.push(b4),r.push(pn.parse(m))):m.startsWith(yj)?(n.var.push(l),s.push(gj),r.push(m)):(n.number.push(l),s.push(v4),r.push(parseFloat(m))),++l,$v)).split($v);return{values:r,split:h,indexes:n,types:s}}function w4(e){return Uc(e).values}function S4(e){const{split:t,types:r}=Uc(e),n=t.length;return s=>{let l="";for(let u=0;u<n;u++)if(l+=t[u],s[u]!==void 0){const h=r[u];h===v4?l+=Nc(s[u]):h===b4?l+=pn.transform(s[u]):l+=s[u]}return l}}const bj=e=>typeof e=="number"?0:e;function wj(e){const t=w4(e);return S4(e)(t.map(bj))}const si={test:xj,parse:w4,createTransformer:S4,getAnimatableNone:wj};function dm(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Sj({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,l=0,u=0;if(!t)s=l=u=r;else{const h=r<.5?r*(1+t):r+t-r*t,m=2*r-h;s=dm(m,h,e+1/3),l=dm(m,h,e),u=dm(m,h,e-1/3)}return{red:Math.round(s*255),green:Math.round(l*255),blue:Math.round(u*255),alpha:n}}function sf(e,t){return r=>r>0?t:e}const pr=(e,t,r)=>e+(t-e)*r,fm=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},Nj=[Qm,Bi,Go],Tj=e=>Nj.find(t=>t.test(e));function Wv(e){const t=Tj(e);if(!t)return!1;let r=t.parse(e);return t===Go&&(r=Sj(r)),r}const Xv=(e,t)=>{const r=Wv(e),n=Wv(t);if(!r||!n)return sf(e,t);const s={...r};return l=>(s.red=fm(r.red,n.red,l),s.green=fm(r.green,n.green,l),s.blue=fm(r.blue,n.blue,l),s.alpha=pr(r.alpha,n.alpha,l),Bi.transform(s))},Zm=new Set(["none","hidden"]);function Ej(e,t){return Zm.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function _j(e,t){return r=>pr(e,t,r)}function $p(e){return typeof e=="number"?_j:typeof e=="string"?Yp(e)?sf:pn.test(e)?Xv:jj:Array.isArray(e)?N4:typeof e=="object"?pn.test(e)?Xv:Cj:sf}function N4(e,t){const r=[...e],n=r.length,s=e.map((l,u)=>$p(l)(l,t[u]));return l=>{for(let u=0;u<n;u++)r[u]=s[u](l);return r}}function Cj(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=$p(e[s])(e[s],t[s]));return s=>{for(const l in n)r[l]=n[l](s);return r}}function Aj(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const l=t.types[s],u=e.indexes[l][n[l]],h=e.values[u]??0;r[s]=h,n[l]++}return r}const jj=(e,t)=>{const r=si.createTransformer(t),n=Uc(e),s=Uc(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Zm.has(e)&&!s.values.length||Zm.has(t)&&!n.values.length?Ej(e,t):ou(N4(Aj(n,s),s.values),r):sf(e,t)};function T4(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?pr(e,t,r):$p(e)(e,t)}const Dj=e=>{const t=({timestamp:r})=>e(r);return{start:()=>xr.update(t,!0),stop:()=>ai(t),now:()=>an.isProcessing?an.timestamp:On.now()}},E4=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let l=0;l<s;l++)n+=e(l/(s-1))+", ";return`linear(${n.substring(0,n.length-2)})`},of=2e4;function Wp(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<of;)t+=r,n=e.next(t);return t>=of?1/0:t}function kj(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(Wp(n),of);return{type:"keyframes",ease:l=>n.next(s*l).value/t,duration:Ga(s)}}const Oj=5;function _4(e,t,r){const n=Math.max(t-Oj,0);return s4(r-e(n),t-n)}const wr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Kv=.001;function Rj({duration:e=wr.duration,bounce:t=wr.bounce,velocity:r=wr.velocity,mass:n=wr.mass}){let s,l,u=1-t;u=vs(wr.minDamping,wr.maxDamping,u),e=vs(wr.minDuration,wr.maxDuration,Ga(e)),u<1?(s=f=>{const p=f*u,g=p*e,y=p-r,v=Jm(f,u),S=Math.exp(-g);return Kv-y/v*S},l=f=>{const g=f*u*e,y=g*r+r,v=Math.pow(u,2)*Math.pow(f,2)*e,S=Math.exp(-g),N=Jm(Math.pow(f,2),u);return(-s(f)+Kv>0?-1:1)*((y-v)*S)/N}):(s=f=>{const p=Math.exp(-f*e),g=(f-r)*e+1;return-.001+p*g},l=f=>{const p=Math.exp(-f*e),g=(r-f)*(e*e);return p*g});const h=5/e,m=Fj(s,l,h);if(e=Ya(e),isNaN(m))return{stiffness:wr.stiffness,damping:wr.damping,duration:e};{const f=Math.pow(m,2)*n;return{stiffness:f,damping:u*2*Math.sqrt(n*f),duration:e}}}const Mj=12;function Fj(e,t,r){let n=r;for(let s=1;s<Mj;s++)n=n-e(n)/t(n);return n}function Jm(e,t){return e*Math.sqrt(1-t*t)}const Lj=["duration","bounce"],Pj=["stiffness","damping","mass"];function Qv(e,t){return t.some(r=>e[r]!==void 0)}function Bj(e){let t={velocity:wr.velocity,stiffness:wr.stiffness,damping:wr.damping,mass:wr.mass,isResolvedFromDuration:!1,...e};if(!Qv(e,Pj)&&Qv(e,Lj))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,l=2*vs(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:wr.mass,stiffness:s,damping:l}}else{const r=Rj(e);t={...t,...r,mass:wr.mass},t.isResolvedFromDuration=!0}return t}function lf(e=wr.visualDuration,t=wr.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const l=r.keyframes[0],u=r.keyframes[r.keyframes.length-1],h={done:!1,value:l},{stiffness:m,damping:f,mass:p,duration:g,velocity:y,isResolvedFromDuration:v}=Bj({...r,velocity:-Ga(r.velocity||0)}),S=y||0,N=f/(2*Math.sqrt(m*p)),w=u-l,E=Ga(Math.sqrt(m/p)),C=Math.abs(w)<5;n||(n=C?wr.restSpeed.granular:wr.restSpeed.default),s||(s=C?wr.restDelta.granular:wr.restDelta.default);let T;if(N<1){const j=Jm(E,N);T=q=>{const D=Math.exp(-N*E*q);return u-D*((S+N*E*w)/j*Math.sin(j*q)+w*Math.cos(j*q))}}else if(N===1)T=j=>u-Math.exp(-E*j)*(w+(S+E*w)*j);else{const j=E*Math.sqrt(N*N-1);T=q=>{const D=Math.exp(-N*E*q),U=Math.min(j*q,300);return u-D*((S+N*E*w)*Math.sinh(U)+j*w*Math.cosh(U))/j}}const O={calculatedDuration:v&&g||null,next:j=>{const q=T(j);if(v)h.done=j>=g;else{let D=j===0?S:0;N<1&&(D=j===0?Ya(S):_4(T,j,q));const U=Math.abs(D)<=n,K=Math.abs(u-q)<=s;h.done=U&&K}return h.value=h.done?u:q,h},toString:()=>{const j=Math.min(Wp(O),of),q=E4(D=>O.next(j*D).value,j,30);return j+"ms "+q},toTransition:()=>{}};return O}lf.applyToOptions=e=>{const t=kj(e,100,lf);return e.ease=t.ease,e.duration=Ya(t.duration),e.type="keyframes",e};function ep({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:l=500,modifyTarget:u,min:h,max:m,restDelta:f=.5,restSpeed:p}){const g=e[0],y={done:!1,value:g},v=U=>h!==void 0&&U<h||m!==void 0&&U>m,S=U=>h===void 0?m:m===void 0||Math.abs(h-U)<Math.abs(m-U)?h:m;let N=r*t;const w=g+N,E=u===void 0?w:u(w);E!==w&&(N=E-g);const C=U=>-N*Math.exp(-U/n),T=U=>E+C(U),O=U=>{const K=C(U),ie=T(U);y.done=Math.abs(K)<=f,y.value=y.done?E:ie};let j,q;const D=U=>{v(y.value)&&(j=U,q=lf({keyframes:[y.value,S(y.value)],velocity:_4(T,U,y.value),damping:s,stiffness:l,restDelta:f,restSpeed:p}))};return D(0),{calculatedDuration:null,next:U=>{let K=!1;return!q&&j===void 0&&(K=!0,O(U),D(U)),j!==void 0&&U>=j?q.next(U-j):(!K&&O(U),y)}}}function Uj(e,t,r){const n=[],s=r||bs.mix||T4,l=e.length-1;for(let u=0;u<l;u++){let h=s(e[u],e[u+1]);if(t){const m=Array.isArray(t)?t[u]||fa:t;h=ou(m,h)}n.push(h)}return n}function Ij(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const l=e.length;if(Bp(l===t.length),l===1)return()=>t[0];if(l===2&&t[0]===t[1])return()=>t[1];const u=e[0]===e[1];e[0]>e[l-1]&&(e=[...e].reverse(),t=[...t].reverse());const h=Uj(t,n,s),m=h.length,f=p=>{if(u&&p<e[0])return t[0];let g=0;if(m>1)for(;g<e.length-2&&!(p<e[g+1]);g++);const y=Pc(e[g],e[g+1],p);return h[g](y)};return r?p=>f(vs(e[0],e[l-1],p)):f}function zj(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Pc(0,t,n);e.push(pr(r,1,s))}}function Vj(e){const t=[0];return zj(t,e.length-1),t}function Hj(e,t){return e.map(r=>r*t)}function Yj(e,t){return e.map(()=>t||m4).splice(0,e.length-1)}function Tc({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=tj(n)?n.map(Yv):Yv(n),l={done:!1,value:t[0]},u=Hj(r&&r.length===t.length?r:Vj(t),e),h=Ij(u,t,{ease:Array.isArray(s)?s:Yj(t,s)});return{calculatedDuration:e,next:m=>(l.value=h(m),l.done=m>=e,l)}}const Gj=e=>e!==null;function Xp(e,{repeat:t,repeatType:r="loop"},n,s=1){const l=e.filter(Gj),h=s<0||t&&r!=="loop"&&t%2===1?0:l.length-1;return!h||n===void 0?l[h]:n}const qj={decay:ep,inertia:ep,tween:Tc,keyframes:Tc,spring:lf};function C4(e){typeof e.type=="string"&&(e.type=qj[e.type])}class Kp{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const $j=e=>e/100;class A4 extends Kp{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;if(r&&r.updatedAt!==On.now()&&this.tick(On.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:n}=this.options;n&&n()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;C4(t);const{type:r=Tc,repeat:n=0,repeatDelay:s=0,repeatType:l,velocity:u=0}=t;let{keyframes:h}=t;const m=r||Tc;m!==Tc&&typeof h[0]!="number"&&(this.mixKeyframes=ou($j,T4(h[0],h[1])),h=[0,100]);const f=m({...t,keyframes:h});l==="mirror"&&(this.mirroredGenerator=m({...t,keyframes:[...h].reverse(),velocity:-u})),f.calculatedDuration===null&&(f.calculatedDuration=Wp(f));const{calculatedDuration:p}=f;this.calculatedDuration=p,this.resolvedDuration=p+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=f}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:l,mirroredGenerator:u,resolvedDuration:h,calculatedDuration:m}=this;if(this.startTime===null)return n.next(0);const{delay:f=0,keyframes:p,repeat:g,repeatType:y,repeatDelay:v,type:S,onUpdate:N,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const E=this.currentTime-f*(this.playbackSpeed>=0?1:-1),C=this.playbackSpeed>=0?E<0:E>s;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let T=this.currentTime,O=n;if(g){const U=Math.min(this.currentTime,s)/h;let K=Math.floor(U),ie=U%1;!ie&&U>=1&&(ie=1),ie===1&&K--,K=Math.min(K,g+1),!!(K%2)&&(y==="reverse"?(ie=1-ie,v&&(ie-=v/h)):y==="mirror"&&(O=u)),T=vs(0,1,ie)*h}const j=C?{done:!1,value:p[0]}:O.next(T);l&&(j.value=l(j.value));let{done:q}=j;!C&&m!==null&&(q=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&q);return D&&S!==ep&&(j.value=Xp(p,this.options,w,this.speed)),N&&N(j.value),D&&this.finish(),j}then(t,r){return this.finished.then(t,r)}get duration(){return Ga(this.calculatedDuration)}get time(){return Ga(this.currentTime)}set time(t){t=Ya(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(On.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Ga(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Dj,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(l=>this.tick(l))),r&&r();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=n??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(On.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function Wj(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Ui=e=>e*180/Math.PI,tp=e=>{const t=Ui(Math.atan2(e[1],e[0]));return rp(t)},Xj={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:tp,rotateZ:tp,skewX:e=>Ui(Math.atan(e[1])),skewY:e=>Ui(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},rp=e=>(e=e%360,e<0&&(e+=360),e),Zv=tp,Jv=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),e2=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Kj={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Jv,scaleY:e2,scale:e=>(Jv(e)+e2(e))/2,rotateX:e=>rp(Ui(Math.atan2(e[6],e[5]))),rotateY:e=>rp(Ui(Math.atan2(-e[2],e[0]))),rotateZ:Zv,rotate:Zv,skewX:e=>Ui(Math.atan(e[4])),skewY:e=>Ui(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function t2(e){return e.includes("scale")?1:0}function np(e,t){if(!e||e==="none")return t2(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Kj,s=r;else{const h=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=Xj,s=h}if(!s)return t2(t);const l=n[t],u=s[1].split(",").map(Zj);return typeof l=="function"?l(u):u[l]}const Qj=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return np(r,t)};function Zj(e){return parseFloat(e.trim())}const cl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ul=new Set(cl),r2=e=>e===ll||e===pt,Jj=new Set(["x","y","z"]),e8=cl.filter(e=>!Jj.has(e));function t8(e){const t=[];return e8.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const tl={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>np(t,"x"),y:(e,{transform:t})=>np(t,"y")};tl.translateX=tl.x;tl.translateY=tl.y;const Vi=new Set;let ap=!1,sp=!1,ip=!1;function j4(){if(sp){const e=Array.from(Vi).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=t8(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([l,u])=>{var h;(h=n.getValue(l))==null||h.set(u)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}sp=!1,ap=!1,Vi.forEach(e=>e.complete(ip)),Vi.clear()}function D4(){Vi.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(sp=!0)})}function r8(){ip=!0,D4(),j4(),ip=!1}class Qp{constructor(t,r,n,s,l,u=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=l,this.isAsync=u}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Vi.add(this),ap||(ap=!0,xr.read(D4),xr.resolveKeyframes(j4))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const l=s==null?void 0:s.get(),u=t[t.length-1];if(l!==void 0)t[0]=l;else if(n&&r){const h=n.readValue(r,u);h!=null&&(t[0]=h)}t[0]===void 0&&(t[0]=u),s&&l===void 0&&s.set(t[0])}Wj(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Vi.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Vi.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const n8=e=>e.startsWith("--");function a8(e,t,r){n8(t)?e.style.setProperty(t,r):e.style[t]=r}const s8=Up(()=>window.ScrollTimeline!==void 0),i8={};function o8(e,t){const r=Up(e);return()=>i8[t]??r()}const k4=o8(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),vc=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,n2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vc([0,.65,.55,1]),circOut:vc([.55,0,1,.45]),backIn:vc([.31,.01,.66,-.59]),backOut:vc([.33,1.53,.69,.99])};function O4(e,t){if(e)return typeof e=="function"?k4()?E4(e,t):"ease-out":p4(e)?vc(e):Array.isArray(e)?e.map(r=>O4(r,t)||n2.easeOut):n2[e]}function l8(e,t,r,{delay:n=0,duration:s=300,repeat:l=0,repeatType:u="loop",ease:h="easeOut",times:m}={},f=void 0){const p={[t]:r};m&&(p.offset=m);const g=O4(h,s);Array.isArray(g)&&(p.easing=g);const y={delay:n,duration:s,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:l+1,direction:u==="reverse"?"alternate":"normal"};return f&&(y.pseudoElement=f),e.animate(p,y)}function R4(e){return typeof e=="function"&&"applyToOptions"in e}function c8({type:e,...t}){return R4(e)&&k4()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class u8 extends Kp{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:l,allowFlatten:u=!1,finalKeyframe:h,onComplete:m}=t;this.isPseudoElement=!!l,this.allowFlatten=u,this.options=t,Bp(typeof t.type!="string");const f=c8(t);this.animation=l8(r,n,s,f,l),f.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const p=Xp(s,this.options,h,this.speed);this.updateMotionValue?this.updateMotionValue(p):a8(r,n,p),this.animation.cancel()}m==null||m(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,n;const t=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Ga(Number(t))}get time(){return Ga(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Ya(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&s8()?(this.animation.timeline=t,fa):r(this)}}const M4={anticipate:d4,backInOut:u4,circInOut:h4};function d8(e){return e in M4}function f8(e){typeof e.ease=="string"&&d8(e.ease)&&(e.ease=M4[e.ease])}const a2=10;class h8 extends u8{constructor(t){f8(t),C4(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:l,...u}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const h=new A4({...u,autoplay:!1}),m=Ya(this.finishedTime??this.time);r.setWithVelocity(h.sample(m-a2).value,h.sample(m).value,a2),h.stop()}}const s2=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(si.test(e)||e==="0")&&!e.startsWith("url("));function m8(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function p8(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const l=e[e.length-1],u=s2(s,t),h=s2(l,t);return!u||!h?!1:m8(e)||(r==="spring"||R4(r))&&n}const x8=new Set(["opacity","clipPath","filter","transform"]),g8=Up(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function y8(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:l,type:u}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:m}=t.owner.getProps();return g8()&&r&&x8.has(r)&&(r!=="transform"||!m)&&!h&&!n&&s!=="mirror"&&l!==0&&u!=="inertia"}const v8=40;class b8 extends Kp{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:l=0,repeatType:u="loop",keyframes:h,name:m,motionValue:f,element:p,...g}){var S;super(),this.stop=()=>{var N,w;this._animation?(this._animation.stop(),(N=this.stopTimeline)==null||N.call(this)):(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=On.now();const y={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:l,repeatType:u,name:m,motionValue:f,element:p,...g},v=(p==null?void 0:p.KeyframeResolver)||Qp;this.keyframeResolver=new v(h,(N,w,E)=>this.onKeyframesResolved(N,w,y,!E),m,f,p),(S=this.keyframeResolver)==null||S.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:l,type:u,velocity:h,delay:m,isHandoff:f,onUpdate:p}=n;this.resolvedAt=On.now(),p8(t,l,u,h)||((bs.instantAnimations||!m)&&(p==null||p(Xp(t,n,r))),t[0]=t[t.length-1],n.duration=0,n.repeat=0);const y={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>v8?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},v=!f&&y8(y)?new h8({...y,element:y.motionValue.owner.current}):new A4(y);v.finished.then(()=>this.notifyFinished()).catch(fa),this.pendingTimeline&&(this.stopTimeline=v.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=v}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||r8(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const w8=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function S8(e){const t=w8.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function F4(e,t,r=1){const[n,s]=S8(e);if(!n)return;const l=window.getComputedStyle(t).getPropertyValue(n);if(l){const u=l.trim();return n4(u)?parseFloat(u):u}return Yp(s)?F4(s,t,r+1):s}function Zp(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const L4=new Set(["width","height","top","left","right","bottom",...cl]),N8={test:e=>e==="auto",parse:e=>e},P4=e=>t=>t.test(e),B4=[ll,pt,qa,Js,mj,hj,N8],i2=e=>B4.find(P4(e));function T8(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||a4(e):!0}const E8=new Set(["brightness","contrast","saturate","opacity"]);function _8(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(Gp)||[];if(!n)return e;const s=r.replace(n,"");let l=E8.has(t)?1:0;return n!==r&&(l*=100),t+"("+l+s+")"}const C8=/\b([a-z-]*)\(.*?\)/gu,op={...si,getAnimatableNone:e=>{const t=e.match(C8);return t?t.map(_8).join(" "):e}},o2={...ll,transform:Math.round},A8={rotate:Js,rotateX:Js,rotateY:Js,rotateZ:Js,scale:Ad,scaleX:Ad,scaleY:Ad,scaleZ:Ad,skew:Js,skewX:Js,skewY:Js,distance:pt,translateX:pt,translateY:pt,translateZ:pt,x:pt,y:pt,z:pt,perspective:pt,transformPerspective:pt,opacity:Bc,originX:qv,originY:qv,originZ:pt},Jp={borderWidth:pt,borderTopWidth:pt,borderRightWidth:pt,borderBottomWidth:pt,borderLeftWidth:pt,borderRadius:pt,radius:pt,borderTopLeftRadius:pt,borderTopRightRadius:pt,borderBottomRightRadius:pt,borderBottomLeftRadius:pt,width:pt,maxWidth:pt,height:pt,maxHeight:pt,top:pt,right:pt,bottom:pt,left:pt,padding:pt,paddingTop:pt,paddingRight:pt,paddingBottom:pt,paddingLeft:pt,margin:pt,marginTop:pt,marginRight:pt,marginBottom:pt,marginLeft:pt,backgroundPositionX:pt,backgroundPositionY:pt,...A8,zIndex:o2,fillOpacity:Bc,strokeOpacity:Bc,numOctaves:o2},j8={...Jp,color:pn,backgroundColor:pn,outlineColor:pn,fill:pn,stroke:pn,borderColor:pn,borderTopColor:pn,borderRightColor:pn,borderBottomColor:pn,borderLeftColor:pn,filter:op,WebkitFilter:op},U4=e=>j8[e];function I4(e,t){let r=U4(e);return r!==op&&(r=si),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const D8=new Set(["auto","none","0"]);function k8(e,t,r){let n=0,s;for(;n<e.length&&!s;){const l=e[n];typeof l=="string"&&!D8.has(l)&&Uc(l).values.length&&(s=e[n]),n++}if(s&&r)for(const l of t)e[l]=I4(r,s)}class O8 extends Qp{constructor(t,r,n,s,l){super(t,r,n,s,l,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let m=0;m<t.length;m++){let f=t[m];if(typeof f=="string"&&(f=f.trim(),Yp(f))){const p=F4(f,r.current);p!==void 0&&(t[m]=p),m===t.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!L4.has(n)||t.length!==2)return;const[s,l]=t,u=i2(s),h=i2(l);if(u!==h)if(r2(u)&&r2(h))for(let m=0;m<t.length;m++){const f=t[m];typeof f=="string"&&(t[m]=parseFloat(f))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||T8(t[s]))&&n.push(s);n.length&&k8(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=tl[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){var h;const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const l=n.length-1,u=n[l];n[l]=tl[r](t.measureViewportBox(),window.getComputedStyle(t.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),(h=this.removedTransforms)!=null&&h.length&&this.removedTransforms.forEach(([m,f])=>{t.getValue(m).set(f)}),this.resolveNoneKeyframes()}}function R8(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=(r==null?void 0:r[e])??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const{schedule:ex}=x4(queueMicrotask,!1),_a={x:!1,y:!1};function z4(){return _a.x||_a.y}function M8(e){return e==="x"||e==="y"?_a[e]?null:(_a[e]=!0,()=>{_a[e]=!1}):_a.x||_a.y?null:(_a.x=_a.y=!0,()=>{_a.x=_a.y=!1})}function V4(e,t){const r=R8(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function l2(e){return!(e.pointerType==="touch"||z4())}function F8(e,t,r={}){const[n,s,l]=V4(e,r),u=h=>{if(!l2(h))return;const{target:m}=h,f=t(m,h);if(typeof f!="function"||!m)return;const p=g=>{l2(g)&&(f(g),m.removeEventListener("pointerleave",p))};m.addEventListener("pointerleave",p,s)};return n.forEach(h=>{h.addEventListener("pointerenter",u,s)}),l}const H4=(e,t)=>t?e===t?!0:H4(e,t.parentElement):!1,tx=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,L8=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function P8(e){return L8.has(e.tagName)||e.tabIndex!==-1}const bc=new WeakSet;function c2(e){return t=>{t.key==="Enter"&&e(t)}}function hm(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const B8=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=c2(()=>{if(bc.has(r))return;hm(r,"down");const s=c2(()=>{hm(r,"up")}),l=()=>hm(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",l,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function u2(e){return tx(e)&&!z4()}function U8(e,t,r={}){const[n,s,l]=V4(e,r),u=h=>{const m=h.currentTarget;if(!u2(h)||bc.has(m))return;bc.add(m);const f=t(m,h),p=(v,S)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",y),!(!u2(v)||!bc.has(m))&&(bc.delete(m),typeof f=="function"&&f(v,{success:S}))},g=v=>{p(v,m===window||m===document||r.useGlobalTarget||H4(m,v.target))},y=v=>{p(v,!1)};window.addEventListener("pointerup",g,s),window.addEventListener("pointercancel",y,s)};return n.forEach(h=>{(r.useGlobalTarget?window:h).addEventListener("pointerdown",u,s),h instanceof HTMLElement&&(h.addEventListener("focus",f=>B8(f,s)),!P8(h)&&!h.hasAttribute("tabindex")&&(h.tabIndex=0))}),l}const d2=30,I8=e=>!isNaN(parseFloat(e));class z8{constructor(t,r={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,s=!0)=>{var u,h;const l=On.now();this.updatedAt!==l&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((u=this.events.change)==null||u.notify(this.current)),s&&((h=this.events.renderRequest)==null||h.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=On.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=I8(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Ip);const n=this.events[t].add(r);return t==="change"?()=>{n(),xr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=On.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>d2)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,d2);return s4(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ic(e,t){return new z8(e,t)}const V8=[...B4,pn,si],H8=e=>V8.find(P4(e)),Y4=(e,t)=>t&&typeof e=="number"?t.transform(e):e,G4=k.createContext({strict:!1}),f2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},rl={};for(const e in f2)rl[e]={isEnabled:t=>f2[e].some(r=>!!t[r])};function Y8(e){for(const t in e)rl[t]={...rl[t],...e[t]}}const G8=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function cf(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||G8.has(e)}let q4=e=>!cf(e);function q8(e){e&&(q4=t=>t.startsWith("on")?!cf(t):e(t))}try{q8(require("@emotion/is-prop-valid").default)}catch{}function $8(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(q4(s)||r===!0&&cf(s)||!t&&!cf(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function W8(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const If=k.createContext({});function zf(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function zc(e){return typeof e=="string"||Array.isArray(e)}const rx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],nx=["initial",...rx];function Vf(e){return zf(e.animate)||nx.some(t=>zc(e[t]))}function $4(e){return!!(Vf(e)||e.variants)}function X8(e,t){if(Vf(e)){const{initial:r,animate:n}=e;return{initial:r===!1||zc(r)?r:void 0,animate:zc(n)?n:void 0}}return e.inherit!==!1?t:{}}function K8(e){const{initial:t,animate:r}=X8(e,k.useContext(If));return k.useMemo(()=>({initial:t,animate:r}),[h2(t),h2(r)])}function h2(e){return Array.isArray(e)?e.join(" "):e}const Q8=Symbol.for("motionComponentSymbol");function qo(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Z8(e,t,r){return k.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):qo(r)&&(r.current=n))},[t])}const ax=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),J8="framerAppearId",W4="data-"+ax(J8),X4=k.createContext({});function eD(e,t,r,n,s){var N,w;const{visualElement:l}=k.useContext(If),u=k.useContext(G4),h=k.useContext(Fp),m=k.useContext(r4).reducedMotion,f=k.useRef(null);n=n||u.renderer,!f.current&&n&&(f.current=n(e,{visualState:t,parent:l,props:r,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:m}));const p=f.current,g=k.useContext(X4);p&&!p.projection&&s&&(p.type==="html"||p.type==="svg")&&tD(f.current,r,s,g);const y=k.useRef(!1);k.useInsertionEffect(()=>{p&&y.current&&p.update(r,h)});const v=r[W4],S=k.useRef(!!v&&!((N=window.MotionHandoffIsComplete)!=null&&N.call(window,v))&&((w=window.MotionHasOptimisedAnimation)==null?void 0:w.call(window,v)));return $5(()=>{p&&(y.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),ex.render(p.render),S.current&&p.animationState&&p.animationState.animateChanges())}),k.useEffect(()=>{p&&(!S.current&&p.animationState&&p.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{var E;(E=window.MotionHandoffMarkAsComplete)==null||E.call(window,v)}),S.current=!1))}),p}function tD(e,t,r,n){const{layoutId:s,layout:l,drag:u,dragConstraints:h,layoutScroll:m,layoutRoot:f,layoutCrossfade:p}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:K4(e.parent)),e.projection.setOptions({layoutId:s,layout:l,alwaysMeasureLayout:!!u||h&&qo(h),visualElement:e,animationType:typeof l=="string"?l:"both",initialPromotionConfig:n,crossfade:p,layoutScroll:m,layoutRoot:f})}function K4(e){if(e)return e.options.allowProjection!==!1?e.projection:K4(e.parent)}function rD({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){e&&Y8(e);function l(h,m){let f;const p={...k.useContext(r4),...h,layoutId:nD(h)},{isStatic:g}=p,y=K8(h),v=n(h,g);if(!g&&Mp){aD();const S=sD(p);f=S.MeasureLayout,y.visualElement=eD(s,v,p,t,S.ProjectionNode)}return o.jsxs(If.Provider,{value:y,children:[f&&y.visualElement?o.jsx(f,{visualElement:y.visualElement,...p}):null,r(s,h,Z8(v,y.visualElement,m),v,g,y.visualElement)]})}l.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const u=k.forwardRef(l);return u[Q8]=s,u}function nD({layoutId:e}){const t=k.useContext(t4).id;return t&&e!==void 0?t+"-"+e:e}function aD(e,t){k.useContext(G4).strict}function sD(e){const{drag:t,layout:r}=rl;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const Vc={};function iD(e){for(const t in e)Vc[t]=e[t],Hp(t)&&(Vc[t].isCSSVariable=!0)}function Q4(e,{layout:t,layoutId:r}){return ul.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Vc[e]||e==="opacity")}const gn=e=>!!(e&&e.getVelocity),oD={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},lD=cl.length;function cD(e,t,r){let n="",s=!0;for(let l=0;l<lD;l++){const u=cl[l],h=e[u];if(h===void 0)continue;let m=!0;if(typeof h=="number"?m=h===(u.startsWith("scale")?1:0):m=parseFloat(h)===0,!m||r){const f=Y4(h,Jp[u]);if(!m){s=!1;const p=oD[u]||u;n+=`${p}(${f}) `}r&&(t[u]=f)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function sx(e,t,r){const{style:n,vars:s,transformOrigin:l}=e;let u=!1,h=!1;for(const m in t){const f=t[m];if(ul.has(m)){u=!0;continue}else if(Hp(m)){s[m]=f;continue}else{const p=Y4(f,Jp[m]);m.startsWith("origin")?(h=!0,l[m]=p):n[m]=p}}if(t.transform||(u||r?n.transform=cD(t,e.transform,r):n.transform&&(n.transform="none")),h){const{originX:m="50%",originY:f="50%",originZ:p=0}=l;n.transformOrigin=`${m} ${f} ${p}`}}const ix=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Z4(e,t,r){for(const n in t)!gn(t[n])&&!Q4(n,r)&&(e[n]=t[n])}function uD({transformTemplate:e},t){return k.useMemo(()=>{const r=ix();return sx(r,t,e),Object.assign({},r.vars,r.style)},[t])}function dD(e,t){const r=e.style||{},n={};return Z4(n,r,e),Object.assign(n,uD(e,t)),n}function fD(e,t){const r={},n=dD(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const hD=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ox(e){return typeof e!="string"||e.includes("-")?!1:!!(hD.indexOf(e)>-1||/[A-Z]/u.test(e))}const mD={offset:"stroke-dashoffset",array:"stroke-dasharray"},pD={offset:"strokeDashoffset",array:"strokeDasharray"};function xD(e,t,r=1,n=0,s=!0){e.pathLength=1;const l=s?mD:pD;e[l.offset]=pt.transform(-n);const u=pt.transform(t),h=pt.transform(r);e[l.array]=`${u} ${h}`}function J4(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:l=1,pathOffset:u=0,...h},m,f){if(sx(e,h,f),m){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:g}=e;p.transform&&(g.transform=p.transform,delete p.transform),(g.transform||p.transformOrigin)&&(g.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),g.transform&&(g.transformBox="fill-box",delete p.transformBox),t!==void 0&&(p.x=t),r!==void 0&&(p.y=r),n!==void 0&&(p.scale=n),s!==void 0&&xD(p,s,l,u,!1)}const eS=()=>({...ix(),attrs:{}}),tS=e=>typeof e=="string"&&e.toLowerCase()==="svg";function gD(e,t,r,n){const s=k.useMemo(()=>{const l=eS();return J4(l,t,tS(n),e.transformTemplate),{...l.attrs,style:{...l.style}}},[t]);if(e.style){const l={};Z4(l,e.style,e),s.style={...l,...s.style}}return s}function yD(e=!1){return(r,n,s,{latestValues:l},u)=>{const m=(ox(r)?gD:fD)(n,l,u,r),f=$8(n,typeof r=="string",e),p=r!==k.Fragment?{...f,...m,ref:s}:{},{children:g}=n,y=k.useMemo(()=>gn(g)?g.get():g,[g]);return k.createElement(r,{...p,children:y})}}function m2(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function lx(e,t,r,n){if(typeof t=="function"){const[s,l]=m2(n);t=t(r!==void 0?r:e.custom,s,l)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,l]=m2(n);t=t(r!==void 0?r:e.custom,s,l)}return t}function Wd(e){return gn(e)?e.get():e}function vD({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:bD(r,n,s,e),renderState:t()}}const rS=e=>(t,r)=>{const n=k.useContext(If),s=k.useContext(Fp),l=()=>vD(e,t,n,s);return r?l():q5(l)};function bD(e,t,r,n){const s={},l=n(e,{});for(const y in l)s[y]=Wd(l[y]);let{initial:u,animate:h}=e;const m=Vf(e),f=$4(e);t&&f&&!m&&e.inherit!==!1&&(u===void 0&&(u=t.initial),h===void 0&&(h=t.animate));let p=r?r.initial===!1:!1;p=p||u===!1;const g=p?h:u;if(g&&typeof g!="boolean"&&!zf(g)){const y=Array.isArray(g)?g:[g];for(let v=0;v<y.length;v++){const S=lx(e,y[v]);if(S){const{transitionEnd:N,transition:w,...E}=S;for(const C in E){let T=E[C];if(Array.isArray(T)){const O=p?T.length-1:0;T=T[O]}T!==null&&(s[C]=T)}for(const C in N)s[C]=N[C]}}}return s}function cx(e,t,r){var l;const{style:n}=e,s={};for(const u in n)(gn(n[u])||t.style&&gn(t.style[u])||Q4(u,e)||((l=r==null?void 0:r.getValue(u))==null?void 0:l.liveStyle)!==void 0)&&(s[u]=n[u]);return s}const wD={useVisualState:rS({scrapeMotionValuesFromProps:cx,createRenderState:ix})};function nS(e,t,r){const n=cx(e,t,r);for(const s in e)if(gn(e[s])||gn(t[s])){const l=cl.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[l]=e[s]}return n}const SD={useVisualState:rS({scrapeMotionValuesFromProps:nS,createRenderState:eS})};function ND(e,t){return function(n,{forwardMotionProps:s}={forwardMotionProps:!1}){const u={...ox(n)?SD:wD,preloadedFeatures:e,useRender:yD(s),createVisualElement:t,Component:n};return rD(u)}}function Hc(e,t,r){const n=e.getProps();return lx(n,t,r!==void 0?r:n.custom,e)}const lp=e=>Array.isArray(e);function TD(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Ic(r))}function ED(e){return lp(e)?e[e.length-1]||0:e}function _D(e,t){const r=Hc(e,t);let{transitionEnd:n={},transition:s={},...l}=r||{};l={...l,...n};for(const u in l){const h=ED(l[u]);TD(e,u,h)}}function CD(e){return!!(gn(e)&&e.add)}function cp(e,t){const r=e.getValue("willChange");if(CD(r))return r.add(t);if(!r&&bs.WillChange){const n=new bs.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function aS(e){return e.props[W4]}const AD=e=>e!==null;function jD(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(AD),l=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[l]}const DD={type:"spring",stiffness:500,damping:25,restSpeed:10},kD=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),OD={type:"keyframes",duration:.8},RD={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},MD=(e,{keyframes:t})=>t.length>2?OD:ul.has(e)?e.startsWith("scale")?kD(t[1]):DD:RD;function FD({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:l,repeatType:u,repeatDelay:h,from:m,elapsed:f,...p}){return!!Object.keys(p).length}const ux=(e,t,r,n={},s,l)=>u=>{const h=Zp(n,e)||{},m=h.delay||n.delay||0;let{elapsed:f=0}=n;f=f-Ya(m);const p={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...h,delay:-f,onUpdate:y=>{t.set(y),h.onUpdate&&h.onUpdate(y)},onComplete:()=>{u(),h.onComplete&&h.onComplete()},name:e,motionValue:t,element:l?void 0:s};FD(h)||Object.assign(p,MD(e,p)),p.duration&&(p.duration=Ya(p.duration)),p.repeatDelay&&(p.repeatDelay=Ya(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let g=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(p.duration=0,p.delay===0&&(g=!0)),(bs.instantAnimations||bs.skipAnimations)&&(g=!0,p.duration=0,p.delay=0),p.allowFlatten=!h.type&&!h.ease,g&&!l&&t.get()!==void 0){const y=jD(p.keyframes,h);if(y!==void 0){xr.update(()=>{p.onUpdate(y),p.onComplete()});return}}return new b8(p)};function LD({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function sS(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:l=e.getDefaultTransition(),transitionEnd:u,...h}=t;n&&(l=n);const m=[],f=s&&e.animationState&&e.animationState.getState()[s];for(const p in h){const g=e.getValue(p,e.latestValues[p]??null),y=h[p];if(y===void 0||f&&LD(f,p))continue;const v={delay:r,...Zp(l||{},p)},S=g.get();if(S!==void 0&&!g.isAnimating&&!Array.isArray(y)&&y===S&&!v.velocity)continue;let N=!1;if(window.MotionHandoffAnimation){const E=aS(e);if(E){const C=window.MotionHandoffAnimation(E,p,xr);C!==null&&(v.startTime=C,N=!0)}}cp(e,p),g.start(ux(p,g,y,e.shouldReduceMotion&&L4.has(p)?{type:!1}:v,e,N));const w=g.animation;w&&m.push(w)}return u&&Promise.all(m).then(()=>{xr.update(()=>{u&&_D(e,u)})}),m}function up(e,t,r={}){var m;const n=Hc(e,t,r.type==="exit"?(m=e.presenceContext)==null?void 0:m.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const l=n?()=>Promise.all(sS(e,n,r)):()=>Promise.resolve(),u=e.variantChildren&&e.variantChildren.size?(f=0)=>{const{delayChildren:p=0,staggerChildren:g,staggerDirection:y}=s;return PD(e,t,p+f,g,y,r)}:()=>Promise.resolve(),{when:h}=s;if(h){const[f,p]=h==="beforeChildren"?[l,u]:[u,l];return f().then(()=>p())}else return Promise.all([l(),u(r.delay)])}function PD(e,t,r=0,n=0,s=1,l){const u=[],h=(e.variantChildren.size-1)*n,m=s===1?(f=0)=>f*n:(f=0)=>h-f*n;return Array.from(e.variantChildren).sort(BD).forEach((f,p)=>{f.notify("AnimationStart",t),u.push(up(f,t,{...l,delay:r+m(p)}).then(()=>f.notify("AnimationComplete",t)))}),Promise.all(u)}function BD(e,t){return e.sortNodePosition(t)}function UD(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(l=>up(e,l,r));n=Promise.all(s)}else if(typeof t=="string")n=up(e,t,r);else{const s=typeof t=="function"?Hc(e,t,r.custom):t;n=Promise.all(sS(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function iS(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const ID=nx.length;function oS(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?oS(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<ID;r++){const n=nx[r],s=e.props[n];(zc(s)||s===!1)&&(t[n]=s)}return t}const zD=[...rx].reverse(),VD=rx.length;function HD(e){return t=>Promise.all(t.map(({animation:r,options:n})=>UD(e,r,n)))}function YD(e){let t=HD(e),r=p2(),n=!0;const s=m=>(f,p)=>{var y;const g=Hc(e,p,m==="exit"?(y=e.presenceContext)==null?void 0:y.custom:void 0);if(g){const{transition:v,transitionEnd:S,...N}=g;f={...f,...N,...S}}return f};function l(m){t=m(e)}function u(m){const{props:f}=e,p=oS(e.parent)||{},g=[],y=new Set;let v={},S=1/0;for(let w=0;w<VD;w++){const E=zD[w],C=r[E],T=f[E]!==void 0?f[E]:p[E],O=zc(T),j=E===m?C.isActive:null;j===!1&&(S=w);let q=T===p[E]&&T!==f[E]&&O;if(q&&n&&e.manuallyAnimateOnMount&&(q=!1),C.protectedKeys={...v},!C.isActive&&j===null||!T&&!C.prevProp||zf(T)||typeof T=="boolean")continue;const D=GD(C.prevProp,T);let U=D||E===m&&C.isActive&&!q&&O||w>S&&O,K=!1;const ie=Array.isArray(T)?T:[T];let te=ie.reduce(s(E),{});j===!1&&(te={});const{prevResolvedValues:G={}}=C,de={...G,...te},J=Z=>{U=!0,y.has(Z)&&(K=!0,y.delete(Z)),C.needsAnimating[Z]=!0;const oe=e.getValue(Z);oe&&(oe.liveStyle=!1)};for(const Z in de){const oe=te[Z],le=G[Z];if(v.hasOwnProperty(Z))continue;let R=!1;lp(oe)&&lp(le)?R=!iS(oe,le):R=oe!==le,R?oe!=null?J(Z):y.add(Z):oe!==void 0&&y.has(Z)?J(Z):C.protectedKeys[Z]=!0}C.prevProp=T,C.prevResolvedValues=te,C.isActive&&(v={...v,...te}),n&&e.blockInitialAnimation&&(U=!1),U&&(!(q&&D)||K)&&g.push(...ie.map(Z=>({animation:Z,options:{type:E}})))}if(y.size){const w={};if(typeof f.initial!="boolean"){const E=Hc(e,Array.isArray(f.initial)?f.initial[0]:f.initial);E&&E.transition&&(w.transition=E.transition)}y.forEach(E=>{const C=e.getBaseTarget(E),T=e.getValue(E);T&&(T.liveStyle=!0),w[E]=C??null}),g.push({animation:w})}let N=!!g.length;return n&&(f.initial===!1||f.initial===f.animate)&&!e.manuallyAnimateOnMount&&(N=!1),n=!1,N?t(g):Promise.resolve()}function h(m,f){var g;if(r[m].isActive===f)return Promise.resolve();(g=e.variantChildren)==null||g.forEach(y=>{var v;return(v=y.animationState)==null?void 0:v.setActive(m,f)}),r[m].isActive=f;const p=u(m);for(const y in r)r[y].protectedKeys={};return p}return{animateChanges:u,setActive:h,setAnimateFunction:l,getState:()=>r,reset:()=>{r=p2(),n=!0}}}function GD(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!iS(t,e):!1}function Oi(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function p2(){return{animate:Oi(!0),whileInView:Oi(),whileHover:Oi(),whileTap:Oi(),whileDrag:Oi(),whileFocus:Oi(),exit:Oi()}}class fi{constructor(t){this.isMounted=!1,this.node=t}update(){}}class qD extends fi{constructor(t){super(t),t.animationState||(t.animationState=YD(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();zf(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let $D=0;class WD extends fi{constructor(){super(...arguments),this.id=$D++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const XD={animation:{Feature:qD},exit:{Feature:WD}};function Yc(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function uu(e){return{point:{x:e.pageX,y:e.pageY}}}const KD=e=>t=>tx(t)&&e(t,uu(t));function Ec(e,t,r,n){return Yc(e,t,KD(r),n)}function lS({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function QD({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function ZD(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}const cS=1e-4,JD=1-cS,ek=1+cS,uS=.01,tk=0-uS,rk=0+uS;function Tn(e){return e.max-e.min}function nk(e,t,r){return Math.abs(e-t)<=r}function x2(e,t,r,n=.5){e.origin=n,e.originPoint=pr(t.min,t.max,e.origin),e.scale=Tn(r)/Tn(t),e.translate=pr(r.min,r.max,e.origin)-e.originPoint,(e.scale>=JD&&e.scale<=ek||isNaN(e.scale))&&(e.scale=1),(e.translate>=tk&&e.translate<=rk||isNaN(e.translate))&&(e.translate=0)}function _c(e,t,r,n){x2(e.x,t.x,r.x,n?n.originX:void 0),x2(e.y,t.y,r.y,n?n.originY:void 0)}function g2(e,t,r){e.min=r.min+t.min,e.max=e.min+Tn(t)}function ak(e,t,r){g2(e.x,t.x,r.x),g2(e.y,t.y,r.y)}function y2(e,t,r){e.min=t.min-r.min,e.max=e.min+Tn(t)}function Cc(e,t,r){y2(e.x,t.x,r.x),y2(e.y,t.y,r.y)}const v2=()=>({translate:0,scale:1,origin:0,originPoint:0}),$o=()=>({x:v2(),y:v2()}),b2=()=>({min:0,max:0}),Ar=()=>({x:b2(),y:b2()});function ua(e){return[e("x"),e("y")]}function mm(e){return e===void 0||e===1}function dp({scale:e,scaleX:t,scaleY:r}){return!mm(e)||!mm(t)||!mm(r)}function Ri(e){return dp(e)||dS(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function dS(e){return w2(e.x)||w2(e.y)}function w2(e){return e&&e!=="0%"}function uf(e,t,r){const n=e-r,s=t*n;return r+s}function S2(e,t,r,n,s){return s!==void 0&&(e=uf(e,s,n)),uf(e,r,n)+t}function fp(e,t=0,r=1,n,s){e.min=S2(e.min,t,r,n,s),e.max=S2(e.max,t,r,n,s)}function fS(e,{x:t,y:r}){fp(e.x,t.translate,t.scale,t.originPoint),fp(e.y,r.translate,r.scale,r.originPoint)}const N2=.999999999999,T2=1.0000000000001;function sk(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let l,u;for(let h=0;h<s;h++){l=r[h],u=l.projectionDelta;const{visualElement:m}=l.options;m&&m.props.style&&m.props.style.display==="contents"||(n&&l.options.layoutScroll&&l.scroll&&l!==l.root&&Xo(e,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),u&&(t.x*=u.x.scale,t.y*=u.y.scale,fS(e,u)),n&&Ri(l.latestValues)&&Xo(e,l.latestValues))}t.x<T2&&t.x>N2&&(t.x=1),t.y<T2&&t.y>N2&&(t.y=1)}function Wo(e,t){e.min=e.min+t,e.max=e.max+t}function E2(e,t,r,n,s=.5){const l=pr(e.min,e.max,s);fp(e,t,r,l,n)}function Xo(e,t){E2(e.x,t.x,t.scaleX,t.scale,t.originX),E2(e.y,t.y,t.scaleY,t.scale,t.originY)}function hS(e,t){return lS(ZD(e.getBoundingClientRect(),t))}function ik(e,t,r){const n=hS(e,r),{scroll:s}=t;return s&&(Wo(n.x,s.offset.x),Wo(n.y,s.offset.y)),n}const mS=({current:e})=>e?e.ownerDocument.defaultView:null,_2=(e,t)=>Math.abs(e-t);function ok(e,t){const r=_2(e.x,t.x),n=_2(e.y,t.y);return Math.sqrt(r**2+n**2)}class pS{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:l=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=xm(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,v=ok(g.offset,{x:0,y:0})>=3;if(!y&&!v)return;const{point:S}=g,{timestamp:N}=an;this.history.push({...S,timestamp:N});const{onStart:w,onMove:E}=this.handlers;y||(w&&w(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),E&&E(this.lastMoveEvent,g)},this.handlePointerMove=(g,y)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=pm(y,this.transformPagePoint),xr.update(this.updatePoint,!0)},this.handlePointerUp=(g,y)=>{this.end();const{onEnd:v,onSessionEnd:S,resumeAnimation:N}=this.handlers;if(this.dragSnapToOrigin&&N&&N(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=xm(g.type==="pointercancel"?this.lastMoveEventInfo:pm(y,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,w),S&&S(g,w)},!tx(t))return;this.dragSnapToOrigin=l,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const u=uu(t),h=pm(u,this.transformPagePoint),{point:m}=h,{timestamp:f}=an;this.history=[{...m,timestamp:f}];const{onSessionStart:p}=r;p&&p(t,xm(h,this.history)),this.removeListeners=ou(Ec(this.contextWindow,"pointermove",this.handlePointerMove),Ec(this.contextWindow,"pointerup",this.handlePointerUp),Ec(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),ai(this.updatePoint)}}function pm(e,t){return t?{point:t(e.point)}:e}function C2(e,t){return{x:e.x-t.x,y:e.y-t.y}}function xm({point:e},t){return{point:e,delta:C2(e,xS(t)),offset:C2(e,lk(t)),velocity:ck(t,.1)}}function lk(e){return e[0]}function xS(e){return e[e.length-1]}function ck(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=xS(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Ya(t)));)r--;if(!n)return{x:0,y:0};const l=Ga(s.timestamp-n.timestamp);if(l===0)return{x:0,y:0};const u={x:(s.x-n.x)/l,y:(s.y-n.y)/l};return u.x===1/0&&(u.x=0),u.y===1/0&&(u.y=0),u}function uk(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?pr(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?pr(r,e,n.max):Math.min(e,r)),e}function A2(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function dk(e,{top:t,left:r,bottom:n,right:s}){return{x:A2(e.x,r,s),y:A2(e.y,t,n)}}function j2(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function fk(e,t){return{x:j2(e.x,t.x),y:j2(e.y,t.y)}}function hk(e,t){let r=.5;const n=Tn(e),s=Tn(t);return s>n?r=Pc(t.min,t.max-n,e.min):n>s&&(r=Pc(e.min,e.max-s,t.min)),vs(0,1,r)}function mk(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const hp=.35;function pk(e=hp){return e===!1?e=0:e===!0&&(e=hp),{x:D2(e,"left","right"),y:D2(e,"top","bottom")}}function D2(e,t,r){return{min:k2(e,t),max:k2(e,r)}}function k2(e,t){return typeof e=="number"?e:e[t]||0}const xk=new WeakMap;class gk{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ar(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=p=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(uu(p).point)},l=(p,g)=>{const{drag:y,dragPropagation:v,onDragStart:S}=this.getProps();if(y&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=M8(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ua(w=>{let E=this.getAxisMotionValue(w).get()||0;if(qa.test(E)){const{projection:C}=this.visualElement;if(C&&C.layout){const T=C.layout.layoutBox[w];T&&(E=Tn(T)*(parseFloat(E)/100))}}this.originPoint[w]=E}),S&&xr.postRender(()=>S(p,g)),cp(this.visualElement,"transform");const{animationState:N}=this.visualElement;N&&N.setActive("whileDrag",!0)},u=(p,g)=>{const{dragPropagation:y,dragDirectionLock:v,onDirectionLock:S,onDrag:N}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:w}=g;if(v&&this.currentDirection===null){this.currentDirection=yk(w),this.currentDirection!==null&&S&&S(this.currentDirection);return}this.updateAxis("x",g.point,w),this.updateAxis("y",g.point,w),this.visualElement.render(),N&&N(p,g)},h=(p,g)=>this.stop(p,g),m=()=>ua(p=>{var g;return this.getAnimationState(p)==="paused"&&((g=this.getAxisMotionValue(p).animation)==null?void 0:g.play())}),{dragSnapToOrigin:f}=this.getProps();this.panSession=new pS(t,{onSessionStart:s,onStart:l,onMove:u,onSessionEnd:h,resumeAnimation:m},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,contextWindow:mS(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:l}=this.getProps();l&&xr.postRender(()=>l(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!jd(t,s,this.currentDirection))return;const l=this.getAxisMotionValue(t);let u=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(u=uk(u,this.constraints[t],this.elastic[t])),l.set(u)}resolveConstraints(){var l;const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,s=this.constraints;t&&qo(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=dk(n.layoutBox,t):this.constraints=!1,this.elastic=pk(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&ua(u=>{this.constraints!==!1&&this.getAxisMotionValue(u)&&(this.constraints[u]=mk(n.layoutBox[u],this.constraints[u]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!qo(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const l=ik(n,s.root,this.visualElement.getTransformPagePoint());let u=fk(s.layout.layoutBox,l);if(r){const h=r(QD(u));this.hasMutatedConstraints=!!h,h&&(u=lS(h))}return u}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:l,dragSnapToOrigin:u,onDragTransitionEnd:h}=this.getProps(),m=this.constraints||{},f=ua(p=>{if(!jd(p,r,this.currentDirection))return;let g=m&&m[p]||{};u&&(g={min:0,max:0});const y=s?200:1e6,v=s?40:1e7,S={type:"inertia",velocity:n?t[p]:0,bounceStiffness:y,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...l,...g};return this.startAxisValueAnimation(p,S)});return Promise.all(f).then(h)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return cp(this.visualElement,t),n.start(ux(t,n,0,r,this.visualElement,!1))}stopAnimation(){ua(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ua(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ua(r=>{const{drag:n}=this.getProps();if(!jd(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,l=this.getAxisMotionValue(r);if(s&&s.layout){const{min:u,max:h}=s.layout.layoutBox[r];l.set(t[r]-pr(u,h,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!qo(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ua(u=>{const h=this.getAxisMotionValue(u);if(h&&this.constraints!==!1){const m=h.get();s[u]=hk({min:m,max:m},this.constraints[u])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ua(u=>{if(!jd(u,t,null))return;const h=this.getAxisMotionValue(u),{min:m,max:f}=this.constraints[u];h.set(pr(m,f,s[u]))})}addListeners(){if(!this.visualElement.current)return;xk.set(this.visualElement,this);const t=this.visualElement.current,r=Ec(t,"pointerdown",m=>{const{drag:f,dragListener:p=!0}=this.getProps();f&&p&&this.start(m)}),n=()=>{const{dragConstraints:m}=this.getProps();qo(m)&&m.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,l=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),xr.read(n);const u=Yc(window,"resize",()=>this.scalePositionWithinConstraints()),h=s.addEventListener("didUpdate",({delta:m,hasLayoutChanged:f})=>{this.isDragging&&f&&(ua(p=>{const g=this.getAxisMotionValue(p);g&&(this.originPoint[p]+=m[p].translate,g.set(g.get()+m[p].translate))}),this.visualElement.render())});return()=>{u(),r(),l(),h&&h()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:l=!1,dragElastic:u=hp,dragMomentum:h=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:l,dragElastic:u,dragMomentum:h}}}function jd(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function yk(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class vk extends fi{constructor(t){super(t),this.removeGroupControls=fa,this.removeListeners=fa,this.controls=new gk(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fa}unmount(){this.removeGroupControls(),this.removeListeners()}}const O2=e=>(t,r)=>{e&&xr.postRender(()=>e(t,r))};class bk extends fi{constructor(){super(...arguments),this.removePointerDownListener=fa}onPointerDown(t){this.session=new pS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:mS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:O2(t),onStart:O2(r),onMove:n,onEnd:(l,u)=>{delete this.session,s&&xr.postRender(()=>s(l,u))}}}mount(){this.removePointerDownListener=Ec(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Xd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function R2(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const pc={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(pt.test(e))e=parseFloat(e);else return e;const r=R2(e,t.target.x),n=R2(e,t.target.y);return`${r}% ${n}%`}},wk={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=si.parse(e);if(s.length>5)return n;const l=si.createTransformer(e),u=typeof s[0]!="number"?1:0,h=r.x.scale*t.x,m=r.y.scale*t.y;s[0+u]/=h,s[1+u]/=m;const f=pr(h,m,.5);return typeof s[2+u]=="number"&&(s[2+u]/=f),typeof s[3+u]=="number"&&(s[3+u]/=f),l(s)}};class Sk extends k.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:l}=t;iD(Nk),l&&(r.group&&r.group.add(l),n&&n.register&&s&&n.register(l),l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Xd.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:l}=this.props,u=n.projection;return u&&(u.isPresent=l,s||t.layoutDependency!==r||r===void 0||t.isPresent!==l?u.willUpdate():this.safeToRemove(),t.isPresent!==l&&(l?u.promote():u.relegate()||xr.postRender(()=>{const h=u.getStack();(!h||!h.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),ex.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function gS(e){const[t,r]=W5(),n=k.useContext(t4);return o.jsx(Sk,{...e,layoutGroup:n,switchLayoutGroup:k.useContext(X4),isPresent:t,safeToRemove:r})}const Nk={borderRadius:{...pc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:pc,borderTopRightRadius:pc,borderBottomLeftRadius:pc,borderBottomRightRadius:pc,boxShadow:wk};function Tk(e,t,r){const n=gn(e)?e:Ic(e);return n.start(ux("",n,t,r)),n.animation}function Ek(e){return e instanceof SVGElement&&e.tagName!=="svg"}const _k=(e,t)=>e.depth-t.depth;class Ck{constructor(){this.children=[],this.isDirty=!1}add(t){Lp(this.children,t),this.isDirty=!0}remove(t){Pp(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(_k),this.isDirty=!1,this.children.forEach(t)}}function Ak(e,t){const r=On.now(),n=({timestamp:s})=>{const l=s-r;l>=t&&(ai(n),e(l-t))};return xr.setup(n,!0),()=>ai(n)}const yS=["TopLeft","TopRight","BottomLeft","BottomRight"],jk=yS.length,M2=e=>typeof e=="string"?parseFloat(e):e,F2=e=>typeof e=="number"||pt.test(e);function Dk(e,t,r,n,s,l){s?(e.opacity=pr(0,r.opacity??1,kk(n)),e.opacityExit=pr(t.opacity??1,0,Ok(n))):l&&(e.opacity=pr(t.opacity??1,r.opacity??1,n));for(let u=0;u<jk;u++){const h=`border${yS[u]}Radius`;let m=L2(t,h),f=L2(r,h);if(m===void 0&&f===void 0)continue;m||(m=0),f||(f=0),m===0||f===0||F2(m)===F2(f)?(e[h]=Math.max(pr(M2(m),M2(f),n),0),(qa.test(f)||qa.test(m))&&(e[h]+="%")):e[h]=f}(t.rotate||r.rotate)&&(e.rotate=pr(t.rotate||0,r.rotate||0,n))}function L2(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const kk=vS(0,.5,f4),Ok=vS(.5,.95,fa);function vS(e,t,r){return n=>n<e?0:n>t?1:r(Pc(e,t,n))}function P2(e,t){e.min=t.min,e.max=t.max}function la(e,t){P2(e.x,t.x),P2(e.y,t.y)}function B2(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function U2(e,t,r,n,s){return e-=t,e=uf(e,1/r,n),s!==void 0&&(e=uf(e,1/s,n)),e}function Rk(e,t=0,r=1,n=.5,s,l=e,u=e){if(qa.test(t)&&(t=parseFloat(t),t=pr(u.min,u.max,t/100)-u.min),typeof t!="number")return;let h=pr(l.min,l.max,n);e===l&&(h-=t),e.min=U2(e.min,t,r,h,s),e.max=U2(e.max,t,r,h,s)}function I2(e,t,[r,n,s],l,u){Rk(e,t[r],t[n],t[s],t.scale,l,u)}const Mk=["x","scaleX","originX"],Fk=["y","scaleY","originY"];function z2(e,t,r,n){I2(e.x,t,Mk,r?r.x:void 0,n?n.x:void 0),I2(e.y,t,Fk,r?r.y:void 0,n?n.y:void 0)}function V2(e){return e.translate===0&&e.scale===1}function bS(e){return V2(e.x)&&V2(e.y)}function H2(e,t){return e.min===t.min&&e.max===t.max}function Lk(e,t){return H2(e.x,t.x)&&H2(e.y,t.y)}function Y2(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function wS(e,t){return Y2(e.x,t.x)&&Y2(e.y,t.y)}function G2(e){return Tn(e.x)/Tn(e.y)}function q2(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Pk{constructor(){this.members=[]}add(t){Lp(this.members,t),t.scheduleRender()}remove(t){if(Pp(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const l=this.members[s];if(l.isPresent!==!1){n=l;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Bk(e,t,r){let n="";const s=e.x.translate/t.x,l=e.y.translate/t.y,u=(r==null?void 0:r.z)||0;if((s||l||u)&&(n=`translate3d(${s}px, ${l}px, ${u}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:f,rotate:p,rotateX:g,rotateY:y,skewX:v,skewY:S}=r;f&&(n=`perspective(${f}px) ${n}`),p&&(n+=`rotate(${p}deg) `),g&&(n+=`rotateX(${g}deg) `),y&&(n+=`rotateY(${y}deg) `),v&&(n+=`skewX(${v}deg) `),S&&(n+=`skewY(${S}deg) `)}const h=e.x.scale*t.x,m=e.y.scale*t.y;return(h!==1||m!==1)&&(n+=`scale(${h}, ${m})`),n||"none"}const gm=["","X","Y","Z"],Uk={visibility:"hidden"},$2=1e3;let Ik=0;function ym(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function SS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=aS(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:l}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",xr,!(s||l))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&SS(n)}function NS({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(u={},h=t==null?void 0:t()){this.id=Ik++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Hk),this.nodes.forEach(Wk),this.nodes.forEach(Xk),this.nodes.forEach(Yk)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=u,this.root=h?h.root||h:this,this.path=h?[...h.path,h]:[],this.parent=h,this.depth=h?h.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new Ck)}addEventListener(u,h){return this.eventHandlers.has(u)||this.eventHandlers.set(u,new Ip),this.eventHandlers.get(u).add(h)}notifyListeners(u,...h){const m=this.eventHandlers.get(u);m&&m.notify(...h)}hasListeners(u){return this.eventHandlers.has(u)}mount(u,h=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Ek(u),this.instance=u;const{layoutId:m,layout:f,visualElement:p}=this.options;if(p&&!p.current&&p.mount(u),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),h&&(f||m)&&(this.isLayoutDirty=!0),e){let g;const y=()=>this.root.updateBlockedByResize=!1;e(u,()=>{this.root.updateBlockedByResize=!0,g&&g(),g=Ak(y,250),Xd.hasAnimatedSinceResize&&(Xd.hasAnimatedSinceResize=!1,this.nodes.forEach(X2))})}m&&this.root.registerSharedNode(m,this),this.options.animate!==!1&&p&&(m||f)&&this.addEventListener("didUpdate",({delta:g,hasLayoutChanged:y,hasRelativeLayoutChanged:v,layout:S})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const N=this.options.transition||p.getDefaultTransition()||eO,{onLayoutAnimationStart:w,onLayoutAnimationComplete:E}=p.getProps(),C=!this.targetLayout||!wS(this.targetLayout,S),T=!y&&v;if(this.options.layoutRoot||this.resumeFrom||T||y&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(g,T);const O={...Zp(N,"layout"),onPlay:w,onComplete:E};(p.shouldReduceMotion||this.options.layoutRoot)&&(O.delay=0,O.type=!1),this.startAnimation(O)}else y||X2(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=S})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const u=this.getStack();u&&u.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),ai(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Kk),this.animationId++)}getTransformTemplate(){const{visualElement:u}=this.options;return u&&u.getProps().transformTemplate}willUpdate(u=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&SS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const g=this.path[p];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:h,layout:m}=this.options;if(h===void 0&&!m)return;const f=this.getTransformTemplate();this.prevTransformTemplateValue=f?f(this.latestValues,""):void 0,this.updateSnapshot(),u&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(W2);return}this.isUpdating||this.nodes.forEach(qk),this.isUpdating=!1,this.nodes.forEach($k),this.nodes.forEach(zk),this.nodes.forEach(Vk),this.clearAllSnapshots();const h=On.now();an.delta=vs(0,1e3/60,h-an.timestamp),an.timestamp=h,an.isProcessing=!0,cm.update.process(an),cm.preRender.process(an),cm.render.process(an),an.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ex.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Gk),this.sharedNodes.forEach(Qk)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Tn(this.snapshot.measuredBox.x)&&!Tn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const u=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ar(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:h}=this.options;h&&h.notify("LayoutMeasure",this.layout.layoutBox,u?u.layoutBox:void 0)}updateScroll(u="measure"){let h=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===u&&(h=!1),h){const m=n(this.instance);this.scroll={animationId:this.root.animationId,phase:u,isRoot:m,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:m}}}resetTransform(){if(!s)return;const u=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,h=this.projectionDelta&&!bS(this.projectionDelta),m=this.getTransformTemplate(),f=m?m(this.latestValues,""):void 0,p=f!==this.prevTransformTemplateValue;u&&(h||Ri(this.latestValues)||p)&&(s(this.instance,f),this.shouldResetTransform=!1,this.scheduleRender())}measure(u=!0){const h=this.measurePageBox();let m=this.removeElementScroll(h);return u&&(m=this.removeTransform(m)),tO(m),{animationId:this.root.animationId,measuredBox:h,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){var f;const{visualElement:u}=this.options;if(!u)return Ar();const h=u.measureViewportBox();if(!(((f=this.scroll)==null?void 0:f.wasRoot)||this.path.some(rO))){const{scroll:p}=this.root;p&&(Wo(h.x,p.offset.x),Wo(h.y,p.offset.y))}return h}removeElementScroll(u){var m;const h=Ar();if(la(h,u),(m=this.scroll)!=null&&m.wasRoot)return h;for(let f=0;f<this.path.length;f++){const p=this.path[f],{scroll:g,options:y}=p;p!==this.root&&g&&y.layoutScroll&&(g.wasRoot&&la(h,u),Wo(h.x,g.offset.x),Wo(h.y,g.offset.y))}return h}applyTransform(u,h=!1){const m=Ar();la(m,u);for(let f=0;f<this.path.length;f++){const p=this.path[f];!h&&p.options.layoutScroll&&p.scroll&&p!==p.root&&Xo(m,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),Ri(p.latestValues)&&Xo(m,p.latestValues)}return Ri(this.latestValues)&&Xo(m,this.latestValues),m}removeTransform(u){const h=Ar();la(h,u);for(let m=0;m<this.path.length;m++){const f=this.path[m];if(!f.instance||!Ri(f.latestValues))continue;dp(f.latestValues)&&f.updateSnapshot();const p=Ar(),g=f.measurePageBox();la(p,g),z2(h,f.latestValues,f.snapshot?f.snapshot.layoutBox:void 0,p)}return Ri(this.latestValues)&&z2(h,this.latestValues),h}setTargetDelta(u){this.targetDelta=u,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(u){this.options={...this.options,...u,crossfade:u.crossfade!==void 0?u.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==an.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(u=!1){var y;const h=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=h.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=h.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=h.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==h;if(!(u||m&&this.isSharedProjectionDirty||this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:g}=this.options;if(!(!this.layout||!(p||g))){if(this.resolvedRelativeTargetAt=an.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ar(),this.relativeTargetOrigin=Ar(),Cc(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),la(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ar(),this.targetWithTransforms=Ar()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ak(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):la(this.target,this.layout.layoutBox),fS(this.target,this.targetDelta)):la(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ar(),this.relativeTargetOrigin=Ar(),Cc(this.relativeTargetOrigin,this.target,v.target),la(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||dp(this.parent.latestValues)||dS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var S;const u=this.getLead(),h=!!this.resumingFrom||this!==u;let m=!0;if((this.isProjectionDirty||(S=this.parent)!=null&&S.isProjectionDirty)&&(m=!1),h&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===an.timestamp&&(m=!1),m)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;la(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,y=this.treeScale.y;sk(this.layoutCorrected,this.treeScale,this.path,h),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=Ar());const{target:v}=u;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(B2(this.prevProjectionDelta.x,this.projectionDelta.x),B2(this.prevProjectionDelta.y,this.projectionDelta.y)),_c(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==y||!q2(this.projectionDelta.x,this.prevProjectionDelta.x)||!q2(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(u=!0){var h;if((h=this.options.visualElement)==null||h.scheduleRender(),u){const m=this.getStack();m&&m.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=$o(),this.projectionDelta=$o(),this.projectionDeltaWithTransform=$o()}setAnimationOrigin(u,h=!1){const m=this.snapshot,f=m?m.latestValues:{},p={...this.latestValues},g=$o();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!h;const y=Ar(),v=m?m.source:void 0,S=this.layout?this.layout.source:void 0,N=v!==S,w=this.getStack(),E=!w||w.members.length<=1,C=!!(N&&!E&&this.options.crossfade===!0&&!this.path.some(Jk));this.animationProgress=0;let T;this.mixTargetDelta=O=>{const j=O/1e3;K2(g.x,u.x,j),K2(g.y,u.y,j),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cc(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Zk(this.relativeTarget,this.relativeTargetOrigin,y,j),T&&Lk(this.relativeTarget,T)&&(this.isProjectionDirty=!1),T||(T=Ar()),la(T,this.relativeTarget)),N&&(this.animationValues=p,Dk(p,f,this.latestValues,j,C,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=j},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(u){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ai(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xr.update(()=>{Xd.hasAnimatedSinceResize=!0,this.currentAnimation=Tk(0,$2,{...u,onUpdate:h=>{this.mixTargetDelta(h),u.onUpdate&&u.onUpdate(h)},onStop:()=>{},onComplete:()=>{u.onComplete&&u.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const u=this.getStack();u&&u.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta($2),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const u=this.getLead();let{targetWithTransforms:h,target:m,layout:f,latestValues:p}=u;if(!(!h||!m||!f)){if(this!==u&&this.layout&&f&&TS(this.options.animationType,this.layout.layoutBox,f.layoutBox)){m=this.target||Ar();const g=Tn(this.layout.layoutBox.x);m.x.min=u.target.x.min,m.x.max=m.x.min+g;const y=Tn(this.layout.layoutBox.y);m.y.min=u.target.y.min,m.y.max=m.y.min+y}la(h,m),Xo(h,p),_c(this.projectionDeltaWithTransform,this.layoutCorrected,h,p)}}registerSharedNode(u,h){this.sharedNodes.has(u)||this.sharedNodes.set(u,new Pk),this.sharedNodes.get(u).add(h);const f=h.options.initialPromotionConfig;h.promote({transition:f?f.transition:void 0,preserveFollowOpacity:f&&f.shouldPreserveFollowOpacity?f.shouldPreserveFollowOpacity(h):void 0})}isLead(){const u=this.getStack();return u?u.lead===this:!0}getLead(){var h;const{layoutId:u}=this.options;return u?((h=this.getStack())==null?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:u}=this.options;return u?(h=this.getStack())==null?void 0:h.prevLead:void 0}getStack(){const{layoutId:u}=this.options;if(u)return this.root.sharedNodes.get(u)}promote({needsReset:u,transition:h,preserveFollowOpacity:m}={}){const f=this.getStack();f&&f.promote(this,m),u&&(this.projectionDelta=void 0,this.needsReset=!0),h&&this.setOptions({transition:h})}relegate(){const u=this.getStack();return u?u.relegate(this):!1}resetSkewAndRotation(){const{visualElement:u}=this.options;if(!u)return;let h=!1;const{latestValues:m}=u;if((m.z||m.rotate||m.rotateX||m.rotateY||m.rotateZ||m.skewX||m.skewY)&&(h=!0),!h)return;const f={};m.z&&ym("z",u,f,this.animationValues);for(let p=0;p<gm.length;p++)ym(`rotate${gm[p]}`,u,f,this.animationValues),ym(`skew${gm[p]}`,u,f,this.animationValues);u.render();for(const p in f)u.setStaticValue(p,f[p]),this.animationValues&&(this.animationValues[p]=f[p]);u.scheduleRender()}getProjectionStyles(u){if(!this.instance||this.isSVG)return;if(!this.isVisible)return Uk;const h={visibility:""},m=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=Wd(u==null?void 0:u.pointerEvents)||"",h.transform=m?m(this.latestValues,""):"none",h;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Wd(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!Ri(this.latestValues)&&(v.transform=m?m({},""):"none",this.hasProjected=!1),v}const p=f.animationValues||f.latestValues;this.applyTransformsToTarget(),h.transform=Bk(this.projectionDeltaWithTransform,this.treeScale,p),m&&(h.transform=m(p,h.transform));const{x:g,y}=this.projectionDelta;h.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,f.animationValues?h.opacity=f===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:h.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const v in Vc){if(p[v]===void 0)continue;const{correct:S,applyTo:N,isCSSVariable:w}=Vc[v],E=h.transform==="none"?p[v]:S(p[v],f);if(N){const C=N.length;for(let T=0;T<C;T++)h[N[T]]=E}else w?this.options.visualElement.renderState.vars[v]=E:h[v]=E}return this.options.layoutId&&(h.pointerEvents=f===this?Wd(u==null?void 0:u.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(u=>{var h;return(h=u.currentAnimation)==null?void 0:h.stop()}),this.root.nodes.forEach(W2),this.root.sharedNodes.clear()}}}function zk(e){e.updateLayout()}function Vk(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:l}=e.options,u=t.source!==e.layout.source;l==="size"?ua(g=>{const y=u?t.measuredBox[g]:t.layoutBox[g],v=Tn(y);y.min=n[g].min,y.max=y.min+v}):TS(l,t.layoutBox,n)&&ua(g=>{const y=u?t.measuredBox[g]:t.layoutBox[g],v=Tn(n[g]);y.max=y.min+v,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[g].max=e.relativeTarget[g].min+v)});const h=$o();_c(h,n,t.layoutBox);const m=$o();u?_c(m,e.applyTransform(s,!0),t.measuredBox):_c(m,n,t.layoutBox);const f=!bS(h);let p=!1;if(!e.resumeFrom){const g=e.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:y,layout:v}=g;if(y&&v){const S=Ar();Cc(S,t.layoutBox,y.layoutBox);const N=Ar();Cc(N,n,v.layoutBox),wS(S,N)||(p=!0),g.options.layoutRoot&&(e.relativeTarget=N,e.relativeTargetOrigin=S,e.relativeParent=g)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:m,layoutDelta:h,hasLayoutChanged:f,hasRelativeLayoutChanged:p})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Hk(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Yk(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Gk(e){e.clearSnapshot()}function W2(e){e.clearMeasurements()}function qk(e){e.isLayoutDirty=!1}function $k(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function X2(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Wk(e){e.resolveTargetDelta()}function Xk(e){e.calcProjection()}function Kk(e){e.resetSkewAndRotation()}function Qk(e){e.removeLeadSnapshot()}function K2(e,t,r){e.translate=pr(t.translate,0,r),e.scale=pr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Q2(e,t,r,n){e.min=pr(t.min,r.min,n),e.max=pr(t.max,r.max,n)}function Zk(e,t,r,n){Q2(e.x,t.x,r.x,n),Q2(e.y,t.y,r.y,n)}function Jk(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const eO={duration:.45,ease:[.4,0,.1,1]},Z2=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),J2=Z2("applewebkit/")&&!Z2("chrome/")?Math.round:fa;function eb(e){e.min=J2(e.min),e.max=J2(e.max)}function tO(e){eb(e.x),eb(e.y)}function TS(e,t,r){return e==="position"||e==="preserve-aspect"&&!nk(G2(t),G2(r),.2)}function rO(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const nO=NS({attachResizeListener:(e,t)=>Yc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),vm={current:void 0},ES=NS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!vm.current){const e=new nO({});e.mount(window),e.setOptions({layoutScroll:!0}),vm.current=e}return vm.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),aO={pan:{Feature:bk},drag:{Feature:vk,ProjectionNode:ES,MeasureLayout:gS}};function tb(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,l=n[s];l&&xr.postRender(()=>l(t,uu(t)))}class sO extends fi{mount(){const{current:t}=this.node;t&&(this.unmount=F8(t,(r,n)=>(tb(this.node,n,"Start"),s=>tb(this.node,s,"End"))))}unmount(){}}class iO extends fi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ou(Yc(this.node.current,"focus",()=>this.onFocus()),Yc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function rb(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),l=n[s];l&&xr.postRender(()=>l(t,uu(t)))}class oO extends fi{mount(){const{current:t}=this.node;t&&(this.unmount=U8(t,(r,n)=>(rb(this.node,n,"Start"),(s,{success:l})=>rb(this.node,s,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const mp=new WeakMap,bm=new WeakMap,lO=e=>{const t=mp.get(e.target);t&&t(e)},cO=e=>{e.forEach(lO)};function uO({root:e,...t}){const r=e||document;bm.has(r)||bm.set(r,{});const n=bm.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(cO,{root:e,...t})),n[s]}function dO(e,t,r){const n=uO(t);return mp.set(e,r),n.observe(e),()=>{mp.delete(e),n.unobserve(e)}}const fO={some:0,all:1};class hO extends fi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:l}=t,u={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:fO[s]},h=m=>{const{isIntersecting:f}=m;if(this.isInView===f||(this.isInView=f,l&&!f&&this.hasEnteredView))return;f&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",f);const{onViewportEnter:p,onViewportLeave:g}=this.node.getProps(),y=f?p:g;y&&y(m)};return dO(this.node.current,u,h)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(mO(t,r))&&this.startObserver()}unmount(){}}function mO({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const pO={inView:{Feature:hO},tap:{Feature:oO},focus:{Feature:iO},hover:{Feature:sO}},xO={layout:{ProjectionNode:ES,MeasureLayout:gS}},pp={current:null},_S={current:!1};function gO(){if(_S.current=!0,!!Mp)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>pp.current=e.matches;e.addListener(t),t()}else pp.current=!1}const yO=new WeakMap;function vO(e,t,r){for(const n in t){const s=t[n],l=r[n];if(gn(s))e.addValue(n,s);else if(gn(l))e.addValue(n,Ic(s,{owner:e}));else if(l!==s)if(e.hasValue(n)){const u=e.getValue(n);u.liveStyle===!0?u.jump(s):u.hasAnimated||u.set(s)}else{const u=e.getStaticValue(n);e.addValue(n,Ic(u!==void 0?u:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const nb=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class bO{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:l,visualState:u},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Qp,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=On.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,xr.render(this.render,!1,!0))};const{latestValues:m,renderState:f}=u;this.latestValues=m,this.baseTarget={...m},this.initialValues=r.initial?{...m}:{},this.renderState=f,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=h,this.blockInitialAnimation=!!l,this.isControllingVariants=Vf(r),this.isVariantNode=$4(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:p,...g}=this.scrapeMotionValuesFromProps(r,{},this);for(const y in g){const v=g[y];m[y]!==void 0&&gn(v)&&v.set(m[y],!1)}}mount(t){this.current=t,yO.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),_S.current||gO(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:pp.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),this.projection=void 0,ai(this.notifyUpdate),ai(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=ul.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",h=>{this.latestValues[t]=h,this.props.onUpdate&&xr.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),l=r.on("renderRequest",this.scheduleRender);let u;window.MotionCheckAppearSync&&(u=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),l(),u&&u(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in rl){const r=rl[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const l=this.features[t];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ar()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<nb.length;n++){const s=nb[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const l="on"+s,u=t[l];u&&(this.propEventSubscriptions[s]=this.on(s,u))}this.prevMotionValues=vO(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=Ic(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(n4(n)||a4(n))?n=parseFloat(n):!H8(n)&&si.test(r)&&(n=I4(t,r)),this.setBaseTarget(t,gn(n)?n.get():n)),gn(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var l;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const u=lx(this.props,r,(l=this.presenceContext)==null?void 0:l.custom);u&&(n=u[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!gn(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Ip),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class CS extends bO{constructor(){super(...arguments),this.KeyframeResolver=O8}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;gn(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function AS(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const l in r)e.style.setProperty(l,r[l])}function wO(e){return window.getComputedStyle(e)}class SO extends CS{constructor(){super(...arguments),this.type="html",this.renderInstance=AS}readValueFromInstance(t,r){if(ul.has(r))return Qj(t,r);{const n=wO(t),s=(Hp(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return hS(t,r)}build(t,r,n){sx(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return cx(t,r,n)}}const jS=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function NO(e,t,r,n){AS(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(jS.has(s)?s:ax(s),t.attrs[s])}class TO extends CS{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ar}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(ul.has(r)){const n=U4(r);return n&&n.default||0}return r=jS.has(r)?r:ax(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return nS(t,r,n)}build(t,r,n){J4(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,s){NO(t,r,n,s)}mount(t){this.isSVGTag=tS(t.tagName),super.mount(t)}}const EO=(e,t)=>ox(e)?new TO(t):new SO(t,{allowProjection:e!==k.Fragment}),_O=ND({...XD,...pO,...aO,...xO},EO),ur=W8(_O);function CO(e){return yr({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"},child:[]}]})(e)}function AO(e){return yr({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zm151 118.3C226 97.7 269.5 80 320 80c65.2 0 118.8 29.6 159.9 67.7C518.4 183.5 545 226 558.6 256c-12.6 28-36.6 66.8-70.9 100.9l-53.8-42.2c9.1-17.6 14.2-37.5 14.2-58.7c0-70.7-57.3-128-128-128c-32.2 0-61.7 11.9-84.2 31.5l-46.1-36.1zM394.9 284.2l-81.5-63.9c4.2-8.5 6.6-18.2 6.6-28.3c0-5.5-.7-10.9-2-16c.7 0 1.3 0 2 0c44.2 0 80 35.8 80 80c0 9.9-1.8 19.4-5.1 28.2zm9.4 130.3C378.8 425.4 350.7 432 320 432c-65.2 0-118.8-29.6-159.9-67.7C121.6 328.5 95 286 81.4 256c8.3-18.4 21.5-41.5 39.4-64.8L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5l-41.9-33zM192 256c0 70.7 57.3 128 128 128c13.3 0 26.1-2 38.2-5.8L302 334c-23.5-5.4-43.1-21.2-53.7-42.3l-56.1-44.2c-.2 2.8-.3 5.6-.3 8.5z"},child:[]}]})(e)}const jO=()=>{const e=ui(),[t,r]=k.useState(!1),[n,s]=k.useState(!0),[l,u]=k.useState(!1),[h,m]=k.useState(!1),[f,p]=k.useState({email:"",otp:"",newPassword:"",confirmPassword:""}),[g,y]=k.useState(!1),v=at.useRef([]),S=(G,de)=>{[...v.current.map(J=>(J==null?void 0:J.value)||"")],G.target.value,G.target.value.length>0&&de<v.current.length-1&&v.current[de+1].focus()},N=(G,de)=>{G.key==="Backspace"&&G.target.value===""&&de>0&&v.current[de-1].focus()},w=G=>{G.preventDefault();const J=G.clipboardData.getData("text").split("");v.current.forEach((W,F)=>{F<J.length&&W&&(W.value=J[F])}),v.current[J.length-1]&&v.current[J.length-1].focus()},[E,C]=k.useState(!1),[T,O]=k.useState(!1),j=G=>{p({...f,[G.target.name]:G.target.value})},q=async G=>{var de,J,W,F;G.preventDefault();try{if(m(!0),!f.email.trim()){r("Email is required"),ze.error("Email is required"),m(!1);return}const oe=(await fr.sendOTP(f.email)).data;oe.success?(r(!1),C(!0),s(!1),m(!1),u("OTP sent successfully"),ze.success("OTP sent successfully to your email!")):(console.log("result",oe),ze.error(oe.message||"Failed to send OTP"),r(oe.message||"Failed to send OTP"),m(!1))}catch(Z){m(!1),console.error(Z),Z.message==="Network Error"?(ze.error("Network error. Please check your internet connection or contact support."),r("Network error. Please check your internet connection or contact support.")):(ze.error(((J=(de=Z.response)==null?void 0:de.data)==null?void 0:J.message)||"Failed to send OTP. Please try again later."),r(((F=(W=Z.response)==null?void 0:W.data)==null?void 0:F.message)||"Failed to send OTP. Please try again later."))}},D=async G=>{var W,F,Z,oe;G.preventDefault();const J=v.current.map(le=>(le==null?void 0:le.value)||"").join("");if(J.length!==6){ze.error("Please enter the complete 6-digit OTP"),r("Please enter the complete 6-digit OTP");return}try{m(!0),console.log("payload.email",f.email),console.log("otp",J);const R=(await fr.verifyOTP({otp:J,email:f.email})).data;R.success?(r(!1),O(!0),C(!1),m(!1),u("OTP verified successfully. Enter your new password"),ze.success("OTP verified successfully!")):(u(!1),ze.error(R.message||"Invalid OTP"),r(R.message||"Invalid OTP"),m(!1))}catch(le){m(!1),console.error(le),le.message==="Network Error"?(ze.error("Network error. Please check your internet connection or contact support."),r("Network error. Please check your internet connection or contact support.")):(ze.error(((F=(W=le.response)==null?void 0:W.data)==null?void 0:F.message)||"Failed to verify OTP. Please try again later."),r(((oe=(Z=le.response)==null?void 0:Z.data)==null?void 0:oe.message)||"Failed to verify OTP. Please try again later."))}},U=async G=>{var de,J,W,F;if(u(!1),G.preventDefault(),f.newPassword!==f.confirmPassword){ze.error("Passwords do not match"),r("Passwords do not match");return}if(f.newPassword.length<8){ze.error("Password must be at least 8 characters long"),r("Password must be at least 8 characters long");return}try{m(!0),console.log("newPassword sending to backend is ",f.newPassword);const oe=(await fr.resetPassword({email:f.email,newPassword:f.newPassword})).data;oe.success?(r(!1),m(!1),ze.success("Password changed successfully!"),setTimeout(()=>{e("/login")},2e3)):(ze.error(oe.message||"Failed to reset password"),r(oe.message||"Failed to reset password"),m(!1))}catch(Z){m(!1),console.error(Z),Z.message==="Network Error"?(ze.error("Network error. Please check your internet connection or contact support."),r("Network error. Please check your internet connection or contact support.")):(ze.error(((J=(de=Z.response)==null?void 0:de.data)==null?void 0:J.message)||"Failed to reset password. Please try again later."),r(((F=(W=Z.response)==null?void 0:W.data)==null?void 0:F.message)||"Failed to reset password. Please try again later."))}},K={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.5}},exit:{opacity:0,transition:{duration:.5}}},ie={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6,when:"beforeChildren",staggerChildren:.1}},exit:{opacity:0,y:-20,transition:{duration:.3}}},te={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.5}}};return o.jsxs("div",{className:"w-full min-h-screen bg-cover bg-center relative",style:{backgroundImage:`url(${Hv})`},children:[o.jsx(L6,{position:"top-right",autoClose:3e3}),o.jsx("div",{className:"absolute inset-0 bg-black opacity-50"}),o.jsx(ur.div,{className:"absolute inset-0 flex justify-center items-center p-4",initial:"hidden",animate:"visible",exit:"exit",variants:K,children:o.jsxs("div",{className:"grid grid-cols-1 md:flex max-w-5xl w-full",children:[o.jsxs(ur.div,{className:"bg-[#152B54] w-full md:w-[40%] p-6 hidden md:flex flex-col justify-center items-center",initial:{x:-50,opacity:0},animate:{x:0,opacity:1},transition:{duration:.8},children:[o.jsx("div",{className:"relative",children:o.jsx("img",{src:Hv,alt:"Traincape Technology",className:"w-[130px] h-[130px] mb-8"})}),o.jsxs(ur.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:1},className:"text-white text-center",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Password Recovery"}),o.jsx("p",{className:"mb-6",children:"Recover your account access quickly and securely"}),o.jsx("div",{className:"w-16 h-1 bg-white mx-auto"})]})]}),o.jsxs(ur.div,{className:"bg-white bg-opacity-95 p-8 md:p-12 shadow-xl w-full md:w-[60%] rounded-lg",variants:ie,initial:"hidden",animate:"visible",exit:"exit",children:[o.jsx(ur.h1,{className:"text-3xl font-semibold text-center text-[#152B54] mb-6",variants:te,children:"Forgot Password"}),t&&o.jsx(ur.div,{className:"mb-4 p-3 bg-red-100 text-red-800 rounded-md",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:t}),l&&o.jsx(ur.div,{className:"mb-4 p-3 bg-green-100 text-green-800 rounded-md",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},children:l}),o.jsxs("form",{children:[n&&o.jsxs(ur.div,{variants:ie,children:[o.jsxs(ur.div,{className:"mb-6",variants:te,children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),o.jsx("input",{type:"email",id:"email",name:"email",required:!0,value:f.email,onChange:j,placeholder:"Enter your email address",className:"w-full px-4 py-3 mt-1 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#152B54] transition-all duration-200"})]}),o.jsx(ur.button,{type:"button",onClick:q,disabled:h,variants:te,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-3 bg-[#152B54] text-white rounded-lg hover:bg-sky-950 transition duration-200 flex justify-center items-center",children:h?o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"animate-spin mr-2 h-5 w-5 border-t-2 border-b-2 border-white rounded-full"}),o.jsx("span",{children:"Sending..."})]}):"Send Reset OTP"}),o.jsx(ur.div,{className:"mt-4 text-center",variants:te,children:o.jsx("button",{type:"button",onClick:()=>e("/login"),className:"text-[#152B54] hover:underline",children:"Back to Login"})})]}),E&&o.jsxs(ur.div,{className:"mt-4",variants:ie,initial:"hidden",animate:"visible",exit:"exit",children:[o.jsx(ur.h2,{className:"text-xl font-semibold text-center text-[#152B54] mb-4",variants:te,children:"Enter Verification Code"}),o.jsx(ur.p,{className:"text-center text-gray-600 mb-6",variants:te,children:"We've sent a 6-digit code to your email"}),o.jsx(ur.div,{onPaste:w,className:"flex justify-between mb-6",variants:te,children:Array(6).fill(0).map((G,de)=>o.jsx(ur.input,{type:"text",maxLength:"1",required:!0,onChange:J=>S(J,de),onKeyDown:J=>N(J,de),ref:J=>v.current[de]=J,whileFocus:{scale:1.1},className:"w-12 h-12 text-3xl text-center border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#152B54] focus:border-[#152B54] transition-all duration-200"},de))}),o.jsx(ur.button,{type:"button",onClick:D,disabled:h,variants:te,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-3 mt-2 bg-[#152B54] text-white rounded-lg hover:bg-sky-950 transition duration-200 flex justify-center items-center",children:h?o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"animate-spin mr-2 h-5 w-5 border-t-2 border-b-2 border-white rounded-full"}),o.jsx("span",{children:"Verifying..."})]}):"Verify OTP"}),o.jsx(ur.div,{className:"mt-4 text-center",variants:te,children:o.jsx("button",{type:"button",onClick:q,className:"text-[#152B54] hover:underline",children:"Didn't receive code? Resend"})})]}),T&&o.jsxs(ur.div,{className:"mt-4",variants:ie,initial:"hidden",animate:"visible",exit:"exit",children:[o.jsx(ur.h2,{className:"text-xl font-semibold text-center text-[#152B54] mb-4",variants:te,children:"Create New Password"}),o.jsx(ur.p,{className:"text-center text-gray-600 mb-6",variants:te,children:"Your new password must be at least 8 characters"}),o.jsxs(ur.div,{className:"mb-5 relative",variants:te,children:[o.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:g?"text":"password",id:"newPassword",name:"newPassword",value:f.newPassword,onChange:j,required:!0,placeholder:"Enter new password",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#152B54] transition-all duration-200"}),o.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:()=>y(!g),children:g?o.jsx(AO,{size:18}):o.jsx(CO,{size:18})})]})]}),o.jsxs(ur.div,{className:"mb-6",variants:te,children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),o.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:f.confirmPassword,onChange:j,required:!0,placeholder:"Confirm new password",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#152B54] transition-all duration-200"})]}),o.jsx(ur.button,{type:"button",onClick:U,disabled:h,variants:te,whileHover:{scale:1.02},whileTap:{scale:.98},className:"w-full py-3 bg-[#152B54] text-white rounded-lg hover:bg-sky-950 transition duration-200 flex justify-center items-center",children:h?o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"animate-spin mr-2 h-5 w-5 border-t-2 border-b-2 border-white rounded-full"}),o.jsx("span",{children:"Resetting Password..."})]}):"Reset Password"})]})]})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var df={};df.version="0.18.5";var DS=1252,DO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kS=function(e){DO.indexOf(e)!=-1&&(DS=e)};function kO(){kS(1252)}var Gc=function(e){kS(e)};function OO(){Gc(1200),kO()}var Dd=function(t){return String.fromCharCode(t)},ab=function(t){return String.fromCharCode(t)},sb,ri="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qc(e){for(var t="",r=0,n=0,s=0,l=0,u=0,h=0,m=0,f=0;f<e.length;)r=e.charCodeAt(f++),l=r>>2,n=e.charCodeAt(f++),u=(r&3)<<4|n>>4,s=e.charCodeAt(f++),h=(n&15)<<2|s>>6,m=s&63,isNaN(n)?h=m=64:isNaN(s)&&(m=64),t+=ri.charAt(l)+ri.charAt(u)+ri.charAt(h)+ri.charAt(m);return t}function ws(e){var t="",r=0,n=0,s=0,l=0,u=0,h=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)l=ri.indexOf(e.charAt(f++)),u=ri.indexOf(e.charAt(f++)),r=l<<2|u>>4,t+=String.fromCharCode(r),h=ri.indexOf(e.charAt(f++)),n=(u&15)<<4|h>>2,h!==64&&(t+=String.fromCharCode(n)),m=ri.indexOf(e.charAt(f++)),s=(h&3)<<6|m,m!==64&&(t+=String.fromCharCode(s));return t}var Bt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ts=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function qi(e){return Bt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ib(e){return Bt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ca=function(t){return Bt?Ts(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Hf(e){if(typeof ArrayBuffer>"u")return Ca(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function du(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function RO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var on=Bt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ts(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function MO(e){for(var t=[],r=0,n=e.length+250,s=qi(e.length+255),l=0;l<e.length;++l){var u=e.charCodeAt(l);if(u<128)s[r++]=u;else if(u<2048)s[r++]=192|u>>6&31,s[r++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var h=e.charCodeAt(++l)&1023;s[r++]=240|u>>8&7,s[r++]=128|u>>2&63,s[r++]=128|h>>6&15|(u&3)<<4,s[r++]=128|h&63}else s[r++]=224|u>>12&15,s[r++]=128|u>>6&63,s[r++]=128|u&63;r>n&&(t.push(s.slice(0,r)),r=0,s=qi(65535),n=65530)}return t.push(s.slice(0,r)),on(t)}var Ac=/\u0000/g,kd=/[\u0001-\u0006]/g;function Qo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Aa(e,t){var r=""+e;return r.length>=t?r:Sr("0",t-r.length)+r}function dx(e,t){var r=""+e;return r.length>=t?r:Sr(" ",t-r.length)+r}function ff(e,t){var r=""+e;return r.length>=t?r:r+Sr(" ",t-r.length)}function FO(e,t){var r=""+Math.round(e);return r.length>=t?r:Sr("0",t-r.length)+r}function LO(e,t){var r=""+e;return r.length>=t?r:Sr("0",t-r.length)+r}var ob=Math.pow(2,32);function Io(e,t){if(e>ob||e<-ob)return FO(e,t);var r=Math.round(e);return LO(r,t)}function hf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var lb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],wm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function PO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Nr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},cb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},BO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function mf(e,t,r){for(var n=e<0?-1:1,s=e*n,l=0,u=1,h=0,m=1,f=0,p=0,g=Math.floor(s);f<t&&(g=Math.floor(s),h=g*u+l,p=g*f+m,!(s-g<5e-8));)s=1/(s-g),l=u,u=h,m=f,f=p;if(p>t&&(f>t?(p=m,h=l):(p=f,h=u)),!r)return[0,n*h,p];var y=Math.floor(n*h/p);return[y,n*h-y*p,p]}function Od(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),l=0,u=[],h={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),t&&t.date1904&&(n+=1462),h.u>.9999&&(h.u=0,++s==86400&&(h.T=s=0,++n,++h.D)),n===60)u=r?[1317,10,29]:[1900,2,29],l=3;else if(n===0)u=r?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),u=[m.getFullYear(),m.getMonth()+1,m.getDate()],l=m.getDay(),n<60&&(l=(l+6)%7),r&&(l=GO(m,u))}return h.y=u[0],h.m=u[1],h.d=u[2],h.S=s%60,s=Math.floor(s/60),h.M=s%60,s=Math.floor(s/60),h.H=s,h.q=l,h}var OS=new Date(1899,11,31,0,0,0),UO=OS.getTime(),IO=new Date(1900,2,1,0,0,0);function RS(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=IO&&(r+=24*60*60*1e3),(r-(UO+(e.getTimezoneOffset()-OS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function fx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function zO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function VO(e){var t=e<0?12:11,r=fx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function HO(e){var t=fx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function YO(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=VO(e):t===10?r=e.toFixed(10).substr(0,12):r=HO(e),fx(zO(r.toUpperCase()))}function xp(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):YO(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ii(14,RS(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function GO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function qO(e,t,r,n){var s="",l=0,u=0,h=r.y,m,f=0;switch(e){case 98:h=r.y+543;case 121:switch(t.length){case 1:case 2:m=h%100,f=2;break;default:m=h%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:m=r.m,f=t.length;break;case 3:return wm[r.m-1][1];case 5:return wm[r.m-1][0];default:return wm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:m=r.d,f=t.length;break;case 3:return lb[r.q][0];default:return lb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:m=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:m=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:m=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Aa(r.S,t.length):(n>=2?u=n===3?1e3:100:u=n===1?10:1,l=Math.round(u*(r.S+r.u)),l>=60*u&&(l=0),t==="s"?l===0?"0":""+l/u:(s=Aa(l,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":m=r.D*24+r.H;break;case"[m]":case"[mm]":m=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":m=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:m=h,f=1;break}var p=f>0?Aa(m,f):"";return p}function ni(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var MS=/%/g;function $O(e,t,r){var n=t.replace(MS,""),s=t.length-n.length;return hs(e,n,r*Math.pow(10,2*s))+Sr("%",s)}function WO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function FS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+FS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),r.indexOf("e")===-1){var u=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(u-r.length+l):r+="E+"+(u-l);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,m,f,p){return m+f+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var LS=/# (\?+)( ?)\/( ?)(\d+)/;function XO(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),l=Math.floor(s/n),u=s-l*n,h=n;return r+(l===0?"":""+l)+" "+(u===0?Sr(" ",e[1].length+1+e[4].length):dx(u,e[1].length)+e[2]+"/"+e[3]+Aa(h,e[4].length))}function KO(e,t,r){return r+(t===0?"":""+t)+Sr(" ",e[1].length+2+e[4].length)}var PS=/^#*0*\.([0#]+)/,BS=/\).*[0#]/,US=/\(###\) ###\\?-####/;function wn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ub(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function db(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function QO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ZO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ca(e,t,r){if(e.charCodeAt(0)===40&&!t.match(BS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ca("n",n,r):"("+ca("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return WO(e,t,r);if(t.indexOf("%")!==-1)return $O(e,t,r);if(t.indexOf("E")!==-1)return FS(t,r);if(t.charCodeAt(0)===36)return"$"+ca(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,u,h,m=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Io(m,t.length);if(t.match(/^[#?]+$/))return s=Io(r,0),s==="0"&&(s=""),s.length>t.length?s:wn(t.substr(0,t.length-s.length))+s;if(l=t.match(LS))return XO(l,m,f);if(t.match(/^#+0+$/))return f+Io(m,t.length-t.indexOf("0"));if(l=t.match(PS))return s=ub(r,l[1].length).replace(/^([^\.]+)$/,"$1."+wn(l[1])).replace(/\.$/,"."+wn(l[1])).replace(/\.(\d*)$/,function(S,N){return"."+N+Sr("0",wn(l[1]).length-N.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return f+ub(m,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return f+ni(Io(m,0));if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ca(e,t,-r):ni(""+(Math.floor(r)+QO(r,l[1].length)))+"."+Aa(db(r,l[1].length),l[1].length);if(l=t.match(/^#,#*,#0/))return ca(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qo(ca(e,t.replace(/[\\-]/g,""),r)),u=0,Qo(Qo(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return u<s.length?s.charAt(u++):S==="0"?"0":""}));if(t.match(US))return s=ca(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(l[4].length,7),h=mf(m,Math.pow(10,u)-1,!1),s=""+f,p=hs("n",l[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ff(h[2],u),p.length<l[4].length&&(p=wn(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(l[1].length,l[4].length),7),h=mf(m,Math.pow(10,u)-1,!0),f+(h[0]||(h[1]?"":"0"))+" "+(h[1]?dx(h[1],u)+l[2]+"/"+l[3]+ff(h[2],u):Sr(" ",2*u+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=Io(r,0),t.length<=s.length?s:wn(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),u=s.indexOf(".");var g=t.indexOf(".")-u,y=t.length-s.length-g;return wn(t.substr(0,g)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return u=db(r,l[1].length),r<0?"-"+ca(e,t,-r):ni(ZO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Aa(0,3-S.length):"")+S})+"."+Aa(u,l[1].length);switch(t){case"###,##0.00":return ca(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=ni(Io(m,0));return v!=="0"?f+v:"";case"###,###.00":return ca(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ca(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function JO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function eR(e,t,r){var n=t.replace(MS,""),s=t.length-n.length;return hs(e,n,r*Math.pow(10,2*s))+Sr("%",s)}function IS(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+IS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var l=Math.floor(Math.log(t)*Math.LOG10E)%s;if(l<0&&(l+=s),r=(t/Math.pow(10,l)).toPrecision(n+1+(s+l)%s),!r.match(/[Ee]/)){var u=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(u-r.length+l):r+="E+"+(u-l),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,m,f,p){return m+f+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function za(e,t,r){if(e.charCodeAt(0)===40&&!t.match(BS)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?za("n",n,r):"("+za("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return JO(e,t,r);if(t.indexOf("%")!==-1)return eR(e,t,r);if(t.indexOf("E")!==-1)return IS(t,r);if(t.charCodeAt(0)===36)return"$"+za(e,t.substr(t.charAt(1)==" "?2:1),r);var s,l,u,h,m=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Aa(m,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:wn(t.substr(0,t.length-s.length))+s;if(l=t.match(LS))return KO(l,m,f);if(t.match(/^#+0+$/))return f+Aa(m,t.length-t.indexOf("0"));if(l=t.match(PS))return s=(""+r).replace(/^([^\.]+)$/,"$1."+wn(l[1])).replace(/\.$/,"."+wn(l[1])),s=s.replace(/\.(\d*)$/,function(S,N){return"."+N+Sr("0",wn(l[1]).length-N.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),l=t.match(/^(0*)\.(#*)$/))return f+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=t.match(/^#{1,3},##0(\.?)$/))return f+ni(""+m);if(l=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+za(e,t,-r):ni(""+r)+"."+Sr("0",l[1].length);if(l=t.match(/^#,#*,#0/))return za(e,t.replace(/^#,#*,/,""),r);if(l=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qo(za(e,t.replace(/[\\-]/g,""),r)),u=0,Qo(Qo(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return u<s.length?s.charAt(u++):S==="0"?"0":""}));if(t.match(US))return s=za(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(l[4].length,7),h=mf(m,Math.pow(10,u)-1,!1),s=""+f,p=hs("n",l[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ff(h[2],u),p.length<l[4].length&&(p=wn(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(l[1].length,l[4].length),7),h=mf(m,Math.pow(10,u)-1,!0),f+(h[0]||(h[1]?"":"0"))+" "+(h[1]?dx(h[1],u)+l[2]+"/"+l[3]+ff(h[2],u):Sr(" ",2*u+1+l[2].length+l[3].length));if(l=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:wn(t.substr(0,t.length-s.length))+s;if(l=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),u=s.indexOf(".");var g=t.indexOf(".")-u,y=t.length-s.length-g;return wn(t.substr(0,g)+s+t.substr(t.length-y))}if(l=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+za(e,t,-r):ni(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Aa(0,3-S.length):"")+S})+"."+Aa(0,l[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=ni(""+m);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return za(e,t.slice(0,t.lastIndexOf(".")),r)+wn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function hs(e,t,r){return(r|0)===r?za(e,t,r):ca(e,t,r)}function tR(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var zS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function VS(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":hf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(zS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function rR(e,t,r,n){for(var s=[],l="",u=0,h="",m="t",f,p,g,y="H";u<e.length;)switch(h=e.charAt(u)){case"G":if(!hf(e,u))throw new Error("unrecognized character "+h+" in "+e);s[s.length]={t:"G",v:"General"},u+=7;break;case'"':for(l="";(g=e.charCodeAt(++u))!==34&&u<e.length;)l+=String.fromCharCode(g);s[s.length]={t:"t",v:l},++u;break;case"\\":var v=e.charAt(++u),S=v==="("||v===")"?v:"t";s[s.length]={t:S,v},++u;break;case"_":s[s.length]={t:"t",v:" "},u+=2;break;case"@":s[s.length]={t:"T",v:t},++u;break;case"B":case"b":if(e.charAt(u+1)==="1"||e.charAt(u+1)==="2"){if(f==null&&(f=Od(t,r,e.charAt(u+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(u,2)},m=h,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Od(t,r),f==null))return"";for(l=h;++u<e.length&&e.charAt(u).toLowerCase()===h;)l+=h;h==="m"&&m.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=y),s[s.length]={t:h,v:l},m=h;break;case"A":case"a":case"":var N={t:h,v:h};if(f==null&&(f=Od(t,r)),e.substr(u,3).toUpperCase()==="A/P"?(f!=null&&(N.v=f.H>=12?"P":"A"),N.t="T",y="h",u+=3):e.substr(u,5).toUpperCase()==="AM/PM"?(f!=null&&(N.v=f.H>=12?"PM":"AM"),N.t="T",u+=5,y="h"):e.substr(u,5).toUpperCase()==="/"?(f!=null&&(N.v=f.H>=12?"":""),N.t="T",u+=5,y="h"):(N.t="t",++u),f==null&&N.t==="T")return"";s[s.length]=N,m=h;break;case"[":for(l=h;e.charAt(u++)!=="]"&&u<e.length;)l+=e.charAt(u);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(zS)){if(f==null&&(f=Od(t,r),f==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},m=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",VS(e)||(s[s.length]={t:"t",v:l}));break;case".":if(f!=null){for(l=h;++u<e.length&&(h=e.charAt(u))==="0";)l+=h;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++u<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(u))>-1;)l+=h;s[s.length]={t:"n",v:l};break;case"?":for(l=h;e.charAt(++u)===h;)l+=h;s[s.length]={t:h,v:l},m=h;break;case"*":++u,(e.charAt(u)==" "||e.charAt(u)=="*")&&++u;break;case"(":case")":s[s.length]={t:n===1?"t":h,v:h},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)l+=e.charAt(u);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:h,v:h},++u;break;case"$":s[s.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+e);s[s.length]={t:"t",v:h},++u;break}var w=0,E=0,C;for(u=s.length-1,m="t";u>=0;--u)switch(s[u].t){case"h":case"H":s[u].t=y,m="h",w<1&&(w=1);break;case"s":(C=s[u].v.match(/\.0+$/))&&(E=Math.max(E,C[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":m=s[u].t;break;case"m":m==="s"&&(s[u].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[u].v.match(/[Hh]/)&&(w=1),w<2&&s[u].v.match(/[Mm]/)&&(w=2),w<3&&s[u].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var T="",O;for(u=0;u<s.length;++u)switch(s[u].t){case"t":case"T":case" ":case"D":break;case"X":s[u].v="",s[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[u].v=qO(s[u].t.charCodeAt(0),s[u].v,f,E),s[u].t="t";break;case"n":case"?":for(O=u+1;s[O]!=null&&((h=s[O].t)==="?"||h==="D"||(h===" "||h==="t")&&s[O+1]!=null&&(s[O+1].t==="?"||s[O+1].t==="t"&&s[O+1].v==="/")||s[u].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(s[O].v==="/"||s[O].v===" "&&s[O+1]!=null&&s[O+1].t=="?"));)s[u].v+=s[O].v,s[O]={v:"",t:";"},++O;T+=s[u].v,u=O-1;break;case"G":s[u].t="t",s[u].v=xp(t,r);break}var j="",q,D;if(T.length>0){T.charCodeAt(0)==40?(q=t<0&&T.charCodeAt(0)===45?-t:t,D=hs("n",T,q)):(q=t<0&&n>1?-t:t,D=hs("n",T,q),q<0&&s[0]&&s[0].t=="t"&&(D=D.substr(1),s[0].v="-"+s[0].v)),O=D.length-1;var U=s.length;for(u=0;u<s.length;++u)if(s[u]!=null&&s[u].t!="t"&&s[u].v.indexOf(".")>-1){U=u;break}var K=s.length;if(U===s.length&&D.indexOf("E")===-1){for(u=s.length-1;u>=0;--u)s[u]==null||"n?".indexOf(s[u].t)===-1||(O>=s[u].v.length-1?(O-=s[u].v.length,s[u].v=D.substr(O+1,s[u].v.length)):O<0?s[u].v="":(s[u].v=D.substr(0,O+1),O=-1),s[u].t="t",K=u);O>=0&&K<s.length&&(s[K].v=D.substr(0,O+1)+s[K].v)}else if(U!==s.length&&D.indexOf("E")===-1){for(O=D.indexOf(".")-1,u=U;u>=0;--u)if(!(s[u]==null||"n?".indexOf(s[u].t)===-1)){for(p=s[u].v.indexOf(".")>-1&&u===U?s[u].v.indexOf(".")-1:s[u].v.length-1,j=s[u].v.substr(p+1);p>=0;--p)O>=0&&(s[u].v.charAt(p)==="0"||s[u].v.charAt(p)==="#")&&(j=D.charAt(O--)+j);s[u].v=j,s[u].t="t",K=u}for(O>=0&&K<s.length&&(s[K].v=D.substr(0,O+1)+s[K].v),O=D.indexOf(".")+1,u=U;u<s.length;++u)if(!(s[u]==null||"n?(".indexOf(s[u].t)===-1&&u!==U)){for(p=s[u].v.indexOf(".")>-1&&u===U?s[u].v.indexOf(".")+1:0,j=s[u].v.substr(0,p);p<s[u].v.length;++p)O<D.length&&(j+=D.charAt(O++));s[u].v=j,s[u].t="t",K=u}}}for(u=0;u<s.length;++u)s[u]!=null&&"n?".indexOf(s[u].t)>-1&&(q=n>1&&t<0&&u>0&&s[u-1].v==="-"?-t:t,s[u].v=hs(s[u].t,s[u].v,q),s[u].t="t");var ie="";for(u=0;u!==s.length;++u)s[u]!=null&&(ie+=s[u].v);return ie}var fb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function hb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function nR(e,t){var r=tR(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var l=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,l];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var u=r[0].match(fb),h=r[1].match(fb);return hb(t,u)?[n,r[0]]:hb(t,h)?[n,r[1]]:[n,r[u!=null&&h!=null?2:1]]}return[n,l]}function ii(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Nr)[e],n==null&&(n=r.table&&r.table[cb[e]]||Nr[cb[e]]),n==null&&(n=BO[e]||"General");break}if(hf(n,0))return xp(t,r);t instanceof Date&&(t=RS(t,r.date1904));var s=nR(n,t);if(hf(s[1]))return xp(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return rR(s[1],t,r,s[0])}function HS(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Nr[r]==null){t<0&&(t=r);continue}if(Nr[r]==e){t=r;break}}t<0&&(t=391)}return Nr[t]=e,t}function Yf(e){for(var t=0;t!=392;++t)e[t]!==void 0&&HS(e[t],t)}function Gf(){Nr=PO()}var YS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aR(e){var t=typeof e=="number"?Nr[e]:e;return t=t.replace(YS,"(\\d+)"),new RegExp("^"+t+"$")}function sR(e,t,r){var n=-1,s=-1,l=-1,u=-1,h=-1,m=-1;(t.match(YS)||[]).forEach(function(g,y){var v=parseInt(r[y+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=v;break;case"d":l=v;break;case"h":u=v;break;case"s":m=v;break;case"m":u>=0?h=v:s=v;break}}),m>=0&&h==-1&&s>=0&&(h=s,s=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var p=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return u==-1&&h==-1&&m==-1?f:n==-1&&s==-1&&l==-1?p:f+"T"+p}var iR=function(){var e={};e.version="1.2.0";function t(){for(var D=0,U=new Array(256),K=0;K!=256;++K)D=K,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,U[K]=D;return typeof Int32Array<"u"?new Int32Array(U):U}var r=t();function n(D){var U=0,K=0,ie=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)te[ie]=D[ie];for(ie=0;ie!=256;++ie)for(K=D[ie],U=256+ie;U<4096;U+=256)K=te[U]=K>>>8^D[K&255];var G=[];for(ie=1;ie!=16;++ie)G[ie-1]=typeof Int32Array<"u"?te.subarray(ie*256,ie*256+256):te.slice(ie*256,ie*256+256);return G}var s=n(r),l=s[0],u=s[1],h=s[2],m=s[3],f=s[4],p=s[5],g=s[6],y=s[7],v=s[8],S=s[9],N=s[10],w=s[11],E=s[12],C=s[13],T=s[14];function O(D,U){for(var K=U^-1,ie=0,te=D.length;ie<te;)K=K>>>8^r[(K^D.charCodeAt(ie++))&255];return~K}function j(D,U){for(var K=U^-1,ie=D.length-15,te=0;te<ie;)K=T[D[te++]^K&255]^C[D[te++]^K>>8&255]^E[D[te++]^K>>16&255]^w[D[te++]^K>>>24]^N[D[te++]]^S[D[te++]]^v[D[te++]]^y[D[te++]]^g[D[te++]]^p[D[te++]]^f[D[te++]]^m[D[te++]]^h[D[te++]]^u[D[te++]]^l[D[te++]]^r[D[te++]];for(ie+=15;te<ie;)K=K>>>8^r[(K^D[te++])&255];return~K}function q(D,U){for(var K=U^-1,ie=0,te=D.length,G=0,de=0;ie<te;)G=D.charCodeAt(ie++),G<128?K=K>>>8^r[(K^G)&255]:G<2048?(K=K>>>8^r[(K^(192|G>>6&31))&255],K=K>>>8^r[(K^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,de=D.charCodeAt(ie++)&1023,K=K>>>8^r[(K^(240|G>>8&7))&255],K=K>>>8^r[(K^(128|G>>2&63))&255],K=K>>>8^r[(K^(128|de>>6&15|(G&3)<<4))&255],K=K>>>8^r[(K^(128|de&63))&255]):(K=K>>>8^r[(K^(224|G>>12&15))&255],K=K>>>8^r[(K^(128|G>>6&63))&255],K=K>>>8^r[(K^(128|G&63))&255]);return~K}return e.table=r,e.bstr=O,e.buf=j,e.str=q,e}(),er=function(){var t={};t.version="1.2.1";function r(M,X){for(var V=M.split("/"),Y=X.split("/"),Q=0,ee=0,ve=Math.min(V.length,Y.length);Q<ve;++Q){if(ee=V[Q].length-Y[Q].length)return ee;if(V[Q]!=Y[Q])return V[Q]<Y[Q]?-1:1}return V.length-Y.length}function n(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:n(M.slice(0,-1));var X=M.lastIndexOf("/");return X===-1?M:M.slice(0,X+1)}function s(M){if(M.charAt(M.length-1)=="/")return s(M.slice(0,-1));var X=M.lastIndexOf("/");return X===-1?M:M.slice(X+1)}function l(M,X){typeof X=="string"&&(X=new Date(X));var V=X.getHours();V=V<<6|X.getMinutes(),V=V<<5|X.getSeconds()>>>1,M.write_shift(2,V);var Y=X.getFullYear()-1980;Y=Y<<4|X.getMonth()+1,Y=Y<<5|X.getDate(),M.write_shift(2,Y)}function u(M){var X=M.read_shift(2)&65535,V=M.read_shift(2)&65535,Y=new Date,Q=V&31;V>>>=5;var ee=V&15;V>>>=4,Y.setMilliseconds(0),Y.setFullYear(V+1980),Y.setMonth(ee-1),Y.setDate(Q);var ve=X&31;X>>>=5;var De=X&63;return X>>>=6,Y.setHours(X),Y.setMinutes(De),Y.setSeconds(ve<<1),Y}function h(M){Xn(M,0);for(var X={},V=0;M.l<=M.length-4;){var Y=M.read_shift(2),Q=M.read_shift(2),ee=M.l+Q,ve={};switch(Y){case 21589:V=M.read_shift(1),V&1&&(ve.mtime=M.read_shift(4)),Q>5&&(V&2&&(ve.atime=M.read_shift(4)),V&4&&(ve.ctime=M.read_shift(4))),ve.mtime&&(ve.mt=new Date(ve.mtime*1e3));break}M.l=ee,X[Y]=ve}return X}var m;function f(){return m||(m={})}function p(M,X){if(M[0]==80&&M[1]==75)return Se(M,X);if((M[0]|32)==109&&(M[1]|32)==105)return Pr(M,X);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var V=3,Y=512,Q=0,ee=0,ve=0,De=0,pe=0,we=[],Te=M.slice(0,512);Xn(Te,0);var L=g(Te);switch(V=L[0],V){case 3:Y=512;break;case 4:Y=4096;break;case 0:if(L[1]==0)return Se(M,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+V)}Y!==512&&(Te=M.slice(0,Y),Xn(Te,28));var se=M.slice(0,Y);y(Te,V);var xe=Te.read_shift(4,"i");if(V===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);Te.l+=4,ve=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),De=Te.read_shift(4,"i"),Q=Te.read_shift(4,"i"),pe=Te.read_shift(4,"i"),ee=Te.read_shift(4,"i");for(var fe=-1,ke=0;ke<109&&(fe=Te.read_shift(4,"i"),!(fe<0));++ke)we[ke]=fe;var Be=v(M,Y);w(pe,ee,Be,Y,we);var Je=C(Be,ve,we,Y);Je[ve].name="!Directory",Q>0&&De!==de&&(Je[De].name="!MiniFAT"),Je[we[0]].name="!FAT",Je.fat_addrs=we,Je.ssz=Y;var ct={},ut=[],_t=[],wt=[];T(ve,Je,Be,ut,Q,ct,_t,De),S(_t,wt,ut),ut.shift();var ir={FileIndex:_t,FullPaths:wt};return X&&X.raw&&(ir.raw={header:se,sectors:Be}),ir}function g(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(J,"Header Signature: "),M.l+=16;var X=M.read_shift(2,"u");return[M.read_shift(2,"u"),X]}function y(M,X){var V=9;switch(M.l+=2,V=M.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+V);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+V);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+V)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function v(M,X){for(var V=Math.ceil(M.length/X)-1,Y=[],Q=1;Q<V;++Q)Y[Q-1]=M.slice(Q*X,(Q+1)*X);return Y[V-1]=M.slice(V*X),Y}function S(M,X,V){for(var Y=0,Q=0,ee=0,ve=0,De=0,pe=V.length,we=[],Te=[];Y<pe;++Y)we[Y]=Te[Y]=Y,X[Y]=V[Y];for(;De<Te.length;++De)Y=Te[De],Q=M[Y].L,ee=M[Y].R,ve=M[Y].C,we[Y]===Y&&(Q!==-1&&we[Q]!==Q&&(we[Y]=we[Q]),ee!==-1&&we[ee]!==ee&&(we[Y]=we[ee])),ve!==-1&&(we[ve]=Y),Q!==-1&&Y!=we[Y]&&(we[Q]=we[Y],Te.lastIndexOf(Q)<De&&Te.push(Q)),ee!==-1&&Y!=we[Y]&&(we[ee]=we[Y],Te.lastIndexOf(ee)<De&&Te.push(ee));for(Y=1;Y<pe;++Y)we[Y]===Y&&(ee!==-1&&we[ee]!==ee?we[Y]=we[ee]:Q!==-1&&we[Q]!==Q&&(we[Y]=we[Q]));for(Y=1;Y<pe;++Y)if(M[Y].type!==0){if(De=Y,De!=we[De])do De=we[De],X[Y]=X[De]+"/"+X[Y];while(De!==0&&we[De]!==-1&&De!=we[De]);we[Y]=-1}for(X[0]+="/",Y=1;Y<pe;++Y)M[Y].type!==2&&(X[Y]+="/")}function N(M,X,V){for(var Y=M.start,Q=M.size,ee=[],ve=Y;V&&Q>0&&ve>=0;)ee.push(X.slice(ve*G,ve*G+G)),Q-=G,ve=Fi(V,ve*4);return ee.length===0?Oe(0):on(ee).slice(0,M.size)}function w(M,X,V,Y,Q){var ee=de;if(M===de){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var ve=V[M],De=(Y>>>2)-1;if(!ve)return;for(var pe=0;pe<De&&(ee=Fi(ve,pe*4))!==de;++pe)Q.push(ee);w(Fi(ve,Y-4),X-1,V,Y,Q)}}function E(M,X,V,Y,Q){var ee=[],ve=[];Q||(Q=[]);var De=Y-1,pe=0,we=0;for(pe=X;pe>=0;){Q[pe]=!0,ee[ee.length]=pe,ve.push(M[pe]);var Te=V[Math.floor(pe*4/Y)];if(we=pe*4&De,Y<4+we)throw new Error("FAT boundary crossed: "+pe+" 4 "+Y);if(!M[Te])break;pe=Fi(M[Te],we)}return{nodes:ee,data:wb([ve])}}function C(M,X,V,Y){var Q=M.length,ee=[],ve=[],De=[],pe=[],we=Y-1,Te=0,L=0,se=0,xe=0;for(Te=0;Te<Q;++Te)if(De=[],se=Te+X,se>=Q&&(se-=Q),!ve[se]){pe=[];var fe=[];for(L=se;L>=0;){fe[L]=!0,ve[L]=!0,De[De.length]=L,pe.push(M[L]);var ke=V[Math.floor(L*4/Y)];if(xe=L*4&we,Y<4+xe)throw new Error("FAT boundary crossed: "+L+" 4 "+Y);if(!M[ke]||(L=Fi(M[ke],xe),fe[L]))break}ee[se]={nodes:De,data:wb([pe])}}return ee}function T(M,X,V,Y,Q,ee,ve,De){for(var pe=0,we=Y.length?2:0,Te=X[M].data,L=0,se=0,xe;L<Te.length;L+=128){var fe=Te.slice(L,L+128);Xn(fe,64),se=fe.read_shift(2),xe=gx(fe,0,se-we),Y.push(xe);var ke={name:xe,type:fe.read_shift(1),color:fe.read_shift(1),L:fe.read_shift(4,"i"),R:fe.read_shift(4,"i"),C:fe.read_shift(4,"i"),clsid:fe.read_shift(16),state:fe.read_shift(4,"i"),start:0,size:0},Be=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Be!==0&&(ke.ct=O(fe,fe.l-8));var Je=fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2)+fe.read_shift(2);Je!==0&&(ke.mt=O(fe,fe.l-8)),ke.start=fe.read_shift(4,"i"),ke.size=fe.read_shift(4,"i"),ke.size<0&&ke.start<0&&(ke.size=ke.type=0,ke.start=de,ke.name=""),ke.type===5?(pe=ke.start,Q>0&&pe!==de&&(X[pe].name="!StreamData")):ke.size>=4096?(ke.storage="fat",X[ke.start]===void 0&&(X[ke.start]=E(V,ke.start,X.fat_addrs,X.ssz)),X[ke.start].name=ke.name,ke.content=X[ke.start].data.slice(0,ke.size)):(ke.storage="minifat",ke.size<0?ke.size=0:pe!==de&&ke.start!==de&&X[pe]&&(ke.content=N(ke,X[pe].data,(X[De]||{}).data))),ke.content&&Xn(ke.content,0),ee[xe]=ke,ve.push(ke)}}function O(M,X){return new Date((Qn(M,X+4)/1e7*Math.pow(2,32)+Qn(M,X)/1e7-11644473600)*1e3)}function j(M,X){return f(),p(m.readFileSync(M),X)}function q(M,X){var V=X&&X.type;switch(V||Bt&&Buffer.isBuffer(M)&&(V="buffer"),V||"base64"){case"file":return j(M,X);case"base64":return p(Ca(ws(M)),X);case"binary":return p(Ca(M),X)}return p(M,X)}function D(M,X){var V=X||{},Y=V.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=Y+"/",M.FileIndex[0]={name:Y,type:5}),V.CLSID&&(M.FileIndex[0].clsid=V.CLSID),U(M)}function U(M){var X="Sh33tJ5";if(!er.find(M,"/"+X)){var V=Oe(4);V[0]=55,V[1]=V[3]=50,V[2]=54,M.FileIndex.push({name:X,type:2,content:V,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+X),K(M)}}function K(M,X){D(M);for(var V=!1,Y=!1,Q=M.FullPaths.length-1;Q>=0;--Q){var ee=M.FileIndex[Q];switch(ee.type){case 0:Y?V=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:Y=!0,isNaN(ee.R*ee.L*ee.C)&&(V=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(V=!0);break;default:V=!0;break}}if(!(!V&&!X)){var ve=new Date(1987,1,19),De=0,pe=Object.create?Object.create(null):{},we=[];for(Q=0;Q<M.FullPaths.length;++Q)pe[M.FullPaths[Q]]=!0,M.FileIndex[Q].type!==0&&we.push([M.FullPaths[Q],M.FileIndex[Q]]);for(Q=0;Q<we.length;++Q){var Te=n(we[Q][0]);Y=pe[Te],Y||(we.push([Te,{name:s(Te).replace("/",""),type:1,clsid:F,ct:ve,mt:ve,content:null}]),pe[Te]=!0)}for(we.sort(function(xe,fe){return r(xe[0],fe[0])}),M.FullPaths=[],M.FileIndex=[],Q=0;Q<we.length;++Q)M.FullPaths[Q]=we[Q][0],M.FileIndex[Q]=we[Q][1];for(Q=0;Q<we.length;++Q){var L=M.FileIndex[Q],se=M.FullPaths[Q];if(L.name=s(se).replace("/",""),L.L=L.R=L.C=-(L.color=1),L.size=L.content?L.content.length:0,L.start=0,L.clsid=L.clsid||F,Q===0)L.C=we.length>1?1:-1,L.size=0,L.type=5;else if(se.slice(-1)=="/"){for(De=Q+1;De<we.length&&n(M.FullPaths[De])!=se;++De);for(L.C=De>=we.length?-1:De,De=Q+1;De<we.length&&n(M.FullPaths[De])!=n(se);++De);L.R=De>=we.length?-1:De,L.type=1}else n(M.FullPaths[Q+1]||"")==n(se)&&(L.R=Q+1),L.type=2}}}function ie(M,X){var V=X||{};if(V.fileType=="mad")return fn(M,V);switch(K(M),V.fileType){case"zip":return Ie(M,V)}var Y=function(xe){for(var fe=0,ke=0,Be=0;Be<xe.FileIndex.length;++Be){var Je=xe.FileIndex[Be];if(Je.content){var ct=Je.content.length;ct>0&&(ct<4096?fe+=ct+63>>6:ke+=ct+511>>9)}}for(var ut=xe.FullPaths.length+3>>2,_t=fe+7>>3,wt=fe+127>>7,ir=_t+ke+ut+wt,Vt=ir+127>>7,rr=Vt<=109?0:Math.ceil((Vt-109)/127);ir+Vt+rr+127>>7>Vt;)rr=++Vt<=109?0:Math.ceil((Vt-109)/127);var zt=[1,rr,Vt,wt,ut,ke,fe,0];return xe.FileIndex[0].size=fe<<6,zt[7]=(xe.FileIndex[0].start=zt[0]+zt[1]+zt[2]+zt[3]+zt[4]+zt[5])+(zt[6]+7>>3),zt}(M),Q=Oe(Y[7]<<9),ee=0,ve=0;{for(ee=0;ee<8;++ee)Q.write_shift(1,W[ee]);for(ee=0;ee<8;++ee)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),ee=0;ee<3;++ee)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,Y[2]),Q.write_shift(4,Y[0]+Y[1]+Y[2]+Y[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,Y[3]?Y[0]+Y[1]+Y[2]-1:de),Q.write_shift(4,Y[3]),Q.write_shift(-4,Y[1]?Y[0]-1:de),Q.write_shift(4,Y[1]),ee=0;ee<109;++ee)Q.write_shift(-4,ee<Y[2]?Y[1]+ee:-1)}if(Y[1])for(ve=0;ve<Y[1];++ve){for(;ee<236+ve*127;++ee)Q.write_shift(-4,ee<Y[2]?Y[1]+ee:-1);Q.write_shift(-4,ve===Y[1]-1?de:ve+1)}var De=function(xe){for(ve+=xe;ee<ve-1;++ee)Q.write_shift(-4,ee+1);xe&&(++ee,Q.write_shift(-4,de))};for(ve=ee=0,ve+=Y[1];ee<ve;++ee)Q.write_shift(-4,Z.DIFSECT);for(ve+=Y[2];ee<ve;++ee)Q.write_shift(-4,Z.FATSECT);De(Y[3]),De(Y[4]);for(var pe=0,we=0,Te=M.FileIndex[0];pe<M.FileIndex.length;++pe)Te=M.FileIndex[pe],Te.content&&(we=Te.content.length,!(we<4096)&&(Te.start=ve,De(we+511>>9)));for(De(Y[6]+7>>3);Q.l&511;)Q.write_shift(-4,Z.ENDOFCHAIN);for(ve=ee=0,pe=0;pe<M.FileIndex.length;++pe)Te=M.FileIndex[pe],Te.content&&(we=Te.content.length,!(!we||we>=4096)&&(Te.start=ve,De(we+63>>6)));for(;Q.l&511;)Q.write_shift(-4,Z.ENDOFCHAIN);for(ee=0;ee<Y[4]<<2;++ee){var L=M.FullPaths[ee];if(!L||L.length===0){for(pe=0;pe<17;++pe)Q.write_shift(4,0);for(pe=0;pe<3;++pe)Q.write_shift(4,-1);for(pe=0;pe<12;++pe)Q.write_shift(4,0);continue}Te=M.FileIndex[ee],ee===0&&(Te.start=Te.size?Te.start-1:de);var se=ee===0&&V.root||Te.name;if(we=2*(se.length+1),Q.write_shift(64,se,"utf16le"),Q.write_shift(2,we),Q.write_shift(1,Te.type),Q.write_shift(1,Te.color),Q.write_shift(-4,Te.L),Q.write_shift(-4,Te.R),Q.write_shift(-4,Te.C),Te.clsid)Q.write_shift(16,Te.clsid,"hex");else for(pe=0;pe<4;++pe)Q.write_shift(4,0);Q.write_shift(4,Te.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,Te.start),Q.write_shift(4,Te.size),Q.write_shift(4,0)}for(ee=1;ee<M.FileIndex.length;++ee)if(Te=M.FileIndex[ee],Te.size>=4096)if(Q.l=Te.start+1<<9,Bt&&Buffer.isBuffer(Te.content))Te.content.copy(Q,Q.l,0,Te.size),Q.l+=Te.size+511&-512;else{for(pe=0;pe<Te.size;++pe)Q.write_shift(1,Te.content[pe]);for(;pe&511;++pe)Q.write_shift(1,0)}for(ee=1;ee<M.FileIndex.length;++ee)if(Te=M.FileIndex[ee],Te.size>0&&Te.size<4096)if(Bt&&Buffer.isBuffer(Te.content))Te.content.copy(Q,Q.l,0,Te.size),Q.l+=Te.size+63&-64;else{for(pe=0;pe<Te.size;++pe)Q.write_shift(1,Te.content[pe]);for(;pe&63;++pe)Q.write_shift(1,0)}if(Bt)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function te(M,X){var V=M.FullPaths.map(function(pe){return pe.toUpperCase()}),Y=V.map(function(pe){var we=pe.split("/");return we[we.length-(pe.slice(-1)=="/"?2:1)]}),Q=!1;X.charCodeAt(0)===47?(Q=!0,X=V[0].slice(0,-1)+X):Q=X.indexOf("/")!==-1;var ee=X.toUpperCase(),ve=Q===!0?V.indexOf(ee):Y.indexOf(ee);if(ve!==-1)return M.FileIndex[ve];var De=!ee.match(kd);for(ee=ee.replace(Ac,""),De&&(ee=ee.replace(kd,"!")),ve=0;ve<V.length;++ve)if((De?V[ve].replace(kd,"!"):V[ve]).replace(Ac,"")==ee||(De?Y[ve].replace(kd,"!"):Y[ve]).replace(Ac,"")==ee)return M.FileIndex[ve];return null}var G=64,de=-2,J="d0cf11e0a1b11ae1",W=[208,207,17,224,161,177,26,225],F="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:de,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:F,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(M,X,V){f();var Y=ie(M,V);m.writeFileSync(X,Y)}function le(M){for(var X=new Array(M.length),V=0;V<M.length;++V)X[V]=String.fromCharCode(M[V]);return X.join("")}function R(M,X){var V=ie(M,X);switch(X&&X.type||"buffer"){case"file":return f(),m.writeFileSync(X.filename,V),V;case"binary":return typeof V=="string"?V:le(V);case"base64":return qc(typeof V=="string"?V:le(V));case"buffer":if(Bt)return Buffer.isBuffer(V)?V:Ts(V);case"array":return typeof V=="string"?Ca(V):V}return V}var ne;function P(M){try{var X=M.InflateRaw,V=new X;if(V._processChunk(new Uint8Array([3,0]),V._finishFlushFlag),V.bytesRead)ne=M;else throw new Error("zlib does not expose bytesRead")}catch(Y){console.error("cannot use native zlib: "+(Y.message||Y))}}function H(M,X){if(!ne)return Un(M,X);var V=ne.InflateRaw,Y=new V,Q=Y._processChunk(M.slice(M.l),Y._finishFlushFlag);return M.l+=Y.bytesRead,Q}function z(M){return ne?ne.deflateRawSync(M):tr(M)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],re=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(M){var X=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(X>>16|X>>8|X)&255}for(var je=typeof Uint8Array<"u",Re=je?new Uint8Array(256):[],We=0;We<256;++We)Re[We]=me(We);function Ge(M,X){var V=Re[M&255];return X<=8?V>>>8-X:(V=V<<8|Re[M>>8&255],X<=16?V>>>16-X:(V=V<<8|Re[M>>16&255],V>>>24-X))}function Ve(M,X){var V=X&7,Y=X>>>3;return(M[Y]|(V<=6?0:M[Y+1]<<8))>>>V&3}function He(M,X){var V=X&7,Y=X>>>3;return(M[Y]|(V<=5?0:M[Y+1]<<8))>>>V&7}function ge(M,X){var V=X&7,Y=X>>>3;return(M[Y]|(V<=4?0:M[Y+1]<<8))>>>V&15}function Ce(M,X){var V=X&7,Y=X>>>3;return(M[Y]|(V<=3?0:M[Y+1]<<8))>>>V&31}function _e(M,X){var V=X&7,Y=X>>>3;return(M[Y]|(V<=1?0:M[Y+1]<<8))>>>V&127}function nt(M,X,V){var Y=X&7,Q=X>>>3,ee=(1<<V)-1,ve=M[Q]>>>Y;return V<8-Y||(ve|=M[Q+1]<<8-Y,V<16-Y)||(ve|=M[Q+2]<<16-Y,V<24-Y)||(ve|=M[Q+3]<<24-Y),ve&ee}function Ke(M,X,V){var Y=X&7,Q=X>>>3;return Y<=5?M[Q]|=(V&7)<<Y:(M[Q]|=V<<Y&255,M[Q+1]=(V&7)>>8-Y),X+3}function rt(M,X,V){var Y=X&7,Q=X>>>3;return V=(V&1)<<Y,M[Q]|=V,X+1}function ot(M,X,V){var Y=X&7,Q=X>>>3;return V<<=Y,M[Q]|=V&255,V>>>=8,M[Q+1]=V,X+8}function At(M,X,V){var Y=X&7,Q=X>>>3;return V<<=Y,M[Q]|=V&255,V>>>=8,M[Q+1]=V&255,M[Q+2]=V>>>8,X+16}function Ze(M,X){var V=M.length,Y=2*V>X?2*V:X+5,Q=0;if(V>=X)return M;if(Bt){var ee=ib(Y);if(M.copy)M.copy(ee);else for(;Q<M.length;++Q)ee[Q]=M[Q];return ee}else if(je){var ve=new Uint8Array(Y);if(ve.set)ve.set(M);else for(;Q<V;++Q)ve[Q]=M[Q];return ve}return M.length=Y,M}function et(M){for(var X=new Array(M),V=0;V<M;++V)X[V]=0;return X}function xt(M,X,V){var Y=1,Q=0,ee=0,ve=0,De=0,pe=M.length,we=je?new Uint16Array(32):et(32);for(ee=0;ee<32;++ee)we[ee]=0;for(ee=pe;ee<V;++ee)M[ee]=0;pe=M.length;var Te=je?new Uint16Array(pe):et(pe);for(ee=0;ee<pe;++ee)we[Q=M[ee]]++,Y<Q&&(Y=Q),Te[ee]=0;for(we[0]=0,ee=1;ee<=Y;++ee)we[ee+16]=De=De+we[ee-1]<<1;for(ee=0;ee<pe;++ee)De=M[ee],De!=0&&(Te[ee]=we[De+16]++);var L=0;for(ee=0;ee<pe;++ee)if(L=M[ee],L!=0)for(De=Ge(Te[ee],Y)>>Y-L,ve=(1<<Y+4-L)-1;ve>=0;--ve)X[De|ve<<L]=L&15|ee<<4;return Y}var Qe=je?new Uint16Array(512):et(512),Xe=je?new Uint16Array(32):et(32);if(!je){for(var gt=0;gt<512;++gt)Qe[gt]=0;for(gt=0;gt<32;++gt)Xe[gt]=0}(function(){for(var M=[],X=0;X<32;X++)M.push(5);xt(M,Xe,32);var V=[];for(X=0;X<=143;X++)V.push(8);for(;X<=255;X++)V.push(9);for(;X<=279;X++)V.push(7);for(;X<=287;X++)V.push(8);xt(V,Qe,288)})();var Ft=function(){for(var X=je?new Uint8Array(32768):[],V=0,Y=0;V<re.length-1;++V)for(;Y<re[V+1];++Y)X[Y]=V;for(;Y<32768;++Y)X[Y]=29;var Q=je?new Uint8Array(259):[];for(V=0,Y=0;V<ce.length-1;++V)for(;Y<ce[V+1];++Y)Q[Y]=V;function ee(De,pe){for(var we=0;we<De.length;){var Te=Math.min(65535,De.length-we),L=we+Te==De.length;for(pe.write_shift(1,+L),pe.write_shift(2,Te),pe.write_shift(2,~Te&65535);Te-- >0;)pe[pe.l++]=De[we++]}return pe.l}function ve(De,pe){for(var we=0,Te=0,L=je?new Uint16Array(32768):[];Te<De.length;){var se=Math.min(65535,De.length-Te);if(se<10){for(we=Ke(pe,we,+(Te+se==De.length)),we&7&&(we+=8-(we&7)),pe.l=we/8|0,pe.write_shift(2,se),pe.write_shift(2,~se&65535);se-- >0;)pe[pe.l++]=De[Te++];we=pe.l*8;continue}we=Ke(pe,we,+(Te+se==De.length)+2);for(var xe=0;se-- >0;){var fe=De[Te];xe=(xe<<5^fe)&32767;var ke=-1,Be=0;if((ke=L[xe])&&(ke|=Te&-32768,ke>Te&&(ke-=32768),ke<Te))for(;De[ke+Be]==De[Te+Be]&&Be<250;)++Be;if(Be>2){fe=Q[Be],fe<=22?we=ot(pe,we,Re[fe+1]>>1)-1:(ot(pe,we,3),we+=5,ot(pe,we,Re[fe-23]>>5),we+=3);var Je=fe<8?0:fe-4>>2;Je>0&&(At(pe,we,Be-ce[fe]),we+=Je),fe=X[Te-ke],we=ot(pe,we,Re[fe]>>3),we-=3;var ct=fe<4?0:fe-2>>1;ct>0&&(At(pe,we,Te-ke-re[fe]),we+=ct);for(var ut=0;ut<Be;++ut)L[xe]=Te&32767,xe=(xe<<5^De[Te])&32767,++Te;se-=Be-1}else fe<=143?fe=fe+48:we=rt(pe,we,1),we=ot(pe,we,Re[fe]),L[xe]=Te&32767,++Te}we=ot(pe,we,0)-1}return pe.l=(we+7)/8|0,pe.l}return function(pe,we){return pe.length<8?ee(pe,we):ve(pe,we)}}();function tr(M){var X=Oe(50+Math.floor(M.length*1.1)),V=Ft(M,X);return X.slice(0,V)}var Ut=je?new Uint16Array(32768):et(32768),Qr=je?new Uint16Array(32768):et(32768),Zr=je?new Uint16Array(128):et(128),It=1,Lr=1;function dn(M,X){var V=Ce(M,X)+257;X+=5;var Y=Ce(M,X)+1;X+=5;var Q=ge(M,X)+4;X+=4;for(var ee=0,ve=je?new Uint8Array(19):et(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,we=je?new Uint8Array(8):et(8),Te=je?new Uint8Array(8):et(8),L=ve.length,se=0;se<Q;++se)ve[_[se]]=ee=He(M,X),pe<ee&&(pe=ee),we[ee]++,X+=3;var xe=0;for(we[0]=0,se=1;se<=pe;++se)Te[se]=xe=xe+we[se-1]<<1;for(se=0;se<L;++se)(xe=ve[se])!=0&&(De[se]=Te[xe]++);var fe=0;for(se=0;se<L;++se)if(fe=ve[se],fe!=0){xe=Re[De[se]]>>8-fe;for(var ke=(1<<7-fe)-1;ke>=0;--ke)Zr[xe|ke<<fe]=fe&7|se<<3}var Be=[];for(pe=1;Be.length<V+Y;)switch(xe=Zr[_e(M,X)],X+=xe&7,xe>>>=3){case 16:for(ee=3+Ve(M,X),X+=2,xe=Be[Be.length-1];ee-- >0;)Be.push(xe);break;case 17:for(ee=3+He(M,X),X+=3;ee-- >0;)Be.push(0);break;case 18:for(ee=11+_e(M,X),X+=7;ee-- >0;)Be.push(0);break;default:Be.push(xe),pe<xe&&(pe=xe);break}var Je=Be.slice(0,V),ct=Be.slice(V);for(se=V;se<286;++se)Je[se]=0;for(se=Y;se<30;++se)ct[se]=0;return It=xt(Je,Ut,286),Lr=xt(ct,Qr,30),X}function Er(M,X){if(M[0]==3&&!(M[1]&3))return[qi(X),2];for(var V=0,Y=0,Q=ib(X||1<<18),ee=0,ve=Q.length>>>0,De=0,pe=0;(Y&1)==0;){if(Y=He(M,V),V+=3,Y>>>1)Y>>1==1?(De=9,pe=5):(V=dn(M,V),De=It,pe=Lr);else{V&7&&(V+=8-(V&7));var we=M[V>>>3]|M[(V>>>3)+1]<<8;if(V+=32,we>0)for(!X&&ve<ee+we&&(Q=Ze(Q,ee+we),ve=Q.length);we-- >0;)Q[ee++]=M[V>>>3],V+=8;continue}for(;;){!X&&ve<ee+32767&&(Q=Ze(Q,ee+32767),ve=Q.length);var Te=nt(M,V,De),L=Y>>>1==1?Qe[Te]:Ut[Te];if(V+=L&15,L>>>=4,(L>>>8&255)===0)Q[ee++]=L;else{if(L==256)break;L-=257;var se=L<8?0:L-4>>2;se>5&&(se=0);var xe=ee+ce[L];se>0&&(xe+=nt(M,V,se),V+=se),Te=nt(M,V,pe),L=Y>>>1==1?Xe[Te]:Qr[Te],V+=L&15,L>>>=4;var fe=L<4?0:L-2>>1,ke=re[L];for(fe>0&&(ke+=nt(M,V,fe),V+=fe),!X&&ve<xe&&(Q=Ze(Q,xe+100),ve=Q.length);ee<xe;)Q[ee]=Q[ee-ke],++ee}}}return X?[Q,V+7>>>3]:[Q.slice(0,ee),V+7>>>3]}function Un(M,X){var V=M.slice(M.l||0),Y=Er(V,X);return M.l+=Y[1],Y[0]}function I(M,X){if(M)typeof console<"u"&&console.error(X);else throw new Error(X)}function Se(M,X){var V=M;Xn(V,0);var Y=[],Q=[],ee={FileIndex:Y,FullPaths:Q};D(ee,{root:X.root});for(var ve=V.length-4;(V[ve]!=80||V[ve+1]!=75||V[ve+2]!=5||V[ve+3]!=6)&&ve>=0;)--ve;V.l=ve+4,V.l+=4;var De=V.read_shift(2);V.l+=6;var pe=V.read_shift(4);for(V.l=pe,ve=0;ve<De;++ve){V.l+=20;var we=V.read_shift(4),Te=V.read_shift(4),L=V.read_shift(2),se=V.read_shift(2),xe=V.read_shift(2);V.l+=8;var fe=V.read_shift(4),ke=h(V.slice(V.l+L,V.l+L+se));V.l+=L+se+xe;var Be=V.l;V.l=fe+4,Ue(V,we,Te,ee,ke),V.l=Be}return ee}function Ue(M,X,V,Y,Q){M.l+=2;var ee=M.read_shift(2),ve=M.read_shift(2),De=u(M);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var pe=M.read_shift(4),we=M.read_shift(4),Te=M.read_shift(4),L=M.read_shift(2),se=M.read_shift(2),xe="",fe=0;fe<L;++fe)xe+=String.fromCharCode(M[M.l++]);if(se){var ke=h(M.slice(M.l,M.l+se));(ke[21589]||{}).mt&&(De=ke[21589].mt),((Q||{})[21589]||{}).mt&&(De=Q[21589].mt)}M.l+=se;var Be=M.slice(M.l,M.l+we);switch(ve){case 8:Be=H(M,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ve)}var Je=!1;ee&8&&(pe=M.read_shift(4),pe==134695760&&(pe=M.read_shift(4),Je=!0),we=M.read_shift(4),Te=M.read_shift(4)),we!=X&&I(Je,"Bad compressed size: "+X+" != "+we),Te!=V&&I(Je,"Bad uncompressed size: "+V+" != "+Te),Lt(Y,xe,Be,{unsafe:!0,mt:De})}function Ie(M,X){var V=X||{},Y=[],Q=[],ee=Oe(1),ve=V.compression?8:0,De=0,pe=0,we=0,Te=0,L=0,se=M.FullPaths[0],xe=se,fe=M.FileIndex[0],ke=[],Be=0;for(pe=1;pe<M.FullPaths.length;++pe)if(xe=M.FullPaths[pe].slice(se.length),fe=M.FileIndex[pe],!(!fe.size||!fe.content||xe=="Sh33tJ5")){var Je=Te,ct=Oe(xe.length);for(we=0;we<xe.length;++we)ct.write_shift(1,xe.charCodeAt(we)&127);ct=ct.slice(0,ct.l),ke[L]=iR.buf(fe.content,0);var ut=fe.content;ve==8&&(ut=z(ut)),ee=Oe(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,De),ee.write_shift(2,ve),fe.mt?l(ee,fe.mt):ee.write_shift(4,0),ee.write_shift(-4,ke[L]),ee.write_shift(4,ut.length),ee.write_shift(4,fe.content.length),ee.write_shift(2,ct.length),ee.write_shift(2,0),Te+=ee.length,Y.push(ee),Te+=ct.length,Y.push(ct),Te+=ut.length,Y.push(ut),ee=Oe(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,De),ee.write_shift(2,ve),ee.write_shift(4,0),ee.write_shift(-4,ke[L]),ee.write_shift(4,ut.length),ee.write_shift(4,fe.content.length),ee.write_shift(2,ct.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,Je),Be+=ee.l,Q.push(ee),Be+=ct.length,Q.push(ct),++L}return ee=Oe(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,L),ee.write_shift(2,L),ee.write_shift(4,Be),ee.write_shift(4,Te),ee.write_shift(2,0),on([on(Y),on(Q),ee])}var st={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lt(M,X){if(M.ctype)return M.ctype;var V=M.name||"",Y=V.match(/\.([^\.]+)$/);return Y&&st[Y[1]]||X&&(Y=(V=X).match(/[\.\\]([^\.\\])+$/),Y&&st[Y[1]])?st[Y[1]]:"application/octet-stream"}function yt(M){for(var X=qc(M),V=[],Y=0;Y<X.length;Y+=76)V.push(X.slice(Y,Y+76));return V.join(`\r
`)+`\r
`}function Ye(M){var X=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var Te=we.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var V=[],Y=X.split(`\r
`),Q=0;Q<Y.length;++Q){var ee=Y[Q];if(ee.length==0){V.push("");continue}for(var ve=0;ve<ee.length;){var De=76,pe=ee.slice(ve,ve+De);pe.charAt(De-1)=="="?De--:pe.charAt(De-2)=="="?De-=2:pe.charAt(De-3)=="="&&(De-=3),pe=ee.slice(ve,ve+De),ve+=De,ve<ee.length&&(pe+="="),V.push(pe)}}return V.join(`\r
`)}function Yr(M){for(var X=[],V=0;V<M.length;++V){for(var Y=M[V];V<=M.length&&Y.charAt(Y.length-1)=="=";)Y=Y.slice(0,Y.length-1)+M[++V];X.push(Y)}for(var Q=0;Q<X.length;++Q)X[Q]=X[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return Ca(X.join(`\r
`))}function Jr(M,X,V){for(var Y="",Q="",ee="",ve,De=0;De<10;++De){var pe=X[De];if(!pe||pe.match(/^\s*$/))break;var we=pe.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":Y=we[2].trim();break;case"content-type":ee=we[2].trim();break;case"content-transfer-encoding":Q=we[2].trim();break}}switch(++De,Q.toLowerCase()){case"base64":ve=Ca(ws(X.slice(De).join("")));break;case"quoted-printable":ve=Yr(X.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var Te=Lt(M,Y.slice(V.length),ve,{unsafe:!0});ee&&(Te.ctype=ee)}function Pr(M,X){if(le(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var V=X&&X.root||"",Y=(Bt&&Buffer.isBuffer(M)?M.toString("binary"):le(M)).split(`\r
`),Q=0,ee="";for(Q=0;Q<Y.length;++Q)if(ee=Y[Q],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),V||(V=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,V.length)!=V))for(;V.length>0&&(V=V.slice(0,V.length-1),V=V.slice(0,V.lastIndexOf("/")+1),ee.slice(0,V.length)!=V););var ve=(Y[1]||"").match(/boundary="(.*?)"/);if(!ve)throw new Error("MAD cannot find boundary");var De="--"+(ve[1]||""),pe=[],we=[],Te={FileIndex:pe,FullPaths:we};D(Te);var L,se=0;for(Q=0;Q<Y.length;++Q){var xe=Y[Q];xe!==De&&xe!==De+"--"||(se++&&Jr(Te,Y.slice(L,Q),V),L=Q)}return Te}function fn(M,X){var V=X||{},Y=V.boundary||"SheetJS";Y="------="+Y;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Y.slice(2)+'"',"","",""],ee=M.FullPaths[0],ve=ee,De=M.FileIndex[0],pe=1;pe<M.FullPaths.length;++pe)if(ve=M.FullPaths[pe].slice(ee.length),De=M.FileIndex[pe],!(!De.size||!De.content||ve=="Sh33tJ5")){ve=ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var we=De.content,Te=Bt&&Buffer.isBuffer(we)?we.toString("binary"):le(we),L=0,se=Math.min(1024,Te.length),xe=0,fe=0;fe<=se;++fe)(xe=Te.charCodeAt(fe))>=32&&xe<128&&++L;var ke=L>=se*4/5;Q.push(Y),Q.push("Content-Location: "+(V.root||"file:///C:/SheetJS/")+ve),Q.push("Content-Transfer-Encoding: "+(ke?"quoted-printable":"base64")),Q.push("Content-Type: "+lt(De,ve)),Q.push(""),Q.push(ke?Ye(Te):yt(Te))}return Q.push(Y+`--\r
`),Q.join(`\r
`)}function ar(M){var X={};return D(X,M),X}function Lt(M,X,V,Y){var Q=Y&&Y.unsafe;Q||D(M);var ee=!Q&&er.find(M,X);if(!ee){var ve=M.FullPaths[0];X.slice(0,ve.length)==ve?ve=X:(ve.slice(-1)!="/"&&(ve+="/"),ve=(ve+X).replace("//","/")),ee={name:s(X),type:2},M.FileIndex.push(ee),M.FullPaths.push(ve),Q||er.utils.cfb_gc(M)}return ee.content=V,ee.size=V?V.length:0,Y&&(Y.CLSID&&(ee.clsid=Y.CLSID),Y.mt&&(ee.mt=Y.mt),Y.ct&&(ee.ct=Y.ct)),ee}function Br(M,X){D(M);var V=er.find(M,X);if(V){for(var Y=0;Y<M.FileIndex.length;++Y)if(M.FileIndex[Y]==V)return M.FileIndex.splice(Y,1),M.FullPaths.splice(Y,1),!0}return!1}function Ra(M,X,V){D(M);var Y=er.find(M,X);if(Y){for(var Q=0;Q<M.FileIndex.length;++Q)if(M.FileIndex[Q]==Y)return M.FileIndex[Q].name=s(V),M.FullPaths[Q]=V,!0}return!1}function Es(M){K(M,!0)}return t.find=te,t.read=q,t.parse=p,t.write=R,t.writeFile=oe,t.utils={cfb_new:ar,cfb_add:Lt,cfb_del:Br,cfb_mov:Ra,cfb_gc:Es,ReadShift:Dc,CheckField:l3,prep_blob:Xn,bconcat:on,use_zlib:P,_deflateRaw:tr,_inflateRaw:Un,consts:Z},t}();function oR(e){return typeof e=="string"?Hf(e):Array.isArray(e)?RO(e):e}function fu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Hf(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Wc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([oR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:e,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=e,u.href=l,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(e);return h.open("w"),h.encoding="binary",Array.isArray(t)&&(t=du(t)),h.write(t),h.close(),t}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function un(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function mb(e,t){for(var r=[],n=un(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function hx(e){for(var t=[],r=un(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function qf(e){for(var t=[],r=un(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function lR(e){for(var t=[],r=un(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var pf=new Date(1899,11,30,0,0,0);function Pn(e,t){var r=e.getTime(),n=pf.getTime()+(e.getTimezoneOffset()-pf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var GS=new Date,cR=pf.getTime()+(GS.getTimezoneOffset()-pf.getTimezoneOffset())*6e4,pb=GS.getTimezoneOffset();function qS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+cR),t.getTimezoneOffset()!==pb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-pb)*6e4),t}var xb=new Date("2017-02-19T19:06:09.000Z"),$S=isNaN(xb.getFullYear())?new Date("2/19/17"):xb,uR=$S.getFullYear()==2017;function En(e,t){var r=new Date(e);if(uR)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if($S.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function $f(e,t){if(Bt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return r[l]||l})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Bn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Bn(e[r]));return t}function Sr(e,t){for(var r="";r.length<t;)r+=e;return r}function ms(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,l){return r=-r,l}),!isNaN(t=Number(n)))?t/r:t}var dR=["january","february","march","april","may","june","july","august","september","october","november","december"];function $c(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),l=t.getDate();if(isNaN(l))return r;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&dR.indexOf(u)==-1)return r}else if(u.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||l>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Tt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Bt?n=Ts(r):n=MO(r),er.utils.cfb_add(e,t,n)}er.utils.cfb_add(e,t,r)}else e.file(t,r)}function mx(){return er.utils.cfb_new()}var Fr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,fR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},px=hx(fR),xx=/[&<>'"]/g,hR=/[\u0000-\u0008\u000b-\u001f]/g;function Xt(e){var t=e+"";return t.replace(xx,function(r){return px[r]}).replace(hR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function gb(e){return Xt(e).replace(/ /g,"_x0020_")}var WS=/[\u0000-\u001f]/g;function mR(e){var t=e+"";return t.replace(xx,function(r){return px[r]}).replace(/\n/g,"<br/>").replace(WS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function pR(e){var t=e+"";return t.replace(xx,function(r){return px[r]}).replace(WS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function xR(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function gR(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Sm(e){for(var t="",r=0,n=0,s=0,l=0,u=0,h=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){u=(n&31)<<6,u|=s&63,t+=String.fromCharCode(u);continue}if(l=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|l&63);continue}u=e.charCodeAt(r++),h=((n&7)<<18|(s&63)<<12|(l&63)<<6|u&63)-65536,t+=String.fromCharCode(55296+(h>>>10&1023)),t+=String.fromCharCode(56320+(h&1023))}return t}function yb(e){var t=qi(2*e.length),r,n,s=1,l=0,u=0,h;for(n=0;n<e.length;n+=s)s=1,(h=e.charCodeAt(n))<128?r=h:h<224?(r=(h&31)*64+(e.charCodeAt(n+1)&63),s=2):h<240?(r=(h&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(h&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,u=55296+(r>>>10&1023),r=56320+(r&1023)),u!==0&&(t[l++]=u&255,t[l++]=u>>>8,u=0),t[l++]=r%256,t[l++]=r>>>8;return t.slice(0,l).toString("ucs2")}function vb(e){return Ts(e,"binary").toString("utf8")}var Rd="foo bar baz",jc=Bt&&(vb(Rd)==Sm(Rd)&&vb||yb(Rd)==Sm(Rd)&&yb)||Sm,Wc=Bt?function(e){return Ts(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},yR=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),XS=/(^\s|\s$|\n)/;function ln(e,t){return"<"+e+(t.match(XS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Xc(e){return un(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function qe(e,t,r){return"<"+e+(r!=null?Xc(r):"")+(t!=null?(t.match(XS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function gp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function vR(e,t){switch(typeof e){case"string":var r=qe("vt:lpwstr",Xt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return qe((e|0)==e?"vt:i4":"vt:r8",Xt(String(e)));case"boolean":return qe("vt:bool",e?"true":"false")}if(e instanceof Date)return qe("vt:filetime",gp(e));throw new Error("Unable to serialize "+e)}var Wr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},dl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Kn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function bR(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,l=5;l>=0;--l)s=s*256+e[t+l];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function wR(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,l=0,u=n?-t:t;isFinite(u)?u==0?s=l=0:(s=Math.floor(Math.log(u)/Math.LN2),l=u*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(t)?26985:0);for(var h=0;h<=5;++h,l/=256)e[r+h]=l&255;e[r+6]=(s&15)<<4|l&15,e[r+7]=s>>4|n}var bb=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,l=e[0][n].length;s<l;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},wb=Bt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ts(t)})):bb(e)}:bb,Sb=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(wc(e,s)));return n.join("").replace(Ac,"")},gx=Bt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ac,""):Sb(e,t,r)}:Sb,Nb=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},KS=Bt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Nb(e,t,r)}:Nb,Tb=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Yo(e,s)));return n.join("")},hu=Bt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Tb(t,r,n)}:Tb,QS=function(e,t){var r=Qn(e,t);return r>0?hu(e,t+4,t+4+r-1):""},ZS=QS,JS=function(e,t){var r=Qn(e,t);return r>0?hu(e,t+4,t+4+r-1):""},e3=JS,t3=function(e,t){var r=2*Qn(e,t);return r>0?hu(e,t+4,t+4+r-1):""},r3=t3,n3=function(t,r){var n=Qn(t,r);return n>0?gx(t,r+4,r+4+n):""},a3=n3,s3=function(e,t){var r=Qn(e,t);return r>0?hu(e,t+4,t+4+r):""},i3=s3,o3=function(e,t){return bR(e,t)},xf=o3,yx=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Bt&&(ZS=function(t,r){if(!Buffer.isBuffer(t))return QS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},e3=function(t,r){if(!Buffer.isBuffer(t))return JS(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},r3=function(t,r){if(!Buffer.isBuffer(t))return t3(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},a3=function(t,r){if(!Buffer.isBuffer(t))return n3(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},i3=function(t,r){if(!Buffer.isBuffer(t))return s3(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},xf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):o3(t,r)},yx=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Yo=function(e,t){return e[t]},wc=function(e,t){return e[t+1]*256+e[t]},SR=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Qn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},NR=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Dc(e,t){var r="",n,s,l=[],u,h,m,f;switch(t){case"dbcs":if(f=this.l,Bt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)r+=String.fromCharCode(wc(this,f)),f+=2;e*=2;break;case"utf8":r=hu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=gx(this,this.l,this.l+e);break;case"wstr":return Dc.call(this,e,"dbcs");case"lpstr-ansi":r=ZS(this,this.l),e=4+Qn(this,this.l);break;case"lpstr-cp":r=e3(this,this.l),e=4+Qn(this,this.l);break;case"lpwstr":r=r3(this,this.l),e=4+2*Qn(this,this.l);break;case"lpp4":e=4+Qn(this,this.l),r=a3(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qn(this,this.l),r=i3(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(u=Yo(this,this.l+e++))!==0;)l.push(Dd(u));r=l.join("");break;case"_wstr":for(e=0,r="";(u=wc(this,this.l+e))!==0;)l.push(Dd(u)),e+=2;e+=2,r=l.join("");break;case"dbcs-cont":for(r="",f=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(f)!==-1)return u=Yo(this,f),this.l=f+1,h=Dc.call(this,e-m,u?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(Dd(wc(this,f))),f+=2}r=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(f)!==-1)return u=Yo(this,f),this.l=f+1,h=Dc.call(this,e-m,u?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(Dd(Yo(this,f))),f+=1}r=l.join("");break;default:switch(e){case 1:return n=Yo(this,this.l),this.l++,n;case 2:return n=(t==="i"?SR:wc)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Fi:NR)(this,this.l),this.l+=4,n):(s=Qn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=xf(this,this.l):s=xf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=KS(this,this.l,e);break}}return this.l+=e,r}var TR=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},ER=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},_R=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function CR(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)_R(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var u=t.charCodeAt(s);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,TR(this,t,this.l);break;case 8:if(n=8,r==="f"){wR(this,t,this.l);break}case 16:break;case-4:n=4,ER(this,t,this.l);break}return this.l+=n,this}function l3(e,t){var r=KS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Xn(e,t){e.l=t,e.read_shift=Dc,e.chk=l3,e.write_shift=CR}function $a(e,t){e.l+=t}function Oe(e){var t=qi(e);return Xn(t,0),t}function Ln(){var e=[],t=Bt?256:2048,r=function(f){var p=Oe(f);return Xn(p,0),p},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(f){return n&&f<n.length-n.l?n:(s(),n=r(Math.max(f+1,t)))},u=function(){return s(),on(e)},h=function(f){s(),n=f,n.l==null&&(n.l=n.length),l(t)};return{next:l,push:h,end:u,_bufs:e}}function Pe(e,t,r,n){var s=+t,l;if(!isNaN(s)){n||(n=b9[s].p||(r||[]).length||0),l=1+(s>=128?1:0)+1,n>=128&&++l,n>=16384&&++l,n>=2097152&&++l;var u=e.next(l);s<=127?u.write_shift(1,s):(u.write_shift(1,(s&127)+128),u.write_shift(1,s>>7));for(var h=0;h!=4;++h)if(n>=128)u.write_shift(1,(n&127)+128),n>>=7;else{u.write_shift(1,n);break}n>0&&yx(r)&&e.push(r)}}function kc(e,t,r){var n=Bn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Eb(e,t,r){var n=Bn(e);return n.s=kc(n.s,t.s,r),n.e=kc(n.e,t.s,r),n}function Oc(e,t){if(e.cRel&&e.c<0)for(e=Bn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Bn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Kt(e);return!e.cRel&&e.cRel!=null&&(r=DR(r)),!e.rRel&&e.rRel!=null&&(r=AR(r)),r}function Nm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+yn(e.s.c)+":"+(e.e.cRel?"":"$")+yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+cn(e.s.r)+":"+(e.e.rRel?"":"$")+cn(e.e.r):Oc(e.s,t.biff)+":"+Oc(e.e,t.biff)}function vx(e){return parseInt(jR(e),10)-1}function cn(e){return""+(e+1)}function AR(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jR(e){return e.replace(/\$(\d+)$/,"$1")}function bx(e){for(var t=kR(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function yn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function DR(e){return e.replace(/^([A-Z])/,"$$$1")}function kR(e){return e.replace(/^\$([A-Z])/,"$1")}function OR(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Xr(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Kt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Zn(e){var t=e.indexOf(":");return t==-1?{s:Xr(e),e:Xr(e)}:{s:Xr(e.slice(0,t)),e:Xr(e.slice(t+1))}}function Mr(e,t){return typeof t>"u"||typeof t=="number"?Mr(e.s,e.e):(typeof e!="string"&&(e=Kt(e)),typeof t!="string"&&(t=Kt(t)),e==t?e:e+":"+t)}function lr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,l=e.length;for(r=0;n<l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===l||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=l&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=l&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function _b(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ii(e.z,r?Pn(t):t)}catch{}try{return e.w=ii((e.XF||{}).numFmtId||(r?14:0),r?Pn(t):t)}catch{return""+t}}function Ss(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?mu[e.v]||e.v:t==null?_b(e,e.v):_b(e,t))}function Qi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function c3(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,l=e||(s?[]:{}),u=0,h=0;if(l&&n.origin!=null){if(typeof n.origin=="number")u=n.origin;else{var m=typeof n.origin=="string"?Xr(n.origin):n.origin;u=m.r,h=m.c}l["!ref"]||(l["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=lr(l["!ref"]);f.s.c=p.s.c,f.s.r=p.s.r,f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),u==-1&&(f.e.r=u=p.e.r+1)}for(var g=0;g!=t.length;++g)if(t[g]){if(!Array.isArray(t[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=t[g].length;++y)if(!(typeof t[g][y]>"u")){var v={v:t[g][y]},S=u+g,N=h+y;if(f.s.r>S&&(f.s.r=S),f.s.c>N&&(f.s.c=N),f.e.r<S&&(f.e.r=S),f.e.c<N&&(f.e.c=N),t[g][y]&&typeof t[g][y]=="object"&&!Array.isArray(t[g][y])&&!(t[g][y]instanceof Date))v=t[g][y];else if(Array.isArray(v.v)&&(v.f=t[g][y][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||Nr[14],n.cellDates?(v.t="d",v.w=ii(v.z,Pn(v.v))):(v.t="n",v.v=Pn(v.v),v.w=ii(v.z,v.v))):v.t="s";if(s)l[S]||(l[S]=[]),l[S][N]&&l[S][N].z&&(v.z=l[S][N].z),l[S][N]=v;else{var w=Kt({c:N,r:S});l[w]&&l[w].z&&(v.z=l[w].z),l[w]=v}}}return f.s.c<1e7&&(l["!ref"]=Mr(f)),l}function fl(e,t){return c3(null,e,t)}function RR(e){return e.read_shift(4,"i")}function ja(e,t){return t||(t=Oe(4)),t.write_shift(4,e),t}function vn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Kr(e,t){var r=!1;return t==null&&(r=!0,t=Oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function MR(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function FR(e,t){return t||(t=Oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function wx(e,t){var r=e.l,n=e.read_shift(1),s=vn(e),l=[],u={t:s,h:s};if((n&1)!==0){for(var h=e.read_shift(4),m=0;m!=h;++m)l.push(MR(e));u.r=l}else u.r=[{ich:0,ifnt:0}];return e.l=r+t,u}function LR(e,t){var r=!1;return t==null&&(r=!0,t=Oe(15+4*e.t.length)),t.write_shift(1,0),Kr(e.t,t),r?t.slice(0,t.l):t}var PR=wx;function BR(e,t){var r=!1;return t==null&&(r=!0,t=Oe(23+4*e.t.length)),t.write_shift(1,1),Kr(e.t,t),t.write_shift(4,1),FR({},t),r?t.slice(0,t.l):t}function ma(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Zi(e,t){return t==null&&(t=Oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ji(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function eo(e,t){return t==null&&(t=Oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var UR=vn,u3=Kr;function Sx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function gf(e,t){var r=!1;return t==null&&(r=!0,t=Oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var IR=vn,yp=Sx,Nx=gf;function d3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?xf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fi(t,0)>>2;return r?s/100:s}function f3(e,t){t==null&&(t=Oe(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function h3(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function zR(e,t){return t||(t=Oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var to=h3,hl=zR;function ml(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $i(e,t){return(t||Oe(8)).write_shift(8,e,"f")}function VR(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),l=e.read_shift(2,"i"),u=e.read_shift(1),h=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var f=QR[s];f&&(t.rgb=Pb(f));break;case 2:t.rgb=Pb([u,h,m]);break;case 3:t.theme=s;break}return l!=0&&(t.tint=l>0?l/32767:l/32768),t}function yf(e,t){if(t||(t=Oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function HR(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function YR(e,t){t||(t=Oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var m3=2,$n=3,Md=11,vf=19,Fd=64,GR=65,qR=71,$R=4108,WR=4126,sn=80,Cb={1:{n:"CodePage",t:m3},2:{n:"Category",t:sn},3:{n:"PresentationFormat",t:sn},4:{n:"ByteCount",t:$n},5:{n:"LineCount",t:$n},6:{n:"ParagraphCount",t:$n},7:{n:"SlideCount",t:$n},8:{n:"NoteCount",t:$n},9:{n:"HiddenCount",t:$n},10:{n:"MultimediaClipCount",t:$n},11:{n:"ScaleCrop",t:Md},12:{n:"HeadingPairs",t:$R},13:{n:"TitlesOfParts",t:WR},14:{n:"Manager",t:sn},15:{n:"Company",t:sn},16:{n:"LinksUpToDate",t:Md},17:{n:"CharacterCount",t:$n},19:{n:"SharedDoc",t:Md},22:{n:"HyperlinksChanged",t:Md},23:{n:"AppVersion",t:$n,p:"version"},24:{n:"DigSig",t:GR},26:{n:"ContentType",t:sn},27:{n:"ContentStatus",t:sn},28:{n:"Language",t:sn},29:{n:"Version",t:sn},255:{},2147483648:{n:"Locale",t:vf},2147483651:{n:"Behavior",t:vf},1919054434:{}},Ab={1:{n:"CodePage",t:m3},2:{n:"Title",t:sn},3:{n:"Subject",t:sn},4:{n:"Author",t:sn},5:{n:"Keywords",t:sn},6:{n:"Comments",t:sn},7:{n:"Template",t:sn},8:{n:"LastAuthor",t:sn},9:{n:"RevNumber",t:sn},10:{n:"EditTime",t:Fd},11:{n:"LastPrinted",t:Fd},12:{n:"CreatedDate",t:Fd},13:{n:"ModifiedDate",t:Fd},14:{n:"PageCount",t:$n},15:{n:"WordCount",t:$n},16:{n:"CharCount",t:$n},17:{n:"Thumbnail",t:qR},18:{n:"Application",t:sn},19:{n:"DocSecurity",t:$n},255:{},2147483648:{n:"Locale",t:vf},2147483651:{n:"Behavior",t:vf},1919054434:{}};function XR(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var KR=XR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),QR=Bn(KR),mu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZR={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ld={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function p3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x3(e,t){var r=lR(ZR),n=[],s;n[n.length]=Fr,n[n.length]=qe("Types",null,{xmlns:Wr.CT,"xmlns:xsd":Wr.xsd,"xmlns:xsi":Wr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return qe("Default",null,{Extension:m[0],ContentType:m[1]})}));var l=function(m){e[m]&&e[m].length>0&&(s=e[m][0],n[n.length]=qe("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Ld[m][t.bookType]||Ld[m].xlsx}))},u=function(m){(e[m]||[]).forEach(function(f){n[n.length]=qe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Ld[m][t.bookType]||Ld[m].xlsx})})},h=function(m){(e[m]||[]).forEach(function(f){n[n.length]=qe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[m][0]})})};return l("workbooks"),u("sheets"),u("charts"),h("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),u("metadata"),h("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Mt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function g3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Zo(e){var t=[Fr,qe("Relationships",null,{xmlns:Wr.RELS})];return un(e["!id"]).forEach(function(r){t[t.length]=qe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Wt(e,t,r,n,s,l){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Mt.HLINK,Mt.XPATH,Mt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}function JR(e){var t=[Fr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function jb(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function e7(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function t7(e){var t=[Fr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(jb(e[r][0],e[r][1])),t.push(e7("",e[r][0]));return t.push(jb("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function y3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+df.version+"</meta:generator></office:meta></office:document-meta>"}var Hi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Tm(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Xt(t),n[n.length]=r?qe(e,t,r):ln(e,t))}function v3(e,t){var r=t||{},n=[Fr,qe("cp:coreProperties",null,{"xmlns:cp":Wr.CORE_PROPS,"xmlns:dc":Wr.dc,"xmlns:dcterms":Wr.dcterms,"xmlns:dcmitype":Wr.dcmitype,"xmlns:xsi":Wr.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Tm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:gp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Tm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:gp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var l=0;l!=Hi.length;++l){var u=Hi[l],h=r.Props&&r.Props[u[1]]!=null?r.Props[u[1]]:e?e[u[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&Tm(u[0],h,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Jo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],b3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function w3(e){var t=[],r=qe;return e||(e={}),e.Application="SheetJS",t[t.length]=Fr,t[t.length]=qe("Properties",null,{xmlns:Wr.EXT_PROPS,"xmlns:vt":Wr.vt}),Jo.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Xt(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Xt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function S3(e){var t=[Fr,qe("Properties",null,{xmlns:Wr.CUST_PROPS,"xmlns:vt":Wr.vt})];if(!e)return t.join("");var r=1;return un(e).forEach(function(s){++r,t[t.length]=qe("property",vR(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xt(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Db={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function r7(e,t){var r=[];return un(Db).map(function(n){for(var s=0;s<Hi.length;++s)if(Hi[s][1]==n)return Hi[s];for(s=0;s<Jo.length;++s)if(Jo[s][1]==n)return Jo[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ln(Db[n[1]]||n[1],s))}}),qe("DocumentProperties",r.join(""),{xmlns:Kn.o})}function n7(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&un(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)){for(var u=0;u<Hi.length;++u)if(l==Hi[u][1])return;for(u=0;u<Jo.length;++u)if(l==Jo[u][1])return;for(u=0;u<r.length;++u)if(l==r[u])return;var h=e[l],m="string";typeof h=="number"?(m="float",h=String(h)):h===!0||h===!1?(m="boolean",h=h?"1":"0"):h=String(h),s.push(qe(gb(l),h,{"dt:dt":m}))}}),t&&un(t).forEach(function(l){if(Object.prototype.hasOwnProperty.call(t,l)&&!(e&&Object.prototype.hasOwnProperty.call(e,l))){var u=t[l],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u instanceof Date?(h="dateTime.tz",u=u.toISOString()):u=String(u),s.push(qe(gb(l),u,{"dt:dt":h}))}}),"<"+n+' xmlns="'+Kn.o+'">'+s.join("")+"</"+n+">"}function a7(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var l=n/Math.pow(2,32)|0;l>0&&(n=n%Math.pow(2,32),s+=l);var u=Oe(8);return u.write_shift(4,n),u.write_shift(4,s),u}function kb(e,t){var r=Oe(4),n=Oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=a7(t);break;case 31:case 80:for(n=Oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return on([r,n])}var N3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function s7(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ob(e,t,r){var n=Oe(8),s=[],l=[],u=8,h=0,m=Oe(8),f=Oe(8);if(m.write_shift(4,2),m.write_shift(4,1200),f.write_shift(4,1),l.push(m),s.push(f),u+=8+m.length,!t){f=Oe(8),f.write_shift(4,0),s.unshift(f);var p=[Oe(4)];for(p[0].write_shift(4,e.length),h=0;h<e.length;++h){var g=e[h][0];for(m=Oe(8+2*(g.length+1)+(g.length%2?0:2)),m.write_shift(4,h+2),m.write_shift(4,g.length+1),m.write_shift(0,g,"dbcs");m.l!=m.length;)m.write_shift(1,0);p.push(m)}m=on(p),l.unshift(m),u+=8+m.length}for(h=0;h<e.length;++h)if(!(t&&!t[e[h][0]])&&!(N3.indexOf(e[h][0])>-1||b3.indexOf(e[h][0])>-1)&&e[h][1]!=null){var y=e[h][1],v=0;if(t){v=+t[e[h][0]];var S=r[v];if(S.p=="version"&&typeof y=="string"){var N=y.split(".");y=(+N[0]<<16)+(+N[1]||0)}m=kb(S.t,y)}else{var w=s7(y);w==-1&&(w=31,y=String(y)),m=kb(w,y)}l.push(m),f=Oe(8),f.write_shift(4,t?v:2+h),s.push(f),u+=8+m.length}var E=8*(l.length+1);for(h=0;h<l.length;++h)s[h].write_shift(4,E),E+=l[h].length;return n.write_shift(4,u),n.write_shift(4,l.length),on([n].concat(s).concat(l))}function Rb(e,t,r,n,s,l){var u=Oe(s?68:48),h=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,er.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,s?2:1),u.write_shift(16,t,"hex"),u.write_shift(4,s?68:48);var m=Ob(e,r,n);if(h.push(m),s){var f=Ob(s,null,null);u.write_shift(16,l,"hex"),u.write_shift(4,68+m.length),h.push(f)}return on(h)}function i7(e,t){t||(t=Oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function o7(e,t){return e.read_shift(t)===1}function Sn(e,t){return t||(t=Oe(2)),t.write_shift(2,+!!e),t}function T3(e){return e.read_shift(2,"u")}function da(e,t){return t||(t=Oe(2)),t.write_shift(2,e),t}function E3(e,t,r){return r||(r=Oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function _3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var l=e.read_shift(1);l&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var u=n?e.read_shift(n,s):"";return u}function l7(e){var t=e.t||"",r=Oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return on(s)}function c7(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function u7(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):c7(e,n,r)}function d7(e,t,r){if(r.biff>5)return u7(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function C3(e,t,r){return r||(r=Oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Mb(e,t){t||(t=Oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function f7(e){var t=Oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),l=s>-1?31:23;switch(n.charAt(0)){case"#":l=28;break;case".":l&=-3;break}t.write_shift(4,2),t.write_shift(4,l);var u=[8,6815827,6619237,4849780,83];for(r=0;r<u.length;++r)t.write_shift(4,u[r]);if(l==28)n=n.slice(1),Mb(n,t);else if(l&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<u.length;++r)t.write_shift(1,parseInt(u[r],16));var h=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(h.length+1)),r=0;r<h.length;++r)t.write_shift(2,h.charCodeAt(r));t.write_shift(2,0),l&8&&Mb(s>-1?n.slice(s+1):"",t)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<u.length;++r)t.write_shift(1,parseInt(u[r],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(t.write_shift(2,m),t.write_shift(4,n.length-3*m+1),r=0;r<n.length-3*m;++r)t.write_shift(1,n.charCodeAt(r+3*m)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Wi(e,t,r,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function h7(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),l=e.read_shift(n,"i"),u=e.read_shift(n,"i");return[s,l,u]}function m7(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function A3(e,t){return t||(t=Oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Tx(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=Oe(s);return l.write_shift(2,n),l.write_shift(2,t),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function p7(e,t){var r=!t||t.biff==8,n=Oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function x7(e,t){var r=!t||t.biff>=8?2:1,n=Oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function g7(e,t){var r=Oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=l7(e[s]);var l=on([r].concat(n));return l.parts=[r.length].concat(n.map(function(u){return u.length})),l}function y7(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function v7(e){var t=Oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function b7(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,l=Oe(s);return l.write_shift(2,e.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,r.length),n||l.write_shift(1,1),l.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),l}function w7(e,t,r,n){var s=Oe(10);return Wi(e,t,n,s),s.write_shift(4,r),s}function S7(e,t,r,n,s){var l=!s||s.biff==8,u=Oe(8+ +l+(1+l)*r.length);return Wi(e,t,n,u),u.write_shift(2,r.length),l&&u.write_shift(1,1),u.write_shift((1+l)*r.length,r,l?"utf16le":"sbcs"),u}function N7(e,t,r,n){var s=r&&r.biff==5;n||(n=Oe(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var l=n.length>n.l?n.slice(0,n.l):n;return l.l==null&&(l.l=l.length),l}function T7(e,t){var r=t.biff==8||!t.biff?4:2,n=Oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Fb(e,t,r,n){var s=r&&r.biff==5;n||(n=Oe(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var l=0;return e.numFmtId>0&&s&&(l|=1024),n.write_shift(4,l),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function E7(e){var t=Oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _7(e,t,r,n,s,l){var u=Oe(8);return Wi(e,t,n,u),E3(r,l,u),u}function C7(e,t,r,n){var s=Oe(14);return Wi(e,t,n,s),$i(r,s),s}function A7(e,t,r){if(r.biff<8)return j7(e,t,r);for(var n=[],s=e.l+t,l=e.read_shift(r.biff>8?4:2);l--!==0;)n.push(h7(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function j7(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=_3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function D7(e){var t=Oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)A3(e[r],t);return t}function k7(e){var t=Oe(24),r=Xr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return on([t,f7(e[1])])}function O7(e){var t=e[1].Tooltip,r=Oe(10+2*(t.length+1));r.write_shift(2,2048);var n=Xr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function R7(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function M7(e,t,r){if(!r.cellStyles)return $a(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(n),h=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var f={s,e:l,w:u,ixfe:h,flags:m};return(r.biff>=5||!r.biff)&&(f.level=m>>8&7),f}function F7(e,t){var r=Oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function L7(e){for(var t=Oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function P7(e,t,r){var n=Oe(15);return xu(n,e,t),n.write_shift(8,r,"f"),n}function B7(e,t,r){var n=Oe(9);return xu(n,e,t),n.write_shift(2,r),n}var U7=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=hx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(h,m){var f=[],p=qi(1);switch(m.type){case"base64":p=Ca(ws(h));break;case"binary":p=Ca(h);break;case"buffer":case"array":p=h;break}Xn(p,0);var g=p.read_shift(1),y=!!(g&136),v=!1,S=!1;switch(g){case 2:break;case 3:break;case 48:v=!0,y=!0;break;case 49:v=!0,y=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var N=0,w=521;g==2&&(N=p.read_shift(2)),p.l+=3,g!=2&&(N=p.read_shift(4)),N>1048576&&(N=1e6),g!=2&&(w=p.read_shift(2));var E=p.read_shift(2),C=m.codepage||1252;g!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(C=e[p[p.l]]),p.l+=1,p.l+=2),S&&(p.l+=36);for(var T=[],O={},j=Math.min(p.length,g==2?521:w-10-(v?264:0)),q=S?32:11;p.l<j&&p[p.l]!=13;)switch(O={},O.name=sb.utils.decode(C,p.slice(p.l,p.l+q)).replace(/[\u0000\r\n].*$/g,""),p.l+=q,O.type=String.fromCharCode(p.read_shift(1)),g!=2&&!S&&(O.offset=p.read_shift(4)),O.len=p.read_shift(1),g==2&&(O.offset=p.read_shift(2)),O.dec=p.read_shift(1),O.name.length&&T.push(O),g!=2&&(p.l+=S?13:14),O.type){case"B":(!v||O.len!=8)&&m.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(p[p.l]!==13&&(p.l=w-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=w;var D=0,U=0;for(f[0]=[],U=0;U!=T.length;++U)f[0][U]=T[U].name;for(;N-- >0;){if(p[p.l]===42){p.l+=E;continue}for(++p.l,f[++D]=[],U=0,U=0;U!=T.length;++U){var K=p.slice(p.l,p.l+T[U].len);p.l+=T[U].len,Xn(K,0);var ie=sb.utils.decode(C,K);switch(T[U].type){case"C":ie.trim().length&&(f[D][U]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?f[D][U]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):f[D][U]=ie;break;case"F":f[D][U]=parseFloat(ie.trim());break;case"+":case"I":f[D][U]=S?K.read_shift(-4,"i")^2147483648:K.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":f[D][U]=!0;break;case"N":case"F":f[D][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));f[D][U]="##MEMO##"+(S?parseInt(ie.trim(),10):K.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(f[D][U]=+ie||0);break;case"@":f[D][U]=new Date(K.read_shift(-8,"f")-621356832e5);break;case"T":f[D][U]=new Date((K.read_shift(4)-2440588)*864e5+K.read_shift(4));break;case"Y":f[D][U]=K.read_shift(4,"i")/1e4+K.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[D][U]=-K.read_shift(-8,"f");break;case"B":if(v&&T[U].len==8){f[D][U]=K.read_shift(8,"f");break}case"G":case"P":K.l+=T[U].len;break;case"0":if(T[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[U].type)}}}if(g!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return m&&m.sheetRows&&(f=f.slice(0,m.sheetRows)),m.DBF=T,f}function n(h,m){var f=m||{};f.dateNF||(f.dateNF="yyyymmdd");var p=fl(r(h,f),f);return p["!cols"]=f.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete f.DBF,p}function s(h,m){try{return Qi(n(h,m),m)}catch(f){if(m&&m.WTF)throw f}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function u(h,m){var f=m||{};if(+f.codepage>=0&&Gc(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ln(),g=Tf(h,{header:1,raw:!0,cellDates:!0}),y=g[0],v=g.slice(1),S=h["!cols"]||[],N=0,w=0,E=0,C=1;for(N=0;N<y.length;++N){if(((S[N]||{}).DBF||{}).name){y[N]=S[N].DBF.name,++E;continue}if(y[N]!=null){if(++E,typeof y[N]=="number"&&(y[N]=y[N].toString(10)),typeof y[N]!="string")throw new Error("DBF Invalid column name "+y[N]+" |"+typeof y[N]+"|");if(y.indexOf(y[N])!==N){for(w=0;w<1024;++w)if(y.indexOf(y[N]+"_"+w)==-1){y[N]+="_"+w;break}}}}var T=lr(h["!ref"]),O=[],j=[],q=[];for(N=0;N<=T.e.c-T.s.c;++N){var D="",U="",K=0,ie=[];for(w=0;w<v.length;++w)v[w][N]!=null&&ie.push(v[w][N]);if(ie.length==0||y[N]==null){O[N]="?";continue}for(w=0;w<ie.length;++w){switch(typeof ie[w]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=ie[w]instanceof Date?"D":"C";break;default:U="C"}K=Math.max(K,String(ie[w]).length),D=D&&D!=U?"C":U}K>250&&(K=250),U=((S[N]||{}).DBF||{}).type,U=="C"&&S[N].DBF.len>K&&(K=S[N].DBF.len),D=="B"&&U=="N"&&(D="N",q[N]=S[N].DBF.dec,K=S[N].DBF.len),j[N]=D=="C"||U=="N"?K:l[D]||0,C+=j[N],O[N]=D}var te=p.next(32);for(te.write_shift(4,318902576),te.write_shift(4,v.length),te.write_shift(2,296+32*E),te.write_shift(2,C),N=0;N<4;++N)te.write_shift(4,0);for(te.write_shift(4,0|(+t[DS]||3)<<8),N=0,w=0;N<y.length;++N)if(y[N]!=null){var G=p.next(32),de=(y[N].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,de,"sbcs"),G.write_shift(1,O[N]=="?"?"C":O[N],"sbcs"),G.write_shift(4,w),G.write_shift(1,j[N]||l[O[N]]||0),G.write_shift(1,q[N]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),w+=j[N]||l[O[N]]||0}var J=p.next(264);for(J.write_shift(4,13),N=0;N<65;++N)J.write_shift(4,0);for(N=0;N<v.length;++N){var W=p.next(C);for(W.write_shift(1,0),w=0;w<y.length;++w)if(y[w]!=null)switch(O[w]){case"L":W.write_shift(1,v[N][w]==null?63:v[N][w]?84:70);break;case"B":W.write_shift(8,v[N][w]||0,"f");break;case"N":var F="0";for(typeof v[N][w]=="number"&&(F=v[N][w].toFixed(q[w]||0)),E=0;E<j[w]-F.length;++E)W.write_shift(1,32);W.write_shift(1,F,"sbcs");break;case"D":v[N][w]?(W.write_shift(4,("0000"+v[N][w].getFullYear()).slice(-4),"sbcs"),W.write_shift(2,("00"+(v[N][w].getMonth()+1)).slice(-2),"sbcs"),W.write_shift(2,("00"+v[N][w].getDate()).slice(-2),"sbcs")):W.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(v[N][w]!=null?v[N][w]:"").slice(0,j[w]);for(W.write_shift(1,Z,"sbcs"),E=0;E<j[w]-Z.length;++E)W.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),I7=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+un(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,v){var S=e[v];return typeof S=="number"?ab(S):S},n=function(y,v,S){var N=v.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return N==59?y:ab(N)};e["|"]=254;function s(y,v){switch(v.type){case"base64":return l(ws(y),v);case"binary":return l(y,v);case"buffer":return l(Bt&&Buffer.isBuffer(y)?y.toString("binary"):du(y),v);case"array":return l($f(y),v)}throw new Error("Unrecognized type "+v.type)}function l(y,v){var S=y.split(/[\n\r]+/),N=-1,w=-1,E=0,C=0,T=[],O=[],j=null,q={},D=[],U=[],K=[],ie=0,te;for(+v.codepage>=0&&Gc(+v.codepage);E!==S.length;++E){ie=0;var G=S[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),de=G.replace(/;;/g,"\0").split(";").map(function(_){return _.replace(/\u0000/g,";")}),J=de[0],W;if(G.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":de[1].charAt(0)=="P"&&O.push(G.slice(3).replace(/;;/g,";"));break;case"C":var F=!1,Z=!1,oe=!1,le=!1,R=-1,ne=-1;for(C=1;C<de.length;++C)switch(de[C].charAt(0)){case"A":break;case"X":w=parseInt(de[C].slice(1))-1,Z=!0;break;case"Y":for(N=parseInt(de[C].slice(1))-1,Z||(w=0),te=T.length;te<=N;++te)T[te]=[];break;case"K":W=de[C].slice(1),W.charAt(0)==='"'?W=W.slice(1,W.length-1):W==="TRUE"?W=!0:W==="FALSE"?W=!1:isNaN(ms(W))?isNaN($c(W).getDate())||(W=En(W)):(W=ms(W),j!==null&&VS(j)&&(W=qS(W))),F=!0;break;case"E":le=!0;var P=BM(de[C].slice(1),{r:N,c:w});T[N][w]=[T[N][w],P];break;case"S":oe=!0,T[N][w]=[T[N][w],"S5S"];break;case"G":break;case"R":R=parseInt(de[C].slice(1))-1;break;case"C":ne=parseInt(de[C].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}if(F&&(T[N][w]&&T[N][w].length==2?T[N][w][0]=W:T[N][w]=W,j=null),oe){if(le)throw new Error("SYLK shared formula cannot have own formula");var H=R>-1&&T[R][ne];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");T[N][w][1]=UM(H[1],{r:N-R,c:w-ne})}break;case"F":var z=0;for(C=1;C<de.length;++C)switch(de[C].charAt(0)){case"X":w=parseInt(de[C].slice(1))-1,++z;break;case"Y":for(N=parseInt(de[C].slice(1))-1,te=T.length;te<=N;++te)T[te]=[];break;case"M":ie=parseInt(de[C].slice(1))/20;break;case"F":break;case"G":break;case"P":j=O[parseInt(de[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(K=de[C].slice(1).split(" "),te=parseInt(K[0],10);te<=parseInt(K[1],10);++te)ie=parseInt(K[2],10),U[te-1]=ie===0?{hidden:!0}:{wch:ie},Ex(U[te-1]);break;case"C":w=parseInt(de[C].slice(1))-1,U[w]||(U[w]={});break;case"R":N=parseInt(de[C].slice(1))-1,D[N]||(D[N]={}),ie>0?(D[N].hpt=ie,D[N].hpx=R3(ie)):ie===0&&(D[N].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}z<1&&(j=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+G)}}return D.length>0&&(q["!rows"]=D),U.length>0&&(q["!cols"]=U),v&&v.sheetRows&&(T=T.slice(0,v.sheetRows)),[T,q]}function u(y,v){var S=s(y,v),N=S[0],w=S[1],E=fl(N,v);return un(w).forEach(function(C){E[C]=w[C]}),E}function h(y,v){return Qi(u(y,v),v)}function m(y,v,S,N){var w="C;Y"+(S+1)+";X"+(N+1)+";K";switch(y.t){case"n":w+=y.v||0,y.f&&!y.F&&(w+=";E"+Cx(y.f,{r:S,c:N}));break;case"b":w+=y.v?"TRUE":"FALSE";break;case"e":w+=y.w||y.v;break;case"d":w+='"'+(y.w||y.v)+'"';break;case"s":w+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function f(y,v){v.forEach(function(S,N){var w="F;W"+(N+1)+" "+(N+1)+" ";S.hidden?w+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=bf(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=wf(S.wpx)),typeof S.wch=="number"&&(w+=Math.round(S.wch))),w.charAt(w.length-1)!=" "&&y.push(w)})}function p(y,v){v.forEach(function(S,N){var w="F;";S.hidden?w+="M0;":S.hpt?w+="M"+20*S.hpt+";":S.hpx&&(w+="M"+20*Sf(S.hpx)+";"),w.length>2&&y.push(w+"R"+(N+1))})}function g(y,v){var S=["ID;PWXL;N;E"],N=[],w=lr(y["!ref"]),E,C=Array.isArray(y),T=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),y["!cols"]&&f(S,y["!cols"]),y["!rows"]&&p(S,y["!rows"]),S.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var O=w.s.r;O<=w.e.r;++O)for(var j=w.s.c;j<=w.e.c;++j){var q=Kt({r:O,c:j});E=C?(y[O]||[])[j]:y[q],!(!E||E.v==null&&(!E.f||E.F))&&N.push(m(E,y,O,j))}return S.join(T)+T+N.join(T)+T+"E"+T}return{to_workbook:h,to_sheet:u,from_sheet:g}}(),z7=function(){function e(l,u){switch(u.type){case"base64":return t(ws(l),u);case"binary":return t(l,u);case"buffer":return t(Bt&&Buffer.isBuffer(l)?l.toString("binary"):du(l),u);case"array":return t($f(l),u)}throw new Error("Unrecognized type "+u.type)}function t(l,u){for(var h=l.split(`
`),m=-1,f=-1,p=0,g=[];p!==h.length;++p){if(h[p].trim()==="BOT"){g[++m]=[],f=0;continue}if(!(m<0)){var y=h[p].trim().split(","),v=y[0],S=y[1];++p;for(var N=h[p]||"";(N.match(/["]/g)||[]).length&1&&p<h.length-1;)N+=`
`+h[++p];switch(N=N.trim(),+v){case-1:if(N==="BOT"){g[++m]=[],f=0;continue}else if(N!=="EOD")throw new Error("Unrecognized DIF special command "+N);break;case 0:N==="TRUE"?g[m][f]=!0:N==="FALSE"?g[m][f]=!1:isNaN(ms(S))?isNaN($c(S).getDate())?g[m][f]=S:g[m][f]=En(S):g[m][f]=ms(S),++f;break;case 1:N=N.slice(1,N.length-1),N=N.replace(/""/g,'"'),N&&N.match(/^=".*"$/)&&(N=N.slice(2,-1)),g[m][f++]=N!==""?N:null;break}if(N==="EOD")break}}return u&&u.sheetRows&&(g=g.slice(0,u.sheetRows)),g}function r(l,u){return fl(e(l,u),u)}function n(l,u){return Qi(r(l,u),u)}var s=function(){var l=function(m,f,p,g,y){m.push(f),m.push(p+","+g),m.push('"'+y.replace(/"/g,'""')+'"')},u=function(m,f,p,g){m.push(f+","+p),m.push(f==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(m){var f=[],p=lr(m["!ref"]),g,y=Array.isArray(m);l(f,"TABLE",0,1,"sheetjs"),l(f,"VECTORS",0,p.e.r-p.s.r+1,""),l(f,"TUPLES",0,p.e.c-p.s.c+1,""),l(f,"DATA",0,0,"");for(var v=p.s.r;v<=p.e.r;++v){u(f,-1,0,"BOT");for(var S=p.s.c;S<=p.e.c;++S){var N=Kt({r:v,c:S});if(g=y?(m[v]||[])[S]:m[N],!g){u(f,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?u(f,1,0,"="+g.f):u(f,1,0,""):u(f,0,w,"V");break;case"b":u(f,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":u(f,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=ii(g.z||Nr[14],Pn(En(g.v)))),u(f,0,g.w,"V");break;default:u(f,1,0,"")}}}u(f,-1,0,"EOD");var E=`\r
`,C=f.join(E);return C}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),j3=function(){function e(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,y){for(var v=g.split(`
`),S=-1,N=-1,w=0,E=[];w!==v.length;++w){var C=v[w].trim().split(":");if(C[0]==="cell"){var T=Xr(C[1]);if(E.length<=T.r)for(S=E.length;S<=T.r;++S)E[S]||(E[S]=[]);switch(S=T.r,N=T.c,C[2]){case"t":E[S][N]=e(C[3]);break;case"v":E[S][N]=+C[3];break;case"vtf":var O=C[C.length-1];case"vtc":switch(C[3]){case"nl":E[S][N]=!!+C[4];break;default:E[S][N]=+C[4];break}C[2]=="vtf"&&(E[S][N]=[E[S][N],O])}}}return y&&y.sheetRows&&(E=E.slice(0,y.sheetRows)),E}function n(g,y){return fl(r(g,y),y)}function s(g,y){return Qi(n(g,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function f(g){if(!g||!g["!ref"])return"";for(var y=[],v=[],S,N="",w=Zn(g["!ref"]),E=Array.isArray(g),C=w.s.r;C<=w.e.r;++C)for(var T=w.s.c;T<=w.e.c;++T)if(N=Kt({r:C,c:T}),S=E?(g[C]||[])[T]:g[N],!(!S||S.v==null||S.t==="z")){switch(v=["cell",N,"t"],S.t){case"s":case"str":v.push(t(S.v));break;case"n":S.f?(v[2]="vtf",v[3]="n",v[4]=S.v,v[5]=t(S.f)):(v[2]="v",v[3]=S.v);break;case"b":v[2]="vt"+(S.f?"f":"c"),v[3]="nl",v[4]=S.v?"1":"0",v[5]=t(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var O=Pn(En(S.v));v[2]="vtc",v[3]="nd",v[4]=""+O,v[5]=S.w||ii(S.z||Nr[14],O);break;case"e":continue}y.push(v.join(":"))}return y.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(g){return[l,u,h,u,f(g),m].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:p}}(),V7=function(){function e(p,g,y,v,S){S.raw?g[y][v]=p:p===""||(p==="TRUE"?g[y][v]=!0:p==="FALSE"?g[y][v]=!1:isNaN(ms(p))?isNaN($c(p).getDate())?g[y][v]=p:g[y][v]=En(p):g[y][v]=ms(p))}function t(p,g){var y=g||{},v=[];if(!p||p.length===0)return v;for(var S=p.split(/[\r\n]/),N=S.length-1;N>=0&&S[N].length===0;)--N;for(var w=10,E=0,C=0;C<=N;++C)E=S[C].indexOf(" "),E==-1?E=S[C].length:E++,w=Math.max(w,E);for(C=0;C<=N;++C){v[C]=[];var T=0;for(e(S[C].slice(0,w).trim(),v,C,T,y),T=1;T<=(S[C].length-w)/10+1;++T)e(S[C].slice(w+(T-1)*10,w+T*10).trim(),v,C,T,y)}return y.sheetRows&&(v=v.slice(0,y.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(p){for(var g={},y=!1,v=0,S=0;v<p.length;++v)(S=p.charCodeAt(v))==34?y=!y:!y&&S in r&&(g[S]=(g[S]||0)+1);S=[];for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&S.push([g[v],v]);if(!S.length){g=n;for(v in g)Object.prototype.hasOwnProperty.call(g,v)&&S.push([g[v],v])}return S.sort(function(N,w){return N[0]-w[0]||n[N[1]]-n[w[1]]}),r[S.pop()[1]]||44}function l(p,g){var y=g||{},v="",S=y.dense?[]:{},N={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(v=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(v=p.charAt(4),p=p.slice(6)):v=s(p.slice(0,1024)):y&&y.FS?v=y.FS:v=s(p.slice(0,1024));var w=0,E=0,C=0,T=0,O=0,j=v.charCodeAt(0),q=!1,D=0,U=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var K=y.dateNF!=null?aR(y.dateNF):null;function ie(){var te=p.slice(T,O),G={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)G.t="z";else if(y.raw)G.t="s",G.v=te;else if(te.trim().length===0)G.t="s",G.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(G.t="s",G.v=te.slice(2,-1).replace(/""/g,'"')):IM(te)?(G.t="n",G.f=te.slice(1)):(G.t="s",G.v=te);else if(te=="TRUE")G.t="b",G.v=!0;else if(te=="FALSE")G.t="b",G.v=!1;else if(!isNaN(C=ms(te)))G.t="n",y.cellText!==!1&&(G.w=te),G.v=C;else if(!isNaN($c(te).getDate())||K&&te.match(K)){G.z=y.dateNF||Nr[14];var de=0;K&&te.match(K)&&(te=sR(te,y.dateNF,te.match(K)||[]),de=1),y.cellDates?(G.t="d",G.v=En(te,de)):(G.t="n",G.v=Pn(En(te,de))),y.cellText!==!1&&(G.w=ii(G.z,G.v instanceof Date?Pn(G.v):G.v)),y.cellNF||delete G.z}else G.t="s",G.v=te;if(G.t=="z"||(y.dense?(S[w]||(S[w]=[]),S[w][E]=G):S[Kt({c:E,r:w})]=G),T=O+1,U=p.charCodeAt(T),N.e.c<E&&(N.e.c=E),N.e.r<w&&(N.e.r=w),D==j)++E;else if(E=0,++w,y.sheetRows&&y.sheetRows<=w)return!0}e:for(;O<p.length;++O)switch(D=p.charCodeAt(O)){case 34:U===34&&(q=!q);break;case j:case 10:case 13:if(!q&&ie())break e;break}return O-T>0&&ie(),S["!ref"]=Mr(N),S}function u(p,g){return!(g&&g.PRN)||g.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,g):fl(t(p,g),g)}function h(p,g){var y="",v=g.type=="string"?[0,0,0,0]:eB(p,g);switch(g.type){case"base64":y=ws(p);break;case"binary":y=p;break;case"buffer":g.codepage==65001?y=p.toString("utf8"):(g.codepage,y=Bt&&Buffer.isBuffer(p)?p.toString("binary"):du(p));break;case"array":y=$f(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+g.type)}return v[0]==239&&v[1]==187&&v[2]==191?y=jc(y.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?y=jc(y):g.type=="binary",y.slice(0,19)=="socialcalc:version:"?j3.to_sheet(g.type=="string"?y:jc(y),g):u(y,g)}function m(p,g){return Qi(h(p,g),g)}function f(p){for(var g=[],y=lr(p["!ref"]),v,S=Array.isArray(p),N=y.s.r;N<=y.e.r;++N){for(var w=[],E=y.s.c;E<=y.e.c;++E){var C=Kt({r:N,c:E});if(v=S?(p[N]||[])[E]:p[C],!v||v.v==null){w.push("          ");continue}for(var T=(v.w||(Ss(v),v.w)||"").slice(0,10);T.length<10;)T+=" ";w.push(T+(E===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:m,to_sheet:h,from_sheet:f}}(),Lb=function(){function e(P,H,z){if(P){Xn(P,P.l||0);for(var _=z.Enum||R;P.l<P.length;){var ce=P.read_shift(2),re=_[ce]||_[65535],me=P.read_shift(2),je=P.l+me,Re=re.f&&re.f(P,me,z);if(P.l=je,H(Re,re,ce))return}}}function t(P,H){switch(H.type){case"base64":return r(Ca(ws(P)),H);case"binary":return r(Ca(P),H);case"buffer":case"array":return r(P,H)}throw"Unsupported type "+H.type}function r(P,H){if(!P)return P;var z=H||{},_=z.dense?[]:{},ce="Sheet1",re="",me=0,je={},Re=[],We=[],Ge={s:{r:0,c:0},e:{r:0,c:0}},Ve=z.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)z.Enum=R,e(P,function(_e,nt,Ke){switch(Ke){case 0:z.vers=_e,_e>=4096&&(z.qpro=!0);break;case 6:Ge=_e;break;case 204:_e&&(re=_e);break;case 222:re=_e;break;case 15:case 51:z.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Ke==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=z.dateNF||Nr[14],z.cellDates&&(_e[1].t="d",_e[1].v=qS(_e[1].v))),z.qpro&&_e[3]>me&&(_["!ref"]=Mr(Ge),je[ce]=_,Re.push(ce),_=z.dense?[]:{},Ge={s:{r:0,c:0},e:{r:0,c:0}},me=_e[3],ce=re||"Sheet"+(me+1),re="");var rt=z.dense?(_[_e[0].r]||[])[_e[0].c]:_[Kt(_e[0])];if(rt){rt.t=_e[1].t,rt.v=_e[1].v,_e[1].z!=null&&(rt.z=_e[1].z),_e[1].f!=null&&(rt.f=_e[1].f);break}z.dense?(_[_e[0].r]||(_[_e[0].r]=[]),_[_e[0].r][_e[0].c]=_e[1]):_[Kt(_e[0])]=_e[1];break}},z);else if(P[2]==26||P[2]==14)z.Enum=ne,P[2]==14&&(z.qpro=!0,P.l=0),e(P,function(_e,nt,Ke){switch(Ke){case 204:ce=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>me&&(_["!ref"]=Mr(Ge),je[ce]=_,Re.push(ce),_=z.dense?[]:{},Ge={s:{r:0,c:0},e:{r:0,c:0}},me=_e[3],ce="Sheet"+(me+1)),Ve>0&&_e[0].r>=Ve)break;z.dense?(_[_e[0].r]||(_[_e[0].r]=[]),_[_e[0].r][_e[0].c]=_e[1]):_[Kt(_e[0])]=_e[1],Ge.e.c<_e[0].c&&(Ge.e.c=_e[0].c),Ge.e.r<_e[0].r&&(Ge.e.r=_e[0].r);break;case 27:_e[14e3]&&(We[_e[14e3][0]]=_e[14e3][1]);break;case 1537:We[_e[0]]=_e[1],_e[0]==me&&(ce=_e[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(_["!ref"]=Mr(Ge),je[re||ce]=_,Re.push(re||ce),!We.length)return{SheetNames:Re,Sheets:je};for(var He={},ge=[],Ce=0;Ce<We.length;++Ce)je[Re[Ce]]?(ge.push(We[Ce]||Re[Ce]),He[We[Ce]]=je[We[Ce]]||je[Re[Ce]]):(ge.push(We[Ce]),He[We[Ce]]={"!ref":"A1"});return{SheetNames:ge,Sheets:He}}function n(P,H){var z=H||{};if(+z.codepage>=0&&Gc(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var _=Ln(),ce=lr(P["!ref"]),re=Array.isArray(P),me=[];$e(_,0,l(1030)),$e(_,6,m(ce));for(var je=Math.min(ce.e.r,8191),Re=ce.s.r;Re<=je;++Re)for(var We=cn(Re),Ge=ce.s.c;Ge<=ce.e.c;++Ge){Re===ce.s.r&&(me[Ge]=yn(Ge));var Ve=me[Ge]+We,He=re?(P[Re]||[])[Ge]:P[Ve];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?$e(_,13,v(Re,Ge,He.v)):$e(_,14,N(Re,Ge,He.v));else{var ge=Ss(He);$e(_,15,g(Re,Ge,ge.slice(0,239)))}}return $e(_,1),_.end()}function s(P,H){var z=H||{};if(+z.codepage>=0&&Gc(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var _=Ln();$e(_,0,u(P));for(var ce=0,re=0;ce<P.SheetNames.length;++ce)(P.Sheets[P.SheetNames[ce]]||{})["!ref"]&&$e(_,27,le(P.SheetNames[ce],re++));var me=0;for(ce=0;ce<P.SheetNames.length;++ce){var je=P.Sheets[P.SheetNames[ce]];if(!(!je||!je["!ref"])){for(var Re=lr(je["!ref"]),We=Array.isArray(je),Ge=[],Ve=Math.min(Re.e.r,8191),He=Re.s.r;He<=Ve;++He)for(var ge=cn(He),Ce=Re.s.c;Ce<=Re.e.c;++Ce){He===Re.s.r&&(Ge[Ce]=yn(Ce));var _e=Ge[Ce]+ge,nt=We?(je[He]||[])[Ce]:je[_e];if(!(!nt||nt.t=="z"))if(nt.t=="n")$e(_,23,ie(He,Ce,me,nt.v));else{var Ke=Ss(nt);$e(_,22,D(He,Ce,me,Ke.slice(0,239)))}}++me}}return $e(_,1),_.end()}function l(P){var H=Oe(2);return H.write_shift(2,P),H}function u(P){var H=Oe(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var z=0,_=0,ce=0,re=0;re<P.SheetNames.length;++re){var me=P.SheetNames[re],je=P.Sheets[me];if(!(!je||!je["!ref"])){++ce;var Re=Zn(je["!ref"]);z<Re.e.r&&(z=Re.e.r),_<Re.e.c&&(_=Re.e.c)}}return z>8191&&(z=8191),H.write_shift(2,z),H.write_shift(1,ce),H.write_shift(1,_),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function h(P,H,z){var _={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&z.qpro?(_.s.c=P.read_shift(1),P.l++,_.s.r=P.read_shift(2),_.e.c=P.read_shift(1),P.l++,_.e.r=P.read_shift(2),_):(_.s.c=P.read_shift(2),_.s.r=P.read_shift(2),H==12&&z.qpro&&(P.l+=2),_.e.c=P.read_shift(2),_.e.r=P.read_shift(2),H==12&&z.qpro&&(P.l+=2),_.s.c==65535&&(_.s.c=_.e.c=_.s.r=_.e.r=0),_)}function m(P){var H=Oe(8);return H.write_shift(2,P.s.c),H.write_shift(2,P.s.r),H.write_shift(2,P.e.c),H.write_shift(2,P.e.r),H}function f(P,H,z){var _=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(_[0].c=P.read_shift(1),_[3]=P.read_shift(1),_[0].r=P.read_shift(2),P.l+=2):(_[2]=P.read_shift(1),_[0].c=P.read_shift(2),_[0].r=P.read_shift(2)),_}function p(P,H,z){var _=P.l+H,ce=f(P,H,z);if(ce[1].t="s",z.vers==20768){P.l++;var re=P.read_shift(1);return ce[1].v=P.read_shift(re,"utf8"),ce}return z.qpro&&P.l++,ce[1].v=P.read_shift(_-P.l,"cstr"),ce}function g(P,H,z){var _=Oe(7+z.length);_.write_shift(1,255),_.write_shift(2,H),_.write_shift(2,P),_.write_shift(1,39);for(var ce=0;ce<_.length;++ce){var re=z.charCodeAt(ce);_.write_shift(1,re>=128?95:re)}return _.write_shift(1,0),_}function y(P,H,z){var _=f(P,H,z);return _[1].v=P.read_shift(2,"i"),_}function v(P,H,z){var _=Oe(7);return _.write_shift(1,255),_.write_shift(2,H),_.write_shift(2,P),_.write_shift(2,z,"i"),_}function S(P,H,z){var _=f(P,H,z);return _[1].v=P.read_shift(8,"f"),_}function N(P,H,z){var _=Oe(13);return _.write_shift(1,255),_.write_shift(2,H),_.write_shift(2,P),_.write_shift(8,z,"f"),_}function w(P,H,z){var _=P.l+H,ce=f(P,H,z);if(ce[1].v=P.read_shift(8,"f"),z.qpro)P.l=_;else{var re=P.read_shift(2);O(P.slice(P.l,P.l+re),ce),P.l+=re}return ce}function E(P,H,z){var _=H&32768;return H&=-32769,H=(_?P:0)+(H>=8192?H-16384:H),(_?"":"$")+(z?yn(H):cn(H))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(P,H){Xn(P,0);for(var z=[],_=0,ce="",re="",me="",je="";P.l<P.length;){var Re=P[P.l++];switch(Re){case 0:z.push(P.read_shift(8,"f"));break;case 1:re=E(H[0].c,P.read_shift(2),!0),ce=E(H[0].r,P.read_shift(2),!1),z.push(re+ce);break;case 2:{var We=E(H[0].c,P.read_shift(2),!0),Ge=E(H[0].r,P.read_shift(2),!1);re=E(H[0].c,P.read_shift(2),!0),ce=E(H[0].r,P.read_shift(2),!1),z.push(We+Ge+":"+re+ce)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(P.read_shift(2));break;case 6:{for(var Ve="";Re=P[P.l++];)Ve+=String.fromCharCode(Re);z.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:je=z.pop(),me=z.pop(),z.push(["AND","OR"][Re-20]+"("+me+","+je+")");break;default:if(Re<32&&T[Re])je=z.pop(),me=z.pop(),z.push(me+T[Re]+je);else if(C[Re]){if(_=C[Re][1],_==69&&(_=P[P.l++]),_>z.length){console.error("WK1 bad formula parse 0x"+Re.toString(16)+":|"+z.join("|")+"|");return}var He=z.slice(-_);z.length-=_,z.push(C[Re][0]+"("+He.join(",")+")")}else return Re<=7?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=24?console.error("WK1 unsupported op "+Re.toString(16)):Re<=30?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=115?console.error("WK1 unsupported function opcode "+Re.toString(16)):console.error("WK1 unrecognized opcode "+Re.toString(16))}}z.length==1?H[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function j(P){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=P.read_shift(2),H[3]=P[P.l++],H[0].c=P[P.l++],H}function q(P,H){var z=j(P);return z[1].t="s",z[1].v=P.read_shift(H-4,"cstr"),z}function D(P,H,z,_){var ce=Oe(6+_.length);ce.write_shift(2,P),ce.write_shift(1,z),ce.write_shift(1,H),ce.write_shift(1,39);for(var re=0;re<_.length;++re){var me=_.charCodeAt(re);ce.write_shift(1,me>=128?95:me)}return ce.write_shift(1,0),ce}function U(P,H){var z=j(P);z[1].v=P.read_shift(2);var _=z[1].v>>1;if(z[1].v&1)switch(_&7){case 0:_=(_>>3)*5e3;break;case 1:_=(_>>3)*500;break;case 2:_=(_>>3)/20;break;case 3:_=(_>>3)/200;break;case 4:_=(_>>3)/2e3;break;case 5:_=(_>>3)/2e4;break;case 6:_=(_>>3)/16;break;case 7:_=(_>>3)/64;break}return z[1].v=_,z}function K(P,H){var z=j(P),_=P.read_shift(4),ce=P.read_shift(4),re=P.read_shift(2);if(re==65535)return _===0&&ce===3221225472?(z[1].t="e",z[1].v=15):_===0&&ce===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var me=re&32768;return re=(re&32767)-16446,z[1].v=(1-me*2)*(ce*Math.pow(2,re+32)+_*Math.pow(2,re)),z}function ie(P,H,z,_){var ce=Oe(14);if(ce.write_shift(2,P),ce.write_shift(1,z),ce.write_shift(1,H),_==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var re=0,me=0,je=0,Re=0;return _<0&&(re=1,_=-_),me=Math.log2(_)|0,_/=Math.pow(2,me-31),Re=_>>>0,(Re&2147483648)==0&&(_/=2,++me,Re=_>>>0),_-=Re,Re|=2147483648,Re>>>=0,_*=Math.pow(2,32),je=_>>>0,ce.write_shift(4,je),ce.write_shift(4,Re),me+=16383+(re?32768:0),ce.write_shift(2,me),ce}function te(P,H){var z=K(P);return P.l+=H-14,z}function G(P,H){var z=j(P),_=P.read_shift(4);return z[1].v=_>>6,z}function de(P,H){var z=j(P),_=P.read_shift(8,"f");return z[1].v=_,z}function J(P,H){var z=de(P);return P.l+=H-10,z}function W(P,H){return P[P.l+H-1]==0?P.read_shift(H,"cstr"):""}function F(P,H){var z=P[P.l++];z>H-1&&(z=H-1);for(var _="";_.length<z;)_+=String.fromCharCode(P[P.l++]);return _}function Z(P,H,z){if(!(!z.qpro||H<21)){var _=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var ce=P.read_shift(H-21,"cstr");return[_,ce]}}function oe(P,H){for(var z={},_=P.l+H;P.l<_;){var ce=P.read_shift(2);if(ce==14e3){for(z[ce]=[0,""],z[ce][0]=P.read_shift(2);P[P.l];)z[ce][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return z}function le(P,H){var z=Oe(5+P.length);z.write_shift(2,14e3),z.write_shift(2,H);for(var _=0;_<P.length;++_){var ce=P.charCodeAt(_);z[z.l++]=ce>127?95:ce}return z[z.l++]=0,z}var R={0:{n:"BOF",f:T3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:W},222:{n:"SHEETNAMELP",f:F},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:q},23:{n:"NUMBER17",f:K},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:de},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:W},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}(),H7=/^\s|\s$|[\t\n\r]/;function D3(e,t){if(!t.bookSST)return"";var r=[Fr];r[r.length]=qe("sst",null,{xmlns:dl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(H7)&&(l+=' xml:space="preserve"'),l+=">"+Xt(s.t)+"</t>"),l+="</si>",r[r.length]=l}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Y7(e){return[e.read_shift(4),e.read_shift(4)]}function G7(e,t){return t||(t=Oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var q7=LR;function $7(e){var t=Ln();Pe(t,159,G7(e));for(var r=0;r<e.length;++r)Pe(t,19,q7(e[r]));return Pe(t,160),t.end()}function W7(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function k3(e){var t=0,r,n=W7(e),s=n.length+1,l,u,h,m,f;for(r=qi(s),r[0]=n.length,l=1;l!=s;++l)r[l]=n[l-1];for(l=s-1;l>=0;--l)u=r[l],h=(t&16384)===0?0:1,m=t<<1&32767,f=h|m,t=f^u;return t^52811}var X7=function(){function e(s,l){switch(l.type){case"base64":return t(ws(s),l);case"binary":return t(s,l);case"buffer":return t(Bt&&Buffer.isBuffer(s)?s.toString("binary"):du(s),l);case"array":return t($f(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){var u=l||{},h=u.dense?[]:{},m=s.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(p,g){Array.isArray(h)&&(h[g]=[]);for(var y=/\\\w+\b/g,v=0,S,N=-1;S=y.exec(p);){switch(S[0]){case"\\cell":var w=p.slice(v,y.lastIndex-S[0].length);if(w[0]==" "&&(w=w.slice(1)),++N,w.length){var E={v:w,t:"s"};Array.isArray(h)?h[g][N]=E:h[Kt({r:g,c:N})]=E}break}v=y.lastIndex}N>f.e.c&&(f.e.c=N)}),h["!ref"]=Mr(f),h}function r(s,l){return Qi(e(s,l),l)}function n(s){for(var l=["{\\rtf1\\ansi"],u=lr(s["!ref"]),h,m=Array.isArray(s),f=u.s.r;f<=u.e.r;++f){l.push("\\trowd\\trautofit1");for(var p=u.s.c;p<=u.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=u.s.c;p<=u.e.c;++p){var g=Kt({r:f,c:p});h=m?(s[f]||[])[p]:s[g],!(!h||h.v==null&&(!h.f||h.F))&&(l.push(" "+(h.w||(Ss(h),h.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Pb(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var K7=6,ps=K7;function bf(e){return Math.floor((e+Math.round(128/ps)/256)*ps)}function wf(e){return Math.floor((e-5)/ps*100+.5)/100}function vp(e){return Math.round((e*ps+5)/ps*256)/256}function Ex(e){e.width?(e.wpx=bf(e.width),e.wch=wf(e.wpx),e.MDW=ps):e.wpx?(e.wch=wf(e.wpx),e.width=vp(e.wch),e.MDW=ps):typeof e.wch=="number"&&(e.width=vp(e.wch),e.wpx=bf(e.width),e.MDW=ps),e.customWidth&&delete e.customWidth}var Q7=96,O3=Q7;function Sf(e){return e*96/O3}function R3(e){return e*O3/96}function Z7(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=qe("numFmt",null,{numFmtId:n,formatCode:Xt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=qe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function J7(e){var t=[];return t[t.length]=qe("cellXfs",null),e.forEach(function(r){t[t.length]=qe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=qe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function M3(e,t){var r=[Fr,qe("styleSheet",null,{xmlns:dl[0],"xmlns:vt":Wr.vt})],n;return e.SSF&&(n=Z7(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=J7(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function eM(e,t){var r=e.read_shift(2),n=vn(e);return[r,n]}function tM(e,t,r){r||(r=Oe(6+4*t.length)),r.write_shift(2,e),Kr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rM(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=HR(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var u=e.read_shift(1);u!=0&&(n.underline=u);var h=e.read_shift(1);h>0&&(n.family=h);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=VR(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=vn(e),n}function nM(e,t){t||(t=Oe(25+4*32)),t.write_shift(2,e.sz*20),YR(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),yf(e.color,t);var n=0;return n=2,t.write_shift(1,n),Kr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var aM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Em,sM=$a;function Bb(e,t){t||(t=Oe(4*3+8*7+16*1)),Em||(Em=hx(aM));var r=Em[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(yf({auto:1},t),yf({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function iM(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function F3(e,t,r){r||(r=Oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xc(e,t){return t||(t=Oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var oM=$a;function lM(e,t){return t||(t=Oe(51)),t.write_shift(1,0),xc(null,t),xc(null,t),xc(null,t),xc(null,t),xc(null,t),t.length>t.l?t.slice(0,t.l):t}function cM(e,t){return t||(t=Oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),gf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function uM(e,t,r){var n=Oe(2052);return n.write_shift(4,e),gf(t,n),gf(r,n),n.length>n.l?n.slice(0,n.l):n}function dM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Pe(e,615,ja(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Pe(e,44,tM(s,t[s]))}),Pe(e,616))}}function fM(e){var t=1;Pe(e,611,ja(t)),Pe(e,43,nM({sz:12,color:{theme:1},name:"Calibri",family:2})),Pe(e,612)}function hM(e){var t=2;Pe(e,603,ja(t)),Pe(e,45,Bb({patternType:"none"})),Pe(e,45,Bb({patternType:"gray125"})),Pe(e,604)}function mM(e){var t=1;Pe(e,613,ja(t)),Pe(e,46,lM()),Pe(e,614)}function pM(e){var t=1;Pe(e,626,ja(t)),Pe(e,47,F3({numFmtId:0},65535)),Pe(e,627)}function xM(e,t){Pe(e,617,ja(t.length)),t.forEach(function(r){Pe(e,47,F3(r,0))}),Pe(e,618)}function gM(e){var t=1;Pe(e,619,ja(t)),Pe(e,48,cM({xfId:0,name:"Normal"})),Pe(e,620)}function yM(e){var t=0;Pe(e,505,ja(t)),Pe(e,506)}function vM(e){var t=0;Pe(e,508,uM(t,"TableStyleMedium9","PivotStyleMedium4")),Pe(e,509)}function bM(e,t){var r=Ln();return Pe(r,278),dM(r,e.SSF),fM(r),hM(r),mM(r),pM(r),xM(r,t.cellXfs),gM(r),yM(r),vM(r),Pe(r,279),r.end()}function L3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Fr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wM(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:vn(e)}}function SM(e){var t=Oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Kr(e.name,t),t.slice(0,t.l)}function NM(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function TM(e){var t=Oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function EM(e,t){var r=Oe(8+2*t.length);return r.write_shift(4,e),Kr(t,r),r.slice(0,r.l)}function _M(e){return e.l+=4,e.read_shift(4)!=0}function CM(e,t){var r=Oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function AM(){var e=Ln();return Pe(e,332),Pe(e,334,ja(1)),Pe(e,335,SM({name:"XLDAPR",version:12e4,flags:3496657072})),Pe(e,336),Pe(e,339,EM(1,"XLDAPR")),Pe(e,52),Pe(e,35,ja(514)),Pe(e,4096,ja(0)),Pe(e,4097,da(1)),Pe(e,36),Pe(e,53),Pe(e,340),Pe(e,337,CM(1)),Pe(e,51,TM([[1,0]])),Pe(e,338),Pe(e,333),e.end()}function P3(){var e=[Fr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function jM(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Kt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var Ko=1024;function B3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[qe("xml",null,{"xmlns:v":Kn.v,"xmlns:o":Kn.o,"xmlns:x":Kn.x,"xmlns:mv":Kn.mv}).replace(/\/>/,">"),qe("o:shapelayout",qe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),qe("v:shapetype",[qe("v:stroke",null,{joinstyle:"miter"}),qe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Ko<e*1e3;)Ko+=1e3;return t.forEach(function(l){var u=Xr(l[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var m=h.type=="gradient"?qe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=qe("v:fill",m,h),p={on:"t",obscured:"t"};++Ko,s=s.concat(["<v:shape"+Xc({id:"_x0000_s"+Ko,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,qe("v:shadow",null,p),qe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ln("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),ln("x:AutoFill","False"),ln("x:Row",String(u.r)),ln("x:Column",String(u.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function U3(e){var t=[Fr,qe("comments",null,{xmlns:dl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var l=Xt(s.a);r.indexOf(l)==-1&&(r.push(l),t.push("<author>"+l+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,l=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(s=r.indexOf(Xt(m.a))),l.push(m.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),l.length<=1)t.push(ln("t",Xt(l[0]||"")));else{for(var u=`Comment:
    `+l[0]+`
`,h=1;h<l.length;++h)u+=`Reply:
    `+l[h]+`
`;t.push(ln("t",Xt(u)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function DM(e,t,r){var n=[Fr,qe("ThreadedComments",null,{xmlns:Wr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var l="";(s[1]||[]).forEach(function(u,h){if(!u.T){delete u.ID;return}u.a&&t.indexOf(u.a)==-1&&t.push(u.a);var m={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};h==0?l=m.id:m.parentId=l,u.ID=m.id,u.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(u.a)).slice(-12)+"}"),n.push(qe("threadedComment",ln("text",u.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function kM(e){var t=[Fr,qe("personList",null,{xmlns:Wr.TCMNT,"xmlns:x":dl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(qe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function OM(e){var t={};t.iauthor=e.read_shift(4);var r=to(e);return t.rfx=r.s,t.ref=Kt(r.s),e.l+=16,t}function RM(e,t){return t==null&&(t=Oe(36)),t.write_shift(4,e[1].iauthor),hl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var MM=vn;function FM(e){return Kr(e.slice(0,54))}function LM(e){var t=Ln(),r=[];return Pe(t,628),Pe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Pe(t,632,FM(s.a)))})}),Pe(t,631),Pe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var l={s:Xr(n[0]),e:Xr(n[0])};Pe(t,635,RM([l,s])),s.t&&s.t.length>0&&Pe(t,637,BR(s)),Pe(t,636),delete s.iauthor})}),Pe(t,634),Pe(t,629),t.end()}function PM(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&er.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var I3=["xlsb","xlsm","xlam","biff8","xla"],BM=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,l,u){var h=!1,m=!1;l.length==0?m=!0:l.charAt(0)=="["&&(m=!0,l=l.slice(1,-1)),u.length==0?h=!0:u.charAt(0)=="["&&(h=!0,u=u.slice(1,-1));var f=l.length>0?parseInt(l,10)|0:0,p=u.length>0?parseInt(u,10)|0:0;return h?p+=t.c:--p,m?f+=t.r:--f,s+(h?"":"$")+yn(p)+(m?"":"$")+cn(f)}return function(s,l){return t=l,s.replace(e,r)}}(),_x=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Cx=function(){return function(t,r){return t.replace(_x,function(n,s,l,u,h,m){var f=bx(u)-(l?0:r.c),p=vx(m)-(h?0:r.r),g=p==0?"":h?p+1:"["+p+"]",y=f==0?"":l?f+1:"["+f+"]";return s+"R"+g+"C"+y})}}();function UM(e,t){return e.replace(_x,function(r,n,s,l,u,h){return n+(s=="$"?s+l:yn(bx(l)+t.c))+(u=="$"?u+h:cn(vx(h)+t.r))})}function IM(e){return e.length!=1}function Rr(e){e.l+=1}function oi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function z3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return V3(e);r.biff==12&&(n=4)}var s=e.read_shift(n),l=e.read_shift(n),u=oi(e),h=oi(e);return{s:{r:s,c:u[0],cRel:u[1],rRel:u[2]},e:{r:l,c:h[0],cRel:h[1],rRel:h[2]}}}function V3(e){var t=oi(e),r=oi(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function zM(e,t,r){if(r.biff<8)return V3(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),l=oi(e),u=oi(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function H3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return VM(e);var n=e.read_shift(r&&r.biff==12?4:2),s=oi(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function VM(e){var t=oi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function HM(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YM(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return GM(e);var s=e.read_shift(n>=12?4:2),l=e.read_shift(2),u=(l&16384)>>14,h=(l&32768)>>15;if(l&=16383,h==1)for(;s>524287;)s-=1048576;if(u==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:u,rRel:h}}function GM(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function qM(e,t,r){var n=(e[e.l++]&96)>>5,s=z3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function $M(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var u=z3(e,l,r);return[n,s,u]}function WM(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function XM(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=8;if(r)switch(r.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,s]}function KM(e,t,r){var n=(e[e.l++]&96)>>5,s=zM(e,t-1,r);return[n,s]}function QM(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Ub(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function ZM(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],l=0;l<=n;++l)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function JM(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function eF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function tF(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function rF(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Y3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function nF(e){return e.read_shift(2),Y3(e)}function aF(e){return e.read_shift(2),Y3(e)}function sF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=H3(e,0,r);return[n,s]}function iF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=YM(e,0,r);return[n,s]}function oF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var l=H3(e,0,r);return[n,s,l]}function lF(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[lL[s],$3[s],n]}function cF(e,t,r){var n=e[e.l++],s=e.read_shift(1),l=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:uF(e);return[s,(l[0]===0?$3:oL)[l[1]]]}function uF(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function dF(e,t,r){e.l+=r&&r.biff==2?3:4}function fF(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function hF(e){return e.l++,mu[e.read_shift(1)]}function mF(e){return e.l++,e.read_shift(2)}function pF(e){return e.l++,e.read_shift(1)!==0}function xF(e){return e.l++,ml(e)}function gF(e,t,r){return e.l++,_3(e,t-1,r)}function yF(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=o7(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=mu[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ml(e);break;case 2:r[1]=d7(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function vF(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],l=0;l!=n;++l)s.push((r.biff==12?to:m7)(e));return s}function bF(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var l=0,u=[];l!=n&&(u[l]=[]);++l)for(var h=0;h!=s;++h)u[l][h]=yF(e,r.biff);return u}function wF(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,l=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function SF(e,t,r){if(r.biff==5)return NF(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),l=e.read_shift(4);return[n,s,l]}function NF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function TF(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function EF(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function _F(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function CF(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),l=4;if(r)switch(r.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,s]}var AF=$a,jF=$a,DF=$a;function pu(e,t,r){return e.l+=2,[HM(e)]}function Ax(e){return e.l+=6,[]}var kF=pu,OF=Ax,RF=Ax,MF=pu;function G3(e){return e.l+=2,[T3(e),e.read_shift(2)&1]}var FF=pu,LF=G3,PF=Ax,BF=pu,UF=pu,IF=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zF(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),l=e.read_shift(2),u=IF[r>>2&31];return{ixti:t,coltype:r&3,rt:u,idx:n,c:s,C:l}}function VF(e){return e.l+=2,[e.read_shift(4)]}function HF(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function YF(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function GF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qF(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function $F(e){return e.l+=4,[0,0]}var Ib={1:{n:"PtgExp",f:fF},2:{n:"PtgTbl",f:DF},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:gF},26:{n:"PtgSheet",f:HF},27:{n:"PtgEndSheet",f:YF},28:{n:"PtgErr",f:hF},29:{n:"PtgBool",f:pF},30:{n:"PtgInt",f:mF},31:{n:"PtgNum",f:xF},32:{n:"PtgArray",f:QM},33:{n:"PtgFunc",f:lF},34:{n:"PtgFuncVar",f:cF},35:{n:"PtgName",f:wF},36:{n:"PtgRef",f:sF},37:{n:"PtgArea",f:qM},38:{n:"PtgMemArea",f:TF},39:{n:"PtgMemErr",f:AF},40:{n:"PtgMemNoMem",f:jF},41:{n:"PtgMemFunc",f:EF},42:{n:"PtgRefErr",f:_F},43:{n:"PtgAreaErr",f:WM},44:{n:"PtgRefN",f:iF},45:{n:"PtgAreaN",f:KM},46:{n:"PtgMemAreaN",f:GF},47:{n:"PtgMemNoMemN",f:qF},57:{n:"PtgNameX",f:SF},58:{n:"PtgRef3d",f:oF},59:{n:"PtgArea3d",f:$M},60:{n:"PtgRefErr3d",f:CF},61:{n:"PtgAreaErr3d",f:XM},255:{}},WF={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},XF={1:{n:"PtgElfLel",f:G3},2:{n:"PtgElfRw",f:BF},3:{n:"PtgElfCol",f:kF},6:{n:"PtgElfRwV",f:UF},7:{n:"PtgElfColV",f:MF},10:{n:"PtgElfRadical",f:FF},11:{n:"PtgElfRadicalS",f:PF},13:{n:"PtgElfColS",f:OF},15:{n:"PtgElfColSV",f:RF},16:{n:"PtgElfRadicalLel",f:LF},25:{n:"PtgList",f:zF},29:{n:"PtgSxName",f:VF},255:{}},KF={0:{n:"PtgAttrNoop",f:$F},1:{n:"PtgAttrSemi",f:rF},2:{n:"PtgAttrIf",f:eF},4:{n:"PtgAttrChoose",f:ZM},8:{n:"PtgAttrGoto",f:JM},16:{n:"PtgAttrSum",f:dF},32:{n:"PtgAttrBaxcel",f:Ub},33:{n:"PtgAttrBaxcel",f:Ub},64:{n:"PtgAttrSpace",f:nF},65:{n:"PtgAttrSpaceSemi",f:aF},128:{n:"PtgAttrIfError",f:tF},255:{}};function QF(e,t,r,n){if(n.biff<8)return $a(e,t);for(var s=e.l+t,l=[],u=0;u!==r.length;++u)switch(r[u][0]){case"PtgArray":r[u][1]=bF(e,0,n),l.push(r[u][1]);break;case"PtgMemArea":r[u][2]=vF(e,r[u][1],n),l.push(r[u][2]);break;case"PtgExp":n&&n.biff==12&&(r[u][1][1]=e.read_shift(4),l.push(r[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[u][0]}return t=s-e.l,t!==0&&l.push($a(e,t)),l}function ZF(e,t,r){for(var n=e.l+t,s,l,u=[];n!=e.l;)t=n-e.l,l=e[e.l],s=Ib[l]||Ib[WF[l]],(l===24||l===25)&&(s=(l===24?XF:KF)[e[e.l+1]]),!s||!s.f?$a(e,t):u.push([s.n,s.f(e,t,r)]);return u}function JF(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],l=0;l<n.length;++l){var u=n[l];if(u)switch(u[0]){case 2:s.push('"'+u[1].replace(/"/g,'""')+'"');break;default:s.push(u[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var eL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tL(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function q3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function zb(e,t,r){var n=q3(e,t,r);return n=="#REF"?n:tL(n,r)}function nl(e,t,r,n,s){var l=s&&s.biff||8,u={s:{c:0,r:0}},h=[],m,f,p,g=0,y=0,v,S="";if(!e[0]||!e[0][0])return"";for(var N=-1,w="",E=0,C=e[0].length;E<C;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=h.pop(),f=h.pop(),N>=0){switch(e[0][N][1][0]){case 0:w=Sr(" ",e[0][N][1][1]);break;case 1:w=Sr("\r",e[0][N][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][N][1][0])}f=f+w,N=-1}h.push(f+eL[T[0]]+m);break;case"PtgIsect":m=h.pop(),f=h.pop(),h.push(f+" "+m);break;case"PtgUnion":m=h.pop(),f=h.pop(),h.push(f+","+m);break;case"PtgRange":m=h.pop(),f=h.pop(),h.push(f+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=kc(T[1][1],u,s),h.push(Oc(p,l));break;case"PtgRefN":p=r?kc(T[1][1],r,s):T[1][1],h.push(Oc(p,l));break;case"PtgRef3d":g=T[1][1],p=kc(T[1][2],u,s),S=zb(n,g,s),h.push(S+"!"+Oc(p,l));break;case"PtgFunc":case"PtgFuncVar":var O=T[1][0],j=T[1][1];O||(O=0),O&=127;var q=O==0?[]:h.slice(-O);h.length-=O,j==="User"&&(j=q.shift()),h.push(j+"("+q.join(",")+")");break;case"PtgBool":h.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(T[1]);break;case"PtgNum":h.push(String(T[1]));break;case"PtgStr":h.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(T[1]);break;case"PtgAreaN":v=Eb(T[1][1],r?{s:r}:u,s),h.push(Nm(v,s));break;case"PtgArea":v=Eb(T[1][1],u,s),h.push(Nm(v,s));break;case"PtgArea3d":g=T[1][1],v=T[1][2],S=zb(n,g,s),h.push(S+"!"+Nm(v,s));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=T[1][2];var D=(n.names||[])[y-1]||(n[0]||[])[y],U=D?D.Name:"SH33TJSNAME"+String(y);U&&U.slice(0,6)=="_xlfn."&&!s.xlfn&&(U=U.slice(6)),h.push(U);break;case"PtgNameX":var K=T[1][1];y=T[1][2];var ie;if(s.biff<=5)K<0&&(K=-K),n[K]&&(ie=n[K][y]);else{var te="";if(((n[K]||[])[0]||[])[0]==14849||(((n[K]||[])[0]||[])[0]==1025?n[K][y]&&n[K][y].itab>0&&(te=n.SheetNames[n[K][y].itab-1]+"!"):te=n.SheetNames[y-1]+"!"),n[K]&&n[K][y])te+=n[K][y].Name;else if(n[0]&&n[0][y])te+=n[0][y].Name;else{var G=(q3(n,K,s)||"").split(";;");G[y-1]?te=G[y-1]:te+="SH33TJSERRX"}h.push(te);break}ie||(ie={Name:"SH33TJSERRY"}),h.push(ie.Name);break;case"PtgParen":var de="(",J=")";if(N>=0){switch(w="",e[0][N][1][0]){case 2:de=Sr(" ",e[0][N][1][1])+de;break;case 3:de=Sr("\r",e[0][N][1][1])+de;break;case 4:J=Sr(" ",e[0][N][1][1])+J;break;case 5:J=Sr("\r",e[0][N][1][1])+J;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][N][1][0])}N=-1}h.push(de+h.pop()+J);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":p={c:T[1][1],r:T[1][0]};var W={c:r.c,r:r.r};if(n.sharedf[Kt(p)]){var F=n.sharedf[Kt(p)];h.push(nl(F,u,W,n,s))}else{var Z=!1;for(m=0;m!=n.arrayf.length;++m)if(f=n.arrayf[m],!(p.c<f[0].s.c||p.c>f[0].e.c)&&!(p.r<f[0].s.r||p.r>f[0].e.r)){h.push(nl(f[1],u,W,n,s)),Z=!0;break}Z||h.push(T[1])}break;case"PtgArray":h.push("{"+JF(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":N=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&N>=0&&oe.indexOf(e[0][E][0])==-1){T=e[0][N];var le=!0;switch(T[1][0]){case 4:le=!1;case 0:w=Sr(" ",T[1][1]);break;case 5:le=!1;case 1:w=Sr("\r",T[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}h.push((le?w:"")+h.pop()+(le?"":w)),N=-1}}if(h.length>1&&s.WTF)throw new Error("bad formula stack");return h[0]}function rL(e){if(e==null){var t=Oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return $i(e);return $i(0)}function nL(e,t,r,n,s){var l=Wi(t,r,s),u=rL(e.v),h=Oe(6),m=33;h.write_shift(2,m),h.write_shift(4,0);for(var f=Oe(e.bf.length),p=0;p<e.bf.length;++p)f[p]=e.bf[p];var g=on([l,u,h,f]);return g}function Wf(e,t,r){var n=e.read_shift(4),s=ZF(e,n,r),l=e.read_shift(4),u=l>0?QF(e,l,s,r):null;return[s,u]}var aL=Wf,Xf=Wf,sL=Wf,iL=Wf,oL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cL(e){var t="of:="+e.replace(_x,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function uL(e){return e.replace(/\./,"!")}var Rc=typeof Map<"u";function jx(e,t,r){var n=0,s=e.length;if(r){if(Rc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var l=Rc?r.get(t):r[t];n<l.length;++n)if(e[l[n]].t===t)return e.Count++,l[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Rc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function Kf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(ps=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=wf(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=vp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function W3(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function hi(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,l=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){HS(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=l;++s)if(e[s].numFmtId===n)return s;return e[l]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function dL(e,t,r){if(e&&e["!ref"]){var n=lr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function fL(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Mr(e[r])+'"/>';return t+"</mergeCells>"}function hL(e,t,r,n,s){var l=!1,u={},h=null;if(n.bookType!=="xlsx"&&t.vbaraw){var m=t.SheetNames[r];try{t.Workbook&&(m=t.Workbook.Sheets[r].CodeName||m)}catch{}l=!0,u.codeName=Wc(Xt(m))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),h=(h||"")+qe("outlinePr",null,f)}!l&&!h||(s[s.length]=qe("sheetPr",h,u))}var mL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function xL(e){var t={sheet:1};return mL.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),pL.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=k3(e.password).toString(16).toUpperCase()),qe("sheetProtection",null,t)}function gL(e){return W3(e),qe("pageMargins",null,e)}function yL(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=qe("col",null,Kf(s,n)));return r[r.length]="</cols>",r.join("")}function vL(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Mr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=Zn(s);u.s.r==u.e.r&&(u.e.r=Zn(t["!ref"]).e.r,s=Mr(u));for(var h=0;h<l.length;++h){var m=l[h];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),qe("autoFilter",null,{ref:s})}function bL(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),qe("sheetViews",qe("sheetView",null,s),{})}function wL(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",l=e.t,u=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=mu[e.v];break;case"d":n&&n.cellDates?s=En(e.v,-1).toISOString():(e=Bn(e),e.t="n",s=""+(e.v=Pn(En(e.v)))),typeof e.z>"u"&&(e.z=Nr[14]);break;default:s=e.v;break}var h=ln("v",Xt(s)),m={r:t},f=hi(n.cellXfs,e,n);switch(f!==0&&(m.s=f),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){h=ln("v",""+jx(n.Strings,e.v,n.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=l&&(e.t=l,e.v=u),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;h=qe("f",Xt(e.f),p)+(e.v!=null?h:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(m.cm=1),qe("c",h,m)}function SL(e,t,r,n){var s=[],l=[],u=lr(e["!ref"]),h="",m,f="",p=[],g=0,y=0,v=e["!rows"],S=Array.isArray(e),N={r:f},w,E=-1;for(y=u.s.c;y<=u.e.c;++y)p[y]=yn(y);for(g=u.s.r;g<=u.e.r;++g){for(l=[],f=cn(g),y=u.s.c;y<=u.e.c;++y){m=p[y]+f;var C=S?(e[g]||[])[y]:e[m];C!==void 0&&(h=wL(C,m,e,t))!=null&&l.push(h)}(l.length>0||v&&v[g])&&(N={r:f},v&&v[g]&&(w=v[g],w.hidden&&(N.hidden=1),E=-1,w.hpx?E=Sf(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(N.ht=E,N.customHeight=1),w.level&&(N.outlineLevel=w.level)),s[s.length]=qe("row",l.join(""),N))}if(v)for(;g<v.length;++g)v&&v[g]&&(N={r:g+1},w=v[g],w.hidden&&(N.hidden=1),E=-1,w.hpx?E=Sf(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(N.ht=E,N.customHeight=1),w.level&&(N.outlineLevel=w.level),s[s.length]=qe("row","",N));return s.join("")}function X3(e,t,r,n){var s=[Fr,qe("worksheet",null,{xmlns:dl[0],"xmlns:r":Wr.r})],l=r.SheetNames[e],u=0,h="",m=r.Sheets[l];m==null&&(m={});var f=m["!ref"]||"A1",p=lr(f);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),f=Mr(p)}n||(n={}),m["!comments"]=[];var g=[];hL(m,r,e,t,s),s[s.length]=qe("dimension",null,{ref:f}),s[s.length]=bL(m,t,e,r),t.sheetFormat&&(s[s.length]=qe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(s[s.length]=yL(m,m["!cols"])),s[u=s.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(h=SL(m,t),h.length>0&&(s[s.length]=h)),s.length>u+1&&(s[s.length]="</sheetData>",s[u]=s[u].replace("/>",">")),m["!protect"]&&(s[s.length]=xL(m["!protect"])),m["!autofilter"]!=null&&(s[s.length]=vL(m["!autofilter"],m,r,e)),m["!merges"]!=null&&m["!merges"].length>0&&(s[s.length]=fL(m["!merges"]));var y=-1,v,S=-1;return m["!links"].length>0&&(s[s.length]="<hyperlinks>",m["!links"].forEach(function(N){N[1].Target&&(v={ref:N[0]},N[1].Target.charAt(0)!="#"&&(S=Wt(n,-1,Xt(N[1].Target).replace(/#.*$/,""),Mt.HLINK),v["r:id"]="rId"+S),(y=N[1].Target.indexOf("#"))>-1&&(v.location=Xt(N[1].Target.slice(y+1))),N[1].Tooltip&&(v.tooltip=Xt(N[1].Tooltip)),s[s.length]=qe("hyperlink",null,v))}),s[s.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(s[s.length]=gL(m["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=ln("ignoredErrors",qe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),g.length>0&&(S=Wt(n,-1,"../drawings/drawing"+(e+1)+".xml",Mt.DRAW),s[s.length]=qe("drawing",null,{"r:id":"rId"+S}),m["!drawing"]=g),m["!comments"].length>0&&(S=Wt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Mt.VML),s[s.length]=qe("legacyDrawing",null,{"r:id":"rId"+S}),m["!legacy"]=S),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function NL(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(r.level=l&7),l&16&&(r.hidden=!0),l&32&&(r.hpt=s/20),r}function TL(e,t,r){var n=Oe(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var l=320;s.hpx?l=Sf(s.hpx)*20:s.hpt&&(l=s.hpt*20),n.write_shift(2,l),n.write_shift(1,0);var u=0;s.level&&(u|=s.level),s.hidden&&(u|=16),(s.hpx||s.hpt)&&(u|=32),n.write_shift(1,u),n.write_shift(1,0);var h=0,m=n.l;n.l+=4;for(var f={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var g=-1,y=-1,v=p<<10;v<p+1<<10;++v){f.c=v;var S=Array.isArray(r)?(r[f.r]||[])[f.c]:r[Kt(f)];S&&(g<0&&(g=v),y=v)}g<0||(++h,n.write_shift(4,g),n.write_shift(4,y))}var N=n.l;return n.l=m,n.write_shift(4,h),n.l=N,n.length>n.l?n.slice(0,n.l):n}function EL(e,t,r,n){var s=TL(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Pe(e,0,s)}var _L=to,CL=hl;function AL(){}function jL(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=UR(e),r}function DL(e,t,r){r==null&&(r=Oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return yf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),u3(e,r),r.slice(0,r.l)}function kL(e){var t=ma(e);return[t]}function OL(e,t,r){return r==null&&(r=Oe(8)),Zi(t,r)}function RL(e){var t=Ji(e);return[t]}function ML(e,t,r){return r==null&&(r=Oe(4)),eo(t,r)}function FL(e){var t=ma(e),r=e.read_shift(1);return[t,r,"b"]}function LL(e,t,r){return r==null&&(r=Oe(9)),Zi(t,r),r.write_shift(1,e.v?1:0),r}function PL(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"b"]}function BL(e,t,r){return r==null&&(r=Oe(5)),eo(t,r),r.write_shift(1,e.v?1:0),r}function UL(e){var t=ma(e),r=e.read_shift(1);return[t,r,"e"]}function IL(e,t,r){return r==null&&(r=Oe(9)),Zi(t,r),r.write_shift(1,e.v),r}function zL(e){var t=Ji(e),r=e.read_shift(1);return[t,r,"e"]}function VL(e,t,r){return r==null&&(r=Oe(8)),eo(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function HL(e){var t=ma(e),r=e.read_shift(4);return[t,r,"s"]}function YL(e,t,r){return r==null&&(r=Oe(12)),Zi(t,r),r.write_shift(4,t.v),r}function GL(e){var t=Ji(e),r=e.read_shift(4);return[t,r,"s"]}function qL(e,t,r){return r==null&&(r=Oe(8)),eo(t,r),r.write_shift(4,t.v),r}function $L(e){var t=ma(e),r=ml(e);return[t,r,"n"]}function WL(e,t,r){return r==null&&(r=Oe(16)),Zi(t,r),$i(e.v,r),r}function XL(e){var t=Ji(e),r=ml(e);return[t,r,"n"]}function KL(e,t,r){return r==null&&(r=Oe(12)),eo(t,r),$i(e.v,r),r}function QL(e){var t=ma(e),r=d3(e);return[t,r,"n"]}function ZL(e,t,r){return r==null&&(r=Oe(12)),Zi(t,r),f3(e.v,r),r}function JL(e){var t=Ji(e),r=d3(e);return[t,r,"n"]}function eP(e,t,r){return r==null&&(r=Oe(8)),eo(t,r),f3(e.v,r),r}function tP(e){var t=ma(e),r=wx(e);return[t,r,"is"]}function rP(e){var t=ma(e),r=vn(e);return[t,r,"str"]}function nP(e,t,r){return r==null&&(r=Oe(12+4*e.v.length)),Zi(t,r),Kr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function aP(e){var t=Ji(e),r=vn(e);return[t,r,"str"]}function sP(e,t,r){return r==null&&(r=Oe(8+4*e.v.length)),eo(t,r),Kr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iP(e,t,r){var n=e.l+t,s=ma(e);s.r=r["!row"];var l=e.read_shift(1),u=[s,l,"b"];if(r.cellFormula){e.l+=2;var h=Xf(e,n-e.l,r);u[3]=nl(h,null,s,r.supbooks,r)}else e.l=n;return u}function oP(e,t,r){var n=e.l+t,s=ma(e);s.r=r["!row"];var l=e.read_shift(1),u=[s,l,"e"];if(r.cellFormula){e.l+=2;var h=Xf(e,n-e.l,r);u[3]=nl(h,null,s,r.supbooks,r)}else e.l=n;return u}function lP(e,t,r){var n=e.l+t,s=ma(e);s.r=r["!row"];var l=ml(e),u=[s,l,"n"];if(r.cellFormula){e.l+=2;var h=Xf(e,n-e.l,r);u[3]=nl(h,null,s,r.supbooks,r)}else e.l=n;return u}function cP(e,t,r){var n=e.l+t,s=ma(e);s.r=r["!row"];var l=vn(e),u=[s,l,"str"];if(r.cellFormula){e.l+=2;var h=Xf(e,n-e.l,r);u[3]=nl(h,null,s,r.supbooks,r)}else e.l=n;return u}var uP=to,dP=hl;function fP(e,t){return t==null&&(t=Oe(4)),t.write_shift(4,e),t}function hP(e,t){var r=e.l+t,n=to(e),s=Sx(e),l=vn(e),u=vn(e),h=vn(e);e.l=r;var m={rfx:n,relId:s,loc:l,display:h};return u&&(m.Tooltip=u),m}function mP(e,t){var r=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));hl({s:Xr(e[0]),e:Xr(e[0])},r),Nx("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Kr(s||"",r),Kr(e[1].Tooltip||"",r),Kr("",r),r.slice(0,r.l)}function pP(){}function xP(e,t,r){var n=e.l+t,s=h3(e),l=e.read_shift(1),u=[s];if(u[2]=l,r.cellFormula){var h=aL(e,n-e.l,r);u[1]=h}else e.l=n;return u}function gP(e,t,r){var n=e.l+t,s=to(e),l=[s];if(r.cellFormula){var u=iL(e,n-e.l,r);l[1]=u,e.l=n}else e.l=n;return l}function yP(e,t,r){r==null&&(r=Oe(18));var n=Kf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var K3=["left","right","top","bottom","header","footer"];function vP(e){var t={};return K3.forEach(function(r){t[r]=ml(e)}),t}function bP(e,t){return t==null&&(t=Oe(6*8)),W3(e),K3.forEach(function(r){$i(e[r],t)}),t}function wP(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function SP(e,t,r){r==null&&(r=Oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function NP(e){var t=Oe(24);return t.write_shift(4,4),t.write_shift(4,1),hl(e,t),t}function TP(e,t){return t==null&&(t=Oe(16*4+2)),t.write_shift(2,e.password?k3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function EP(){}function _P(){}function CP(e,t,r,n,s,l,u){if(t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=Bn(t),t.z=t.z||Nr[14],t.v=Pn(En(t.v)),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}var m={r,c:n};switch(m.s=hi(s.cellXfs,t,s),t.l&&l["!links"].push([Kt(m),t.l]),t.c&&l["!comments"].push([Kt(m),t.c]),t.t){case"s":case"str":return s.bookSST?(h=jx(s.Strings,t.v,s.revStrings),m.t="s",m.v=h,u?Pe(e,18,qL(t,m)):Pe(e,7,YL(t,m))):(m.t="str",u?Pe(e,17,sP(t,m)):Pe(e,6,nP(t,m))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?u?Pe(e,13,eP(t,m)):Pe(e,2,ZL(t,m)):u?Pe(e,16,KL(t,m)):Pe(e,5,WL(t,m)),!0;case"b":return m.t="b",u?Pe(e,15,BL(t,m)):Pe(e,4,LL(t,m)),!0;case"e":return m.t="e",u?Pe(e,14,VL(t,m)):Pe(e,3,IL(t,m)),!0}return u?Pe(e,12,ML(t,m)):Pe(e,1,OL(t,m)),!0}function AP(e,t,r,n){var s=lr(t["!ref"]||"A1"),l,u="",h=[];Pe(e,145);var m=Array.isArray(t),f=s.e.r;t["!rows"]&&(f=Math.max(s.e.r,t["!rows"].length-1));for(var p=s.s.r;p<=f;++p){u=cn(p),EL(e,t,s,p);var g=!1;if(p<=s.e.r)for(var y=s.s.c;y<=s.e.c;++y){p===s.s.r&&(h[y]=yn(y)),l=h[y]+u;var v=m?(t[p]||[])[y]:t[l];if(!v){g=!1;continue}g=CP(e,v,p,y,n,t,g)}}Pe(e,146)}function jP(e,t){!t||!t["!merges"]||(Pe(e,177,fP(t["!merges"].length)),t["!merges"].forEach(function(r){Pe(e,176,dP(r))}),Pe(e,178))}function DP(e,t){!t||!t["!cols"]||(Pe(e,390),t["!cols"].forEach(function(r,n){r&&Pe(e,60,yP(n,r))}),Pe(e,391))}function kP(e,t){!t||!t["!ref"]||(Pe(e,648),Pe(e,649,NP(lr(t["!ref"]))),Pe(e,650))}function OP(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Wt(r,-1,n[1].Target.replace(/#.*$/,""),Mt.HLINK);Pe(e,494,mP(n,s))}}),delete t["!links"]}function RP(e,t,r,n){if(t["!comments"].length>0){var s=Wt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Mt.VML);Pe(e,551,Nx("rId"+s)),t["!legacy"]=s}}function MP(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],l=typeof s.ref=="string"?s.ref:Mr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var u=r.Workbook.Names,h=Zn(l);h.s.r==h.e.r&&(h.e.r=Zn(t["!ref"]).e.r,l=Mr(h));for(var m=0;m<u.length;++m){var f=u[m];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+l;break}}m==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+l}),Pe(e,161,hl(lr(l))),Pe(e,162)}}function FP(e,t,r){Pe(e,133),Pe(e,137,SP(t,r)),Pe(e,138),Pe(e,134)}function LP(e,t){t["!protect"]&&Pe(e,535,TP(t["!protect"]))}function PP(e,t,r,n){var s=Ln(),l=r.SheetNames[e],u=r.Sheets[l]||{},h=l;try{r&&r.Workbook&&(h=r.Workbook.Sheets[e].CodeName||h)}catch{}var m=lr(u["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Pe(s,129),(r.vbaraw||u["!outline"])&&Pe(s,147,DL(h,u["!outline"])),Pe(s,148,CL(m)),FP(s,u,r.Workbook),DP(s,u),AP(s,u,e,t),LP(s,u),MP(s,u,r,e),jP(s,u),OP(s,u,n),u["!margins"]&&Pe(s,476,bP(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&kP(s,u),RP(s,u,e,n),Pe(s,130),s.end()}function BP(e,t){e.l+=10;var r=vn(e);return{name:r}}var UP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function IP(e){return!e.Workbook||!e.Workbook.WBProps?"false":gR(e.Workbook.WBProps.date1904)?"true":"false"}var zP="][*?/\\".split("");function Q3(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return zP.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function VP(e,t,r){e.forEach(function(n,s){Q3(n);for(var l=0;l<s;++l)if(n==e[l])throw new Error("Duplicate Sheet Name: "+n);if(r){var u=t&&t[s]&&t[s].CodeName||n;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function HP(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];VP(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)dL(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function Z3(e){var t=[Fr];t[t.length]=qe("workbook",null,{xmlns:dl[0],"xmlns:r":Wr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(UP.forEach(function(h){e.Workbook.WBProps[h[0]]!=null&&e.Workbook.WBProps[h[0]]!=h[1]&&(n[h[0]]=e.Workbook.WBProps[h[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=qe("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",l=0;l!=e.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==e.SheetNames.length&&(l=0),t[t.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",l=0;l!=e.SheetNames.length;++l){var u={name:Xt(e.SheetNames[l].slice(0,31))};if(u.sheetId=""+(l+1),u["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}t[t.length]=qe("sheet",null,u)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(h){var m={name:h.Name};h.Comment&&(m.comment=h.Comment),h.Sheet!=null&&(m.localSheetId=""+h.Sheet),h.Hidden&&(m.hidden="1"),h.Ref&&(t[t.length]=qe("definedName",Xt(h.Ref),m))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function YP(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=yp(e),r.name=vn(e),r}function GP(e,t){return t||(t=Oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Nx(e.strRelID,t),Kr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function qP(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?vn(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $P(e,t){t||(t=Oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),u3(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function WP(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),l=IR(e),u=sL(e,0,r),h=Sx(e);e.l=n;var m={Name:l,Ptg:u};return s<268435455&&(m.Sheet=s),h&&(m.Comment=h),m}function XP(e,t){Pe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Pe(e,156,GP(s))}Pe(e,144)}function KP(e,t){t||(t=Oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Kr("SheetJS",t),Kr(df.version,t),Kr(df.version,t),Kr("7262",t),t.length>t.l?t.slice(0,t.l):t}function QP(e,t){t||(t=Oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ZP(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,l=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&l==-1&&(l=n);l>s||(Pe(e,135),Pe(e,158,QP(s)),Pe(e,136))}}function JP(e,t){var r=Ln();return Pe(r,131),Pe(r,128,KP()),Pe(r,153,$P(e.Workbook&&e.Workbook.WBProps||null)),ZP(r,e),XP(r,e),Pe(r,132),r.end()}function e9(e,t,r){return(t.slice(-4)===".bin"?JP:Z3)(e)}function t9(e,t,r,n,s){return(t.slice(-4)===".bin"?PP:X3)(e,r,n,s)}function r9(e,t,r){return(t.slice(-4)===".bin"?bM:M3)(e,r)}function n9(e,t,r){return(t.slice(-4)===".bin"?$7:D3)(e,r)}function a9(e,t,r){return(t.slice(-4)===".bin"?LM:U3)(e)}function s9(e){return(e.slice(-4)===".bin"?AM:P3)()}function i9(e,t){var r=[];return e.Props&&r.push(r7(e.Props,t)),e.Custprops&&r.push(n7(e.Props,e.Custprops)),r.join("")}function o9(){return""}function l9(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var l=[];l.push(qe("NumberFormat",null,{"ss:Format":Xt(Nr[n.numFmtId])}));var u={"ss:ID":"s"+(21+s)};r.push(qe("Style",l.join(""),u))}),qe("Styles",r.join(""))}function J3(e){return qe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Cx(e.Ref,{r:0,c:0})})}function c9(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(J3(s)))}return qe("Names",r.join(""))}function u9(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,l=[],u=0;u<s.length;++u){var h=s[u];h.Sheet==r&&(h.Name.match(/^_xlfn\./)||l.push(J3(h)))}return l.join("")}function d9(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(qe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(qe("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(qe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(qe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<r&&!(n.Workbook.Sheets[l]&&!n.Workbook.Sheets[l].Hidden);++l);l==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(ln("ProtectContents","True")),e["!protect"].objects&&s.push(ln("ProtectObjects","True")),e["!protect"].scenarios&&s.push(ln("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(ln("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(ln("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){e["!protect"][u[0]]&&s.push("<"+u[1]+"/>")})),s.length==0?"":qe("WorksheetOptions",s.join(""),{xmlns:Kn.x})}function f9(e){return e.map(function(t){var r=xR(t.t||""),n=qe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return qe("Comment",n,{"ss:Author":t.a})}).join("")}function h9(e,t,r,n,s,l,u){if(!e||e.v==null&&e.f==null)return"";var h={};if(e.f&&(h["ss:Formula"]="="+Xt(Cx(e.f,u))),e.F&&e.F.slice(0,t.length)==t){var m=Xr(e.F.slice(t.length+1));h["ss:ArrayRange"]="RC:R"+(m.r==u.r?"":"["+(m.r-u.r)+"]")+"C"+(m.c==u.c?"":"["+(m.c-u.c)+"]")}if(e.l&&e.l.Target&&(h["ss:HRef"]=Xt(e.l.Target),e.l.Tooltip&&(h["x:HRefScreenTip"]=Xt(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],p=0;p!=f.length;++p)f[p].s.c!=u.c||f[p].s.r!=u.r||(f[p].e.c>f[p].s.c&&(h["ss:MergeAcross"]=f[p].e.c-f[p].s.c),f[p].e.r>f[p].s.r&&(h["ss:MergeDown"]=f[p].e.r-f[p].s.r));var g="",y="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",y=String(e.v);break;case"b":g="Boolean",y=e.v?"1":"0";break;case"e":g="Error",y=mu[e.v];break;case"d":g="DateTime",y=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Nr[14]);break;case"s":g="String",y=pR(e.v||"");break}var v=hi(n.cellXfs,e,n);h["ss:StyleID"]="s"+(21+v),h["ss:Index"]=u.c+1;var S=e.v!=null?y:"",N=e.t=="z"?"":'<Data ss:Type="'+g+'">'+S+"</Data>";return(e.c||[]).length>0&&(N+=f9(e.c)),qe("Cell",N,h)}function m9(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=R3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function p9(e,t,r,n){if(!e["!ref"])return"";var s=lr(e["!ref"]),l=e["!merges"]||[],u=0,h=[];e["!cols"]&&e["!cols"].forEach(function(w,E){Ex(w);var C=!!w.width,T=Kf(E,w),O={"ss:Index":E+1};C&&(O["ss:Width"]=bf(T.width)),w.hidden&&(O["ss:Hidden"]="1"),h.push(qe("Column",null,O))});for(var m=Array.isArray(e),f=s.s.r;f<=s.e.r;++f){for(var p=[m9(f,(e["!rows"]||[])[f])],g=s.s.c;g<=s.e.c;++g){var y=!1;for(u=0;u!=l.length;++u)if(!(l[u].s.c>g)&&!(l[u].s.r>f)&&!(l[u].e.c<g)&&!(l[u].e.r<f)){(l[u].s.c!=g||l[u].s.r!=f)&&(y=!0);break}if(!y){var v={r:f,c:g},S=Kt(v),N=m?(e[f]||[])[g]:e[S];p.push(h9(N,S,e,t,r,n,v))}}p.push("</Row>"),p.length>2&&h.push(p.join(""))}return h.join("")}function x9(e,t,r){var n=[],s=r.SheetNames[e],l=r.Sheets[s],u=l?u9(l,t,e,r):"";return u.length>0&&n.push("<Names>"+u+"</Names>"),u=l?p9(l,t,e,r):"",u.length>0&&n.push("<Table>"+u+"</Table>"),n.push(d9(l,t,e,r)),n.join("")}function g9(e,t){t||(t={}),e.SSF||(e.SSF=Bn(Nr)),e.SSF&&(Gf(),Yf(e.SSF),t.revssf=qf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],hi(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(i9(e,t)),r.push(o9()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(qe("Worksheet",x9(n,t,e),{"ss:Name":Xt(e.SheetNames[n])}));return r[2]=l9(e,t),r[3]=c9(e),Fr+qe("Workbook",r.join(""),{xmlns:Kn.ss,"xmlns:o":Kn.o,"xmlns:x":Kn.x,"xmlns:ss":Kn.ss,"xmlns:dt":Kn.dt,"xmlns:html":Kn.html})}var _m={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function y9(e,t){var r=[],n=[],s=[],l=0,u,h=mb(Cb,"n"),m=mb(Ab,"n");if(e.Props)for(u=un(e.Props),l=0;l<u.length;++l)(Object.prototype.hasOwnProperty.call(h,u[l])?r:Object.prototype.hasOwnProperty.call(m,u[l])?n:s).push([u[l],e.Props[u[l]]]);if(e.Custprops)for(u=un(e.Custprops),l=0;l<u.length;++l)Object.prototype.hasOwnProperty.call(e.Props||{},u[l])||(Object.prototype.hasOwnProperty.call(h,u[l])?r:Object.prototype.hasOwnProperty.call(m,u[l])?n:s).push([u[l],e.Custprops[u[l]]]);var f=[];for(l=0;l<s.length;++l)N3.indexOf(s[l][0])>-1||b3.indexOf(s[l][0])>-1||s[l][1]!=null&&f.push(s[l]);n.length&&er.utils.cfb_add(t,"/SummaryInformation",Rb(n,_m.SI,m,Ab)),(r.length||f.length)&&er.utils.cfb_add(t,"/DocumentSummaryInformation",Rb(r,_m.DSI,h,Cb,f.length?f:null,_m.UDI))}function v9(e,t){var r=t||{},n=er.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return er.utils.cfb_add(n,s,eN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&y9(e,n),r.biff==8&&e.vbaraw&&PM(n,er.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var b9={0:{f:NL},1:{f:kL},2:{f:QL},3:{f:UL},4:{f:FL},5:{f:$L},6:{f:rP},7:{f:HL},8:{f:cP},9:{f:lP},10:{f:iP},11:{f:oP},12:{f:RL},13:{f:JL},14:{f:zL},15:{f:PL},16:{f:XL},17:{f:aP},18:{f:GL},19:{f:wx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:WP},40:{},42:{},43:{f:rM},44:{f:eM},45:{f:sM},46:{f:oM},47:{f:iM},48:{},49:{f:RR},50:{},51:{f:NM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:M7},62:{f:tP},63:{f:jM},64:{f:EP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$a,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:wP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jL},148:{f:_L,p:16},151:{f:pP},152:{},153:{f:qP},154:{},155:{},156:{f:YP},157:{},158:{},159:{T:1,f:Y7},160:{T:-1},161:{T:1,f:to},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uP},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:wM},336:{T:-1},337:{f:_M,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:A7},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:xP},427:{f:gP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:AL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:MM},633:{T:1},634:{T:-1},635:{T:1,f:OM},636:{T:-1},637:{f:PR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:BP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_P},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function $e(e,t,r,n){var s=t;if(!isNaN(s)){var l=n||(r||[]).length||0,u=e.next(4);u.write_shift(2,s),u.write_shift(2,l),l>0&&yx(r)&&e.push(r)}}function w9(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return $e(e,t,r,s);var l=t;if(!isNaN(l)){for(var u=r.parts||[],h=0,m=0,f=0;f+(u[h]||8224)<=8224;)f+=u[h]||8224,h++;var p=e.next(4);for(p.write_shift(2,l),p.write_shift(2,f),e.push(r.slice(m,m+f)),m+=f;m<s;){for(p=e.next(4),p.write_shift(2,60),f=0;f+(u[h]||8224)<=8224;)f+=u[h]||8224,h++;p.write_shift(2,f),e.push(r.slice(m,m+f)),m+=f}}}function xu(e,t,r){return e||(e=Oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function S9(e,t,r,n){var s=Oe(9);return xu(s,e,t),E3(r,n||"b",s),s}function N9(e,t,r){var n=Oe(8+2*r.length);return xu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function T9(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Pn(En(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?$e(e,2,B7(r,n,s)):$e(e,3,P7(r,n,s));return;case"b":case"e":$e(e,5,S9(r,n,t.v,t.t));return;case"s":case"str":$e(e,4,N9(r,n,(t.v||"").slice(0,255)));return}$e(e,1,xu(null,r,n))}function E9(e,t,r,n){var s=Array.isArray(t),l=lr(t["!ref"]||"A1"),u,h="",m=[];if(l.e.c>255||l.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),u=Mr(l)}for(var f=l.s.r;f<=l.e.r;++f){h=cn(f);for(var p=l.s.c;p<=l.e.c;++p){f===l.s.r&&(m[p]=yn(p)),u=m[p]+h;var g=s?(t[f]||[])[p]:t[u];g&&T9(e,g,f,p)}}}function _9(e,t){for(var r=t||{},n=Ln(),s=0,l=0;l<e.SheetNames.length;++l)e.SheetNames[l]==r.sheet&&(s=l);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return $e(n,r.biff==4?1033:r.biff==3?521:9,Tx(e,16,r)),E9(n,e.Sheets[e.SheetNames[s]],s,r),$e(n,10),n.end()}function C9(e,t,r){$e(e,49,b7({sz:12,name:"Arial"},r))}function A9(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&$e(e,1054,N7(s,t[s],r))})}function j9(e,t){var r=Oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),$e(e,2151,r),r=Oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),A3(lr(t["!ref"]||"A1"),r),r.write_shift(4,4),$e(e,2152,r)}function D9(e,t){for(var r=0;r<16;++r)$e(e,224,Fb({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){$e(e,224,Fb(n,0,t))})}function k9(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];$e(e,440,k7(n)),n[1].Tooltip&&$e(e,2048,O7(n))}delete t["!links"]}function O9(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&$e(e,125,F7(Kf(s,n),s))})}}function R9(e,t,r,n,s){var l=16+hi(s.cellXfs,t,s);if(t.v==null&&!t.bf){$e(e,513,Wi(r,n,l));return}if(t.bf)$e(e,6,nL(t,r,n,s,l));else switch(t.t){case"d":case"n":var u=t.t=="d"?Pn(En(t.v)):t.v;$e(e,515,C7(r,n,u,l));break;case"b":case"e":$e(e,517,_7(r,n,t.v,l,s,t.t));break;case"s":case"str":if(s.bookSST){var h=jx(s.Strings,t.v,s.revStrings);$e(e,253,w7(r,n,h,l))}else $e(e,516,S7(r,n,(t.v||"").slice(0,255),l,s));break;default:$e(e,513,Wi(r,n,l))}}function M9(e,t,r){var n=Ln(),s=r.SheetNames[e],l=r.Sheets[s]||{},u=(r||{}).Workbook||{},h=(u.Sheets||[])[e]||{},m=Array.isArray(l),f=t.biff==8,p,g="",y=[],v=lr(l["!ref"]||"A1"),S=f?65536:16384;if(v.e.c>255||v.e.r>=S){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,S-1)}$e(n,2057,Tx(r,16,t)),$e(n,13,da(1)),$e(n,12,da(100)),$e(n,15,Sn(!0)),$e(n,17,Sn(!1)),$e(n,16,$i(.001)),$e(n,95,Sn(!0)),$e(n,42,Sn(!1)),$e(n,43,Sn(!1)),$e(n,130,da(1)),$e(n,128,E7()),$e(n,131,Sn(!1)),$e(n,132,Sn(!1)),f&&O9(n,l["!cols"]),$e(n,512,T7(v,t)),f&&(l["!links"]=[]);for(var N=v.s.r;N<=v.e.r;++N){g=cn(N);for(var w=v.s.c;w<=v.e.c;++w){N===v.s.r&&(y[w]=yn(w)),p=y[w]+g;var E=m?(l[N]||[])[w]:l[p];E&&(R9(n,E,N,w,t),f&&E.l&&l["!links"].push([p,E.l]))}}var C=h.CodeName||h.name||s;return f&&$e(n,574,v7((u.Views||[])[0])),f&&(l["!merges"]||[]).length&&$e(n,229,D7(l["!merges"])),f&&k9(n,l),$e(n,442,C3(C)),f&&j9(n,l),$e(n,10),n.end()}function F9(e,t,r){var n=Ln(),s=(e||{}).Workbook||{},l=s.Sheets||[],u=s.WBProps||{},h=r.biff==8,m=r.biff==5;if($e(n,2057,Tx(e,5,r)),r.bookType=="xla"&&$e(n,135),$e(n,225,h?da(1200):null),$e(n,193,i7(2)),m&&$e(n,191),m&&$e(n,192),$e(n,226),$e(n,92,p7("SheetJS",r)),$e(n,66,da(h?1200:1252)),h&&$e(n,353,da(0)),h&&$e(n,448),$e(n,317,L7(e.SheetNames.length)),h&&e.vbaraw&&$e(n,211),h&&e.vbaraw){var f=u.CodeName||"ThisWorkbook";$e(n,442,C3(f))}$e(n,156,da(17)),$e(n,25,Sn(!1)),$e(n,18,Sn(!1)),$e(n,19,da(0)),h&&$e(n,431,Sn(!1)),h&&$e(n,444,da(0)),$e(n,61,y7()),$e(n,64,Sn(!1)),$e(n,141,da(0)),$e(n,34,Sn(IP(e)=="true")),$e(n,14,Sn(!0)),h&&$e(n,439,Sn(!1)),$e(n,218,da(0)),C9(n,e,r),A9(n,e.SSF,r),D9(n,r),h&&$e(n,352,Sn(!1));var p=n.end(),g=Ln();h&&$e(g,140,R7()),h&&r.Strings&&w9(g,252,g7(r.Strings)),$e(g,10);var y=g.end(),v=Ln(),S=0,N=0;for(N=0;N<e.SheetNames.length;++N)S+=(h?12:11)+(h?2:1)*e.SheetNames[N].length;var w=p.length+S+y.length;for(N=0;N<e.SheetNames.length;++N){var E=l[N]||{};$e(v,133,x7({pos:w,hs:E.Hidden||0,dt:0,name:e.SheetNames[N]},r)),w+=t[N].length}var C=v.end();if(S!=C.length)throw new Error("BS8 "+S+" != "+C.length);var T=[];return p.length&&T.push(p),C.length&&T.push(C),y.length&&T.push(y),on(T)}function L9(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Bn(Nr)),e&&e.SSF&&(Gf(),Yf(e.SSF),r.revssf=qf(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Dx(r),r.cellXfs=[],hi(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=M9(s,r,e);return n.unshift(F9(e,n,r)),on(n)}function eN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Zn(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var l=t||{};switch(l.biff||2){case 8:case 5:return L9(e,t);case 4:case 3:case 2:return _9(e,t)}throw new Error("invalid type "+l.bookType+" for BIFF")}function P9(e,t,r,n){for(var s=e["!merges"]||[],l=[],u=t.s.c;u<=t.e.c;++u){for(var h=0,m=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>u)&&!(s[f].e.r<r||s[f].e.c<u)){if(s[f].s.r<r||s[f].s.c<u){h=-1;break}h=s[f].e.r-s[f].s.r+1,m=s[f].e.c-s[f].s.c+1;break}if(!(h<0)){var p=Kt({r,c:u}),g=n.dense?(e[r]||[])[u]:e[p],y=g&&g.v!=null&&(g.h||mR(g.w||(Ss(g),g.w)||""))||"",v={};h>1&&(v.rowspan=h),m>1&&(v.colspan=m),n.editable?y='<span contenteditable="true">'+y+"</span>":g&&(v["data-t"]=g&&g.t||"z",g.v!=null&&(v["data-v"]=g.v),g.z!=null&&(v["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+g.l.Target+'">'+y+"</a>")),v.id=(n.id||"sjs")+"-"+p,l.push(qe("td",y,v))}}var S="<tr>";return S+l.join("")+"</tr>"}var B9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',U9="</body></html>";function I9(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function tN(e,t){var r=t||{},n=r.header!=null?r.header:B9,s=r.footer!=null?r.footer:U9,l=[n],u=Zn(e["!ref"]);r.dense=Array.isArray(e),l.push(I9(e,u,r));for(var h=u.s.r;h<=u.e.r;++h)l.push(P9(e,u,h,r));return l.push("</table>"+s),l.join("")}function rN(e,t,r){var n=r||{},s=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var u=typeof n.origin=="string"?Xr(n.origin):n.origin;s=u.r,l=u.c}var h=t.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,h.length),f={s:{r:0,c:0},e:{r:s,c:l}};if(e["!ref"]){var p=Zn(e["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),s==-1&&(f.e.r=s=p.e.r+1)}var g=[],y=0,v=e["!rows"]||(e["!rows"]=[]),S=0,N=0,w=0,E=0,C=0,T=0;for(e["!cols"]||(e["!cols"]=[]);S<h.length&&N<m;++S){var O=h[S];if(Vb(O)){if(n.display)continue;v[N]={hidden:!0}}var j=O.children;for(w=E=0;w<j.length;++w){var q=j[w];if(!(n.display&&Vb(q))){var D=q.hasAttribute("data-v")?q.getAttribute("data-v"):q.hasAttribute("v")?q.getAttribute("v"):yR(q.innerHTML),U=q.getAttribute("data-z")||q.getAttribute("z");for(y=0;y<g.length;++y){var K=g[y];K.s.c==E+l&&K.s.r<N+s&&N+s<=K.e.r&&(E=K.e.c+1-l,y=-1)}T=+q.getAttribute("colspan")||1,((C=+q.getAttribute("rowspan")||1)>1||T>1)&&g.push({s:{r:N+s,c:E+l},e:{r:N+s+(C||1)-1,c:E+l+(T||1)-1}});var ie={t:"s",v:D},te=q.getAttribute("data-t")||q.getAttribute("t")||"";D!=null&&(D.length==0?ie.t=te||"z":n.raw||D.trim().length==0||te=="s"||(D==="TRUE"?ie={t:"b",v:!0}:D==="FALSE"?ie={t:"b",v:!1}:isNaN(ms(D))?isNaN($c(D).getDate())||(ie={t:"d",v:En(D)},n.cellDates||(ie={t:"n",v:Pn(ie.v)}),ie.z=n.dateNF||Nr[14]):ie={t:"n",v:ms(D)})),ie.z===void 0&&U!=null&&(ie.z=U);var G="",de=q.getElementsByTagName("A");if(de&&de.length)for(var J=0;J<de.length&&!(de[J].hasAttribute("href")&&(G=de[J].getAttribute("href"),G.charAt(0)!="#"));++J);G&&G.charAt(0)!="#"&&(ie.l={Target:G}),n.dense?(e[N+s]||(e[N+s]=[]),e[N+s][E+l]=ie):e[Kt({c:E+l,r:N+s})]=ie,f.e.c<E+l&&(f.e.c=E+l),E+=T}}++N}return g.length&&(e["!merges"]=(e["!merges"]||[]).concat(g)),f.e.r=Math.max(f.e.r,N-1+s),e["!ref"]=Mr(f),N>=m&&(e["!fullref"]=Mr((f.e.r=h.length-S+N-1+s,f))),e}function nN(e,t){var r=t||{},n=r.dense?[]:{};return rN(n,e,t)}function z9(e,t){return Qi(nN(e,t),t)}function Vb(e){var t="",r=V9(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function V9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var H9=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Xc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Fr+t}}(),Hb=function(){var e=function(l){return Xt(l).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(l,u,h){var m=[];m.push('      <table:table table:name="'+Xt(u.SheetNames[h])+`" table:style-name="ta1">
`);var f=0,p=0,g=Zn(l["!ref"]||"A1"),y=l["!merges"]||[],v=0,S=Array.isArray(l);if(l["!cols"])for(p=0;p<=g.e.c;++p)m.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var N="",w=l["!rows"]||[];for(f=0;f<g.s.r;++f)N=w[f]?' table:style-name="ro'+w[f].ods+'"':"",m.push("        <table:table-row"+N+`></table:table-row>
`);for(;f<=g.e.r;++f){for(N=w[f]?' table:style-name="ro'+w[f].ods+'"':"",m.push("        <table:table-row"+N+`>
`),p=0;p<g.s.c;++p)m.push(t);for(;p<=g.e.c;++p){var E=!1,C={},T="";for(v=0;v!=y.length;++v)if(!(y[v].s.c>p)&&!(y[v].s.r>f)&&!(y[v].e.c<p)&&!(y[v].e.r<f)){(y[v].s.c!=p||y[v].s.r!=f)&&(E=!0),C["table:number-columns-spanned"]=y[v].e.c-y[v].s.c+1,C["table:number-rows-spanned"]=y[v].e.r-y[v].s.r+1;break}if(E){m.push(r);continue}var O=Kt({r:f,c:p}),j=S?(l[f]||[])[p]:l[O];if(j&&j.f&&(C["table:formula"]=Xt(cL(j.f)),j.F&&j.F.slice(0,O.length)==O)){var q=Zn(j.F);C["table:number-matrix-columns-spanned"]=q.e.c-q.s.c+1,C["table:number-matrix-rows-spanned"]=q.e.r-q.s.r+1}if(!j){m.push(t);continue}switch(j.t){case"b":T=j.v?"TRUE":"FALSE",C["office:value-type"]="boolean",C["office:boolean-value"]=j.v?"true":"false";break;case"n":T=j.w||String(j.v||0),C["office:value-type"]="float",C["office:value"]=j.v||0;break;case"s":case"str":T=j.v==null?"":j.v,C["office:value-type"]="string";break;case"d":T=j.w||En(j.v).toISOString(),C["office:value-type"]="date",C["office:date-value"]=En(j.v).toISOString(),C["table:style-name"]="ce1";break;default:m.push(t);continue}var D=e(T);if(j.l&&j.l.Target){var U=j.l.Target;U=U.charAt(0)=="#"?"#"+uL(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),D=qe("text:a",D,{"xlink:href":U.replace(/&/g,"&amp;")})}m.push("          "+qe("table:table-cell",qe("text:p",D,{}),C)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},s=function(l,u){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var h=0;u.SheetNames.map(function(f){return u.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var g=f["!cols"][p];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Ex(g),g.ods=h;var y=f["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),l.push(`  </style:style>
`),++h}}});var m=0;u.SheetNames.map(function(f){return u.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=m;var g=f["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),l.push(`  </style:style>
`),++m}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(u,h){var m=[Fr],f=Xc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Xc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(m.push("<office:document"+f+p+`>
`),m.push(y3().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+f+`>
`),s(m,u),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var g=0;g!=u.SheetNames.length;++g)m.push(n(u.Sheets[u.SheetNames[g]],u,g));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),h.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function aN(e,t){if(t.bookType=="fods")return Hb(e,t);var r=mx(),n="",s=[],l=[];return n="mimetype",Tt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Tt(r,n,Hb(e,t)),s.push([n,"text/xml"]),l.push([n,"ContentFile"]),n="styles.xml",Tt(r,n,H9(e,t)),s.push([n,"text/xml"]),l.push([n,"StylesFile"]),n="meta.xml",Tt(r,n,Fr+y3()),s.push([n,"text/xml"]),l.push([n,"MetadataFile"]),n="manifest.rdf",Tt(r,n,t7(l)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Tt(r,n,JR(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Nf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Y9(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ca(Wc(e))}function G9(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function li(e){var t=e.reduce(function(s,l){return s+l.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function q9(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var l=0;s>=1;++l,s/=256)e[t+l]=s&255;e[t+15]|=r>=0?0:128}function Kc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function qt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function el(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Vr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Kc(e,r),l=s&7;s=Math.floor(s/8);var u=0,h;if(s==0)break;switch(l){case 0:{for(var m=r[0];e[r[0]++]>=128;);h=e.slice(m,r[0])}break;case 5:u=4,h=e.slice(r[0],r[0]+u),r[0]+=u;break;case 1:u=8,h=e.slice(r[0],r[0]+u),r[0]+=u;break;case 2:u=Kc(e,r),h=e.slice(r[0],r[0]+u),r[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(n))}var f={data:h,type:l};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function nn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(qt(n*8+s.type)),s.type==2&&t.push(qt(s.data.length)),t.push(s.data))})}),li(t)}function Na(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Kc(e,n),l=Vr(e.slice(n[0],n[0]+s));n[0]+=s;var u={id:el(l[1][0].data),messages:[]};l[2].forEach(function(h){var m=Vr(h.data),f=el(m[3][0].data);u.messages.push({meta:m,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=l[3])!=null&&t[0]&&(u.merge=el(l[3][0].data)>>>0>0),r.push(u)}return r}function zo(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:qt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:qt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(u){s.push(u.data),u.meta[3]=[{type:0,data:qt(u.data.length)}],n[2].push({data:nn(u.meta),type:2})});var l=nn(n);t.push(qt(l.length)),t.push(l),s.forEach(function(u){return t.push(u)})}),li(t)}function $9(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Kc(t,r),s=[];r[0]<t.length;){var l=t[r[0]]&3;if(l==0){var u=t[r[0]++]>>2;if(u<60)++u;else{var h=u-59;u=t[r[0]],h>1&&(u|=t[r[0]+1]<<8),h>2&&(u|=t[r[0]+2]<<16),h>3&&(u|=t[r[0]+3]<<24),u>>>=0,u++,r[0]+=h}s.push(t.slice(r[0],r[0]+u)),r[0]+=u;continue}else{var m=0,f=0;if(l==1?(f=(t[r[0]]>>2&7)+4,m=(t[r[0]++]&224)<<3,m|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,l==2?(m=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(m=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[li(s)],m==0)throw new Error("Invalid offset 0");if(m>s[0].length)throw new Error("Invalid offset beyond length");if(f>=m)for(s.push(s[0].slice(-m)),f-=m;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-m,-m+f))}}var p=li(s);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Ta(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push($9(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return li(t)}function Vo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var l=qt(n),u=l.length;t.push(l),n<=60?(u++,t.push(new Uint8Array([n-1<<2]))):n<=256?(u+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(u+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(u+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(u+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),u+=n,s[0]=0,s[1]=u&255,s[2]=u>>8&255,s[3]=u>>16&255,r+=n}return li(t)}function Cm(e,t){var r=new Uint8Array(32),n=Nf(r),s=12,l=0;switch(r[0]=5,e.t){case"n":r[1]=2,q9(r,s,e.v),l|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),l|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,l,!0),r.slice(0,s)}function Am(e,t){var r=new Uint8Array(32),n=Nf(r),s=12,l=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),l|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),l|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,l,!0),r.slice(0,s)}function Ks(e){var t=Vr(e);return Kc(t[1][0].data)}function W9(e,t,r){var n,s,l,u;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var h=((u=(l=e[8])==null?void 0:l[0])==null?void 0:u.data)&&el(e[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var m=0,f=Nf(e[7][0].data),p=0,g=[],y=Nf(e[4][0].data),v=0,S=[],N=0;N<t.length;++N){if(t[N]==null){f.setUint16(N*2,65535,!0),y.setUint16(N*2,65535);continue}f.setUint16(N*2,p,!0),y.setUint16(N*2,v,!0);var w,E;switch(typeof t[N]){case"string":w=Cm({t:"s",v:t[N]},r),E=Am({t:"s",v:t[N]},r);break;case"number":w=Cm({t:"n",v:t[N]},r),E=Am({t:"n",v:t[N]},r);break;case"boolean":w=Cm({t:"b",v:t[N]},r),E=Am({t:"b",v:t[N]},r);break;default:throw new Error("Unsupported value "+t[N])}g.push(w),p+=w.length,S.push(E),v+=E.length,++m}for(e[2][0].data=qt(m);N<e[7][0].data.length/2;++N)f.setUint16(N*2,65535,!0),y.setUint16(N*2,65535,!0);return e[6][0].data=li(g),e[3][0].data=li(S),m}function X9(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Zn(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Mr(n)));var l=Tf(r,{range:n,header:1}),u=["~Sh33tJ5~"];l.forEach(function(H){return H.forEach(function(z){typeof z=="string"&&u.push(z)})});var h={},m=[],f=er.read(t.numbers,{type:"base64"});f.FileIndex.map(function(H,z){return[H,f.FullPaths[z]]}).forEach(function(H){var z=H[0],_=H[1];if(z.type==2&&z.name.match(/\.iwa/)){var ce=z.content,re=Ta(ce),me=Na(re);me.forEach(function(je){m.push(je.id),h[je.id]={deps:[],location:_,type:el(je.messages[0].meta[1][0].data)}})}}),m.sort(function(H,z){return H-z});var p=m.filter(function(H){return H>1}).map(function(H){return[H,qt(H)]});f.FileIndex.map(function(H,z){return[H,f.FullPaths[z]]}).forEach(function(H){var z=H[0];if(H[1],!!z.name.match(/\.iwa/)){var _=Na(Ta(z.content));_.forEach(function(ce){ce.messages.forEach(function(re){p.forEach(function(me){ce.messages.some(function(je){return el(je.meta[1][0].data)!=11006&&G9(je.data,me[1])})&&h[me[0]].deps.push(ce.id)})})})}});for(var g=er.find(f,h[1].location),y=Na(Ta(g.content)),v,S=0;S<y.length;++S){var N=y[S];N.id==1&&(v=N)}var w=Ks(Vr(v.messages[0].data)[1][0].data);for(g=er.find(f,h[w].location),y=Na(Ta(g.content)),S=0;S<y.length;++S)N=y[S],N.id==w&&(v=N);for(w=Ks(Vr(v.messages[0].data)[2][0].data),g=er.find(f,h[w].location),y=Na(Ta(g.content)),S=0;S<y.length;++S)N=y[S],N.id==w&&(v=N);for(w=Ks(Vr(v.messages[0].data)[2][0].data),g=er.find(f,h[w].location),y=Na(Ta(g.content)),S=0;S<y.length;++S)N=y[S],N.id==w&&(v=N);var E=Vr(v.messages[0].data);{E[6][0].data=qt(n.e.r+1),E[7][0].data=qt(n.e.c+1);var C=Ks(E[46][0].data),T=er.find(f,h[C].location),O=Na(Ta(T.content));{for(var j=0;j<O.length&&O[j].id!=C;++j);if(O[j].id!=C)throw"Bad ColumnRowUIDMapArchive";var q=Vr(O[j].messages[0].data);q[1]=[],q[2]=[],q[3]=[];for(var D=0;D<=n.e.c;++D){var U=[];U[1]=U[2]=[{type:0,data:qt(D+420690)}],q[1].push({type:2,data:nn(U)}),q[2].push({type:0,data:qt(D)}),q[3].push({type:0,data:qt(D)})}q[4]=[],q[5]=[],q[6]=[];for(var K=0;K<=n.e.r;++K)U=[],U[1]=U[2]=[{type:0,data:qt(K+726270)}],q[4].push({type:2,data:nn(U)}),q[5].push({type:0,data:qt(K)}),q[6].push({type:0,data:qt(K)});O[j].messages[0].data=nn(q)}T.content=Vo(zo(O)),T.size=T.content.length,delete E[46];var ie=Vr(E[4][0].data);{ie[7][0].data=qt(n.e.r+1);var te=Vr(ie[1][0].data),G=Ks(te[2][0].data);T=er.find(f,h[G].location),O=Na(Ta(T.content));{if(O[0].id!=G)throw"Bad HeaderStorageBucket";var de=Vr(O[0].messages[0].data);for(K=0;K<l.length;++K){var J=Vr(de[2][0].data);J[1][0].data=qt(K),J[4][0].data=qt(l[K].length),de[2][K]={type:de[2][0].type,data:nn(J)}}O[0].messages[0].data=nn(de)}T.content=Vo(zo(O)),T.size=T.content.length;var W=Ks(ie[2][0].data);T=er.find(f,h[W].location),O=Na(Ta(T.content));{if(O[0].id!=W)throw"Bad HeaderStorageBucket";for(de=Vr(O[0].messages[0].data),D=0;D<=n.e.c;++D)J=Vr(de[2][0].data),J[1][0].data=qt(D),J[4][0].data=qt(n.e.r+1),de[2][D]={type:de[2][0].type,data:nn(J)};O[0].messages[0].data=nn(de)}T.content=Vo(zo(O)),T.size=T.content.length;var F=Ks(ie[4][0].data);(function(){for(var H=er.find(f,h[F].location),z=Na(Ta(H.content)),_,ce=0;ce<z.length;++ce){var re=z[ce];re.id==F&&(_=re)}var me=Vr(_.messages[0].data);{me[3]=[];var je=[];u.forEach(function(Ge,Ve){je[1]=[{type:0,data:qt(Ve)}],je[2]=[{type:0,data:qt(1)}],je[3]=[{type:2,data:Y9(Ge)}],me[3].push({type:2,data:nn(je)})})}_.messages[0].data=nn(me);var Re=zo(z),We=Vo(Re);H.content=We,H.size=H.content.length})();var Z=Vr(ie[3][0].data);{var oe=Z[1][0];delete Z[2];var le=Vr(oe.data);{var R=Ks(le[2][0].data);(function(){for(var H=er.find(f,h[R].location),z=Na(Ta(H.content)),_,ce=0;ce<z.length;++ce){var re=z[ce];re.id==R&&(_=re)}var me=Vr(_.messages[0].data);{delete me[6],delete Z[7];var je=new Uint8Array(me[5][0].data);me[5]=[];for(var Re=0,We=0;We<=n.e.r;++We){var Ge=Vr(je);Re+=W9(Ge,l[We],u),Ge[1][0].data=qt(We),me[5].push({data:nn(Ge),type:2})}me[1]=[{type:0,data:qt(n.e.c+1)}],me[2]=[{type:0,data:qt(n.e.r+1)}],me[3]=[{type:0,data:qt(Re)}],me[4]=[{type:0,data:qt(n.e.r+1)}]}_.messages[0].data=nn(me);var Ve=zo(z),He=Vo(Ve);H.content=He,H.size=H.content.length})()}oe.data=nn(le)}ie[3][0].data=nn(Z)}E[4][0].data=nn(ie)}v.messages[0].data=nn(E);var ne=zo(y),P=Vo(ne);return g.content=P,g.size=g.content.length,f}function K9(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Dx(e){K9([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Q9(e,t){return t.bookType=="ods"?aN(e,t):t.bookType=="numbers"?X9(e,t):t.bookType=="xlsb"?Z9(e,t):J9(e,t)}function Z9(e,t){Ko=1024,e&&!e.SSF&&(e.SSF=Bn(Nr)),e&&e.SSF&&(Gf(),Yf(e.SSF),t.revssf=qf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=I3.indexOf(t.bookType)>-1,s=p3();Dx(t=t||{});var l=mx(),u="",h=0;if(t.cellXfs=[],hi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",Tt(l,u,v3(e.Props,t)),s.coreprops.push(u),Wt(t.rels,2,u,Mt.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&m.push(e.SheetNames[f]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,Tt(l,u,w3(e.Props)),s.extprops.push(u),Wt(t.rels,3,u,Mt.EXT_PROPS),e.Custprops!==e.Props&&un(e.Custprops||{}).length>0&&(u="docProps/custom.xml",Tt(l,u,S3(e.Custprops)),s.custprops.push(u),Wt(t.rels,4,u,Mt.CUST_PROPS)),h=1;h<=e.SheetNames.length;++h){var p={"!id":{}},g=e.Sheets[e.SheetNames[h-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:u="xl/worksheets/sheet"+h+"."+r,Tt(l,u,t9(h-1,u,t,e,p)),s.sheets.push(u),Wt(t.wbrels,-1,"worksheets/sheet"+h+"."+r,Mt.WS[0])}if(g){var v=g["!comments"],S=!1,N="";v&&v.length>0&&(N="xl/comments"+h+"."+r,Tt(l,N,a9(v,N)),s.comments.push(N),Wt(p,-1,"../comments"+h+"."+r,Mt.CMNT),S=!0),g["!legacy"]&&S&&Tt(l,"xl/drawings/vmlDrawing"+h+".vml",B3(h,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&Tt(l,g3(u),Zo(p))}return t.Strings!=null&&t.Strings.length>0&&(u="xl/sharedStrings."+r,Tt(l,u,n9(t.Strings,u,t)),s.strs.push(u),Wt(t.wbrels,-1,"sharedStrings."+r,Mt.SST)),u="xl/workbook."+r,Tt(l,u,e9(e,u)),s.workbooks.push(u),Wt(t.rels,1,u,Mt.WB),u="xl/theme/theme1.xml",Tt(l,u,L3(e.Themes,t)),s.themes.push(u),Wt(t.wbrels,-1,"theme/theme1.xml",Mt.THEME),u="xl/styles."+r,Tt(l,u,r9(e,u,t)),s.styles.push(u),Wt(t.wbrels,-1,"styles."+r,Mt.STY),e.vbaraw&&n&&(u="xl/vbaProject.bin",Tt(l,u,e.vbaraw),s.vba.push(u),Wt(t.wbrels,-1,"vbaProject.bin",Mt.VBA)),u="xl/metadata."+r,Tt(l,u,s9(u)),s.metadata.push(u),Wt(t.wbrels,-1,"metadata."+r,Mt.XLMETA),Tt(l,"[Content_Types].xml",x3(s,t)),Tt(l,"_rels/.rels",Zo(t.rels)),Tt(l,"xl/_rels/workbook."+r+".rels",Zo(t.wbrels)),delete t.revssf,delete t.ssf,l}function J9(e,t){Ko=1024,e&&!e.SSF&&(e.SSF=Bn(Nr)),e&&e.SSF&&(Gf(),Yf(e.SSF),t.revssf=qf(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=I3.indexOf(t.bookType)>-1,s=p3();Dx(t=t||{});var l=mx(),u="",h=0;if(t.cellXfs=[],hi(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),u="docProps/core.xml",Tt(l,u,v3(e.Props,t)),s.coreprops.push(u),Wt(t.rels,2,u,Mt.CORE_PROPS),u="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&m.push(e.SheetNames[f]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,Tt(l,u,w3(e.Props)),s.extprops.push(u),Wt(t.rels,3,u,Mt.EXT_PROPS),e.Custprops!==e.Props&&un(e.Custprops||{}).length>0&&(u="docProps/custom.xml",Tt(l,u,S3(e.Custprops)),s.custprops.push(u),Wt(t.rels,4,u,Mt.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,h=1;h<=e.SheetNames.length;++h){var g={"!id":{}},y=e.Sheets[e.SheetNames[h-1]],v=(y||{})["!type"]||"sheet";switch(v){case"chart":default:u="xl/worksheets/sheet"+h+"."+r,Tt(l,u,X3(h-1,t,e,g)),s.sheets.push(u),Wt(t.wbrels,-1,"worksheets/sheet"+h+"."+r,Mt.WS[0])}if(y){var S=y["!comments"],N=!1,w="";if(S&&S.length>0){var E=!1;S.forEach(function(C){C[1].forEach(function(T){T.T==!0&&(E=!0)})}),E&&(w="xl/threadedComments/threadedComment"+h+"."+r,Tt(l,w,DM(S,p,t)),s.threadedcomments.push(w),Wt(g,-1,"../threadedComments/threadedComment"+h+"."+r,Mt.TCMNT)),w="xl/comments"+h+"."+r,Tt(l,w,U3(S)),s.comments.push(w),Wt(g,-1,"../comments"+h+"."+r,Mt.CMNT),N=!0}y["!legacy"]&&N&&Tt(l,"xl/drawings/vmlDrawing"+h+".vml",B3(h,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&Tt(l,g3(u),Zo(g))}return t.Strings!=null&&t.Strings.length>0&&(u="xl/sharedStrings."+r,Tt(l,u,D3(t.Strings,t)),s.strs.push(u),Wt(t.wbrels,-1,"sharedStrings."+r,Mt.SST)),u="xl/workbook."+r,Tt(l,u,Z3(e)),s.workbooks.push(u),Wt(t.rels,1,u,Mt.WB),u="xl/theme/theme1.xml",Tt(l,u,L3(e.Themes,t)),s.themes.push(u),Wt(t.wbrels,-1,"theme/theme1.xml",Mt.THEME),u="xl/styles."+r,Tt(l,u,M3(e,t)),s.styles.push(u),Wt(t.wbrels,-1,"styles."+r,Mt.STY),e.vbaraw&&n&&(u="xl/vbaProject.bin",Tt(l,u,e.vbaraw),s.vba.push(u),Wt(t.wbrels,-1,"vbaProject.bin",Mt.VBA)),u="xl/metadata."+r,Tt(l,u,P3()),s.metadata.push(u),Wt(t.wbrels,-1,"metadata."+r,Mt.XLMETA),p.length>1&&(u="xl/persons/person.xml",Tt(l,u,kM(p)),s.people.push(u),Wt(t.wbrels,-1,"persons/person.xml",Mt.PEOPLE)),Tt(l,"[Content_Types].xml",x3(s,t)),Tt(l,"_rels/.rels",Zo(t.rels)),Tt(l,"xl/_rels/workbook."+r+".rels",Zo(t.wbrels)),delete t.revssf,delete t.ssf,l}function eB(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ws(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return fu(t.file,er.write(e,{type:Bt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return er.write(e,t)}function tB(e,t){var r=Bn(t||{}),n=Q9(e,r);return rB(n,r)}function rB(e,t){var r={},n=Bt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?er.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Hf(s))}return t.password&&typeof encrypt_agile<"u"?sN(encrypt_agile(s,t.password),t):t.type==="file"?fu(t.file,s):t.type=="string"?jc(s):s}function nB(e,t){var r=t||{},n=v9(e,r);return sN(n,r)}function Va(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return qc(Wc(n));case"binary":return Wc(n);case"string":return e;case"file":return fu(t.file,n,"utf8");case"buffer":return Bt?Ts(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Va(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function aB(e,t){switch(t.type){case"base64":return qc(e);case"binary":return e;case"string":return e;case"file":return fu(t.file,e,"binary");case"buffer":return Bt?Ts(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Pd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?qc(r):t.type=="string"?jc(r):r;case"file":return fu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function iN(e,t){OO(),HP(e);var r=Bn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=iN(e,r);return r.type="array",Hf(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Va(g9(e,r),r);case"slk":case"sylk":return Va(I7.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Va(tN(e.Sheets[e.SheetNames[s]],r),r);case"txt":return aB(oN(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Va(kx(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Va(z7.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Pd(U7.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Va(V7.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Va(X7.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Va(j3.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Va(aN(e,r),r);case"wk1":return Pd(Lb.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Pd(Lb.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Pd(eN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),nB(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return tB(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function sB(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function iB(e,t,r){var n={};return n.type="file",n.file=t,sB(n),iN(e,n)}function oB(e,t,r,n,s,l,u,h){var m=cn(r),f=h.defval,p=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),g=!0,y=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!u||e[r])for(var v=t.s.c;v<=t.e.c;++v){var S=u?e[r][v]:e[n[v]+m];if(S===void 0||S.t===void 0){if(f===void 0)continue;l[v]!=null&&(y[l[v]]=f);continue}var N=S.v;switch(S.t){case"z":if(N==null)break;continue;case"e":N=N==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(l[v]!=null){if(N==null)if(S.t=="e"&&N===null)y[l[v]]=null;else if(f!==void 0)y[l[v]]=f;else if(p&&N===null)y[l[v]]=null;else continue;else y[l[v]]=p&&(S.t!=="n"||S.t==="n"&&h.rawNumbers!==!1)?N:Ss(S,N,h);N!=null&&(g=!1)}}return{row:y,isempty:g}}function Tf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,l=[],u=0,h="",m={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},p=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof p){case"string":m=lr(p);break;case"number":m=lr(e["!ref"]),m.s.r=p;break;default:m=p}n>0&&(s=0);var g=cn(m.s.r),y=[],v=[],S=0,N=0,w=Array.isArray(e),E=m.s.r,C=0,T={};w&&!e[E]&&(e[E]=[]);var O=f.skipHidden&&e["!cols"]||[],j=f.skipHidden&&e["!rows"]||[];for(C=m.s.c;C<=m.e.c;++C)if(!(O[C]||{}).hidden)switch(y[C]=yn(C),r=w?e[E][C]:e[y[C]+g],n){case 1:l[C]=C-m.s.c;break;case 2:l[C]=y[C];break;case 3:l[C]=f.header[C-m.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),h=u=Ss(r,null,f),N=T[u]||0,!N)T[u]=1;else{do h=u+"_"+N++;while(T[h]);T[u]=N,T[h]=1}l[C]=h}for(E=m.s.r+s;E<=m.e.r;++E)if(!(j[E]||{}).hidden){var q=oB(e,m,E,y,n,l,w,f);(q.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[S++]=q.row)}return v.length=S,v}var Yb=/"/g;function lB(e,t,r,n,s,l,u,h){for(var m=!0,f=[],p="",g=cn(r),y=t.s.c;y<=t.e.c;++y)if(n[y]){var v=h.dense?(e[r]||[])[y]:e[n[y]+g];if(v==null)p="";else if(v.v!=null){m=!1,p=""+(h.rawNumbers&&v.t=="n"?v.v:Ss(v,null,h));for(var S=0,N=0;S!==p.length;++S)if((N=p.charCodeAt(S))===s||N===l||N===34||h.forceQuotes){p='"'+p.replace(Yb,'""')+'"';break}p=="ID"&&(p='"ID"')}else v.f!=null&&!v.F?(m=!1,p="="+v.f,p.indexOf(",")>=0&&(p='"'+p.replace(Yb,'""')+'"')):p="";f.push(p)}return h.blankrows===!1&&m?null:f.join(u)}function kx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=lr(e["!ref"]),l=n.FS!==void 0?n.FS:",",u=l.charCodeAt(0),h=n.RS!==void 0?n.RS:`
`,m=h.charCodeAt(0),f=new RegExp((l=="|"?"\\|":l)+"+$"),p="",g=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],S=s.s.c;S<=s.e.c;++S)(y[S]||{}).hidden||(g[S]=yn(S));for(var N=0,w=s.s.r;w<=s.e.r;++w)(v[w]||{}).hidden||(p=lB(e,s,w,g,u,m,l,n),p!=null&&(n.strip&&(p=p.replace(f,"")),(p||n.blankrows!==!1)&&r.push((N++?h:"")+p)));return delete n.dense,r.join("")}function oN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=kx(e,t);return r}function cB(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=lr(e["!ref"]),l="",u=[],h,m=[],f=Array.isArray(e);for(h=s.s.c;h<=s.e.c;++h)u[h]=yn(h);for(var p=s.s.r;p<=s.e.r;++p)for(l=cn(p),h=s.s.c;h<=s.e.c;++h)if(t=u[h]+l,r=f?(e[p]||[])[h]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}m[m.length]=t+"="+n}return m}function lN(e,t,r){var n=r||{},s=+!n.skipHeader,l=e||{},u=0,h=0;if(l&&n.origin!=null)if(typeof n.origin=="number")u=n.origin;else{var m=typeof n.origin=="string"?Xr(n.origin):n.origin;u=m.r,h=m.c}var f,p={s:{c:0,r:0},e:{c:h,r:u+t.length-1+s}};if(l["!ref"]){var g=lr(l["!ref"]);p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),u==-1&&(u=g.e.r+1,p.e.r=u+t.length-1+s)}else u==-1&&(u=0,p.e.r=t.length-1+s);var y=n.header||[],v=0;t.forEach(function(N,w){un(N).forEach(function(E){(v=y.indexOf(E))==-1&&(y[v=y.length]=E);var C=N[E],T="z",O="",j=Kt({c:h+v,r:u+w+s});f=Qc(l,j),C&&typeof C=="object"&&!(C instanceof Date)?l[j]=C:(typeof C=="number"?T="n":typeof C=="boolean"?T="b":typeof C=="string"?T="s":C instanceof Date?(T="d",n.cellDates||(T="n",C=Pn(C)),O=n.dateNF||Nr[14]):C===null&&n.nullError&&(T="e",C=0),f?(f.t=T,f.v=C,delete f.w,delete f.R,O&&(f.z=O)):l[j]=f={t:T,v:C},O&&(f.z=O))})}),p.e.c=Math.max(p.e.c,h+y.length-1);var S=cn(u);if(s)for(v=0;v<y.length;++v)l[yn(v+h)+S]={t:"s",v:y[v]};return l["!ref"]=Mr(p),l}function uB(e,t){return lN(null,e,t)}function Qc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Xr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Qc(e,Kt(t)):Qc(e,Kt({r:t,c:r||0}))}function dB(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function fB(){return{SheetNames:[],Sheets:{}}}function hB(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var l=r.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var u=l&&l[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=u+s)!=-1;++s);}if(Q3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function mB(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=dB(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function pB(e,t){return e.z=t,e}function cN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function xB(e,t,r){return cN(e,"#"+t,r)}function gB(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yB(e,t,r,n){for(var s=typeof t!="string"?t:lr(t),l=typeof t=="string"?t:Mr(t),u=s.s.r;u<=s.e.r;++u)for(var h=s.s.c;h<=s.e.c;++h){var m=Qc(e,u,h);m.t="n",m.F=l,delete m.v,u==s.s.r&&h==s.s.c&&(m.f=r,n&&(m.D=!0))}return e}var jm={encode_col:yn,encode_row:cn,encode_cell:Kt,encode_range:Mr,decode_col:bx,decode_row:vx,split_cell:OR,decode_cell:Xr,decode_range:Zn,format_cell:Ss,sheet_add_aoa:c3,sheet_add_json:lN,sheet_add_dom:rN,aoa_to_sheet:fl,json_to_sheet:uB,table_to_sheet:nN,table_to_book:z9,sheet_to_csv:kx,sheet_to_txt:oN,sheet_to_json:Tf,sheet_to_html:tN,sheet_to_formulae:cB,sheet_to_row_object_array:Tf,sheet_get_cell:Qc,book_new:fB,book_append_sheet:hB,book_set_sheet_visibility:mB,cell_set_number_format:pB,cell_set_hyperlink:cN,cell_set_internal_link:xB,cell_add_comment:gB,sheet_set_array_formula:yB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const vB=()=>{const[e,t]=k.useState([]),[r,n]=k.useState([]),[s,l]=k.useState(!0),[u,h]=k.useState(null),[m,f]=k.useState([]),[p,g]=k.useState(null),[y,v]=k.useState({}),{user:S}=Tr(),[N,w]=k.useState(new Date().getMonth()+1),[E,C]=k.useState(new Date().getFullYear()),[T,O]=k.useState(!0),j=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],q=new Date().getFullYear(),D=Array.from({length:6},(le,R)=>q-R);k.useEffect(()=>{K(),de()},[]),k.useEffect(()=>{e.length>0&&U()},[e,N,E,T]);const U=()=>{if(T){const le=new Date().getMonth()+1,R=new Date().getFullYear(),ne=e.filter(P=>{if(!P.date&&!P.createdAt)return console.log("Sale has no date:",P),!1;const H=new Date(P.date||P.createdAt),z=H.getMonth()+1,_=H.getFullYear();return z===le&&_===R});console.log(`Filtered to current month: ${le}/${R}. Found ${ne.length} sales.`),n(ne)}else{const le=e.filter(R=>{if(!R.date&&!R.createdAt)return console.log("Sale has no date:",R),!1;const ne=new Date(R.date||R.createdAt),P=ne.getMonth()+1,H=ne.getFullYear();return console.log(`Sale date: ${ne.toISOString()}, Month: ${P}, Year: ${H}, Filter: ${N}/${E}`),P===N&&H===E});console.log(`Filtered to ${N}/${E}. Found ${le.length} sales.`),n(le)}},K=async()=>{var le;try{l(!0),h(null),console.log("Fetching lead sales for user:",S==null?void 0:S.fullName,S==null?void 0:S.role,S==null?void 0:S._id);const R=await Wn.getLeadSheet();R.data&&R.data.success?(console.log(`Lead sales data loaded: ${R.data.data.length} sales`),t(R.data.data),n(R.data.data),R.data.data.length===0?(console.log("No lead sales found. This could be because:"),console.log("1. No sales have been assigned to this lead person"),console.log("2. Sales were created without selecting this lead person")):console.log("Sample sale data:",R.data.data[0])):(console.error("Failed to load lead sales data:",R.data),h("Failed to load sales data: "+(((le=R.data)==null?void 0:le.message)||"Unknown error")))}catch(R){console.error("Error loading sales data:",R),R.response&&(console.error("Error details:",R.response.data),console.error("Error status:",R.response.status)),h("Failed to load sales data. Please try again.")}finally{l(!1)}},ie=le=>{w(parseInt(le.target.value)),O(!1)},te=le=>{C(parseInt(le.target.value)),O(!1)},G=()=>{const le=new Date;w(le.getMonth()+1),C(le.getFullYear()),O(!0)},de=async()=>{try{const le=await fr.getUsers("Sales Person");f(le.data.data||[])}catch(le){console.error("Error loading users:",le)}},J=le=>{g(le._id),v({DATE:le.date||new Date().toISOString(),NAME:le.customerName||"",COUNTRY:le.country||"",COURSE:le.course||"",CODE:le.countryCode||"+1",NUMBER:le.contactNumber||"","E-MAIL":le.email||"","PSUDO ID":le.pseudoId||"","SALE PERSON":le.salesPerson&&(le.salesPerson._id||le.salesPerson)||"","LEAD PERSON":le.leadPerson&&(le.leadPerson._id||le.leadPerson)||S.id||"",SOURSE:le.source||"","CLIENT REMARK":le.clientRemark||"",FEEDBACK:le.feedback||"",TOTAL_COST:le.totalCost||0,TOTAL_COST_CURRENCY:le.totalCostCurrency||"USD",TOKEN_AMOUNT:le.tokenAmount||0,TOKEN_AMOUNT_CURRENCY:le.tokenAmountCurrency||"USD"}),console.log("Edit data populated:",le)},W=le=>{const{name:R,value:ne}=le.target;v(P=>({...P,[R]:ne}))},F=async()=>{var le;try{console.log("Saving with data:",y);const R={date:y.DATE,customerName:y.NAME,country:y.COUNTRY,course:y.COURSE,countryCode:y.CODE,contactNumber:y.NUMBER,email:y["E-MAIL"],pseudoId:y["PSUDO ID"],salesPerson:y["SALE PERSON"],leadPerson:y["LEAD PERSON"],source:y.SOURSE,clientRemark:y["CLIENT REMARK"],feedback:y.FEEDBACK,totalCost:parseFloat(y.TOTAL_COST)||0,totalCostCurrency:y.TOTAL_COST_CURRENCY,tokenAmount:parseFloat(y.TOKEN_AMOUNT)||0,tokenAmountCurrency:y.TOKEN_AMOUNT_CURRENCY},ne=await Wn.update(p,R);ne.data&&ne.data.success?(console.log("Sale updated successfully:",ne.data),ze.success("Sale updated successfully")):(console.error("Failed to update sale:",ne.data),h("Failed to update sale: "+(((le=ne.data)==null?void 0:le.message)||"Unknown error"))),g(null),K()}catch(R){console.error("Error updating sale:",R),h("Failed to update sale. Please try again.")}},Z=()=>{g(null)},oe=()=>{const le=`Lead-Sales-Sheet-${new Date().toISOString().split("T")[0]}.xlsx`,R=r.map(H=>{var z,_,ce,re;return{DATE:new Date(H.date).toLocaleDateString(),NAME:H.customerName,COUNTRY:H.country,COURSE:H.course,CODE:H.countryCode||"",NUMBER:H.contactNumber,"E-MAIL":H.email||"","PSUDO ID":H.pseudoId||"","SALE PERSON":((z=H.salesPerson)==null?void 0:z.fullName)||"","LEAD PERSON":((_=H.leadPerson)==null?void 0:_.fullName)||"",SOURSE:H.source||"","CLIENT REMARK":H.clientRemark||"",FEEDBACK:H.feedback||"","TOTAL COST":`${((ce=H.totalCost)==null?void 0:ce.toFixed(2))||"0.00"} ${H.totalCostCurrency||"USD"}`,"TOKEN AMOUNT":`${((re=H.tokenAmount)==null?void 0:re.toFixed(2))||"0.00"} ${H.tokenAmountCurrency||"USD"}`}}),ne=jm.json_to_sheet(R),P=jm.book_new();jm.book_append_sheet(P,ne,"Lead Sales"),iB(P,le)};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto px-4 py-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Sales Sheet"}),o.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This page shows all sales assigned to you as a Lead Person. Sales created by Sales Persons who select you as the Lead Person will appear here."})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:K,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Refresh"}),o.jsxs("button",{onClick:oe,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center",children:[o.jsx(XA,{className:"mr-2"})," Export"]})]})]}),o.jsxs("div",{className:"mb-6 p-4 bg-white rounded-lg shadow-md",children:[o.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[o.jsx(kp,{className:"mr-2 text-blue-500"})," Filter Sales by Date"]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-600 mb-1",children:"Month"}),o.jsx("select",{id:"month",value:N,onChange:ie,className:"border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:T,children:j.map(le=>o.jsx("option",{value:le.value,children:le.label},le.value))})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-600 mb-1",children:"Year"}),o.jsx("select",{id:"year",value:E,onChange:te,className:"border border-gray-300 rounded-md p-2 focus:outline-none focus:ring-blue-500 focus:border-blue-500",disabled:T,children:D.map(le=>o.jsx("option",{value:le,children:le},le))})]}),o.jsxs("div",{className:"flex items-center ml-4",children:[o.jsx("input",{id:"currentMonth",type:"checkbox",checked:T,onChange:()=>O(!T),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),o.jsx("label",{htmlFor:"currentMonth",className:"ml-2 block text-sm text-gray-700",children:"Show Current Month Only"})]}),o.jsxs("button",{onClick:G,className:"bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-4 rounded-md ml-auto transition duration-300 flex items-center",children:[o.jsx(GA,{className:"mr-2"})," Reset to Current Month"]})]}),o.jsxs("div",{className:"mt-3 text-sm text-gray-500",children:[T?o.jsxs("p",{children:["Showing sales for current month: ",j[new Date().getMonth()].label," ",new Date().getFullYear()]}):o.jsxs("p",{children:["Showing sales for: ",j[N-1].label," ",E]}),o.jsxs("p",{children:["Total: ",r.length," sales"]})]})]}),u&&o.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4",children:o.jsx("p",{children:u})}),s?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full bg-white border border-gray-200",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-gray-100",children:[o.jsx("th",{className:"border px-4 py-2",children:"DATE"}),o.jsx("th",{className:"border px-4 py-2",children:"NAME"}),o.jsx("th",{className:"border px-4 py-2",children:"COURSE"}),o.jsx("th",{className:"border px-4 py-2",children:"NUMBER"}),o.jsx("th",{className:"border px-4 py-2",children:"EMAIL"}),o.jsx("th",{className:"border px-4 py-2",children:"COUNTRY"}),o.jsx("th",{className:"border px-4 py-2",children:"SALES PERSON"}),o.jsx("th",{className:"border px-4 py-2",children:"TOTAL COST"}),o.jsx("th",{className:"border px-4 py-2",children:"TOKEN AMOUNT"}),o.jsx("th",{className:"border px-4 py-2",children:"LEAD PERSON"}),o.jsx("th",{className:"border px-4 py-2",children:"ACTIONS"})]})}),o.jsx("tbody",{children:r.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"11",className:"border px-4 py-2 text-center",children:o.jsxs("div",{className:"py-6",children:[o.jsx("p",{className:"text-gray-600 mb-2",children:"No sales data found for you as a Lead Person."}),o.jsxs("p",{className:"text-sm text-gray-500",children:["When Sales Persons create sales and select you as the Lead Person, they will appear here.",o.jsx("br",{}),"Ask Sales Persons to make sure they select your name in the Lead Person dropdown when creating sales."]})]})})}):r.map(le=>{var R,ne,P;return o.jsx("tr",{className:"hover:bg-gray-50",children:p===le._id?o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"border px-4 py-2",children:o.jsx("input",{type:"date",name:"DATE",value:y.DATE?new Date(y.DATE).toISOString().split("T")[0]:"",onChange:W,className:"w-full p-1 border"})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsx("input",{type:"text",name:"NAME",value:y.NAME,onChange:W,className:"w-full p-1 border"})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsx("input",{type:"text",name:"COURSE",value:y.COURSE,onChange:W,className:"w-full p-1 border"})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsx("input",{type:"text",name:"NUMBER",value:y.NUMBER,onChange:W,className:"w-full p-1 border"})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsx("input",{type:"text",name:"E-MAIL",value:y["E-MAIL"],onChange:W,className:"w-full p-1 border"})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsx("input",{type:"text",name:"COUNTRY",value:y.COUNTRY,onChange:W,className:"w-full p-1 border"})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsxs("select",{name:"SALE PERSON",value:y["SALE PERSON"],onChange:W,className:"w-full p-1 border",children:[o.jsx("option",{value:"",children:"Select"}),m.map(H=>o.jsx("option",{value:H._id,children:H.fullName},H._id))]})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("input",{type:"number",name:"TOTAL_COST",value:y.TOTAL_COST,onChange:W,className:"w-2/3 p-1 border"}),o.jsxs("select",{name:"TOTAL_COST_CURRENCY",value:y.TOTAL_COST_CURRENCY,onChange:W,className:"w-1/3 p-1 border text-xs",children:[o.jsx("option",{value:"USD",children:"USD"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"GBP",children:"GBP"}),o.jsx("option",{value:"CAD",children:"CAD"}),o.jsx("option",{value:"AUD",children:"AUD"}),o.jsx("option",{value:"INR",children:"INR"}),o.jsx("option",{value:"JPY",children:"JPY"}),o.jsx("option",{value:"CNY",children:"CNY"})]})]})}),o.jsx("td",{className:"border px-4 py-2",children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx("input",{type:"number",name:"TOKEN_AMOUNT",value:y.TOKEN_AMOUNT,onChange:W,className:"w-2/3 p-1 border"}),o.jsxs("select",{name:"TOKEN_AMOUNT_CURRENCY",value:y.TOKEN_AMOUNT_CURRENCY,onChange:W,className:"w-1/3 p-1 border text-xs",children:[o.jsx("option",{value:"USD",children:"USD"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"GBP",children:"GBP"}),o.jsx("option",{value:"CAD",children:"CAD"}),o.jsx("option",{value:"AUD",children:"AUD"}),o.jsx("option",{value:"INR",children:"INR"}),o.jsx("option",{value:"JPY",children:"JPY"}),o.jsx("option",{value:"CNY",children:"CNY"})]})]})}),o.jsx("td",{className:"border px-4 py-2",children:(R=le.leadPerson)==null?void 0:R.fullName}),o.jsx("td",{className:"border px-4 py-2",children:o.jsxs("div",{className:"flex justify-center space-x-1",children:[o.jsx("button",{onClick:F,className:"p-1 bg-green-500 text-white rounded text-sm hover:bg-green-600",children:o.jsx(Hw,{})}),o.jsx("button",{onClick:Z,className:"p-1 bg-red-500 text-white rounded text-sm hover:bg-red-600",children:o.jsx(ZA,{})})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx("td",{className:"border px-4 py-2",children:new Date(le.date).toLocaleDateString()}),o.jsx("td",{className:"border px-4 py-2",children:le.customerName}),o.jsx("td",{className:"border px-4 py-2",children:le.course}),o.jsx("td",{className:"border px-4 py-2",children:le.countryCode&&le.contactNumber?`${le.countryCode} ${le.contactNumber}`:le.contactNumber||"N/A"}),o.jsx("td",{className:"border px-4 py-2",children:le.email||"N/A"}),o.jsx("td",{className:"border px-4 py-2",children:le.country||"N/A"}),o.jsx("td",{className:"border px-4 py-2",children:((ne=le.salesPerson)==null?void 0:ne.fullName)||(typeof le.salesPerson=="string"?le.salesPerson:"N/A")}),o.jsxs("td",{className:"border px-4 py-2",children:[le.totalCost!==void 0?le.totalCost.toFixed(2):"0.00"," ",le.totalCostCurrency||"USD"]}),o.jsxs("td",{className:"border px-4 py-2",children:[le.tokenAmount!==void 0?le.tokenAmount.toFixed(2):"0.00"," ",le.tokenAmountCurrency||"USD"]}),o.jsx("td",{className:"border px-4 py-2",children:((P=le.leadPerson)==null?void 0:P.fullName)||(typeof le.leadPerson=="string"?le.leadPerson:"N/A")}),o.jsx("td",{className:"border px-4 py-2 flex justify-center",children:o.jsx("button",{onClick:()=>J(le),className:"px-2 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600",children:o.jsx(nu,{})})})]})},le._id)})})]})})]})})},bB=()=>{const[e,t]=k.useState([]),[r,n]=k.useState(!0),[s,l]=k.useState(null),[u,h]=k.useState([]),[m,f]=k.useState(!1),[p,g]=k.useState(null),[y,v]=k.useState({DATE:new Date().toISOString().split("T")[0],NAME:"",COUNTRY:"",COURSE:"",CODE:"",NUMBER:"","E-MAIL":"","PSUDO ID":"","SALE PERSON":"","LEAD PERSON":"",SOURSE:"","CLIENT REMARK":"",FEEDBACK:"","TOTAL COST":0,"TOTAL COST CURRENCY":"USD","TOKEN AMOUNT":0,"TOKEN AMOUNT CURRENCY":"USD"}),{user:S,loadUser:N}=Tr();console.log("User object in LeadSalesUpdatePage initial load:",S),console.log("User ID formats:",S?{id:S.id,_id:S._id,userId:S.userId}:"No user data"),k.useEffect(()=>{S?(console.log("User data available:",S),console.log("User ID variations:",{id:S.id,_id:S._id,userId:S.userId})):(console.log("No user data found, attempting to reload user data"),N())},[]),k.useEffect(()=>{console.log("User information on load:",S),S&&(w(),E())},[S]),k.useEffect(()=>{if(S){const D=S.id||S._id||S.userId;console.log("Setting lead person ID to:",D),D&&v(U=>({...U,"LEAD PERSON":D}))}},[S]);const w=async()=>{try{n(!0),l(null);const D=await Wn.getLeadSheet();t(D.data.data)}catch(D){console.error("Error loading sales data:",D),l("Failed to load sales data. Please try again."),Hr.error("Failed to load sales data")}finally{n(!1)}},E=async()=>{try{const D=await fr.getUsers("Sales Person");h(D.data.data||[])}catch(D){console.error("Error loading users:",D),Hr.error("Failed to load sales persons")}},C=D=>{const{name:U,value:K}=D.target;v(ie=>({...ie,[U]:K}))},T=async D=>{var U,K,ie,te;D.preventDefault(),n(!0),l(null);try{if(!S)throw console.error("No user object available"),new Error("User information not available. Please log in again.");console.log("Full user object:",S);const G=S.id||S._id||S.userId;if(!G)throw console.error("No user ID found in any format:",S),new Error("User ID not available. Please log in again.");console.log("Using user ID:",G);const de={date:y.DATE,customerName:y.NAME,country:y.COUNTRY,course:y.COURSE,countryCode:y.CODE,contactNumber:y.NUMBER,email:y["E-MAIL"],pseudoId:y["PSUDO ID"],salesPerson:y["SALE PERSON"],totalCost:parseFloat(y["TOTAL COST"]),totalCostCurrency:y["TOTAL COST CURRENCY"],tokenAmount:parseFloat(y["TOKEN AMOUNT"]),tokenAmountCurrency:y["TOKEN AMOUNT CURRENCY"],leadPerson:G,source:y.SOURSE,clientRemark:y["CLIENT REMARK"],feedback:y.FEEDBACK,isLeadPersonSale:!0};console.log("Sending sale data:",de);let J;p?(J=await om.update(p,de),Hr.success("Sale updated successfully")):(J=await om.create(de),Hr.success("Sale created successfully")),J.data.success&&(v({DATE:new Date().toISOString().split("T")[0],NAME:"",COUNTRY:"",COURSE:"",CODE:"",NUMBER:"","E-MAIL":"","PSUDO ID":"","SALE PERSON":"","LEAD PERSON":G,SOURSE:"","CLIENT REMARK":"",FEEDBACK:"","TOTAL COST":0,"TOTAL COST CURRENCY":"USD","TOKEN AMOUNT":0,"TOKEN AMOUNT CURRENCY":"USD"}),f(!1),g(null),w())}catch(G){console.error("Error with sale:",G),l(((K=(U=G.response)==null?void 0:U.data)==null?void 0:K.message)||"Failed to process sale. Please try again."),Hr.error(((te=(ie=G.response)==null?void 0:ie.data)==null?void 0:te.message)||"Failed to process sale")}finally{n(!1)}},O=async D=>{if(window.confirm("Are you sure you want to delete this sale?"))try{n(!0),await om.delete(D),Hr.success("Sale deleted successfully"),w()}catch(U){console.error("Error deleting sale:",U),Hr.error("Failed to delete sale")}finally{n(!1)}},j=D=>{var U,K;g(D._id),v({DATE:new Date(D.date).toISOString().split("T")[0],NAME:D.customerName||"",COUNTRY:D.country||"",COURSE:D.course||"",CODE:D.countryCode||"",NUMBER:D.contactNumber||"","E-MAIL":D.email||"","PSUDO ID":D.pseudoId||"","SALE PERSON":((U=D.salesPerson)==null?void 0:U._id)||D.salesPerson||"","LEAD PERSON":((K=D.leadPerson)==null?void 0:K._id)||D.leadPerson||"",SOURSE:D.source||"","CLIENT REMARK":D.clientRemark||"",FEEDBACK:D.feedback||"","TOTAL COST":D.totalCost||0,"TOTAL COST CURRENCY":D.totalCostCurrency||"USD","TOKEN AMOUNT":D.tokenAmount||0,"TOKEN AMOUNT CURRENCY":D.tokenAmountCurrency||"USD"}),f(!0),window.scrollTo({top:0,behavior:"smooth"})},q=()=>{g(null),v({DATE:new Date().toISOString().split("T")[0],NAME:"",COUNTRY:"",COURSE:"",CODE:"",NUMBER:"","E-MAIL":"","PSUDO ID":"","SALE PERSON":"","LEAD PERSON":(S==null?void 0:S.id)||(S==null?void 0:S._id)||(S==null?void 0:S.userId)||"",SOURSE:"","CLIENT REMARK":"",FEEDBACK:"","TOTAL COST":0,"TOTAL COST CURRENCY":"USD","TOKEN AMOUNT":0,"TOKEN AMOUNT CURRENCY":"USD"}),f(!1)};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-2xl font-bold",children:"Lead Sales Management"}),o.jsx("button",{onClick:()=>{g(null),f(!m)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:m?"Cancel":o.jsxs(o.Fragment,{children:[o.jsx(Op,{className:"mr-2"})," Add New Sale"]})})]}),s&&o.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:s}),m&&o.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:p?"Edit Sale":"Add New Sale"}),o.jsxs("form",{onSubmit:T,children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),o.jsx("input",{type:"date",name:"DATE",value:y.DATE,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer Name"}),o.jsx("input",{type:"text",name:"NAME",value:y.NAME,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),o.jsx("input",{type:"text",name:"COUNTRY",value:y.COUNTRY,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Course"}),o.jsx("input",{type:"text",name:"COURSE",value:y.COURSE,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country Code"}),o.jsx("input",{type:"text",name:"CODE",value:y.CODE,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),o.jsx("input",{type:"text",name:"NUMBER",value:y.NUMBER,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx("input",{type:"email",name:"E-MAIL",value:y["E-MAIL"],onChange:C,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pseudo ID"}),o.jsx("input",{type:"text",name:"PSUDO ID",value:y["PSUDO ID"],onChange:C,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sales Person"}),o.jsxs("select",{name:"SALE PERSON",value:y["SALE PERSON"],onChange:C,className:"w-full p-2 border border-gray-300 rounded-md",children:[o.jsx("option",{value:"",children:"Select Sales Person"}),u.map(D=>o.jsx("option",{value:D._id,children:D.fullName},D._id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source"}),o.jsx("input",{type:"text",name:"SOURSE",value:y.SOURSE,onChange:C,className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Cost"}),o.jsxs("div",{className:"flex",children:[o.jsx("input",{type:"number",name:"TOTAL COST",value:y["TOTAL COST"],onChange:C,className:"w-2/3 p-2 border border-gray-300 rounded-l-md",required:!0}),o.jsxs("select",{name:"TOTAL COST CURRENCY",value:y["TOTAL COST CURRENCY"],onChange:C,className:"w-1/3 p-2 border border-gray-300 rounded-r-md",children:[o.jsx("option",{value:"USD",children:"USD"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"GBP",children:"GBP"}),o.jsx("option",{value:"INR",children:"INR"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Token Amount"}),o.jsxs("div",{className:"flex",children:[o.jsx("input",{type:"number",name:"TOKEN AMOUNT",value:y["TOKEN AMOUNT"],onChange:C,className:"w-2/3 p-2 border border-gray-300 rounded-l-md",required:!0}),o.jsxs("select",{name:"TOKEN AMOUNT CURRENCY",value:y["TOKEN AMOUNT CURRENCY"],onChange:C,className:"w-1/3 p-2 border border-gray-300 rounded-r-md",children:[o.jsx("option",{value:"USD",children:"USD"}),o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"GBP",children:"GBP"}),o.jsx("option",{value:"INR",children:"INR"})]})]})]})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Remark"}),o.jsx("textarea",{name:"CLIENT REMARK",value:y["CLIENT REMARK"],onChange:C,rows:"2",className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{className:"mt-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Feedback"}),o.jsx("textarea",{name:"FEEDBACK",value:y.FEEDBACK,onChange:C,rows:"2",className:"w-full p-2 border border-gray-300 rounded-md"})]}),o.jsxs("div",{className:"mt-6 flex justify-end space-x-4",children:[o.jsx("button",{type:"button",onClick:q,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300",children:r?"Processing...":p?"Update Sale":"Add Sale"})]})]})]}),o.jsxs("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[o.jsx("h2",{className:"text-xl font-semibold p-4 bg-gray-50",children:"Sales List"}),r&&!m?o.jsx("div",{className:"flex justify-center items-center p-8",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.length===0?o.jsx("div",{className:"p-6 text-center text-gray-500",children:"No sales found. Add your first sale above."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sales Person"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Token"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(D=>{var U;return o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(D.date).toLocaleDateString()}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[o.jsx("div",{children:D.customerName}),o.jsx("div",{className:"text-xs text-gray-500",children:D.country})]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.course}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((U=D.salesPerson)==null?void 0:U.fullName)||"N/A"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[D.totalCost," ",D.totalCostCurrency]}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[D.tokenAmount," ",D.tokenAmountCurrency]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${D.saleType==="Lead Person Sale"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:D.saleType||(D.isLeadPersonSale?"Lead Person Sale":"Sales Person Sale")})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>j(D),className:"text-indigo-600 hover:text-indigo-900",children:o.jsx(nu,{className:"h-5 w-5"})}),(!D.saleType||D.saleType==="Lead Person Sale"||D.isLeadPersonSale)&&o.jsx("button",{onClick:()=>O(D._id),className:"text-red-600 hover:text-red-900",children:o.jsx(Rp,{className:"h-5 w-5"})})]})})]},D._id)})})]})})]})]})})},wB=()=>{const{user:e}=Tr(),[t,r]=k.useState("getting-started"),n={"getting-started":{title:"Getting Started with TrainCape CRM",icon:"",content:[{heading:"Welcome to TrainCape CRM",description:"This tutorial will help you understand the basics of the CRM system and how to get started.",steps:["Log in using your provided credentials","Navigate the dashboard to understand available features","Update your profile information","Explore the main navigation menu for your role-specific features"],image:"dashboard.png",tip:"Your role determines which features you can access. The system has four roles: Admin, Manager, Lead Person, and Sales Person."},{heading:"Understanding Your Dashboard",description:"Your dashboard provides quick access to important information based on your role.",steps:["View recent activities and updates","Access quick shortcuts to common tasks","Check pending tasks and notifications","Use the quick stats cards to monitor performance"],tip:"Customize your experience by updating your profile settings."},{heading:"Setting Up Your Profile",description:"Personalize your account and add a profile picture.",steps:["Navigate to your profile by clicking your name in the top navigation","Upload a profile picture by clicking the camera icon","Use the crop tool to adjust and position your image","Click Apply Crop to confirm your selection","Save your profile changes"],tip:"The new image cropping tool allows you to perfectly position your profile picture before uploading."}]},"lead-management":{title:"Lead Management",icon:"",content:[{heading:"Creating New Leads",description:"Learn how to add new potential customers to the system.",steps:["Navigate to the Leads section from the main menu","Click the 'Add New Lead' button in the top right corner","Fill in all required fields (marked with *)","For optional fields like email, include information when available","Click 'Save Lead' to create the new entry"],tip:"Always include as much information as possible, but email is now optional to accommodate clients who prefer phone contact."},{heading:"Managing Existing Leads",description:"How to update, filter, and organize your lead database.",steps:["Use the search bar to quickly find leads by name, email, or phone","Click on any lead to view detailed information","Use the edit button to update lead information","Add feedback notes to track communication history"],tip:"Regular updates to lead information ensures everyone has the most current data."},{heading:"Assigning Leads to Sales Persons",description:"Proper lead assignment ensures timely follow-up.",steps:["From the lead details page, click 'Edit'","Use the 'SALE PERSON' dropdown to select the appropriate sales person","Save the changes to notify the sales person of the new assignment"],tip:"Consider workload balance when assigning leads to ensure timely follow-up."}]},"sales-tracking":{title:"Sales Tracking & Management",icon:"",content:[{heading:"Converting Leads to Sales",description:"Learn the process of turning qualified leads into sales records.",steps:["Navigate to your assigned leads list","Update the lead status to 'Qualified' when appropriate","Click 'Convert to Sale' to begin the sales process","Fill in the required sales information including course details and pricing","Select the appropriate currency for the transaction"],tip:"The system now supports multiple currencies for both Total Cost and Token Amount fields."},{heading:"Creating Reference Sales",description:"Reference sales allow you to track customers who came through referrals rather than the standard lead process.",steps:["From the Sales page, toggle the 'Reference Sale' switch","Select a Lead Person who referred this customer (optional)","Fill in all customer information as this will not be pulled from an existing lead","Complete all required sales information","Submit the form to create the reference sale"],tip:"Reference sales customers will be available in all customer selection dropdowns throughout the system, including exam scheduling."},{heading:"Lead Person Sales Management",description:"Lead persons can now track their own sales separately from the main sales pipeline.",steps:["As a Lead Person, navigate to the Lead Sales Update page","Click 'Add New Sale' to create a new lead person sale","Fill in all required customer and sales information","Select a Sales Person to associate with this sale","Submit the sale to save it to the lead person sales database"],tip:"Lead Person sales are stored in a separate database and are only visible to Lead Persons, Managers, and Admins - not to regular Sales Persons."},{heading:"Managing Your Sales",description:"Sales Persons can now fully edit and update their own sales records.",steps:["Navigate to the Sales Tracking page to see all your assigned sales","Click the edit icon on any sale you created","Update any field as needed - you now have full editing privileges for your own sales","Save your changes to update the record"],tip:"While you can edit all aspects of your own sales, you'll still need an Admin or Manager to delete records if necessary."},{heading:"Using the Sales Sheet",description:"The Lead Sales Sheet provides a comprehensive view of all sales data.",steps:["Access the Lead Sales Sheet from the navigation menu","Use filters to narrow down sales by date range, sales person, or other criteria","Click on column headers to sort the data","Export data to Excel for reporting purposes","Use inline editing for quick updates"],tip:"The sales sheet now includes email information and improved contact details for better customer tracking."},{heading:"Managing Payments & Tracking",description:"Track payments and outstanding balances effectively.",steps:["Record token (initial) payments when received","Update payment status as transactions are completed","Monitor pending payments through the Sales Tracking page","Set follow-up tasks for payment collection"],tip:"Keep the payment currency consistent with the original sale for accurate accounting."}]},"task-management":{title:"Task & Exam Management",icon:"",content:[{heading:"Scheduling Exams",description:"Use the Task Management system to schedule and track exams for your customers.",steps:["Navigate to the Task Management page","Click 'Schedule New Exam' button","Enter the exam title and description","Select a customer from the dropdown (includes both leads and reference customers)","Set the exam date and time","Save to create the scheduled exam"],tip:"The customer dropdown now includes both regular leads and reference sales customers, giving you a complete list of all possible candidates."},{heading:"Managing Scheduled Exams",description:"Track and update exam status as they progress.",steps:["View all scheduled exams on the Task Management page","Use color-coding to quickly identify exam status (pending, completed, overdue)","Click 'Mark Complete' when an exam has been conducted","Edit or reschedule exams as needed using the edit icon","Delete exams that are no longer needed"],tip:"Keep the exam list up to date to ensure nothing falls through the cracks."},{heading:"Exam Follow-up Process",description:"Proper follow-up after exams increases conversion rates.",steps:["After marking an exam as completed, update the related lead or sale with results","Schedule any necessary follow-up tasks","Document exam outcomes in the lead feedback or sales notes","Update the lead status based on exam performance"],tip:"Regular communication after exams builds trust and increases the likelihood of enrollment."}]},"admin-features":{title:"Admin & Management Tools",icon:"",content:[{heading:"User Management",description:"Admin users can manage system access and roles.",steps:["Navigate to Admin > Manage Users","Create new user accounts with appropriate role assignments","Edit existing user information or reset passwords","Deactivate accounts when necessary"],tip:"Review user activity logs periodically to ensure proper system usage."},{heading:"Data Import & Export",description:"Efficiently move data in and out of the CRM.",steps:["Go to Admin > Import Data","Use the template provided for data formatting","Upload your CSV file with lead or sales information","Review and confirm the data mapping","Process the import and check for any errors"],tip:"Always make a backup export before performing large imports or system changes."},{heading:"Permission Management",description:"Configure role-based permissions for different user types.",steps:["Access the Admin Dashboard","Review current permission settings for each role","Adjust permissions as needed for your organization's workflows","Test permission changes with test accounts before rolling out"],tip:"The system now allows Sales Persons to fully edit their own sales while maintaining appropriate restrictions on other users' data."},{heading:"System Configuration",description:"Customize the CRM to fit your organization's needs.",steps:["Access the Admin Dashboard","Configure notification preferences","Set up automated processes for lead assignment","Customize sales stages and lead statuses"],tip:"Document any configuration changes for future reference."}]},"best-practices":{title:"CRM Best Practices",icon:"",content:[{heading:"Data Quality Management",description:"Maintaining high-quality data is essential for CRM success.",steps:["Regularly update lead and customer information","Remove duplicate records when identified","Use consistent naming conventions","Verify contact information periodically"],tip:"Schedule regular data cleaning sessions to maintain database quality."},{heading:"Managing Reference Customers",description:"Reference customers require special attention for ongoing relationship management.",steps:["Properly tag all reference customers when creating sales","Document the source of the reference in notes","Thank referrers for their recommendations","Provide special attention to reference customers to encourage additional referrals","Track conversion rates from references versus other lead sources"],tip:"Reference customers often have higher conversion rates and retention, so track them separately in your analytics."},{heading:"Effective Follow-up Strategies",description:"Consistent follow-up improves conversion rates.",steps:["Document all customer interactions in the CRM","Set follow-up tasks with clear deadlines","Use templates for common follow-up communications","Analyze response patterns to optimize timing"],tip:"The 'CLIENT REMARK' and 'FEEDBACK' fields are ideal for tracking communication history."},{heading:"Reporting & Analytics",description:"Leverage data insights for better decision-making.",steps:["Use the built-in reporting tools to track performance","Export data for detailed analysis when needed","Track conversion rates from lead to sale","Monitor sales team performance metrics","Compare performance between regular leads and reference customers"],tip:"Regular reporting helps identify trends and opportunities for improvement."}]}},s=()=>{const l=n[t];return o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[o.jsxs("div",{className:"flex items-center mb-6",children:[o.jsx("span",{className:"text-3xl mr-3",children:l.icon}),o.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:l.title})]}),o.jsx("div",{className:"space-y-8",children:l.content.map((u,h)=>o.jsxs("div",{className:"border-b border-gray-200 pb-6 last:border-0",children:[o.jsx("h3",{className:"text-xl font-semibold text-blue-700 mb-3",children:u.heading}),o.jsx("p",{className:"text-gray-700 mb-4",children:u.description}),u.steps&&o.jsxs("div",{className:"mb-4",children:[o.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Steps:"}),o.jsx("ol",{className:"list-decimal list-inside space-y-1 text-gray-700",children:u.steps.map((m,f)=>o.jsx("li",{className:"ml-2",children:m},f))})]}),u.image&&o.jsxs("div",{className:"my-4 border border-gray-200 rounded-md p-2 bg-gray-50 text-center",children:[o.jsxs("div",{className:"bg-gray-200 h-40 flex items-center justify-center text-gray-500",children:["[Image: ",u.image,"]"]}),o.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Screenshot reference"})]}),u.tip&&o.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 mt-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-blue-500",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),o.jsx("p",{className:"ml-3 text-sm text-blue-700",children:u.tip})]})})]},h))})]})};return o.jsx(jr,{children:o.jsx("div",{className:"bg-gray-50 min-h-screen py-8",children:o.jsxs("div",{className:"container mx-auto px-4",children:[o.jsxs("div",{className:"mb-8 text-center",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"CRM Tutorials"}),o.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Learn how to use TrainCape CRM effectively with these step-by-step tutorials. Select a category below to get started."})]}),o.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[o.jsxs("div",{className:"md:w-1/4",children:[o.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[o.jsx("h3",{className:"font-bold text-lg mb-4 text-gray-800",children:"Tutorial Topics"}),o.jsx("nav",{children:o.jsx("ul",{className:"space-y-2",children:Object.keys(n).map(l=>o.jsx("li",{children:o.jsxs("button",{onClick:()=>r(l),className:`w-full text-left px-3 py-2 rounded-md transition-colors ${t===l?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[o.jsx("span",{className:"mr-2",children:n[l].icon}),n[l].title]})},l))})}),o.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-4",children:[o.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Your Role"}),o.jsx("p",{className:"text-sm text-gray-600",children:e?o.jsxs(o.Fragment,{children:["You are logged in as: ",o.jsx("span",{className:"font-medium",children:e.role}),o.jsx("br",{}),"Tutorials are tailored to features available to your role."]}):o.jsx(o.Fragment,{children:"You are not logged in. Some advanced features may require authentication."})})]})]}),o.jsxs("div",{className:"bg-gradient-to-r from-purple-500 to-indigo-600 text-white p-5 rounded-lg shadow-md mt-4",children:[o.jsx("h3",{className:"font-bold text-lg mb-2",children:"Need Help?"}),o.jsx("p",{className:"text-sm mb-3",children:"Can't find what you're looking for? Contact our support team for assistance."}),o.jsx(Nt,{to:"/support",className:"inline-block bg-white text-purple-700 px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-100 transition",children:"Contact Support"})]})]}),o.jsxs("div",{className:"md:w-3/4",children:[s(),o.jsxs("div",{className:"mt-6 flex justify-between",children:[o.jsxs("button",{onClick:()=>{const l=Object.keys(n),u=l.indexOf(t);u>0&&r(l[u-1])},disabled:Object.keys(n).indexOf(t)===0,className:`px-4 py-2 flex items-center rounded-md ${Object.keys(n).indexOf(t)===0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-50 text-blue-700 hover:bg-blue-100"}`,children:[o.jsx("svg",{className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous Topic"]}),o.jsxs("button",{onClick:()=>{const l=Object.keys(n),u=l.indexOf(t);u<l.length-1&&r(l[u+1])},disabled:Object.keys(n).indexOf(t)===Object.keys(n).length-1,className:`px-4 py-2 flex items-center rounded-md ${Object.keys(n).indexOf(t)===Object.keys(n).length-1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-50 text-blue-700 hover:bg-blue-100"}`,children:["Next Topic",o.jsx("svg",{className:"h-5 w-5 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]})]}),o.jsxs("div",{className:"mt-12",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:"Additional Resources"}),o.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-md border-t-4 border-blue-500",children:[o.jsx("h3",{className:"font-bold text-lg mb-2",children:"Video Tutorials"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Watch step-by-step demonstrations of key CRM features."}),o.jsxs("a",{href:"#",className:"text-blue-600 hover:text-blue-800 font-medium inline-flex items-center",children:["Watch now",o.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),o.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-md border-t-4 border-green-500",children:[o.jsx("h3",{className:"font-bold text-lg mb-2",children:"FAQ Database"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Find answers to commonly asked questions about the CRM."}),o.jsxs("a",{href:"#",className:"text-green-600 hover:text-green-800 font-medium inline-flex items-center",children:["View FAQs",o.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]}),o.jsxs("div",{className:"bg-white p-5 rounded-lg shadow-md border-t-4 border-purple-500",children:[o.jsx("h3",{className:"font-bold text-lg mb-2",children:"Feature Updates"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Stay informed about the latest CRM features and enhancements."}),o.jsxs("a",{href:"#",className:"text-purple-600 hover:text-purple-800 font-medium inline-flex items-center",children:["Read changelog",o.jsx("svg",{className:"h-4 w-4 ml-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]})]})})})},uN=6048e5,SB=864e5,Gb=Symbol.for("constructDateFrom");function ci(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Gb in e?e[Gb](t):e instanceof Date?new e.constructor(t):new Date(t)}function Oa(e,t){return ci(t||e,e)}let NB={};function Qf(){return NB}function Zc(e,t){var h,m,f,p;const r=Qf(),n=(t==null?void 0:t.weekStartsOn)??((m=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:m.weekStartsOn)??r.weekStartsOn??((p=(f=r.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??0,s=Oa(e,t==null?void 0:t.in),l=s.getDay(),u=(l<n?7:0)+l-n;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}function Ef(e,t){return Zc(e,{...t,weekStartsOn:1})}function dN(e,t){const r=Oa(e,t==null?void 0:t.in),n=r.getFullYear(),s=ci(r,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const l=Ef(s),u=ci(r,0);u.setFullYear(n,0,4),u.setHours(0,0,0,0);const h=Ef(u);return r.getTime()>=l.getTime()?n+1:r.getTime()>=h.getTime()?n:n-1}function qb(e){const t=Oa(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function TB(e,...t){const r=ci.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function $b(e,t){const r=Oa(e,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function EB(e,t,r){const[n,s]=TB(r==null?void 0:r.in,e,t),l=$b(n),u=$b(s),h=+l-qb(l),m=+u-qb(u);return Math.round((h-m)/SB)}function _B(e,t){const r=dN(e,t),n=ci(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),Ef(n)}function CB(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function AB(e){return!(!CB(e)&&typeof e!="number"||isNaN(+Oa(e)))}function jB(e,t){const r=Oa(e,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const DB={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},kB=(e,t,r)=>{let n;const s=DB[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Dm(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const OB={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},RB={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},MB={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},FB={date:Dm({formats:OB,defaultWidth:"full"}),time:Dm({formats:RB,defaultWidth:"full"}),dateTime:Dm({formats:MB,defaultWidth:"full"})},LB={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},PB=(e,t,r,n)=>LB[e];function gc(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const u=e.defaultFormattingWidth||e.defaultWidth,h=r!=null&&r.width?String(r.width):u;s=e.formattingValues[h]||e.formattingValues[u]}else{const u=e.defaultWidth,h=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[h]||e.values[u]}const l=e.argumentCallback?e.argumentCallback(t):t;return s[l]}}const BB={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UB={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},IB={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},zB={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},VB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},HB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},YB=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},GB={ordinalNumber:YB,era:gc({values:BB,defaultWidth:"wide"}),quarter:gc({values:UB,defaultWidth:"wide",argumentCallback:e=>e-1}),month:gc({values:IB,defaultWidth:"wide"}),day:gc({values:zB,defaultWidth:"wide"}),dayPeriod:gc({values:VB,defaultWidth:"wide",formattingValues:HB,defaultFormattingWidth:"wide"})};function yc(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=t.match(s);if(!l)return null;const u=l[0],h=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(h)?$B(h,g=>g.test(u)):qB(h,g=>g.test(u));let f;f=e.valueCallback?e.valueCallback(m):m,f=r.valueCallback?r.valueCallback(f):f;const p=t.slice(u.length);return{value:f,rest:p}}}function qB(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function $B(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function WB(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],l=t.match(e.parsePattern);if(!l)return null;let u=e.valueCallback?e.valueCallback(l[0]):l[0];u=r.valueCallback?r.valueCallback(u):u;const h=t.slice(s.length);return{value:u,rest:h}}}const XB=/^(\d+)(th|st|nd|rd)?/i,KB=/\d+/i,QB={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},ZB={any:[/^b/i,/^(a|c)/i]},JB={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},eU={any:[/1/i,/2/i,/3/i,/4/i]},tU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},rU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},nU={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},aU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},sU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},iU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},oU={ordinalNumber:WB({matchPattern:XB,parsePattern:KB,valueCallback:e=>parseInt(e,10)}),era:yc({matchPatterns:QB,defaultMatchWidth:"wide",parsePatterns:ZB,defaultParseWidth:"any"}),quarter:yc({matchPatterns:JB,defaultMatchWidth:"wide",parsePatterns:eU,defaultParseWidth:"any",valueCallback:e=>e+1}),month:yc({matchPatterns:tU,defaultMatchWidth:"wide",parsePatterns:rU,defaultParseWidth:"any"}),day:yc({matchPatterns:nU,defaultMatchWidth:"wide",parsePatterns:aU,defaultParseWidth:"any"}),dayPeriod:yc({matchPatterns:sU,defaultMatchWidth:"any",parsePatterns:iU,defaultParseWidth:"any"})},lU={code:"en-US",formatDistance:kB,formatLong:FB,formatRelative:PB,localize:GB,match:oU,options:{weekStartsOn:0,firstWeekContainsDate:1}};function cU(e,t){const r=Oa(e,t==null?void 0:t.in);return EB(r,jB(r))+1}function uU(e,t){const r=Oa(e,t==null?void 0:t.in),n=+Ef(r)-+_B(r);return Math.round(n/uN)+1}function fN(e,t){var p,g,y,v;const r=Oa(e,t==null?void 0:t.in),n=r.getFullYear(),s=Qf(),l=(t==null?void 0:t.firstWeekContainsDate)??((g=(p=t==null?void 0:t.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??s.firstWeekContainsDate??((v=(y=s.locale)==null?void 0:y.options)==null?void 0:v.firstWeekContainsDate)??1,u=ci((t==null?void 0:t.in)||e,0);u.setFullYear(n+1,0,l),u.setHours(0,0,0,0);const h=Zc(u,t),m=ci((t==null?void 0:t.in)||e,0);m.setFullYear(n,0,l),m.setHours(0,0,0,0);const f=Zc(m,t);return+r>=+h?n+1:+r>=+f?n:n-1}function dU(e,t){var h,m,f,p;const r=Qf(),n=(t==null?void 0:t.firstWeekContainsDate)??((m=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(f=r.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,s=fN(e,t),l=ci((t==null?void 0:t.in)||e,0);return l.setFullYear(s,0,n),l.setHours(0,0,0,0),Zc(l,t)}function fU(e,t){const r=Oa(e,t==null?void 0:t.in),n=+Zc(r,t)-+dU(r,t);return Math.round(n/uN)+1}function $t(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Qs={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return $t(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):$t(r+1,2)},d(e,t){return $t(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return $t(e.getHours()%12||12,t.length)},H(e,t){return $t(e.getHours(),t.length)},m(e,t){return $t(e.getMinutes(),t.length)},s(e,t){return $t(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return $t(s,t.length)}},Ho={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Wb={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Qs.y(e,t)},Y:function(e,t,r,n){const s=fN(e,n),l=s>0?s:1-s;if(t==="YY"){const u=l%100;return $t(u,2)}return t==="Yo"?r.ordinalNumber(l,{unit:"year"}):$t(l,t.length)},R:function(e,t){const r=dN(e);return $t(r,t.length)},u:function(e,t){const r=e.getFullYear();return $t(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return $t(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return $t(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Qs.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return $t(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=fU(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):$t(s,t.length)},I:function(e,t,r){const n=uU(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):$t(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Qs.d(e,t)},D:function(e,t,r){const n=cU(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):$t(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),l=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(l);case"ee":return $t(l,2);case"eo":return r.ordinalNumber(l,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),l=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(l);case"cc":return $t(l,t.length);case"co":return r.ordinalNumber(l,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return $t(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=Ho.noon:n===0?s=Ho.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=Ho.evening:n>=12?s=Ho.afternoon:n>=4?s=Ho.morning:s=Ho.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Qs.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Qs.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):$t(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):$t(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Qs.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Qs.s(e,t)},S:function(e,t){return Qs.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Kb(n);case"XXXX":case"XX":return Mi(n);case"XXXXX":case"XXX":default:return Mi(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Kb(n);case"xxxx":case"xx":return Mi(n);case"xxxxx":case"xxx":default:return Mi(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Xb(n,":");case"OOOO":default:return"GMT"+Mi(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Xb(n,":");case"zzzz":default:return"GMT"+Mi(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return $t(n,t.length)},T:function(e,t,r){return $t(+e,t.length)}};function Xb(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),l=n%60;return l===0?r+String(s):r+String(s)+t+$t(l,2)}function Kb(e,t){return e%60===0?(e>0?"-":"+")+$t(Math.abs(e)/60,2):Mi(e,t)}function Mi(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=$t(Math.trunc(n/60),2),l=$t(n%60,2);return r+s+t+l}const Qb=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},hN=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},hU=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return Qb(e,t);let l;switch(n){case"P":l=t.dateTime({width:"short"});break;case"PP":l=t.dateTime({width:"medium"});break;case"PPP":l=t.dateTime({width:"long"});break;case"PPPP":default:l=t.dateTime({width:"full"});break}return l.replace("{{date}}",Qb(n,t)).replace("{{time}}",hN(s,t))},mU={p:hN,P:hU},pU=/^D+$/,xU=/^Y+$/,gU=["D","DD","YY","YYYY"];function yU(e){return pU.test(e)}function vU(e){return xU.test(e)}function bU(e,t,r){const n=wU(e,t,r);if(console.warn(n),gU.includes(e))throw new RangeError(n)}function wU(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const SU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,NU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,TU=/^'([^]*?)'?$/,EU=/''/g,_U=/[a-zA-Z]/;function km(e,t,r){var p,g,y,v;const n=Qf(),s=n.locale??lU,l=n.firstWeekContainsDate??((g=(p=n.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,u=n.weekStartsOn??((v=(y=n.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??0,h=Oa(e,r==null?void 0:r.in);if(!AB(h))throw new RangeError("Invalid time value");let m=t.match(NU).map(S=>{const N=S[0];if(N==="p"||N==="P"){const w=mU[N];return w(S,s.formatLong)}return S}).join("").match(SU).map(S=>{if(S==="''")return{isToken:!1,value:"'"};const N=S[0];if(N==="'")return{isToken:!1,value:CU(S)};if(Wb[N])return{isToken:!0,value:S};if(N.match(_U))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:S}});s.localize.preprocessor&&(m=s.localize.preprocessor(h,m));const f={firstWeekContainsDate:l,weekStartsOn:u,locale:s};return m.map(S=>{if(!S.isToken)return S.value;const N=S.value;(vU(N)||yU(N))&&bU(N,t,String(e));const w=Wb[N[0]];return w(h,N,s.localize,f)}).join("")}function CU(e){const t=e.match(TU);return t?t[1].replace(EU,"'"):e}const Bd=()=>localStorage.getItem("token"),AU=()=>{const{user:e}=Tr(),[t,r]=k.useState(localStorage.getItem("token")),[n,s]=k.useState([]),[l,u]=k.useState([]),[h,m]=k.useState(!0),[f,p]=k.useState(!1),[g,y]=k.useState(!1),[v,S]=k.useState(null),[N,w]=k.useState(!1),[E,C]=k.useState("");k.useEffect(()=>{const W=Bd();r(W),W||ze.error("No authentication token found. Please try logging out and back in.")},[]);const[T,O]=k.useState({title:"",description:"",taskType:"Exam",customer:"",examDate:"",examTime:"",manualCustomerName:"",manualCustomerEmail:"",manualCustomerPhone:"",manualCustomerCourse:""}),j=async()=>{try{if(m(!0),!Bd()){ze.error("Authentication token missing. Please log in again."),m(!1);return}const F=await hc.getAll();if(F.data&&F.data.data){console.log("Tasks loaded:",F.data.data);const Z=F.data.data.map(oe=>{if(!oe.customer||typeof oe.customer=="string"){console.log("Task has unpopulated customer:",oe);const le=l.find(R=>R._id===oe.customer);le&&(oe.customer=le)}return oe});s(Z)}else s([]),console.log("No tasks found in response")}catch(W){console.error("Error fetching tasks:",W),W.response&&W.response.status===401?ze.error("Authentication failed. Please log in again."):ze.error("Failed to fetch tasks: "+(W.message||"Unknown error")),s([])}finally{m(!1)}},q=async()=>{var W,F,Z;p(!0);try{if(!Bd()){ze.error("Authentication token missing. Please log in again."),p(!1);return}const le=await Fn.getAllCustomers();let R=[];if((W=le.data)!=null&&W.data&&Array.isArray(le.data.data)?R=le.data.data:(F=le.data)!=null&&F.leads&&Array.isArray(le.data.leads)?R=le.data.leads:Array.isArray(le.data)&&(R=le.data),R.length>0){u(R);const ne=R.filter(H=>!H.isReferenceSale).length,P=R.filter(H=>H.isReferenceSale).length;ne===0&&P===0&&ze.info("No customer data available")}}catch(oe){oe.response?oe.response.status===401?ze.error("Authentication failed. Your session may have expired."):ze.error("Could not fetch customer data: "+(((Z=oe.response.data)==null?void 0:Z.message)||"Server error")):oe.request?ze.error("No response from server. Check your connection."):ze.error("Error: "+oe.message)}finally{p(!1)}};k.useEffect(()=>{t&&(j(),q())},[t]);const D=W=>{const{name:F,value:Z}=W.target;O(oe=>({...oe,[F]:Z}))},U=async W=>{var F,Z;W.preventDefault();try{if(N){if(!T.manualCustomerName){ze.error("Please enter customer name");return}if(!T.manualCustomerPhone){ze.error("Please enter customer phone number");return}if(!T.manualCustomerCourse){ze.error("Please enter course/exam name");return}}else if(!T.customer){ze.error("Please select a customer");return}const oe=new Date(`${T.examDate}T${T.examTime}`);let le={title:T.title,description:T.description,taskType:T.taskType,examDate:oe};N?le.manualCustomer={name:T.manualCustomerName,email:T.manualCustomerEmail,contactNumber:T.manualCustomerPhone,course:T.manualCustomerCourse}:le.customer=T.customer;let R;v?R=await hc.update(v._id,le):R=await hc.create(le),R.data.success?(ze.success(v?"Task updated successfully":"Task created successfully"),J(),j()):ze.error(R.data.message||"Error saving task")}catch(oe){oe.response?oe.response.status===401?ze.error("Authentication failed. Please log out and log back in."):ze.error(((Z=(F=oe.response)==null?void 0:F.data)==null?void 0:Z.message)||"Failed to save task"):ze.error("Network error - could not connect to server")}},K=W=>{var ne;console.log("Editing task:",W);const F=km(new Date(W.examDate),"yyyy-MM-dd"),Z=km(new Date(W.examDate),"HH:mm"),oe=((ne=W.customer)==null?void 0:ne.isManualEntry)||!W.customer&&W.manualCustomer;let le="";!oe&&W.customer&&(typeof W.customer=="string"?le=W.customer:W.customer._id&&W.customer._id!=="manual"&&(le=W.customer._id)),w(oe);const R=oe?W.manualCustomer||W.customer:null;O({title:W.title,description:W.description,taskType:W.taskType||"Exam",customer:le,examDate:F,examTime:Z,manualCustomerName:(R==null?void 0:R.name)||"",manualCustomerEmail:(R==null?void 0:R.email)||"",manualCustomerPhone:(R==null?void 0:R.contactNumber)||"",manualCustomerCourse:(R==null?void 0:R.course)||""}),S(W),y(!0),!oe&&!le&&ze.warning("Customer data may be incomplete. Please select a customer again.")},ie=async W=>{var F;if(window.confirm("Are you sure you want to delete this task?"))try{const Z=await hc.delete(W);Z.data&&Z.data.success?(ze.success("Task deleted successfully"),j()):ze.error(((F=Z.data)==null?void 0:F.message)||"Failed to delete task")}catch(Z){Z.response&&Z.response.status===401?ze.error("Authentication failed. Please log in again."):ze.error("Failed to delete task")}},te=async(W,F)=>{var Z;try{const oe=await hc.updateStatus(W,F);oe.data&&oe.data.success?(ze.success("Task status updated"),j()):ze.error(((Z=oe.data)==null?void 0:Z.message)||"Failed to update task status")}catch(oe){oe.response&&oe.response.status===401?ze.error("Authentication failed. Please log in again."):ze.error("Failed to update task status")}},G=W=>{const F=new Date(W);return km(F,"MMM dd, yyyy 'at' h:mm a")},de=W=>{if(!W)return"No Name";if(console.log("Getting name for lead:",W),typeof W=="string")return`Customer (ID: ${W.substring(0,6)}...)`;if(!Object.keys(W).length)return"Unknown Customer";let F="";const Z=["name","NAME","customerName","fullName"];for(const le of Z)if(W[le]&&typeof W[le]=="string"&&W[le].trim()!==""){F=W[le];break}if(!F){const le=Object.keys(W).filter(R=>R.toLowerCase().includes("name")&&W[R]&&typeof W[R]=="string"&&W[R].trim()!=="");le.length>0&&(F=W[le[0]])}if((!F||F==="Unnamed Customer")&&(W.course||W.COURSE?F=`Student for ${W.course||W.COURSE}`:W._id?F=`Customer ${W._id.substring(0,6)}...`:F="Unnamed Customer"),W.isReferenceSale)return`${F} [Reference]`;const oe=W.course||W.COURSE;return oe&&!F.includes(oe)?`${F} (${oe})`:F},J=()=>{O({title:"",description:"",taskType:"Exam",customer:"",examDate:"",examTime:"",manualCustomerName:"",manualCustomerEmail:"",manualCustomerPhone:"",manualCustomerCourse:""}),S(null),w(!1),C("")};return o.jsx(jr,{children:o.jsx("div",{className:"bg-gray-50 min-h-screen py-4 md:py-8",children:o.jsxs("div",{className:"container mx-auto px-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-3",children:[o.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"Task Management"}),o.jsx("div",{className:"flex gap-2",children:o.jsx("button",{onClick:()=>{J(),y(!0)},className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm sm:text-base",children:"Schedule New Exam"})})]}),!Bd()&&o.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-700 border border-red-200 rounded-md text-sm",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:"Authentication Error"}),o.jsx("p",{className:"text-sm",children:"No authentication token found. Please log out and log back in to refresh your session."}),o.jsx("button",{onClick:()=>window.location.href="/login",className:"mt-2 px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700",children:"Go to Login"})]})]})}),h?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"}),o.jsx("p",{className:"mt-2 text-gray-600",children:"Loading tasks..."})]}):n.length===0?o.jsxs("div",{className:"bg-white p-4 sm:p-8 rounded-md shadow text-center",children:[o.jsx("p",{className:"text-gray-600",children:"No tasks scheduled yet."}),o.jsx("p",{className:"mt-2 text-sm text-gray-500",children:'Click "Schedule New Exam" to create your first task.'})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:n.map(W=>o.jsxs("div",{className:`bg-white rounded-lg shadow p-4 border-l-4 ${W.completed?"border-green-500":new Date(W.examDate)<new Date?"border-red-500":"border-blue-500"}`,children:[o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsx("h3",{className:"font-bold text-base sm:text-lg mb-2",children:W.title}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:()=>K(W),className:"p-1 text-blue-600 hover:text-blue-800",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),o.jsx("button",{onClick:()=>ie(W._id),className:"p-1 text-red-600 hover:text-red-800",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-3",children:W.description}),o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex items-center mb-1",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-700",children:de(W.customer)})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),o.jsx("p",{className:"text-xs sm:text-sm text-gray-700",children:G(W.examDate)})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 pt-3 border-t border-gray-100 gap-2",children:[o.jsx("span",{className:`text-xs px-2 py-1 rounded mb-2 sm:mb-0 ${W.completed?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:W.completed?"Completed":"Pending"}),o.jsx("button",{onClick:()=>te(W._id,!W.completed),className:`text-xs w-full sm:w-auto px-3 py-1 rounded-full ${W.completed?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:W.completed?"Mark Incomplete":"Mark Complete"})]})]},W._id))}),g&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-md my-8",children:[o.jsx("div",{className:"p-4 sm:p-5 border-b border-gray-200",children:o.jsx("h3",{className:"font-bold text-base sm:text-lg",children:v?"Edit Task":"Schedule New Exam"})}),o.jsxs("form",{onSubmit:U,className:"p-4 sm:p-5",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-gray-700 text-xs sm:text-sm font-medium mb-2",children:"Title"}),o.jsx("input",{type:"text",name:"title",value:T.title,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Exam Title",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-gray-700 text-xs sm:text-sm font-medium mb-2",children:"Description"}),o.jsx("textarea",{name:"description",value:T.description,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Exam details",rows:"3"})]}),o.jsxs("div",{className:"mb-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("label",{className:"block text-gray-700 text-xs sm:text-sm font-medium",children:"Customer"}),o.jsxs("div",{className:"flex items-center",children:[o.jsx("span",{className:"text-xs text-gray-600 mr-2",children:"Manual Entry"}),o.jsx("button",{type:"button",onClick:()=>w(!N),className:`relative inline-flex h-5 w-10 items-center rounded-full transition-colors focus:outline-none ${N?"bg-blue-600":"bg-gray-200"}`,children:o.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${N?"translate-x-5":"translate-x-1"}`})})]})]}),N?o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{children:o.jsx("input",{type:"text",name:"manualCustomerName",value:T.manualCustomerName,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Customer Name *",required:!0})}),o.jsx("div",{children:o.jsx("input",{type:"email",name:"manualCustomerEmail",value:T.manualCustomerEmail,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Email Address"})}),o.jsx("div",{children:o.jsx("input",{type:"tel",name:"manualCustomerPhone",value:T.manualCustomerPhone,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Phone Number *",required:!0})}),o.jsx("div",{children:o.jsx("input",{type:"text",name:"manualCustomerCourse",value:T.manualCustomerCourse,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Course/Exam Name *",required:!0})})]}):o.jsxs("div",{children:[o.jsx("div",{className:"mb-2",children:o.jsxs("div",{className:"relative",children:[o.jsx("input",{type:"text",placeholder:"Search leads by name, email, or course...",value:E,onChange:W=>C(W.target.value),className:"w-full px-3 py-2 pl-9 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm"}),o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]})}),o.jsxs("select",{name:"customer",value:T.customer,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",required:!0,children:[o.jsx("option",{value:"",children:"Select Customer"}),(()=>{const W=l.filter(oe=>{if(!E)return!0;const le=E.toLowerCase(),R=(oe.name||oe.NAME||"").toLowerCase(),ne=(oe.email||oe.EMAIL||oe["E-MAIL"]||"").toLowerCase(),P=(oe.course||oe.COURSE||"").toLowerCase(),H=(oe.contactNumber||oe.phone||oe.MOBILE||oe.NUMBER||"").toLowerCase();return R.includes(le)||ne.includes(le)||P.includes(le)||H.includes(le)}),F=W.filter(oe=>!oe.isReferenceSale),Z=W.filter(oe=>oe.isReferenceSale);return o.jsxs(o.Fragment,{children:[F.length>0&&o.jsx("optgroup",{label:`Leads (${F.length})`,children:F.map(oe=>o.jsxs("option",{value:oe._id,children:[oe.name||oe.NAME||"Unknown"," - ",oe.course||oe.COURSE||"No course",oe.status?` (${oe.status})`:""]},oe._id))}),Z.length>0&&o.jsx("optgroup",{label:`Reference Customers (${Z.length})`,children:Z.map(oe=>o.jsxs("option",{value:oe._id,children:[oe.name||"Unknown"," - ",oe.course||"No course",oe.status?` (${oe.status})`:""," [Reference]"]},oe._id))}),W.length===0&&o.jsx("option",{disabled:!0,value:"",children:"No leads match your search"})]})})()]}),f?o.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Loading customers..."}):o.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:[l.filter(W=>!W.isReferenceSale).length," leads +",l.filter(W=>W.isReferenceSale).length," reference customers available",E&&o.jsx("button",{type:"button",onClick:()=>C(""),className:"ml-2 text-blue-600 hover:text-blue-800",children:"Clear search"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-gray-700 text-xs sm:text-sm font-medium mb-2",children:"Exam Date"}),o.jsx("input",{type:"date",name:"examDate",value:T.examDate,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-gray-700 text-xs sm:text-sm font-medium mb-2",children:"Exam Time"}),o.jsx("input",{type:"time",name:"examTime",value:T.examTime,onChange:D,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm",required:!0})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-end sm:space-x-3 mt-6 space-y-2 sm:space-y-0",children:[o.jsx("button",{type:"button",onClick:()=>y(!1),className:"w-full sm:w-auto px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300 text-sm order-2 sm:order-1",children:"Cancel"}),o.jsx("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm order-1 sm:order-2",children:v?"Update Task":"Create Task"})]})]})]})})]})})})},jU=()=>{const{user:e}=Tr(),[t,r]=k.useState([]),[n,s]=k.useState({totalRepeatCustomers:0,totalLeads:0,averageCoursesPerCustomer:0}),[l,u]=k.useState(!0),[h,m]=k.useState(null),[f,p]=k.useState(null);k.useEffect(()=>{g()},[]);const g=async()=>{try{u(!0);const S=await Fn.getRepeatCustomers();S.data.success?(r(S.data.data),s(S.data.stats),m(null)):m("Failed to load repeat customer data")}catch(S){console.error("Error fetching repeat customers:",S),m("Failed to load repeat customer data. Please try again.")}finally{u(!1)}},y=S=>new Date(S).toLocaleDateString(),v=S=>{p(f===S?null:S)};return o.jsx(jr,{children:o.jsxs("div",{className:"container mx-auto px-4 py-8",children:[o.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Repeat Customers"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Repeat Customers"}),o.jsx("p",{className:"text-3xl font-bold text-blue-600",children:n.totalRepeatCustomers})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Courses Purchased"}),o.jsx("p",{className:"text-3xl font-bold text-green-600",children:n.totalLeads})]}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[o.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Avg. Courses per Customer"}),o.jsx("p",{className:"text-3xl font-bold text-purple-600",children:n.averageCoursesPerCustomer})]})]}),h&&o.jsx("div",{className:"mb-4 p-4 bg-red-50 text-red-700 border border-red-200 rounded-md",children:h}),l?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):o.jsx(o.Fragment,{children:t.length===0?o.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md text-center",children:o.jsx("p",{className:"text-gray-500",children:"No repeat customers found."})}):o.jsx("div",{className:"space-y-4",children:t.map((S,N)=>o.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[o.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center cursor-pointer hover:bg-gray-100",onClick:()=>v(N),children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium",children:S.customerInfo.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:[S.customerInfo.email&&o.jsx("span",{className:"mr-3",children:S.customerInfo.email}),S.customerInfo.phone&&o.jsxs("span",{children:[S.customerInfo.countryCode," ",S.customerInfo.phone]})]})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800 mr-3",children:[S.leads.length," courses"]}),o.jsx("svg",{className:`h-5 w-5 text-gray-500 transform ${f===N?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]}),f===N&&o.jsxs("div",{className:"p-4",children:[o.jsx("h4",{className:"text-md font-medium mb-2",children:"Course History"}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sales Person"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.leads.map((w,E)=>o.jsxs("tr",{className:"hover:bg-gray-50",children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:w.course}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y(w.createdAt)}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:w.salesPerson})]},E))})]})})]})]},N))})})]})})};function DU({children:e,className:t=""}){return o.jsx("div",{className:`bg-white border border-gray-200 rounded-xl shadow-sm ${t}`,children:e})}function kU({children:e,className:t=""}){return o.jsx("div",{className:`p-4 ${t}`,children:e})}/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OU=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),RU=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),Zb=e=>{const t=RU(e);return t.charAt(0).toUpperCase()+t.slice(1)},mN=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),MU=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var FU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LU=k.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:l,iconNode:u,...h},m)=>k.createElement("svg",{ref:m,...FU,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:mN("lucide",s),...!l&&!MU(h)&&{"aria-hidden":"true"},...h},[...u.map(([f,p])=>k.createElement(f,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pN=(e,t)=>{const r=k.forwardRef(({className:n,...s},l)=>k.createElement(LU,{ref:l,iconNode:t,className:mN(`lucide-${OU(Zb(e))}`,`lucide-${e}`,n),...s}));return r.displayName=Zb(e),r};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PU=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],BU=pN("ban",PU);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UU=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],IU=pN("circle-check-big",UU),zU=[{name:"United States",code:"US",status:"allowed"},{name:"United Kingdom",code:"UK",status:"allowed"},{name:"France",code:"FR",status:"allowed"},{name:"Italy",code:"IT",status:"allowed"},{name:"Spain",code:"ES",status:"allowed"},{name:"Portugal",code:"PT",status:"allowed"},{name:"Greece",code:"GR",status:"allowed"},{name:"Brazil",code:"BR",status:"allowed"},{name:"Argentina",code:"AR",status:"allowed"},{name:"Chile",code:"CL",status:"allowed"},{name:"Mexico",code:"MX",status:"allowed"},{name:"Colombia",code:"CO",status:"allowed"},{name:"Peru",code:"PE",status:"allowed"},{name:"Venezuela",code:"VE",status:"allowed"},{name:"Ecuador",code:"EC",status:"allowed"},{name:"Bolivia",code:"BO",status:"allowed"},{name:"Paraguay",code:"PY",status:"allowed"},{name:"Uruguay",code:"UY",status:"allowed"},{name:"Saudi Arabia",code:"SA",status:"allowed"},{name:"United Arab Emirates",code:"AE",status:"allowed"},{name:"Qatar",code:"QA",status:"allowed"},{name:"Kuwait",code:"KW",status:"allowed"},{name:"Bahrain",code:"BH",status:"allowed"},{name:"Oman",code:"OM",status:"allowed"},{name:"Jordan",code:"JO",status:"allowed"},{name:"Canada",code:"CA",status:"allowed"},{name:"Ukraine",code:"UA",status:"allowed"},{name:"Switzerland",code:"CH",status:"allowed"},{name:"Singapore",code:"SG",status:"allowed"},{name:"Romania",code:"RO",status:"allowed"},{name:"Netherlands",code:"NL",status:"allowed"},{name:"New Zealand",code:"NZ",status:"allowed"},{name:"Pakistan",code:"PK",status:"blocked"},{name:"Sri Lanka",code:"LK",status:"blocked"},{name:"Nepal",code:"NP",status:"blocked"},{name:"China",code:"CN",status:"blocked"},{name:"Hong Kong",code:"HK",status:"blocked"},{name:"Russia",code:"RU",status:"blocked"},{name:"Philippines",code:"PH",status:"blocked"},{name:"Japan",code:"JP",status:"blocked"},{name:"Vietnam",code:"VN",status:"blocked"},{name:"Bangladesh",code:"BD",status:"blocked"},{name:"Afghanistan",code:"AF",status:"blocked"},{name:"Tajikistan",code:"TJ",status:"blocked"},{name:"Kazakhstan",code:"KZ",status:"blocked"},{name:"Kyrgyzstan",code:"KG",status:"blocked"},{name:"Turkmenistan",code:"TM",status:"blocked"},{name:"Papua New Guinea",code:"PG",status:"blocked"},{name:"Myanmar",code:"MM",status:"blocked"},{name:"Indonesia",code:"ID",status:"blocked"},{name:"Iran",code:"IR",status:"blocked"},{name:"Iraq",code:"IQ",status:"blocked"},{name:"Israel",code:"IL",status:"blocked"},{name:"Lebanon",code:"LB",status:"blocked"},{name:"Palestine",code:"PS",status:"blocked"},{name:"Syria",code:"SY",status:"blocked"},{name:"Turkey",code:"TR",status:"blocked"},{name:"Yemen",code:"YE",status:"blocked"},{name:"Zimbabwe",code:"ZW",status:"blocked"}],VU=()=>{const[e,t]=k.useState("all"),r=zU.filter(n=>e==="all"?!0:n.status===e);return o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsx("h1",{className:"text-3xl font-bold",children:"Lead Geo-Permission Matrix "}),o.jsxs("div",{className:"flex gap-4",children:[o.jsx("button",{className:`px-4 py-2 rounded-xl ${e==="all"?"bg-blue-600 text-white":"bg-gray-200"}`,onClick:()=>t("all"),children:"All"}),o.jsx("button",{className:`px-4 py-2 rounded-xl ${e==="allowed"?"bg-green-600 text-white":"bg-gray-200"}`,onClick:()=>t("allowed"),children:"Allowed "}),o.jsx("button",{className:`px-4 py-2 rounded-xl ${e==="blocked"?"bg-red-600 text-white":"bg-gray-200"}`,onClick:()=>t("blocked"),children:"Blocked "})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(n=>o.jsx(DU,{className:"rounded-2xl shadow-md",children:o.jsxs(kU,{className:"p-4 flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold",children:n.name}),o.jsxs("p",{className:"text-sm text-gray-500",children:["Code: ",n.code]})]}),n.status==="allowed"?o.jsx(IU,{className:"text-green-500 w-6 h-6"}):o.jsx(BU,{className:"text-red-500 w-6 h-6"})]})},n.code))})]})},HU=()=>{const e=[{id:1,name:"Parichay Singh",position:"CEO & Founder",email:"sales@traincapetech.info",phone:"+91 6280281505",linkedin:"https://www.linkedin.com/in/parichay-singh-rana?lipi=urn%3Ali%3Apage%3Ad_flagship3_profile_view_base_contact_details%3B%2BLVd4W1EQj2KhxGQFwlQuQ%3D%3D",image:"https://i.pravatar.cc/300?img=11",icon:o.jsx(JA,{className:"text-3xl text-blue-700"})},{id:2,name:"Shivam Singh",position:"Operations Manager",email:"shivam@traincapetech.in",phone:"+91 9354364160",image:"https://i.pravatar.cc/300?img=13",icon:o.jsx(Pv,{className:"text-3xl text-green-600"})},{id:3,name:"Saurav Kumar",position:"Technical Lead",email:"saurav@traincapetech.in",phone:"+62 852-8223-3601",image:"https://i.pravatar.cc/300?img=12",icon:o.jsx($A,{className:"text-3xl text-purple-600"})}];return o.jsxs(jr,{children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 py-10",children:o.jsxs("div",{className:"container mx-auto px-4 text-center text-white",children:[o.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:"Management Contacts"}),o.jsx("p",{className:"text-lg max-w-2xl mx-auto",children:"Meet our leadership team at TrainCape Technology. Reach out to us directly for any questions or inquiries."})]})}),o.jsxs("div",{className:"container mx-auto px-4 py-12",children:[o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:e.map(t=>o.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden transform transition-transform hover:-translate-y-1 hover:shadow-xl",children:[o.jsx("div",{className:"bg-gray-100 p-6 flex justify-center",children:t.image?o.jsx("img",{src:t.image,alt:t.name,className:"h-32 w-32 rounded-full object-cover border-4 border-white shadow-md"}):o.jsx("div",{className:"h-32 w-32 rounded-full bg-blue-100 flex items-center justify-center",children:t.icon||o.jsx(Pv,{className:"text-4xl text-blue-600"})})}),o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-xl font-bold text-gray-800",children:t.name}),o.jsx("p",{className:"text-blue-600 font-medium mb-4",children:t.position}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(tf,{className:"text-blue-600 mr-3"}),o.jsx("a",{href:`mailto:${t.email}`,className:"text-gray-700 hover:text-blue-600 transition",children:t.email})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(QA,{className:"text-blue-600 mr-3"}),o.jsx("a",{href:`tel:${t.phone}`,className:"text-gray-700 hover:text-blue-600 transition",children:t.phone})]}),o.jsxs("div",{className:"flex items-center",children:[o.jsx(YA,{className:"text-blue-600 mr-3"}),o.jsx("a",{href:t.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-blue-600 transition",children:"LinkedIn Profile"})]})]})]})]},t.id))}),o.jsxs("div",{className:"mt-16 bg-white rounded-lg shadow-lg p-8",children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"General Contact Information"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-3",children:"Main Office"}),o.jsx("p",{className:"text-gray-600 mb-1",children:"123 Tech Boulevard"}),o.jsx("p",{className:"text-gray-600 mb-1",children:"Suite 456"}),o.jsx("p",{className:"text-gray-600 mb-1",children:"San Francisco, CA 94105"}),o.jsx("p",{className:"text-gray-600",children:"United States"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-3",children:"Contact Details"}),o.jsxs("p",{className:"text-gray-600 mb-1",children:[o.jsx("span",{className:"font-medium",children:"General Inquiries:"})," info@traincapetech.com"]}),o.jsxs("p",{className:"text-gray-600 mb-1",children:[o.jsx("span",{className:"font-medium",children:"Customer Support:"})," support@traincapetech.com"]}),o.jsxs("p",{className:"text-gray-600 mb-1",children:[o.jsx("span",{className:"font-medium",children:"Phone:"})," +1 (123) 456-7800"]}),o.jsxs("p",{className:"text-gray-600",children:[o.jsx("span",{className:"font-medium",children:"Working Hours:"})," Monday-Friday, 9AM-6PM PST"]})]})]}),o.jsxs("div",{className:"mt-8",children:[o.jsx("h3",{className:"text-lg font-bold text-gray-700 mb-3",children:"Send Us a Message"}),o.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4",children:o.jsx("p",{className:"text-blue-700",children:"For any questions or inquiries, please feel free to reach out to our team through the contact information provided above. We strive to respond to all messages within 24 business hours."})})]})]})]})]})},Om={generateContent:(e,t={})=>(console.log("Calling geminiAPI.generateContent() with prompt:",e),ht.post("/api/gemini/generate",{prompt:e,options:t})),generateContentWithImage:(e,t)=>(console.log("Calling geminiAPI.generateContentWithImage()"),ht.post("/api/gemini/generate-with-image",{prompt:e,imageData:t})),chatWithGemini:e=>(console.log("Calling geminiAPI.chatWithGemini() with messages:",e.length),ht.post("/api/gemini/chat",{messages:e}))},xN=({isFloating:e=!1})=>{const[t,r]=k.useState(""),[n,s]=k.useState(""),[l,u]=k.useState(!1),[h,m]=k.useState([]),[f,p]=k.useState(!1),g=k.useRef(null),[y,v]=k.useState(null),[S,N]=k.useState(null),w=async j=>{var q,D;if(j.preventDefault(),!t.trim()){Ot.error("Please enter a prompt");return}u(!0),s("");try{let U;if(f){const K=[...h,{role:"user",parts:t}];m(K),U=await Om.chatWithGemini(K),m([...K,{role:"model",parts:U.data.data}])}else y?U=await Om.generateContentWithImage(t,y):U=await Om.generateContent(t);s(U.data.data)}catch(U){console.error("Error generating content:",U),Ot.error(((D=(q=U.response)==null?void 0:q.data)==null?void 0:D.error)||"Failed to generate content")}finally{u(!1)}},E=j=>{const q=j.target.files[0];if(!q)return;if(q.size>10*1024*1024){Ot.error("Image size should be less than 10MB");return}const D=new FileReader;D.onload=()=>{N(D.result);const U=D.result.split(",")[1];v(U)},D.readAsDataURL(q)},C=()=>{v(null),N(null),g.current&&(g.current.value="")},T=()=>{p(!f),m([]),s("")},O=()=>{m([]),s("")};return o.jsxs("div",{className:`${e?"":"p-4 bg-white rounded-lg shadow-md"}`,children:[!e&&o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Gemini AI Assistant"}),o.jsxs("div",{className:"mb-4",children:[o.jsx("button",{onClick:T,className:`mr-2 px-4 py-2 rounded ${f?"bg-blue-600 text-white":"bg-gray-200"} ${e?"text-sm px-2 py-1":""}`,children:"Chat Mode"}),o.jsx("button",{onClick:T,className:`px-4 py-2 rounded ${f?"bg-gray-200":"bg-blue-600 text-white"} ${e?"text-sm px-2 py-1":""}`,disabled:y&&!f,children:"Single Prompt Mode"})]}),f&&o.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-lg max-h-96 overflow-y-auto",children:[h.length===0?o.jsx("p",{className:"text-gray-500",children:"Start a conversation with Gemini..."}):h.map((j,q)=>o.jsxs("div",{className:`mb-3 p-3 rounded-lg ${j.role==="user"?"bg-blue-100 ml-12":"bg-gray-200 mr-12"}`,children:[o.jsx("p",{className:"text-sm font-semibold mb-1",children:j.role==="user"?"You":"Gemini"}),o.jsx("p",{children:j.parts})]},q)),h.length>0&&o.jsx("button",{onClick:O,className:"text-sm text-red-600 hover:underline",children:"Clear Chat History"})]}),!f&&!y&&o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"image-upload",className:"block text-sm font-medium text-gray-700 mb-2",children:"Add an image (optional)"}),o.jsx("input",{id:"image-upload",type:"file",accept:"image/*",onChange:E,ref:g,className:`block w-full text-sm text-gray-500
                      file:mr-4 file:py-2 file:px-4
                      file:rounded-full file:border-0
                      file:text-sm file:font-semibold
                      file:bg-blue-50 file:text-blue-700
                      hover:file:bg-blue-100`})]}),S&&o.jsxs("div",{className:"mb-4 relative",children:[o.jsx("img",{src:S,alt:"Preview",className:"w-full max-h-64 object-contain rounded-lg"}),o.jsx("button",{onClick:C,className:"absolute top-2 right-2 bg-red-600 text-white rounded-full p-1","aria-label":"Remove image",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),o.jsxs("form",{onSubmit:w,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{htmlFor:"prompt",className:"block text-sm font-medium text-gray-700 mb-2",children:f?"Your Message":"Prompt"}),o.jsx("textarea",{id:"prompt",rows:"4",value:t,onChange:j=>r(j.target.value),placeholder:f?"Type your message here...":"Enter your prompt for Gemini...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),o.jsx("button",{type:"submit",disabled:l,className:"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-blue-300",children:l?"Processing...":f?"Send Message":y?"Analyze Image & Text":"Generate Content"})]}),!f&&n&&o.jsxs("div",{className:"mt-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Gemini Response:"}),o.jsx("div",{className:"p-4 bg-gray-50 rounded-lg whitespace-pre-wrap",children:n})]})]})},YU=()=>o.jsxs("div",{className:"container mx-auto py-8 px-4",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold mb-2",children:"AI Assistant"}),o.jsx("p",{className:"text-gray-600",children:"Get help with customer inquiries, generate content, analyze images, and more using Google's Gemini AI."})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[o.jsx("div",{children:o.jsx(xN,{})}),o.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4",children:"How Gemini AI Can Help You"}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Customer Support"}),o.jsx("p",{className:"text-gray-600",children:"Draft personalized responses to customer inquiries, create follow-up emails, and generate helpful content."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Content Creation"}),o.jsx("p",{className:"text-gray-600",children:"Generate product descriptions, marketing copy, social media posts, and other content for your business."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Data Analysis"}),o.jsx("p",{className:"text-gray-600",children:"Ask questions about your business data and get AI-powered insights and recommendations."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Image Analysis"}),o.jsx("p",{className:"text-gray-600",children:"Upload images for analysis, description, or to extract information contained in visuals."})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Conversation Mode"}),o.jsx("p",{className:"text-gray-600",children:"Have a multi-turn conversation with the AI to refine ideas or explore complex topics in depth."})]})]}),o.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-100",children:[o.jsx("h3",{className:"text-lg font-semibold text-blue-800",children:"Pro Tips"}),o.jsxs("ul",{className:"list-disc list-inside text-blue-700 space-y-2 mt-2",children:[o.jsx("li",{children:"Be specific in your prompts for better results"}),o.jsx("li",{children:"For image analysis, use clear, high-quality images"}),o.jsx("li",{children:"In chat mode, you can reference previous messages"}),o.jsx("li",{children:"Try different ways of asking to get varied responses"}),o.jsx("li",{children:"Save useful responses for future reference"})]})]})]})]})]}),GU=()=>{const{user:e}=Tr(),[t,r]=k.useState([]),[n,s]=k.useState(!0),[l,u]=k.useState(null),[h,m]=k.useState(!1),[f,p]=k.useState(null),[g,y]=k.useState({fullName:"",email:"",password:"",role:"Sales Person"}),v=(e==null?void 0:e.role)==="Admin";k.useEffect(()=>{S()},[]);const S=async()=>{try{s(!0);const O=await fr.getUsers();O.data.success?r(O.data.data):u("Failed to load users")}catch(O){console.error("Error fetching users:",O),u("Failed to load users. Please try again.")}finally{s(!1)}},N=O=>{y({...g,[O.target.name]:O.target.value})},w=async O=>{var j,q;if(O.preventDefault(),!v&&(g.role==="Admin"||f&&f.role==="Admin")){Hr.error("Only Admins can manage Admin accounts");return}s(!0);try{let D;if(f){const U={...g};U.password||delete U.password,D=await fr.updateUser(f._id,U),Hr.success("User updated successfully")}else D=await fr.register(g),Hr.success("User created successfully");m(!1),T(),S()}catch(D){console.error("Error with user:",D),Hr.error(((q=(j=D.response)==null?void 0:j.data)==null?void 0:q.message)||"Failed to process user")}finally{s(!1)}},E=async O=>{const j=t.find(q=>q._id===O);if(!v&&j.role==="Admin"){Hr.error("Only Admins can delete Admin accounts");return}if(window.confirm("Are you sure you want to delete this user?"))try{s(!0),await fr.deleteUser(O),Hr.success("User deleted successfully"),S()}catch(q){console.error("Error deleting user:",q),Hr.error("Failed to delete user")}finally{s(!1)}},C=O=>{if(!v&&O.role==="Admin"){Hr.error("Only Admins can edit Admin accounts");return}p(O),y({fullName:O.fullName,email:O.email,password:"",role:O.role}),m(!0)},T=()=>{y({fullName:"",email:"",password:"",role:"Sales Person"}),p(null)};return o.jsxs(jr,{children:[o.jsxs("div",{className:"container mx-auto p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-6",children:[o.jsx("h1",{className:"text-2xl font-bold",children:"Manager Dashboard"}),o.jsxs("button",{onClick:()=>{T(),m(!0)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[o.jsx(Op,{className:"mr-2"})," Add New User"]})]}),o.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 mb-6",children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"User Management"}),!v&&o.jsxs("div",{className:"bg-yellow-50 border border-yellow-400 text-yellow-700 px-4 py-3 rounded relative mb-4",children:[o.jsx("strong",{children:"Note:"})," As a Manager, you cannot modify Admin accounts."]}),n&&!h?o.jsx("div",{className:"flex justify-center items-center h-32",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):l?o.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:l}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500",children:"No users found"})}):t.map(O=>o.jsxs("tr",{className:`hover:bg-gray-50 ${!v&&O.role==="Admin"?"bg-gray-50":""}`,children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.fullName}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:O.email}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:o.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                            ${O.role==="Admin"?"bg-purple-100 text-purple-800":O.role==="Manager"?"bg-blue-100 text-blue-800":O.role==="Lead Person"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:O.role})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.jsx("div",{className:"flex space-x-3",children:!v&&O.role==="Admin"?o.jsx("span",{className:"text-gray-400",title:"Admin users can only be managed by other Admins",children:o.jsx(KA,{className:"h-5 w-5"})}):o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>C(O),className:"text-indigo-600 hover:text-indigo-900",title:"Edit user",children:o.jsx(nu,{className:"h-5 w-5"})}),o.jsx("button",{onClick:()=>E(O._id),className:"text-red-600 hover:text-red-900",title:"Delete user",children:o.jsx(Rp,{className:"h-5 w-5"})})]})})})]},O._id))})]})})]})]}),h&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h2",{className:"text-xl font-semibold",children:f?"Edit User":"Add New User"}),o.jsx("button",{onClick:()=>m(!1),className:"text-gray-500 hover:text-gray-700",children:o.jsx(rf,{className:"h-5 w-5"})})]}),o.jsxs("form",{onSubmit:w,children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),o.jsx("input",{type:"text",name:"fullName",value:g.fullName,onChange:N,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),o.jsx("input",{type:"email",name:"email",value:g.email,onChange:N,className:"w-full p-2 border border-gray-300 rounded-md",required:!0})]}),o.jsxs("div",{className:"mb-4",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:f?"Password (leave empty to keep current)":"Password"}),o.jsx("input",{type:"password",name:"password",value:g.password,onChange:N,className:"w-full p-2 border border-gray-300 rounded-md",required:!f})]}),o.jsxs("div",{className:"mb-6",children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),o.jsxs("select",{name:"role",value:g.role,onChange:N,className:"w-full p-2 border border-gray-300 rounded-md",disabled:!v&&g.role==="Admin",children:[o.jsx("option",{value:"Sales Person",children:"Sales Person"}),o.jsx("option",{value:"Lead Person",children:"Lead Person"}),o.jsx("option",{value:"Manager",children:"Manager"}),v&&o.jsx("option",{value:"Admin",children:"Admin"})]}),!v&&o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Only Admins can create or modify Admin accounts"})]}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400",children:"Cancel"}),o.jsx("button",{type:"submit",disabled:n||!v&&g.role==="Admin",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300",children:n?"Processing...":f?"Update User":"Add User"})]})]})]})})]})},qU=()=>o.jsxs(x_,{children:[o.jsx(or,{path:"/",element:o.jsx(Ov,{})}),o.jsx(or,{path:"/login",element:o.jsx(DA,{})}),o.jsx(or,{path:"/signup",element:o.jsx(kA,{})}),o.jsx(or,{path:"/debug",element:o.jsx(z5,{})}),o.jsx(or,{path:"/forgot-password",element:o.jsx(jO,{})}),o.jsx(or,{path:"/tutorials",element:o.jsx(wB,{})}),o.jsx(or,{path:"/management-contacts",element:o.jsx(HU,{})}),o.jsx(or,{path:"/countries",element:o.jsx(VU,{})}),o.jsx(or,{path:"/ai-assistant",element:o.jsx(YU,{})}),o.jsx(or,{path:"/manager",element:o.jsx(kn,{allowedRoles:["Manager","Admin"],children:o.jsx(GU,{})})}),o.jsx(or,{path:"/leads",element:o.jsx(kn,{allowedRoles:["Lead Person","Manager","Admin"],children:o.jsx(e6,{})})}),o.jsx(or,{path:"/sales",element:o.jsx(kn,{allowedRoles:["Sales Person","Manager","Admin"],children:o.jsx(t6,{})})}),o.jsx(or,{path:"/sales-tracking",element:o.jsx(kn,{allowedRoles:["Sales Person","Manager","Admin"],children:o.jsx(I6,{})})}),o.jsx(or,{path:"/create-sale",element:o.jsx(kn,{allowedRoles:["Sales Person","Manager","Admin"],children:o.jsx(k5,{})})}),o.jsx(or,{path:"/tasks",element:o.jsx(kn,{allowedRoles:["Sales Person","Lead Person","Manager","Admin"],children:o.jsx(AU,{})})}),o.jsx(or,{path:"/profile",element:o.jsx(kn,{allowedRoles:["Sales Person","Lead Person","Manager","Admin"],children:o.jsx(I5,{})})}),o.jsx(or,{path:"/admin",element:o.jsx(kn,{allowedRoles:["Admin"],children:o.jsx(V5,{})})}),o.jsx(or,{path:"/admin/users",element:o.jsx(kn,{allowedRoles:["Admin"],children:o.jsx(H5,{})})}),o.jsx(or,{path:"/admin/leads",element:o.jsx(kn,{allowedRoles:["Admin"],children:o.jsx(Y5,{})})}),o.jsx(or,{path:"/admin/import",element:o.jsx(kn,{allowedRoles:["Admin"],children:o.jsx(G5,{})})}),o.jsx(or,{path:"/repeat-customers",element:o.jsx(kn,{allowedRoles:["Admin","Manager"],children:o.jsx(jU,{})})}),o.jsx(or,{path:"/lead-sales-sheet",element:o.jsx(kn,{allowedRoles:["Lead Person","Manager","Admin"],children:o.jsx(vB,{})})}),o.jsx(or,{path:"/update-sales",element:o.jsx(kn,{allowedRoles:["Lead Person","Manager","Admin"],children:o.jsx(bB,{})})}),o.jsx(or,{path:"*",element:o.jsx(Ov,{})})]}),$U=()=>{const[e,t]=k.useState(!1),r=ui(),n=()=>{t(!e)},s=()=>{r("/ai-assistant")};return o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:n,className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg z-50 flex items-center justify-center transition-all duration-300 transform hover:scale-105","aria-label":"AI Assistant",children:o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6",children:[o.jsx("path",{d:"M18.53 9.29a1 1 0 00-1.06 0L12 12.34 6.53 9.29a1 1 0 00-1.06 0 1 1 0 00-.47.82v5.78a1 1 0 00.47.82 1 1 0 00.53.15 1 1 0 00.53-.15L12 13.66l5.47 3.05a1 1 0 00.53.15 1 1 0 00.53-.15 1 1 0 00.47-.82v-5.78a1 1 0 00-.47-.82z"}),o.jsx("path",{d:"M18.53 5.11a1 1 0 00-1.06 0L12 8.16 6.53 5.11a1 1 0 00-1.06 0 1 1 0 00-.47.82v1.55a1 1 0 00.47.82 1 1 0 00.53.15 1 1 0 00.53-.15L12 5.26l5.47 3.04a1 1 0 00.53.15 1 1 0 00.53-.15 1 1 0 00.47-.82V5.93a1 1 0 00-.47-.82z"})]})}),e&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[o.jsx("h2",{className:"text-xl font-bold",children:"Gemini AI Assistant"}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx("button",{onClick:s,className:"p-2 text-gray-600 hover:text-gray-900",title:"Open in full page",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),o.jsx("button",{onClick:n,className:"p-2 text-gray-600 hover:text-gray-900",title:"Close",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:o.jsx(xN,{isFloating:!0})})]})})]})},WU=()=>o.jsx(I_,{children:o.jsxs(_A,{children:[o.jsx(qU,{}),o.jsx($U,{}),o.jsx(D5,{position:"top-right"})]})}),XU=_E.createRoot(document.getElementById("root"));XU.render(o.jsx(k.StrictMode,{children:o.jsx(WU,{})}));
